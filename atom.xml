<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>个人博客</title>
  
  <subtitle>一个coder的成长记录</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://betgar.github.io/"/>
  <updated>2019-08-28T04:51:55.248Z</updated>
  <id>https://betgar.github.io/</id>
  
  <author>
    <name>俊男</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>TypeScript类型声明书写</title>
    <link href="https://betgar.github.io/2019/08/26/how-to-declare-typescript-types/"/>
    <id>https://betgar.github.io/2019/08/26/how-to-declare-typescript-types/</id>
    <published>2019-08-26T11:00:00.000Z</published>
    <updated>2019-08-28T04:51:55.248Z</updated>
    
    <content type="html"><![CDATA[<h1 id="TypeScript类型声明书写"><a href="#TypeScript类型声明书写" class="headerlink" title="TypeScript类型声明书写"></a>TypeScript类型声明书写</h1><blockquote><p>本文总结一下TypeScript类型声明的书写，很多时候写TypeScript不是问题，写类型就特别纠结，我总结下，我在使用TypeScript中遇到的问题。如果你遇到类型声明不会写的时候，多看看<code>lodash</code>的声明，因为<code>lodash</code>对数据进行各种变形操作，所以你能遇到的，都有参考示例。</p></blockquote><h2 id="基本类型"><a href="#基本类型" class="headerlink" title="基本类型"></a>基本类型</h2><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 变量</span></span><br><span class="line"><span class="keyword">const</span> num: <span class="built_in">number</span> = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">const</span> str: <span class="built_in">string</span> = <span class="string">'str'</span>;</span><br><span class="line"><span class="keyword">const</span> bool: <span class="built_in">boolean</span> = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> nulls: <span class="literal">null</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">const</span> undefine: <span class="literal">undefined</span> = <span class="literal">undefined</span>;</span><br><span class="line"><span class="keyword">const</span> symbols: Symbol = Symbol(<span class="string">'symbal'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="built_in">any</span>: <span class="built_in">any</span> = <span class="string">'any types'</span>; <span class="comment">// typescript的any类型，相当于什么类型约束都没有</span></span><br></pre></td></tr></table></figure><h2 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h2><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 数组: 推荐使用T[]这种写法</span></span><br><span class="line"><span class="keyword">const</span> nums: <span class="built_in">number</span>[] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 不推荐：Array&lt;T&gt;泛型写法，因为在JSX中不兼容，所以为了统一都使用T[]这种类型</span></span><br><span class="line"><span class="keyword">const</span> strs: <span class="built_in">Array</span>&lt;<span class="built_in">string</span>&gt; = [<span class="string">'s'</span>, <span class="string">'t'</span>, <span class="string">'r'</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> dates: <span class="built_in">Date</span>[] = [<span class="keyword">new</span> <span class="built_in">Date</span>(), <span class="keyword">new</span> <span class="built_in">Date</span>()];</span><br></pre></td></tr></table></figure><h3 id="数组的concat方法，返回类型为never-问题"><a href="#数组的concat方法，返回类型为never-问题" class="headerlink" title="数组的concat方法，返回类型为never[]问题"></a>数组的concat方法，返回类型为never[]问题</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 数组concat方法的never问题</span></span><br><span class="line"><span class="comment">// 提示： Type 'string' is not assignable to type 'never'.</span></span><br><span class="line"><span class="keyword">const</span> arrNever: <span class="built_in">string</span>[] = [].concat([<span class="string">'s'</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 主要问题是：[]数组，ts无法根据上下文判断数组内部元素的类型</span></span><br><span class="line"><span class="comment">// @see https://github.com/Microsoft/TypeScript/issues/10479</span></span><br><span class="line"><span class="keyword">const</span> fixArrNever: <span class="built_in">string</span>[] = ([] <span class="keyword">as</span> <span class="built_in">string</span>[]).concat([<span class="string">'s'</span>]);</span><br></pre></td></tr></table></figure><h2 id="接口"><a href="#接口" class="headerlink" title="接口"></a>接口</h2><p>接口是 TypeScript 的一个核心知识，它能合并众多类型声明至一个类型声明：</p><p>而且接口可以用来声明：函数，类，对象等数据类型</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> Name &#123;</span><br><span class="line">  first: <span class="built_in">string</span>;</span><br><span class="line">  second: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> username: Name = &#123;</span><br><span class="line">  first: <span class="string">'John'</span>,</span><br><span class="line">  second: <span class="string">'Doe'</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="any、null、undefined、void类型"><a href="#any、null、undefined、void类型" class="headerlink" title="any、null、undefined、void类型"></a>any、null、undefined、void类型</h2><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 特殊类型</span></span><br><span class="line"><span class="keyword">const</span> <span class="built_in">any</span>: <span class="built_in">any</span> = <span class="string">'any types'</span>; <span class="comment">// typescript的any类型，相当于什么类型都没写</span></span><br><span class="line"><span class="keyword">let</span> nobody: <span class="built_in">any</span> = <span class="string">'nobody, but you'</span>;</span><br><span class="line">nobody = <span class="number">123</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> nulls: <span class="built_in">number</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">let</span> bool: <span class="built_in">boolean</span> = <span class="literal">undefined</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// void</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">printUsername</span> (<span class="params">name: <span class="built_in">string</span></span>): <span class="title">void</span> </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(name);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="联合类型"><a href="#联合类型" class="headerlink" title="联合类型"></a>联合类型</h2><blockquote><p>联合类型在<code>option bags</code>模式场景非常实用，使用  <strong>| </strong>来做标记</p></blockquote><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">options</span>(<span class="params">opts: &#123;</span></span></span><br><span class="line"><span class="function"><span class="params">    types?: <span class="built_in">string</span>;</span></span></span><br><span class="line"><span class="function"><span class="params">    tag: <span class="built_in">string</span> | <span class="built_in">number</span>;</span></span></span><br><span class="line"><span class="function"><span class="params">&#125;</span>): <span class="title">void</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="交叉类型"><a href="#交叉类型" class="headerlink" title="交叉类型"></a>交叉类型</h2><blockquote><p>最典型的使用场景就是<strong>继承</strong>和<strong>mixin</strong>，或者copy等操作</p></blockquote><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 交叉类型：如果以后遇到此种类型声明不会写，直接看Object.assign声明写法</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">$extend</span>&lt;<span class="title">T</span>, <span class="title">U</span>&gt;(<span class="params">first: T, second: U</span>): <span class="title">T</span> &amp; <span class="title">U</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Object</span>.assign(first, second); <span class="comment">// 示意而已</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="元组-tuple"><a href="#元组-tuple" class="headerlink" title="元组 tuple"></a>元组 tuple</h2><blockquote><p>元组很少使用</p></blockquote><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> nameNumber: [<span class="built_in">string</span>, <span class="built_in">number</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// Ok</span></span><br><span class="line">nameNumber = [<span class="string">'Jenny'</span>, <span class="number">221345</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// Error</span></span><br><span class="line"><span class="comment">// nameNumber = ['Jenny', '221345'];</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> tuple: [<span class="built_in">string</span>, <span class="built_in">number</span>];</span><br><span class="line">nameNumber = [<span class="string">'Jenny'</span>, <span class="number">322134</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> [usernameStr, uselessNum] = nameNumber;</span><br></pre></td></tr></table></figure><h2 id="type的作用"><a href="#type的作用" class="headerlink" title="type的作用"></a>type的作用</h2><blockquote><p>type用来创建新的类型，也可以重命名（别名）已有的类型，建议使用type创建简单类型，无嵌套的或者一层嵌套的类型，其它复杂的类型都应该使用interface, 结合implements ,extends实现。</p></blockquote><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> StrOrNum = <span class="built_in">string</span> | <span class="built_in">number</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用</span></span><br><span class="line"><span class="keyword">let</span> sample: StrOrNum;</span><br><span class="line">sample = <span class="number">123</span>;</span><br><span class="line">sample = <span class="string">'123'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 会检查类型</span></span><br><span class="line">sample = <span class="literal">true</span>; <span class="comment">// Error</span></span><br></pre></td></tr></table></figure><h2 id="实践中遇到的问题"><a href="#实践中遇到的问题" class="headerlink" title="实践中遇到的问题"></a>实践中遇到的问题</h2><h3 id="第三方库没有提供声明d-ts文件"><a href="#第三方库没有提供声明d-ts文件" class="headerlink" title="第三方库没有提供声明d.ts文件"></a>第三方库没有提供声明d.ts文件</h3><blockquote><p>如果第三方库没有提供声明文件，第一时间去微软官方的仓库<a href="https://github.com/borisyankov/DefinitelyTyped" target="_blank" rel="noopener">https://github.com/borisyankov/DefinitelyTyped</a>   查找，或者在<code>npmjs.com</code>上搜索<code>@types/依赖的模块名</code>大部分情况都可以找到。</p></blockquote><ul><li><p>手动添加声明文件</p><blockquote><p>声明文件一般都是统一放置在types文件夹下</p></blockquote><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 例子： types/axios.d.ts</span></span><br><span class="line"><span class="keyword">declare</span> <span class="keyword">module</span> 'axios'; // 这里的axios声明为any类型</span><br></pre></td></tr></table></figure></li></ul><h3 id="全局变量"><a href="#全局变量" class="headerlink" title="全局变量"></a>全局变量</h3><blockquote><p>例如一些库直接把在<code>window</code>上添加的全局变量</p></blockquote><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// globals.d.ts</span></span><br><span class="line"><span class="comment">// 例子：jQuery，现实中jQuery是有.d.ts</span></span><br><span class="line"><span class="keyword">declare</span> <span class="keyword">const</span> jQuery: <span class="built_in">any</span>;</span><br><span class="line"><span class="keyword">declare</span> <span class="keyword">const</span> $: <span class="keyword">typeof</span> jQuery;</span><br></pre></td></tr></table></figure><h3 id="非JavaScript资源"><a href="#非JavaScript资源" class="headerlink" title="非JavaScript资源"></a>非JavaScript资源</h3><blockquote><p>在前端工程中，import很多非js资源，例如：css, html, 图片，vue, 这种ts无法识别的资源时，就需要告诉ts，怎么识别这些导入的资源的类型。</p></blockquote><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 看看vue怎么处理的：shims-vue.d.ts</span></span><br><span class="line"><span class="keyword">declare</span> <span class="keyword">module</span> '*.vue' &#123;</span><br><span class="line">  <span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span>;</span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">default</span> Vue;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// html</span></span><br><span class="line"><span class="keyword">declare</span> <span class="keyword">module</span> '*.html';</span><br><span class="line">// css</span><br><span class="line">declare <span class="keyword">module</span> '*.css';</span><br></pre></td></tr></table></figure><h3 id="强制类型转换"><a href="#强制类型转换" class="headerlink" title="强制类型转换"></a>强制类型转换</h3><blockquote><p>有时候遇到需要强制类型转换，尤其是对<code>联合类型</code>或者可选属性时。</p></blockquote><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 第一种：使用&lt;&gt;括号</span></span><br><span class="line"><span class="keyword">const</span> convertArrType: <span class="built_in">string</span>[] = &lt;<span class="built_in">Array</span>&lt;<span class="built_in">string</span>&gt;&gt;[].concat([<span class="string">'s'</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 第二种：使用as关键字</span></span><br><span class="line"><span class="keyword">const</span> fixArrNever: <span class="built_in">string</span>[] = ([] <span class="keyword">as</span> <span class="built_in">string</span>[]).concat([<span class="string">'s'</span>]);</span><br></pre></td></tr></table></figure><blockquote><p>建议使用第二种，因为兼容<code>JSX</code>，第一种官方也不推荐了，虽然它是合法的。</p></blockquote><h3 id="可选属性和默认属性"><a href="#可选属性和默认属性" class="headerlink" title="可选属性和默认属性"></a>可选属性和默认属性</h3><blockquote><p>API中提供的参数很多都有默认值，或者属性可选，怎么书写呢？</p></blockquote><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> Socket &#123;&#125;</span><br><span class="line"><span class="comment">// 联合类型</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> SocketType = <span class="string">'WebSocket'</span> | <span class="string">'SockJs'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> SocketOptions &#123;</span><br><span class="line">  <span class="keyword">type</span>: SocketType;</span><br><span class="line">  protocols?: <span class="built_in">string</span> | <span class="built_in">string</span>[]; <span class="comment">// 可选</span></span><br><span class="line">  pingMessage: <span class="built_in">string</span> | <span class="function">(<span class="params">(<span class="params"></span>) =&gt; <span class="built_in">string</span></span>); // 联合类型，可以为<span class="params">string</span>或者函数</span></span><br><span class="line"><span class="function">  <span class="params">pongMessage</span>: <span class="params">string</span> | (<span class="params">(<span class="params"></span>) =&gt; <span class="built_in">string</span></span>);</span></span><br><span class="line"><span class="function">&#125;</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">// 默认值</span></span><br><span class="line"><span class="function"><span class="params">export</span> <span class="params">function</span> <span class="params">eventHandler</span> = (<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">  evt: CloseEvent | MessageEvent | Event,</span></span></span><br><span class="line"><span class="function"><span class="params">  socket: Socket,</span></span></span><br><span class="line"><span class="function"><span class="params">  <span class="keyword">type</span> = 'WebSocket' <span class="comment">// 默认值</span></span></span></span><br><span class="line"><span class="function"><span class="params"></span>) =&gt;</span> <span class="built_in">any</span>;</span><br></pre></td></tr></table></figure><h3 id="独立函数怎么声明类型"><a href="#独立函数怎么声明类型" class="headerlink" title="独立函数怎么声明类型"></a>独立函数怎么声明类型</h3><blockquote><p>刚开始我也很纠结这个问题，我就是一个独立的函数，怎么声明类型呢？尤其是写<strong>事件处理函数</strong>的API时。</p></blockquote><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> Socket &#123;&#125;</span><br><span class="line"><span class="comment">// 函数的声明方式</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> SocketEventHandler = (</span><br><span class="line">  evt: CloseEvent | MessageEvent | Event,</span><br><span class="line">  socket: Socket</span><br><span class="line">) =&gt; <span class="built_in">any</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> eventHandler: SocketEventHandler = <span class="function">(<span class="params">evt, socket</span>) =&gt;</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 可选参数和rest参数</span></span><br><span class="line"><span class="keyword">let</span> baz = <span class="function">(<span class="params">x = 1</span>) =&gt;</span> &#123;&#125;;</span><br><span class="line"><span class="keyword">let</span> foo = <span class="function">(<span class="params">x: <span class="built_in">number</span>, y: <span class="built_in">number</span></span>) =&gt;</span> &#123;&#125;;</span><br><span class="line"><span class="keyword">let</span> bar = <span class="function">(<span class="params">x?: <span class="built_in">number</span>, y?: <span class="built_in">number</span></span>) =&gt;</span> &#123;&#125;;</span><br><span class="line"><span class="keyword">let</span> bas = <span class="function">(<span class="params">...args: <span class="built_in">number</span>[]</span>) =&gt;</span> &#123;&#125;;</span><br></pre></td></tr></table></figure><h3 id="索引属性类型声明"><a href="#索引属性类型声明" class="headerlink" title="索引属性类型声明"></a>索引属性类型声明</h3><blockquote><p>JavaScript中的对象都可以使用字符串索引直接取属性或者调用方法，TypeScript中也有相应的类型声明方法。</p></blockquote><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Hello = &#123;</span><br><span class="line">    hello: <span class="string">'world'</span>;</span><br><span class="line">    <span class="comment">// key只是一个形式属性名（类似形参一样）</span></span><br><span class="line">    [key: <span class="built_in">string</span>]: <span class="built_in">string</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> greeting: Hello = &#123;</span><br><span class="line">    hi: <span class="string">'morning'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(greeting[<span class="string">'hi'</span>])</span><br></pre></td></tr></table></figure><h3 id="动态添加的属性声明"><a href="#动态添加的属性声明" class="headerlink" title="动态添加的属性声明"></a>动态添加的属性声明</h3><blockquote><p>有的时候我们只声明了一个基本的类型结构，然后后续有扩展的情况 ，尤其时二次封装时的options。</p></blockquote><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> AxiosOptions &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> AjaxOptions = &#123;</span><br><span class="line">   axiosOptions: AxiosOptions;</span><br><span class="line">   <span class="comment">// 额外扩展的放入到单独的属性节点下 </span></span><br><span class="line">   extraOptions: &#123;</span><br><span class="line">       [prop: <span class="built_in">string</span>]: <span class="built_in">any</span></span><br><span class="line">   &#125;; </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> AjaxOptions1 = &#123;</span><br><span class="line">  axiosOptions?: AxiosOptions;</span><br><span class="line">  <span class="comment">// 不要这样写，因为axiosOptions拼写错误时，ts不会提示</span></span><br><span class="line">  <span class="comment">// 尽量把后续扩展的属性，移动到独立的属性节点下</span></span><br><span class="line">  [prop: <span class="built_in">string</span>]: <span class="built_in">any</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> ajaxOptions: AjaxOptions1 = &#123;</span><br><span class="line">  axiosOptions1: &#123;&#125;; <span class="comment">// 本意是axiosOptions，但是ts不会提示</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="的使用"><a href="#的使用" class="headerlink" title="!的使用"></a>!的使用</h3><blockquote><p>! 标识符告诉ts编译器，声明的变量没有问题，再运行期不会报错。</p></blockquote><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> BaseSelect <span class="keyword">extends</span> Vue &#123;</span><br><span class="line">    options: <span class="built_in">string</span>[]; <span class="comment">// 这里会提示没有在constructor中初始化</span></span><br><span class="line">    </span><br><span class="line">    created() &#123;</span><br><span class="line">        <span class="keyword">this</span>.options = [<span class="string">'inited'</span>]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> BaseSelect <span class="keyword">extends</span> Vue &#123;</span><br><span class="line">    options!: <span class="built_in">string</span>[]; <span class="comment">// 使用 ! 告诉编译器，我知道自己在做什么</span></span><br><span class="line">    </span><br><span class="line">    created() &#123;</span><br><span class="line">        <span class="keyword">this</span>.options = [<span class="string">'inited'</span>]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="this的使用"><a href="#this的使用" class="headerlink" title="this的使用"></a>this的使用</h3><blockquote><p>对于独立使用的函数，可以声明指定的调用上下文</p></blockquote><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> Handler &#123;</span><br><span class="line">    info: <span class="built_in">string</span>;</span><br><span class="line">    <span class="comment">// 声明指定的this上下文</span></span><br><span class="line">    onClickBad(<span class="keyword">this</span>: Handler, e: Event) &#123;</span><br><span class="line">        <span class="comment">// oops, used this here. using this callback would crash at runtime</span></span><br><span class="line">        <span class="keyword">this</span>.info = e.message;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> h = <span class="keyword">new</span> Handler();</span><br><span class="line">uiElement.addClickListener(h.onClickBad); <span class="comment">// error!</span></span><br></pre></td></tr></table></figure><h3 id="声明合并（扩展Vue声明）"><a href="#声明合并（扩展Vue声明）" class="headerlink" title="声明合并（扩展Vue声明）"></a>声明合并（扩展Vue声明）</h3><blockquote><p>来看看使用场景，扩展vue，在vue上添加全局的属性。</p></blockquote><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// vue的声明在 vue/types/vue.d.ts</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">declare</span> <span class="keyword">module</span> 'vue/types/vue' &#123;</span><br><span class="line">  <span class="comment">// 相当于Vue.$eventBus</span></span><br><span class="line">  <span class="keyword">interface</span> Vue &#123;  </span><br><span class="line">    $eventBus: Vue;</span><br><span class="line">  &#125;</span><br><span class="line">    </span><br><span class="line">  <span class="comment">// 相当于在Vue.prototype.$eventBus</span></span><br><span class="line">  <span class="keyword">interface</span> VueConstructor &#123;</span><br><span class="line">    $eventBus: Vue;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><blockquote><p><code>TypeScript</code>声明还有很多高级的用法，目前我也没有用到那么多，在我纠结不会写声明的时候，我就会看看别人的声明文件时怎么写的。</p></blockquote><p><em>注意：尽量不要把<strong>解构</strong>和<strong>声明</strong>写在一起，可读性极差。</em></p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> Node &#123;</span><br><span class="line">  onNodeCheck(checkedKeys: <span class="built_in">any</span>, &#123; <span class="comment">// 解构</span></span><br><span class="line">      checked, checkedNodes, node, event,</span><br><span class="line">    &#125; : &#123; <span class="comment">// 声明</span></span><br><span class="line">      node: <span class="built_in">any</span>;</span><br><span class="line">      [key: <span class="built_in">string</span>]: <span class="built_in">any</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  ) &#123; </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;TypeScript类型声明书写&quot;&gt;&lt;a href=&quot;#TypeScript类型声明书写&quot; class=&quot;headerlink&quot; title=&quot;TypeScript类型声明书写&quot;&gt;&lt;/a&gt;TypeScript类型声明书写&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;本
      
    
    </summary>
    
      <category term="typescript" scheme="https://betgar.github.io/categories/typescript/"/>
    
    
      <category term="typescript" scheme="https://betgar.github.io/tags/typescript/"/>
    
  </entry>
  
  <entry>
    <title>在线工具收集</title>
    <link href="https://betgar.github.io/2019/08/13/online-tools-collection/"/>
    <id>https://betgar.github.io/2019/08/13/online-tools-collection/</id>
    <published>2019-08-13T10:00:00.000Z</published>
    <updated>2019-08-22T00:52:56.689Z</updated>
    
    <content type="html"><![CDATA[<h1 id="在线工具收集"><a href="#在线工具收集" class="headerlink" title="在线工具收集"></a>在线工具收集</h1><ul><li><p>腾讯开发者手册</p><blockquote><p><a href="https://cloud.tencent.com/developer/devdocs" target="_blank" rel="noopener">https://cloud.tencent.com/developer/devdocs</a></p></blockquote></li><li><p>印记中文</p><blockquote><p><a href="https://docschina.org/" target="_blank" rel="noopener">https://docschina.org/</a></p></blockquote></li><li><p>learn git</p><blockquote><p><a href="https://learngitbranching.js.org/" target="_blank" rel="noopener">https://learngitbranching.js.org/</a></p></blockquote></li><li><p>Babel在线编译</p><blockquote><p><a href="https://babeljs.io/repl" target="_blank" rel="noopener">https://babeljs.io/repl</a></p></blockquote></li><li><p>polyfill online</p><blockquote><p><a href="https://polyfill.io/v3/" target="_blank" rel="noopener">https://polyfill.io/v3/</a></p><p><a href="https://polyfill.alicdn.com/polyfill.min.js" target="_blank" rel="noopener">https://polyfill.alicdn.com/polyfill.min.js</a></p></blockquote></li><li><p><code>browserlist</code></p><blockquote><p><a href="https://browserl.ist/" target="_blank" rel="noopener">https://browserl.ist/</a></p></blockquote></li><li><p><code>gitignore</code></p><blockquote><p><a href="https://www.gitignore.io/" target="_blank" rel="noopener">https://www.gitignore.io/</a></p></blockquote></li><li><p><code>webpack config</code></p><blockquote><p><a href="https://www.nkgr.app/webpack-config-generator/" target="_blank" rel="noopener">https://www.nkgr.app/webpack-config-generator/</a></p><p><a href="https://doug2k1.github.io/webpack-generator/" target="_blank" rel="noopener">https://doug2k1.github.io/webpack-generator/</a></p></blockquote></li><li><p>Type Search： typescript的类型文件搜索</p><blockquote><p><a href="https://github.com/DefinitelyTyped/DefinitelyTyped" target="_blank" rel="noopener">https://github.com/DefinitelyTyped/DefinitelyTyped</a></p><p><a href="https://microsoft.github.io/TypeSearch/" target="_blank" rel="noopener">https://microsoft.github.io/TypeSearch/</a></p></blockquote><p><img src="https://raw.githubusercontent.com/betgar/betgar.github.io/master/img/picgo/20190730151042-type-search.gif" alt=""></p></li><li><p>TypeScript starter</p><blockquote><p><a href="https://www.tslang.cn/samples/index.html" target="_blank" rel="noopener">https://www.tslang.cn/samples/index.html</a></p><p><a href="https://www.typescriptlang.org/play/index.html" target="_blank" rel="noopener">https://www.typescriptlang.org/play/index.html</a></p></blockquote><p><img src="https://raw.githubusercontent.com/betgar/betgar.github.io/master/img/picgo/20190730151026-typescript-starter.gif" alt=""></p></li></ul><ul><li><p>wapm(webassembly package manager)</p><blockquote><p><a href="https://wapm.io/" target="_blank" rel="noopener">https://wapm.io/</a></p></blockquote></li><li><p>WasmExplorer(wa在线编译器)</p><blockquote><p><a href="http://mbebenita.github.io/WasmExplorer/" target="_blank" rel="noopener">http://mbebenita.github.io/WasmExplorer/</a></p></blockquote></li><li><p>draw.io</p><blockquote><p><a href="https://www.draw.io/" target="_blank" rel="noopener">https://www.draw.io/</a></p></blockquote></li></ul><p>  <img src="https://raw.githubusercontent.com/betgar/betgar.github.io/master/img/picgo/20190731082353-draw-desktop-download.jpg" alt=""></p><ul><li><p>sql.js</p><blockquote><p><a href="http://kripken.github.io/sql.js/examples/GUI/" target="_blank" rel="noopener">http://kripken.github.io/sql.js/examples/GUI/</a></p></blockquote></li><li><p>uTools</p><blockquote><p><a href="https://u.tools/" target="_blank" rel="noopener">https://u.tools/</a></p></blockquote></li><li><p>online tools </p><blockquote><p><a href="http://tool.oschina.net/" target="_blank" rel="noopener">http://tool.oschina.net/</a></p></blockquote></li><li><p>jsnice: 可以反编译混淆过的代码</p><blockquote><p><a href="http://jsnice.org/" target="_blank" rel="noopener">http://jsnice.org/</a></p></blockquote></li><li><p>Online JavaScript Beautifier</p><blockquote><p><a href="https://beautifier.io/" target="_blank" rel="noopener">https://beautifier.io/</a></p></blockquote></li><li><p>在线工具</p><blockquote><p><a href="https://tool.lu/index.html" target="_blank" rel="noopener">https://tool.lu/index.html</a></p></blockquote></li><li><p>CSS, JavaScript 压缩, 美化, 加密, 解密</p><blockquote><p><a href="https://tool.css-js.com/" target="_blank" rel="noopener">https://tool.css-js.com/</a></p></blockquote></li><li><p>cssdb</p><blockquote><p><a href="https://cssdb.org/" target="_blank" rel="noopener">https://cssdb.org/</a></p><p><a href="https://preset-env.cssdb.org/features" target="_blank" rel="noopener">https://preset-env.cssdb.org/features</a></p></blockquote></li><li><p>css playground</p><blockquote><p><a href="https://preset-env.cssdb.org/playground" target="_blank" rel="noopener">https://preset-env.cssdb.org/playground</a></p></blockquote></li><li><p>stylelint</p><blockquote><p><a href="https://stylelint.io/demo" target="_blank" rel="noopener">https://stylelint.io/demo</a></p></blockquote></li><li><p>cssnano</p><blockquote><p><a href="https://cssnano.co/guides/optimisations/" target="_blank" rel="noopener">https://cssnano.co/guides/optimisations/</a></p></blockquote></li><li><p>node green</p><blockquote><p><a href="https://node.green/" target="_blank" rel="noopener">https://node.green/</a></p></blockquote></li><li><p>ecmascript-compat-table</p><blockquote><p><a href="http://kangax.github.io/compat-table/es6/" target="_blank" rel="noopener">http://kangax.github.io/compat-table/es6/</a></p></blockquote></li><li><p>DOM lint</p><blockquote><p><a href="https://kangax.github.io/domlint/" target="_blank" rel="noopener">https://kangax.github.io/domlint/</a></p></blockquote></li><li><p>es-checker</p><blockquote><p><a href="http://ruanyf.github.io/es-checker/index.cn.html" target="_blank" rel="noopener">http://ruanyf.github.io/es-checker/index.cn.html</a></p></blockquote></li><li><p>htmlhint</p><blockquote><p><a href="https://htmlhint.io/" target="_blank" rel="noopener">https://htmlhint.io/</a></p></blockquote></li><li><p>htmllint</p><blockquote><p><a href="http://htmllint.github.io/" target="_blank" rel="noopener">http://htmllint.github.io/</a></p></blockquote></li><li><p>redis</p><blockquote><p><a href="http://try.redis.io/" target="_blank" rel="noopener">http://try.redis.io/</a></p></blockquote></li><li><p>mdown nice</p><blockquote><p><a href="https://mdnice.com/" target="_blank" rel="noopener">https://mdnice.com/</a></p></blockquote></li><li><p>m2c (markdown to confluence)</p><blockquote><p><a href="https://zhuyi731.github.io/m2c-webpage/" target="_blank" rel="noopener">https://zhuyi731.github.io/m2c-webpage/</a></p><p><a href="https://chunpu.github.io/markdown2confluence/browser/" target="_blank" rel="noopener">https://chunpu.github.io/markdown2confluence/browser/</a></p><p>npm package <code>markdown2confluence-cws</code></p></blockquote></li><li><p>npm trends</p><blockquote><p><a href="https://www.npmtrends.com/" target="_blank" rel="noopener">https://www.npmtrends.com</a></p></blockquote></li><li><p>px2em</p><blockquote><p><a href="https://vasilis.nl/nerd/code/emcalc/" target="_blank" rel="noopener">https://vasilis.nl/nerd/code/emcalc/</a></p></blockquote></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;在线工具收集&quot;&gt;&lt;a href=&quot;#在线工具收集&quot; class=&quot;headerlink&quot; title=&quot;在线工具收集&quot;&gt;&lt;/a&gt;在线工具收集&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;腾讯开发者手册&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://
      
    
    </summary>
    
      <category term="fe" scheme="https://betgar.github.io/categories/fe/"/>
    
    
      <category term="fe" scheme="https://betgar.github.io/tags/fe/"/>
    
  </entry>
  
  <entry>
    <title>常用的npm的packages mirror配置</title>
    <link href="https://betgar.github.io/2019/08/12/npm-packages-mirror-config/"/>
    <id>https://betgar.github.io/2019/08/12/npm-packages-mirror-config/</id>
    <published>2019-08-12T10:00:00.000Z</published>
    <updated>2019-08-13T05:41:32.782Z</updated>
    
    <content type="html"><![CDATA[<h1 id="常用的npm的packages-mirror配置"><a href="#常用的npm的packages-mirror配置" class="headerlink" title="常用的npm的packages mirror配置"></a>常用的npm的packages mirror配置</h1><ul><li><p>chrome driver</p><blockquote><p><a href="https://www.npmjs.com/package/chromedriver" target="_blank" rel="noopener">https://www.npmjs.com/package/chromedriver</a></p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装指定地址</span></span><br><span class="line">npm install chromedriver --chromedriver_cdnurl=https://npm.taobao.org/mirrors/chromedriver</span><br><span class="line"></span><br><span class="line"><span class="comment"># 直接设置`.npmrc`变量</span></span><br><span class="line">npm config <span class="built_in">set</span> chromedriver_cdnurl <span class="string">"https://npm.taobao.org/mirrors/chromedriver"</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 添加环境变量 CHROMEDRIVER_CDNURL</span></span><br><span class="line">CHROMEDRIVER_CDNURL=https://npm.taobao.org/mirrors/chromedriver npm install chromedriver</span><br></pre></td></tr></table></figure></li><li><p>electron</p><blockquote><p><a href="https://npm.taobao.org/mirrors/electron/" target="_blank" rel="noopener">https://npm.taobao.org/mirrors/electron/</a></p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">npm config <span class="built_in">set</span> electron_mirror https://npm.taobao.org/mirrors/electron/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 或者</span></span><br><span class="line">ELECTRON_MIRROR=<span class="string">"https://npm.taobao.org/mirrors/electron/"</span> npm i electron</span><br></pre></td></tr></table></figure></li><li><p>phantomjs</p><blockquote><p><a href="https://github.com/Medium/phantomjs" target="_blank" rel="noopener">https://github.com/Medium/phantomjs</a></p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">npm install phantomjs-prebuilt --phantomjs_cdnurl=https://npm.taobao.org/mirrors/phantomjs/</span><br><span class="line"></span><br><span class="line"><span class="comment"># .npmrc 方式</span></span><br><span class="line">npm config <span class="built_in">set</span> phantomjs_cdnurl https://npm.taobao.org/mirrors/phantomjs/</span><br><span class="line"></span><br><span class="line"><span class="comment"># PATH</span></span><br><span class="line">PHANTOMJS_CDNURL=https://npm.taobao.org/mirrors/phantomjs/</span><br></pre></td></tr></table></figure></li><li><p>node-sass</p><blockquote><p><a href="https://github.com/sass/node-sass" target="_blank" rel="noopener">https://github.com/sass/node-sass</a></p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm install -g mirror-config-china --registry=http://registry.npm.taobao.org</span><br><span class="line"><span class="comment"># .npmrc</span></span><br><span class="line">npm config <span class="built_in">set</span> sass_binary_site https://npm.taobao.org/mirrors/node-sass/</span><br></pre></td></tr></table></figure></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;常用的npm的packages-mirror配置&quot;&gt;&lt;a href=&quot;#常用的npm的packages-mirror配置&quot; class=&quot;headerlink&quot; title=&quot;常用的npm的packages mirror配置&quot;&gt;&lt;/a&gt;常用的npm的package
      
    
    </summary>
    
      <category term="npm" scheme="https://betgar.github.io/categories/npm/"/>
    
    
      <category term="npm" scheme="https://betgar.github.io/tags/npm/"/>
    
  </entry>
  
  <entry>
    <title>Polyfill 方案的过去、现在和未来</title>
    <link href="https://betgar.github.io/2019/08/04/polyfill-passed-current-future/"/>
    <id>https://betgar.github.io/2019/08/04/polyfill-passed-current-future/</id>
    <published>2019-08-04T11:00:00.000Z</published>
    <updated>2019-08-04T09:25:02.965Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Polyfill-方案的过去、现在和未来"><a href="#Polyfill-方案的过去、现在和未来" class="headerlink" title="Polyfill 方案的过去、现在和未来"></a>Polyfill 方案的过去、现在和未来</h1><blockquote><p>作者：sorrycc </p><p>日期：2019-01-29 01:31:04</p><p>原文地址: <a href="https://github.com/sorrycc/blog/issues/80" target="_blank" rel="noopener">https://github.com/sorrycc/blog/issues/80</a></p><p>blog: <a href="https://gitissue.com/issues/5c4fe57daba98d5c7d6f4e2c" target="_blank" rel="noopener">https://gitissue.com/issues/5c4fe57daba98d5c7d6f4e2c</a></p></blockquote><p>任何一个小知识点，深挖下去，也是非常有意思的。</p><h2 id="什么是补丁？"><a href="#什么是补丁？" class="headerlink" title="什么是补丁？"></a>什么是补丁？</h2><blockquote><p>A polyfill, or polyfiller, is a piece of code (or plugin) that provides the technology that you, the developer, expect the browser to provide natively. Flattening the API landscape if you will.</p></blockquote><p>我们希望浏览器提供一些特性，但是没有，然后我们自己写一段代码来实现他，那这段代码就是补丁。</p><p>比如 <a href="https://caniuse.com/#feat=promises" target="_blank" rel="noopener">IE11 不支持 Promise</a>，而我们又需要在项目里用到，写了这样的代码：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">  Promise.resolve(&apos;bar&apos;)</span><br><span class="line">    .then(function(foo) &#123;</span><br><span class="line">      document.write(foo);</span><br><span class="line">    &#125;);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>这时在 IE 下运行就会报错了，</p><p>[<figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https://camo.githubusercontent.com/348c3453fc18218b9a60e6eb67821c83e1ec8bdf/68747470733a2f2f67772e616c697061796f626a656374732e636f6d2f7a6f732f726d73706f7274616c2f6b766d4e755778747758636e764f574f6c6f4d752e706e67" alt="img](https://camo.githubusercontent.com/348c3453fc18218b9a60e6eb67821c83e1ec8bdf/68747470733a2f2f67772e616c697061796f626a656374732e636f6d2f7a6f732f726d73706f7274616c2f6b766d4e755778747758636e764f574f6c6f4d752e706e67)" title="">                </div>                <div class="image-caption">img](https://camo.githubusercontent.com/348c3453fc18218b9a60e6eb67821c83e1ec8bdf/68747470733a2f2f67772e616c697061796f626a656374732e636f6d2f7a6f732f726d73706f7274616c2f6b766d4e755778747758636e764f574f6c6f4d752e706e67)</div>            </figure></p><p>然后在此之前加上补丁，</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=&quot;https://cdn.jsdelivr.net/npm/promise-polyfill@8/dist/polyfill.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">  Promise.resolve(&apos;bar&apos;)</span><br><span class="line">    .then(function(foo) &#123;</span><br><span class="line">      document.write(foo);</span><br><span class="line">    &#125;);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>刷新浏览器，就可以正常运行了，</p><p>[<figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https://camo.githubusercontent.com/d8aae6399751c7cc33c634397162e0d3dfd3f31e/68747470733a2f2f67772e616c697061796f626a656374732e636f6d2f7a6f732f726d73706f7274616c2f6c6b7a4e70546878667a7565506a51736f586a792e706e67" alt="img](https://camo.githubusercontent.com/d8aae6399751c7cc33c634397162e0d3dfd3f31e/68747470733a2f2f67772e616c697061796f626a656374732e636f6d2f7a6f732f726d73706f7274616c2f6c6b7a4e70546878667a7565506a51736f586a792e706e67)" title="">                </div>                <div class="image-caption">img](https://camo.githubusercontent.com/d8aae6399751c7cc33c634397162e0d3dfd3f31e/68747470733a2f2f67772e616c697061796f626a656374732e636f6d2f7a6f732f726d73706f7274616c2f6c6b7a4e70546878667a7565506a51736f586a792e706e67)</div>            </figure></p><h2 id="过去"><a href="#过去" class="headerlink" title="过去"></a>过去</h2><h3 id="shim-sham"><a href="#shim-sham" class="headerlink" title="shim + sham"></a>shim + sham</h3><p>如果你是一个 3 年陈 + 的前端，应该会有听说过 shim、sham、<a href="https://github.com/es-shims/es5-shim" target="_blank" rel="noopener">es5-shim</a> 和 <a href="https://github.com/es-shims/es6-shim" target="_blank" rel="noopener">es6-shim</a> 等等现在看起来很古老的补丁方式。</p><p>那么，shim 和 sham 是啥？又有什么区别？</p><ul><li>shim 是<strong>能用</strong>的补丁</li><li>sham 顾名思义，是假的意思，所以 sham 是一些<strong>假的方法</strong>，只能使用保证不出错，但不能用。至于为啥会有 sham，因为有些方法的低端浏览器里根本实现不了</li></ul><h3 id="babel-polyfill-js"><a href="#babel-polyfill-js" class="headerlink" title="babel-polyfill.js"></a>babel-polyfill.js</h3><p>在 shim 和 sham 之后，还有一种补丁方式是引入包含所有语言层补丁的 <code>babel-polyfill.js</code>。比如：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdnjs.cloudflare.com/ajax/libs/babel-polyfill/7.2.5/polyfill.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>然后就 es6、es7 特性随便写了。</p><p>但缺点是，babel-polyfill 包含所有补丁，不管浏览器是否支持，也不管你的项目是否有用到，都全量引了，所以如果你的用户全都不差流量和带宽（比如内部应用），尽可以用这种方式。</p><h2 id="现在"><a href="#现在" class="headerlink" title="现在"></a>现在</h2><p>现在还没有银弹，各种方案百花齐放。</p><h3 id="babel-preset-env-useBuiltins-entry-targets"><a href="#babel-preset-env-useBuiltins-entry-targets" class="headerlink" title="@babel/preset-env + useBuiltins: entry + targets"></a>@babel/preset-env + useBuiltins: entry + targets</h3><p>babel-polyfill 包含所有补丁，那我只需要支持某些浏览器的某些版本，是否有办法只包含这些浏览器的补丁？这就是 <code>@babel/preset-env</code> + <code>useBuiltins: entry</code> + <code>targets</code> 配置的方案。</p><p>我们先在入口文件里引入 <code>@babel/polyfill</code>，</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'@babel/polyfill'</span>;</span><br></pre></td></tr></table></figure><p>然后配置 .babelrc，添加 preset <code>@babel/preset-env</code>，并设置 <code>useBuiltIns</code> 和 <code>targets</code>，</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"presets"</span>: [</span><br><span class="line">    [<span class="string">"@babel/env"</span>, &#123;</span><br><span class="line">      useBuiltIns: <span class="string">'entry'</span>,</span><br><span class="line">      targets: &#123; <span class="attr">chrome</span>: <span class="number">62</span> &#125;</span><br><span class="line">    &#125;]</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>useBuiltIns: entry</code> 的含义是找到入口文件里引入的 <code>@babel/polyfill</code>，并替换为 targets 浏览器/环境需要的补丁列表。</p><p>替换后的内容，比如：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">"core-js/modules/es7.string.pad-start"</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">"core-js/modules/es7.string.pad-end"</span>;</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>这样就只会引入 chrome@62 及以上所需要的补丁，什么 Promise 之类的都不会再打包引入。</p><blockquote><p>是不是很好用？</p></blockquote><p>😄</p><blockquote><p>有什么问题？</p></blockquote><p>🤔</p><p>细细想想，其实还有不少问题，</p><ol><li>特性列表是按浏览器整理的，那怎么知道哪些特性我用了，哪些没有用到，没有用到的部分也引入了是不是也是冗余？<code>@babel/preset-env</code> 有提供 <a href="https://babeljs.io/docs/en/next/babel-preset-env.html#exclude" target="_blank" rel="noopener">exclude</a> 的配置，如果我配置了 exclude，后面是否得小心翼翼地确保不要用到 exclude 掉的特性</li><li>补丁是打包到静态文件的，如果我配置 targets 为 <code>chrome: 62, ie: 9</code>，那意味着 chrome 62 也得载入 ie 9 相关的补丁，这也是一份冗余</li><li>我们是基于 core-js 打的补丁，所以只会包含 ecmascript 规范里的内容，其他比如说 dom 里的补丁，就不在此列，应该如何处理？</li></ol><h3 id="手动引入"><a href="#手动引入" class="headerlink" title="手动引入"></a>手动引入</h3><p>传统的手动打补丁方案虽然低效，但直观有用。有些非常在乎性能的场景，比如我们公司的部分无线 H5 业务，他们宁可牺牲效率也要追求性能。所以他们的补丁方案是手动引入 <a href="https://github.com/zloirock/core-js/tree/v2/modules" target="_blank" rel="noopener">core-js/modules</a> 下的文件，缺啥加啥就好。</p><p>注意：</p><ol><li>core-js 目前用的是 v2 版本，不是 v3-beta</li><li>补丁用的是 core-js/modules，而不是 <a href="https://github.com/zloirock/core-js/tree/v2/library" target="_blank" rel="noopener">core-js/library</a>。为啥？二者又有啥区别呢？</li></ol><h3 id="在线补丁，比如：polyfill-io"><a href="#在线补丁，比如：polyfill-io" class="headerlink" title="在线补丁，比如：polyfill.io"></a>在线补丁，比如：polyfill.io</h3><p>前面的手动引入解决的是特性列表的问题，有了特性列表，要做到按需下载，就需要用到在线的补丁服务了。目前最流行的应该就是 <a href="https://polyfill.io/" target="_blank" rel="noopener">polyfill.io</a>，提供的是 cdn 服务，有些站点在用，例如 <a href="https://spectrum.chat/。另外，polyfill.io" target="_blank" rel="noopener">https://spectrum.chat/。另外，polyfill.io</a> 还开源了 <a href="https://github.com/financial-times/polyfill-service" target="_blank" rel="noopener">polyfill-service</a> 供我们自己搭建使用。</p><p>使用上，比如：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://polyfill.io/v3/polyfill.min.js?features=default%2CPromise"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>然后在 Chrome@71 下的输出是：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Disable minification (remove `.min` from URL path) for more info */</span></span><br></pre></td></tr></table></figure><p>啥都没有，因为 Promsie 特性 Chrome@71 已经支持了。</p><h2 id="未来"><a href="#未来" class="headerlink" title="未来"></a>未来</h2><p>关于补丁方案的未来，我觉得<strong>按需特性探测 + 在线补丁</strong>才是终极方案。</p><p>按需特性探测保证特性的最小集；在线补丁做按需下载。</p><p>按需特性探测可以用 <code>@babel/preset-env</code> 配上 <code>targets</code> 以及试验阶段的 <code>useBuiltIns: usage</code>，保障特性集的最小化。之所以说是未来，因为 JavaScript 的动态性，语法探测不太可能探测出所有特性，但上了 TypeScript 之后可能会好一些。另外，要注意一个前提是 node_modules 也需要走 babel 编译，不然 node_modules 下用到的特性会探测不出来。</p><p>在线补丁可以用类似前面介绍的 <a href="https://polyfill.io/" target="_blank" rel="noopener">https://polyfill.io/</a> 提供的方案，让浏览器只下载必要的补丁，通常大公司用的话会部署一份到自己的 cdn 上。（阿里好像有团队部署了，但一时间想不起地址了。）</p><h2 id="FAQ"><a href="#FAQ" class="headerlink" title="FAQ"></a>FAQ</h2><h3 id="组件应该包含补丁吗？比如-dva-里用了-Promise，是否应该把-Promise-打在-dva-的产出里？"><a href="#组件应该包含补丁吗？比如-dva-里用了-Promise，是否应该把-Promise-打在-dva-的产出里？" class="headerlink" title="组件应该包含补丁吗？比如 dva 里用了 Promise，是否应该把 Promise 打在 dva 的产出里？"></a>组件应该包含补丁吗？比如 dva 里用了 Promise，是否应该把 Promise 打在 dva 的产出里？</h3><p><strong>不应该。</strong> 比如项目了依赖了 a 和 b，a 和 b 都包含 Promise 的补丁，就会有冗余。所以组件不应该包含补丁，补丁应该由项目决定。</p><h3 id="组件不包含补丁？那需要处理啥？"><a href="#组件不包含补丁？那需要处理啥？" class="headerlink" title="组件不包含补丁？那需要处理啥？"></a>组件不包含补丁？那需要处理啥？</h3><p>通常不需要做特殊处理，但是有些语言特性的实现会需要引入额外的 helper 方法。</p><p>比如：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(&#123; ...a &#125;);</span><br></pre></td></tr></table></figure><p>编译后是：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">_objectSpread</span>(<span class="params">target</span>) </span>&#123; <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">1</span>; i &lt; <span class="built_in">arguments</span>.length; i++) &#123; <span class="keyword">var</span> source = <span class="built_in">arguments</span>[i] != <span class="literal">null</span> ? <span class="built_in">arguments</span>[i] : &#123;&#125;; <span class="keyword">var</span> ownKeys = <span class="built_in">Object</span>.keys(source); <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="built_in">Object</span>.getOwnPropertySymbols === <span class="string">'function'</span>) &#123; ownKeys = ownKeys.concat(<span class="built_in">Object</span>.getOwnPropertySymbols(source).filter(<span class="function"><span class="keyword">function</span> (<span class="params">sym</span>) </span>&#123; <span class="keyword">return</span> <span class="built_in">Object</span>.getOwnPropertyDescriptor(source, sym).enumerable; &#125;)); &#125; ownKeys.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">key</span>) </span>&#123; _defineProperty(target, key, source[key]); &#125;); &#125; <span class="keyword">return</span> target; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">_defineProperty</span>(<span class="params">obj, key, value</span>) </span>&#123; <span class="keyword">if</span> (key <span class="keyword">in</span> obj) &#123; <span class="built_in">Object</span>.defineProperty(obj, key, &#123; <span class="attr">value</span>: value, <span class="attr">enumerable</span>: <span class="literal">true</span>, <span class="attr">configurable</span>: <span class="literal">true</span>, <span class="attr">writable</span>: <span class="literal">true</span> &#125;); &#125; <span class="keyword">else</span> &#123; obj[key] = value; &#125; <span class="keyword">return</span> obj; &#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(_objectSpread(&#123;&#125;, a));</span><br></pre></td></tr></table></figure><p>然后我们会有很多文件，每个文件都引入一遍 helper 方法，会有很多冗余。所以我们通常会使用 <a href="https://babeljs.io/docs/en/next/babel-plugin-transform-runtime.html" target="_blank" rel="noopener">@babel/plugin-transform-runtime</a> 来复用这些 helper 方法。</p><p>在 <code>.babelrc</code> 里配置：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"plugins"</span>: [</span><br><span class="line">    <span class="string">"@babel/transform-runtime"</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>编译后是：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> _interopRequireDefault = <span class="built_in">require</span>(<span class="string">"@babel/runtime/helpers/interopRequireDefault"</span>);</span><br><span class="line"><span class="keyword">var</span> _objectSpread2 = _interopRequireDefault(<span class="built_in">require</span>(<span class="string">"@babel/runtime/helpers/objectSpread"</span>));</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log((<span class="number">0</span>, _objectSpread2.default)(&#123;&#125;, a));</span><br></pre></td></tr></table></figure><p>所以，组件编译只要确保没有冗余的 helper 方法就好了。</p><h3 id="core-js-library-or-core-js-modules？"><a href="#core-js-library-or-core-js-modules？" class="headerlink" title="core-js/library or core-js/modules？"></a>core-js/library or core-js/modules？</h3><p>core-js 提供了两种补丁方式。</p><ol><li><code>core-js/library</code>，通过 helper 方法的方式提供</li><li><code>core-js/module</code>，通过覆盖全局变量的方式提供</li></ol><p>举个例子，</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'@babel/polyfill'</span>;</span><br><span class="line"><span class="built_in">Promise</span>.resolve(<span class="string">'foo'</span>);</span><br></pre></td></tr></table></figure><p><code>.babelrc</code> 配：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"presets"</span>: [</span><br><span class="line">    [<span class="string">"@babel/env"</span>, &#123;</span><br><span class="line">    <span class="string">"useBuiltIns"</span>: <span class="string">"entry"</span>,</span><br><span class="line">      <span class="string">"targets"</span>: &#123;</span><br><span class="line">        <span class="string">"ie"</span>: <span class="number">9</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;]</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>编译结果是：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">"core-js/modules/es6.promise"</span>);</span><br><span class="line"><span class="built_in">require</span>(<span class="string">"core-js/modules/es7.promise.finally"</span>);</span><br><span class="line"><span class="comment">// 此处省略数十个其他补丁...</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Promise</span>.resolve(<span class="string">'foo'</span>);</span><br></pre></td></tr></table></figure><p>然后把文件内容换成：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// import '@babel/polyfill';</span></span><br><span class="line"><span class="built_in">Promise</span>.resolve(<span class="string">'foo'</span>);</span><br></pre></td></tr></table></figure><p><code>.babelrc</code> 配：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"plugins"</span>: [</span><br><span class="line">    [<span class="string">"@babel/transform-runtime"</span>, &#123;</span><br><span class="line">      <span class="string">"corejs"</span>: <span class="number">2</span></span><br><span class="line">    &#125;]</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>编译结果是：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> _interopRequireDefault = <span class="built_in">require</span>(<span class="string">"@babel/runtime-corejs2/helpers/interopRequireDefault"</span>);</span><br><span class="line"><span class="keyword">var</span> _promise = _interopRequireDefault(<span class="built_in">require</span>(<span class="string">"@babel/runtime-corejs2/core-js/promise"</span>));</span><br><span class="line"></span><br><span class="line">_promise.default.resolve(<span class="string">'foo'</span>);</span><br></pre></td></tr></table></figure><p>然后 <code>@babel/runtime-corejs2/core-js/promise</code> 的内容是：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="built_in">require</span>(<span class="string">"core-js/library/fn/promise"</span>);</span><br></pre></td></tr></table></figure><p>目前推荐是用 <code>core-js/modules</code>，因为 node_modules 不走 babel 编译，所以 <code>core-js/library</code> 的方式无法为依赖库提供补丁。</p><h3 id="非-core-js-里的特性，如何打补丁？"><a href="#非-core-js-里的特性，如何打补丁？" class="headerlink" title="非 core-js 里的特性，如何打补丁？"></a>非 core-js 里的特性，如何打补丁？</h3><p>手动引入，比如 <a href="https://github.com/andyearnshaw/Intl.js/" target="_blank" rel="noopener">Intl.js</a>、URL 等。但是得小心有些规范后续加入 ecmascript 之后可能的冗余，比如 <a href="https://github.com/zloirock/core-js/pull/454" target="_blank" rel="noopener">URL</a>。</p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><a href="http://2ality.com/2011/12/shim-vs-polyfill.html" target="_blank" rel="noopener">http://2ality.com/2011/12/shim-vs-polyfill.html</a></li><li><a href="https://babeljs.io/docs/en/next/babel-preset-env.html" target="_blank" rel="noopener">https://babeljs.io/docs/en/next/babel-preset-env.html</a></li><li><a href="https://github.com/zloirock/core-js/tree/v2" target="_blank" rel="noopener">https://github.com/zloirock/core-js/tree/v2</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Polyfill-方案的过去、现在和未来&quot;&gt;&lt;a href=&quot;#Polyfill-方案的过去、现在和未来&quot; class=&quot;headerlink&quot; title=&quot;Polyfill 方案的过去、现在和未来&quot;&gt;&lt;/a&gt;Polyfill 方案的过去、现在和未来&lt;/h1&gt;&lt;
      
    
    </summary>
    
      <category term="babel" scheme="https://betgar.github.io/categories/babel/"/>
    
    
      <category term="babel" scheme="https://betgar.github.io/tags/babel/"/>
    
  </entry>
  
  <entry>
    <title>一步一步配置Typescript工程</title>
    <link href="https://betgar.github.io/2019/08/01/the-steps-of-configuration-typescript/"/>
    <id>https://betgar.github.io/2019/08/01/the-steps-of-configuration-typescript/</id>
    <published>2019-08-01T05:00:00.000Z</published>
    <updated>2019-08-02T06:36:02.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="一步一步配置Typescript工程"><a href="#一步一步配置Typescript工程" class="headerlink" title="一步一步配置Typescript工程"></a>一步一步配置Typescript工程</h2><blockquote><p>这里列举一下本工程配置的步骤，有兴趣可以了解。</p></blockquote><ul><li><p>README模板选择</p><blockquote><p><a href="https://gist.github.com/PurpleBooth/109311bb0361f32d87a2" target="_blank" rel="noopener">README模板</a></p></blockquote></li></ul><ul><li><p>LICENSE模板选择</p><blockquote><p><a href="https://choosealicense.com/" target="_blank" rel="noopener">CHOOSE LICENSE</a></p></blockquote></li></ul><h2 id="项目初始化"><a href="#项目初始化" class="headerlink" title="项目初始化"></a>项目初始化</h2><ul><li><p>初始化project</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 初始化仓库</span></span><br><span class="line">git init</span><br><span class="line"></span><br><span class="line"><span class="comment"># 初始化package信息</span></span><br><span class="line">npm init</span><br></pre></td></tr></table></figure></li><li><p><code>.gitignore</code></p><p><a href="https://www.gitignore.io/" target="_blank" rel="noopener">gitignore在线生成</a></p></li><li><p><code>.editorconfig</code></p><p><a href="https://editorconfig.org/" target="_blank" rel="noopener">EditorConfig网站</a></p></li><li><p><code>.browserlistrc</code>目标环境<br><a href="https://browsersl.ist/" target="_blank" rel="noopener">在线生成及查看浏览器覆盖情况</a></p></li></ul><h2 id="Babel安装和配置"><a href="#Babel安装和配置" class="headerlink" title="Babel安装和配置"></a>Babel安装和配置</h2><blockquote><p>Babel的相关文档链接</p></blockquote><p><a href="https://babeljs.io/docs/en/presets" target="_blank" rel="noopener">babel presets文档</a></p><p><a href="https://babeljs.io/docs/en/babel-polyfill" target="_blank" rel="noopener">babel-polyfill文档</a></p><p><a href="https://babeljs.io/docs/en/config-files" target="_blank" rel="noopener">babel config文档</a></p><p><a href="https://babeljs.io/docs/en/plugins#experimental" target="_blank" rel="noopener">babel proposal文档</a></p><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><ul><li>安装Babel</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i --save-dev @babel/core @babel/cli @babel/preset-env @babel/preset-typescript</span><br></pre></td></tr></table></figure><ul><li>安装proposal</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i --save-dev @babel/plugin-proposal-class-properties @babel/plugin-proposal-object-rest-spread</span><br></pre></td></tr></table></figure><ul><li>安装polyfill<blockquote><p><code>@babel/polyfill</code>在<code>babel v7.4.0</code> 之后为deprecated</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 如果需要polyfill</span></span><br><span class="line"><span class="comment"># 注意：core-js版本, babel 7.4.0之后@babel/polyfill过时，默认依赖core-js@2版本，也可以指定3</span></span><br><span class="line">npm i @babel/polyfill core-js</span><br></pre></td></tr></table></figure></blockquote></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 如果之前在entry这么引入polyfill</span></span><br><span class="line"><span class="comment">// before</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">"@babel/polyfill"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 现在替换为这种方式（core-js@3）</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">"core-js/stable"</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">"regenerator-runtime/runtime"</span>;</span><br></pre></td></tr></table></figure><h3 id="Babel配置"><a href="#Babel配置" class="headerlink" title="Babel配置"></a>Babel配置</h3><blockquote><p>仅供参考，你可以自己自定义</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// babel.config.js</span></span><br><span class="line"><span class="comment">// targets推荐使用.browserslistrc替换</span></span><br><span class="line"><span class="keyword">const</span> presets = [</span><br><span class="line">  [</span><br><span class="line">    <span class="string">'@babel/preset-env'</span>,</span><br><span class="line">    &#123;</span><br><span class="line">      useBuiltIns: <span class="string">'usage'</span>,</span><br><span class="line">      corejs: <span class="number">3</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  ],</span><br><span class="line">  [</span><br><span class="line">    <span class="string">'@babel/preset-typescript'</span>,</span><br><span class="line">  ],</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> plugins = [</span><br><span class="line">  <span class="string">'@babel/plugin-proposal-class-properties'</span>,</span><br><span class="line">  <span class="string">'@babel/plugin-proposal-object-rest-spread'</span>,</span><br><span class="line">];</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  presets,</span><br><span class="line">  plugins,</span><br><span class="line">  exclude: [</span><br><span class="line">    <span class="string">'src/**/*.spec.(js|ts)'</span>,</span><br><span class="line">    <span class="string">'src/**/*.test.(js|ts)'</span>,</span><br><span class="line">  ],</span><br><span class="line">  comments: <span class="literal">false</span>,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="eslint配置"><a href="#eslint配置" class="headerlink" title="eslint配置"></a>eslint配置</h2><h3 id="安装eslint并初始化"><a href="#安装eslint并初始化" class="headerlink" title="安装eslint并初始化"></a>安装eslint并初始化</h3><blockquote><p>因为TypeScript官方团队选择支持eslint，所以以后还是选择eslint玩吧。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装</span></span><br><span class="line">npm i -D eslint</span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成默认的配置，因为格式化是ts，默认先不选代码风格</span></span><br><span class="line">npx eslint --init</span><br></pre></td></tr></table></figure></p></blockquote><p>  <img src="https://raw.githubusercontent.com/betgar/betgar.github.io/master/img/picgo/20190802100425-eslint-init.gif" alt=""></p><h3 id="安装TypeScript解析器和插件"><a href="#安装TypeScript解析器和插件" class="headerlink" title="安装TypeScript解析器和插件"></a>安装TypeScript解析器和插件</h3><blockquote><p>typescript-eslint<br>因为eslint的解析器不认识TypeScript，所以这里需要替换掉默认的parser<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># @typescript-eslint/parser</span></span><br><span class="line">npm i --save-dev typescript @typescript-eslint/parser</span><br></pre></td></tr></table></figure></p></blockquote><h3 id="代码风格-typescript-eslint-Prettier-airbnb"><a href="#代码风格-typescript-eslint-Prettier-airbnb" class="headerlink" title="代码风格(typescript-eslint + Prettier + airbnb)"></a>代码风格(typescript-eslint + Prettier + airbnb)</h3><p><a href="https://github.com/typescript-eslint/typescript-eslint/tree/master/packages/eslint-plugin" target="_blank" rel="noopener">@typescript-eslint/eslint-plugin文档</a></p><p><a href="https://github.com/typescript-eslint/typescript-eslint/tree/master/packages/eslint-plugin#supported-rules" target="_blank" rel="noopener"> @typescript-eslint/eslint-plugin支持的规则</a></p><p><a href="https://github.com/AlloyTeam/eslint-config-alloy" target="_blank" rel="noopener">建议以后选择eslint-config-alloy</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装@typescript-eslint/eslint-plugin</span></span><br><span class="line">npm i --save-dev @typescript-eslint/eslint-plugin</span><br></pre></td></tr></table></figure><h3 id="Prettier一起使用（可选）"><a href="#Prettier一起使用（可选）" class="headerlink" title="Prettier一起使用（可选）"></a>Prettier一起使用（可选）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i --save-dev eslint-config-prettier</span><br></pre></td></tr></table></figure><h3 id="airbnb一起使用（可选）"><a href="#airbnb一起使用（可选）" class="headerlink" title="airbnb一起使用（可选）"></a>airbnb一起使用（可选）</h3><blockquote><p><a href="https://github.com/airbnb/javascript/tree/master/packages/eslint-config-airbnb" target="_blank" rel="noopener">eslint-config-airbnb文档</a></p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 注意：官方文档要求npm 5+</span></span><br><span class="line">npx install-peerdeps --dev eslint-config-airbnb</span><br></pre></td></tr></table></figure><h3 id="eslint的最终的配置"><a href="#eslint的最终的配置" class="headerlink" title="eslint的最终的配置"></a>eslint的最终的配置</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// .eslintrc.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">parser: <span class="string">'@typescript-eslint/parser'</span>, <span class="comment">// 解析器</span></span><br><span class="line">plugins: [<span class="string">'@typescript-eslint'</span>],</span><br><span class="line">extends: [</span><br><span class="line"><span class="string">'airbnb'</span>,</span><br><span class="line"><span class="string">'plugin:@typescript-eslint/recommended'</span>,</span><br><span class="line"><span class="string">'prettier'</span>,</span><br><span class="line"><span class="string">'prettier/@typescript-eslint'</span>,</span><br><span class="line">],</span><br><span class="line">env: &#123;</span><br><span class="line">browser: <span class="literal">true</span>,</span><br><span class="line">es6: <span class="literal">true</span>,</span><br><span class="line">node: <span class="literal">true</span>,</span><br><span class="line">&#125;,</span><br><span class="line">globals: &#123;</span><br><span class="line">Atomics: <span class="string">'readonly'</span>,</span><br><span class="line">SharedArrayBuffer: <span class="string">'readonly'</span>,</span><br><span class="line">&#125;,</span><br><span class="line">parserOptions: &#123;</span><br><span class="line">ecmaVersion: <span class="number">2018</span>,</span><br><span class="line">sourceType: <span class="string">'module'</span>,</span><br><span class="line">&#125;,</span><br><span class="line">rules: &#123;</span><br><span class="line">    <span class="string">'@typescript-eslint/no-explicit-any'</span>: [<span class="string">'off'</span>],</span><br><span class="line"><span class="string">'@typescript-eslint/no-var-requires'</span>: [<span class="string">'off'</span>]</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><blockquote><p>因为eslint默认识别.js结尾的文件，这里需要指定下文件后缀<br>eslint之后是文件夹, –ext参数才生效，如果是具体的正则表达式则匹配–ext被忽略<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// package.json</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"scripts"</span>:&#123;</span><br><span class="line">     <span class="string">"lint"</span>: <span class="string">"eslint src --ext .js,.ts,.tsx,.jsx"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></blockquote><h2 id="TypeScript配置"><a href="#TypeScript配置" class="headerlink" title="TypeScript配置"></a>TypeScript配置</h2><blockquote><p><a href="https://www.tslang.cn/docs/handbook/compiler-options.html" target="_blank" rel="noopener">编译器的options配置</a></p></blockquote><h3 id="tsconfig-json初始化"><a href="#tsconfig-json初始化" class="headerlink" title="tsconfig.json初始化"></a>tsconfig.json初始化</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx tsc --init --declaration --allowSyntheticDefaultImports --target esnext --outDir dist</span><br></pre></td></tr></table></figure><blockquote><p>添加scripts命令<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// package.json</span></span><br><span class="line">&#123;</span><br><span class="line">   <span class="string">"scripts"</span>: &#123;</span><br><span class="line">    <span class="string">"checktypes"</span>: <span class="string">"tsc --noEmit"</span>,</span><br><span class="line">    <span class="string">"checktypes:watch"</span>: <span class="string">"npm run checktype -- --watch"</span>,</span><br><span class="line">    <span class="string">"build"</span>: <span class="string">"npm run build:types &amp;&amp; npm run build:js"</span>,</span><br><span class="line">    <span class="string">"build:types"</span>: <span class="string">"tsc --emitDeclarationOnly"</span>,</span><br><span class="line">    <span class="string">"build:js"</span>: <span class="string">"npx babel src --out-dir dist --source-maps inline --extensions .ts,.tsx"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></blockquote><blockquote><p>package.json指定声明文件入口<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="comment">// 如果不指定默认查找project根目录的index.d.ts</span></span><br><span class="line">  <span class="string">"types"</span>: <span class="string">"dist/index.d"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></blockquote><h2 id="webpack"><a href="#webpack" class="headerlink" title="webpack"></a>webpack</h2><h3 id="安装webpack"><a href="#安装webpack" class="headerlink" title="安装webpack"></a>安装webpack</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev webpack webpack-cli babel-loader</span><br></pre></td></tr></table></figure><h3 id="配置webpack"><a href="#配置webpack" class="headerlink" title="配置webpack"></a>配置webpack</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  mode: <span class="string">"production"</span>,</span><br><span class="line">entry: <span class="string">'./src/index'</span>,</span><br><span class="line">output: &#123;</span><br><span class="line">path: path.resolve(__dirname, <span class="string">'dist'</span>),</span><br><span class="line">filename: <span class="string">'app.bundle.js'</span></span><br><span class="line">&#125;,</span><br><span class="line">resolve: &#123;</span><br><span class="line">extensions: [<span class="string">'.ts'</span>, <span class="string">'.tsx'</span>, <span class="string">'.js'</span>, <span class="string">'.json'</span>]</span><br><span class="line">&#125;,</span><br><span class="line"><span class="built_in">module</span>: &#123;</span><br><span class="line">rules: [</span><br><span class="line">&#123;</span><br><span class="line">test: <span class="regexp">/\.(ts|js)x?$/</span>,</span><br><span class="line">exclude: <span class="regexp">/node_modules/</span>,</span><br><span class="line">loader: <span class="string">'babel-loader'</span></span><br><span class="line">&#125;</span><br><span class="line">]</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// package.json</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"scripts"</span>:&#123;</span><br><span class="line">     <span class="string">"bundle"</span>: <span class="string">"webpack"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="约定式提交"><a href="#约定式提交" class="headerlink" title="约定式提交"></a>约定式提交</h2><p><a href="https://www.conventionalcommits.org/zh/v1.0.0-beta.4/" target="_blank" rel="noopener">Conventional Commits</a></p><h3 id="commit-message-style校验"><a href="#commit-message-style校验" class="headerlink" title="commit message style校验"></a>commit message style校验</h3><ul><li><p>commitlint安装</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev @commitlint/config-conventional @commitlint/cli</span><br></pre></td></tr></table></figure></li><li><p>commitlint配置</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">"module.exports = &#123;extends: ['@commitlint/config-conventional']&#125;"</span> &gt; commitlint.config.js</span><br></pre></td></tr></table></figure></li><li><p>husky和lint-staged安装</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装</span></span><br><span class="line">npm i husky lint-staged --save-dev</span><br></pre></td></tr></table></figure></li><li><p>husky配置</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// package.json 配置</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="string">"husky"</span>: &#123;</span><br><span class="line">    <span class="string">"hooks"</span>: &#123;</span><br><span class="line">      <span class="string">"commit-msg"</span>: <span class="string">"commitlint -E HUSKY_GIT_PARAMS"</span>, <span class="comment">// 配合commitlint使用</span></span><br><span class="line">      <span class="string">"pre-commit"</span>: <span class="string">"lint-staged"</span> <span class="comment">// 配置lint-staged</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>lint-staged配置</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// package.json</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">"lint-staged"</span>: &#123;</span><br><span class="line">        <span class="string">"src/**/*.&#123;js,ts,tsx,jsx&#125;"</span>: [</span><br><span class="line">            <span class="string">"eslint src --fix --ext .ts,.js,.tsx,.jsx"</span>, <span class="comment">// npm run lint</span></span><br><span class="line">            <span class="string">"git add"</span></span><br><span class="line">        ]</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h2 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h2><p>  完成了大部分工程涉及的工具的配置，还有测试相关没有进行配置，以后有时间继续。</p><ul><li><p>[ ] jest</p></li><li><p>[ ] jest + typescript</p></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;一步一步配置Typescript工程&quot;&gt;&lt;a href=&quot;#一步一步配置Typescript工程&quot; class=&quot;headerlink&quot; title=&quot;一步一步配置Typescript工程&quot;&gt;&lt;/a&gt;一步一步配置Typescript工程&lt;/h2&gt;&lt;blockquo
      
    
    </summary>
    
      <category term="typescript" scheme="https://betgar.github.io/categories/typescript/"/>
    
    
      <category term="typescript" scheme="https://betgar.github.io/tags/typescript/"/>
    
  </entry>
  
  <entry>
    <title>Babel 6 松散模式</title>
    <link href="https://betgar.github.io/2019/07/30/babel6-loose-mode/"/>
    <id>https://betgar.github.io/2019/07/30/babel6-loose-mode/</id>
    <published>2019-07-30T11:00:00.000Z</published>
    <updated>2019-07-30T05:50:44.608Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Babel-6-松散模式"><a href="#Babel-6-松散模式" class="headerlink" title="Babel 6 松散模式"></a>Babel 6 松散模式</h1><blockquote><p>英文原文：<a href="https://2ality.com/2015/12/babel6-loose-mode.html" target="_blank" rel="noopener">https://2ality.com/2015/12/babel6-loose-mode.html</a></p><p>作者：<a href="https://csspod.com/author/minwe/" target="_blank" rel="noopener">minwe</a></p><p>中文：<a href="https://csspod.com/babel6-loose-mode/" target="_blank" rel="noopener">https://csspod.com/babel6-loose-mode/</a></p></blockquote><p>想必每个写 JavaScript 的都或多或少了解过 ES5 引入的<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Strict_mode" target="_blank" rel="noopener">严格模式</a>，Babel 6 在把 ES6+ 代码转换为 ES5 时，也提供了「松散模式」（loose mode）的选项。Babel 的松散模式和 ES5 没有任何关系，这里提 ES5 严格模式只是在概念上作一个比对，方便理解 Babel 的松散模式。</p><h2 id="两种模式"><a href="#两种模式" class="headerlink" title="两种模式"></a>两种模式</h2><p>一些 Babel 插件有两种工作模式：</p><ul><li><strong>标准模式</strong>：转换时尽可能遵循、接近 ES6 语义。</li><li><strong>松散模式</strong>：转换为简单的 ES5 实现。</li></ul><p>松散模式的优、缺点显而易见：</p><ul><li><strong>优点</strong>：转换出来的代码更简洁，没有为了接近 ES6 而添加的繁杂逻辑，文件更小，运行速度更快，兼容性更好。</li><li><strong>缺点</strong>：以后直接使用原生 ES6 时可能会遇到问题。需要留意。</li></ul><p>一般而言，不建议使用松散模式，不过也可以综合考虑项目的复杂程度，结合实际做选择。</p><h2 id="配置方式"><a href="#配置方式" class="headerlink" title="配置方式"></a>配置方式</h2><p>可以直接使用 <code>babel-preset-es2015-loose</code>：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"> <span class="attr">"presets"</span>: [</span><br><span class="line">   <span class="string">"es2015-loose"</span></span><br><span class="line">  ],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>具体到某个插件时，可以设置 <code>loose</code> 参数为 <code>true</code>：</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"plugins"</span>: [</span><br><span class="line">    ["transform-es2015-classes", &#123;loose: true&#125;],</span><br><span class="line">    <span class="string">"transform-es2015-object-super"</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="转换结果比较"><a href="#转换结果比较" class="headerlink" title="转换结果比较"></a>转换结果比较</h2><p>以下面的代码为例：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(name) &#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  sayHi() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`Hi, this is <span class="subst">$&#123;<span class="keyword">this</span>.name&#125;</span>`</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>.babelrc</code> 配置为标准模式时：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"presets"</span>: [</span><br><span class="line">    <span class="string">"es2015"</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>转换以后的代码为：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">"use strict"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> _createClass = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="function"><span class="keyword">function</span> <span class="title">defineProperties</span>(<span class="params">target, props</span>) </span>&#123; <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; props.length; i++) &#123; <span class="keyword">var</span> descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || <span class="literal">false</span>; descriptor.configurable = <span class="literal">true</span>; <span class="keyword">if</span> (<span class="string">"value"</span> <span class="keyword">in</span> descriptor) descriptor.writable = <span class="literal">true</span>; <span class="built_in">Object</span>.defineProperty(target, descriptor.key, descriptor); &#125; &#125; <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">Constructor, protoProps, staticProps</span>) </span>&#123; <span class="keyword">if</span> (protoProps) defineProperties(Constructor.prototype, protoProps); <span class="keyword">if</span> (staticProps) defineProperties(Constructor, staticProps); <span class="keyword">return</span> Constructor; &#125;; &#125;();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">_classCallCheck</span>(<span class="params">instance, Constructor</span>) </span>&#123; <span class="keyword">if</span> (!(instance <span class="keyword">instanceof</span> Constructor)) &#123; <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">"Cannot call a class as a function"</span>); &#125; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> Person = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">    _classCallCheck(<span class="keyword">this</span>, Person);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  _createClass(Person, [&#123;</span><br><span class="line">    key: <span class="string">"sayHi"</span>,</span><br><span class="line">    value: <span class="function"><span class="keyword">function</span> <span class="title">sayHi</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">"Hi, this is "</span> + <span class="keyword">this</span>.name;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> Person;</span><br><span class="line">&#125;();</span><br></pre></td></tr></table></figure><p>使用 loose preset 后：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"presets"</span>: [</span><br><span class="line">    <span class="string">"es2015-loose"</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>转换结果为：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">"use strict"</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">_classCallCheck</span>(<span class="params">instance, Constructor</span>) </span>&#123; <span class="keyword">if</span> (!(instance <span class="keyword">instanceof</span> Constructor)) &#123; <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">"Cannot call a class as a function"</span>); &#125; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> Person = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">    _classCallCheck(<span class="keyword">this</span>, Person);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  Person.prototype.sayHi = <span class="function"><span class="keyword">function</span> <span class="title">sayHi</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"Hi, this is "</span> + <span class="keyword">this</span>.name;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> Person;</span><br><span class="line">&#125;();</span><br></pre></td></tr></table></figure><p>确实更像熟悉的 ES5 代码。</p><p>该如何选择，自己看着办咯。</p><h2 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h2><p><a href="https://fecoding.cn/2016/08/10/the-loose-mode-babel-6/" target="_blank" rel="noopener">https://fecoding.cn/2016/08/10/the-loose-mode-babel-6/</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Babel-6-松散模式&quot;&gt;&lt;a href=&quot;#Babel-6-松散模式&quot; class=&quot;headerlink&quot; title=&quot;Babel 6 松散模式&quot;&gt;&lt;/a&gt;Babel 6 松散模式&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;英文原文：&lt;a href=&quot;htt
      
    
    </summary>
    
      <category term="babel" scheme="https://betgar.github.io/categories/babel/"/>
    
    
      <category term="babel" scheme="https://betgar.github.io/tags/babel/"/>
    
  </entry>
  
  <entry>
    <title>node-glob-syntax</title>
    <link href="https://betgar.github.io/2019/07/30/node-glob-syntax/"/>
    <id>https://betgar.github.io/2019/07/30/node-glob-syntax/</id>
    <published>2019-07-30T10:00:00.000Z</published>
    <updated>2019-07-30T05:49:55.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Node-glob语法"><a href="#Node-glob语法" class="headerlink" title="Node glob语法"></a>Node glob语法</h1><blockquote><p>原文地址：<a href="https://github.com/isLishude/blog/issues/63" target="_blank" rel="noopener">https://github.com/isLishude/blog/issues/63</a></p></blockquote><p><a href="https://github.com/isaacs/node-glob#readme" target="_blank" rel="noopener">本文</a> 由 <a href="http://yanxyz.net/" target="_blank" rel="noopener">Ivan Yan</a> 翻译，<a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">“署名-非商用-相同方式共享”</a>，意见<a href="https://github.com/hongfanqie/node-glob/issues" target="_blank" rel="noopener">反馈</a>。</p><p>通过星号等 shell 所用的模式匹配文件。</p><p>这是一个 JavaScript 版本的 glob 实现。使用 <a href="https://github.com/isaacs/minimatch" target="_blank" rel="noopener">minimatch</a> 执行匹配操作。</p><p>译注：早期 Unix （第 1-6 版，1969-1975）的命令行解释器依赖独立程序 <em>/etc/glob</em> 展开参数中的通配符。这个程序会展开通配符并把展开后的文件列表传给命令。它的名字是 “global command” 的简称。后来这个功能由工具函数 glob() 提供，被 shell 等程序使用。（译自 <a href="https://en.wikipedia.org/wiki/Glob_(programming" target="_blank" rel="noopener">WikiPedia</a>#Origin)。）</p><h2 id="用法"><a href="#用法" class="headerlink" title="用法"></a>用法</h2><p>用 npm 安装：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i glob</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> glob = <span class="built_in">require</span>(<span class="string">"glob"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// options 可选</span></span><br><span class="line">glob(<span class="string">"**/*.js"</span>, options, <span class="function"><span class="keyword">function</span> (<span class="params">er, files</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// files 是一个文件名数组。</span></span><br><span class="line">  <span class="comment">// 如果设置了选项 `nonull` 并且没有找到匹配，则 files 是 ["**/*.js"]</span></span><br><span class="line">  <span class="comment">// er 是一个错误对象或 null。</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="Glob-基础"><a href="#Glob-基础" class="headerlink" title="Glob 基础"></a>Glob 基础</h2><p>“Globs” 是像这样的模式：用在命令行中的 <code>ls *.js</code>, 用在 <code>.gitignore</code> 文件中的 <code>build/*</code>。</p><p>在解析路径中的模式前，先展开大括号部分。大括号部分以 <code>{</code> 开始，以 <code>}</code> 结束，里面是一个逗号分隔列表。大括号部分可以包含斜杠，例如 <code>a{/b/c,bcd}</code> 将展开为 <code>a/b/c</code> 与 <code>abcd</code>。</p><p>译注：比如路径 “/foo/bar”, 其中 “foo” 与 “bar” 是路径片段(path portion)。</p><p>下面这些字符在路径片段中有特别的意义：</p><ul><li><code>*</code> 匹配路径片段中零个或多个字符。</li><li><code>?</code> 匹配一个字符。</li><li><code>[...]</code> 匹配一个字符集合，类似于正则表达式的字符集合。如果第一个字符是 <code>!</code> 或 <code>^</code> 那么它匹配一个不在这个字符集合内的字符。</li><li><code>!(pattern|pattern|pattern)</code> 匹配不匹配模式的文件。</li><li><code>?(pattern|pattern|pattern)</code> 匹配这些模式零次或一次。</li><li><code>+(pattern|pattern|pattern)</code> 匹配这些模式一次或多次。</li><li><code>*(a|b|c)</code> 匹配这些模式零次或多次。</li><li><code>@(pattern|pat*|pat?erN)</code> 匹配这些模式一次。</li><li><code>**</code> 即 globstar 模式，如果这是单独的一个路径片断，则匹配零级或多级目录，但不会搜索符号链接目录。</li></ul><h3 id="点号"><a href="#点号" class="headerlink" title="点号"></a>点号</h3><p>如果文件或目录路径片段的第一个字符是点号（<code>.</code>），那么它将不匹配任何 glob，除非 glob 相应的路径片段的第一个字符也是 <code>.</code>。</p><p>例如，<code>a/.*/c</code> 匹配 <code>a/.b/c</code>，但是 <code>a/*/c</code> 不匹配，因为 <code>*</code> 第一个字符不是 <code>.</code>。</p><p>可以设置选项 <code>dot:true</code>，将 <code>.</code> 当作普通的字符。</p><p>译注：点文件（dot file），名字以 <code>.</code> 开始，在 Unix 下是隐藏文件。即使使用 globstar 模式，<code>a/**/c</code> 也不会匹配 <code>a/.b/c</code>。</p><h3 id="匹配基本名"><a href="#匹配基本名" class="headerlink" title="匹配基本名"></a>匹配基本名</h3><p>如果设置选项 <code>matchBase:true</code>，并且模式不包含斜杠，那么将搜索目录树下任意地方的匹配基本名（basename）的文件。例如 <code>*.js</code> 匹配 <code>test/simple/basic.js</code>。</p><h3 id="空集"><a href="#空集" class="headerlink" title="空集"></a>空集</h3><p>如果没有找到匹配的文件，那么返回一个空的数组。这跟 shell 不同，shell 会返回模式。例如：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> a*s*d*f</span><br><span class="line">a*s*d*f</span><br></pre></td></tr></table></figure><p>想与 shell 一致，设置选项 <code>nonull:true</code>。</p><h3 id="其它参考"><a href="#其它参考" class="headerlink" title="其它参考"></a>其它参考</h3><ul><li><code>man sh</code></li><li><code>man bash</code> (搜索 “Pattern Matching”)</li><li><code>man 3 fnmatch</code></li><li><code>man 5 gitignore</code></li><li><a href="https://github.com/isaacs/minimatch" target="_blank" rel="noopener">minimatch 文档</a></li></ul><h2 id="glob-hasMagic-pattern-options"><a href="#glob-hasMagic-pattern-options" class="headerlink" title="glob.hasMagic(pattern, [options])"></a>glob.hasMagic(pattern, [options])</h2><p>如果模式包含特殊的字符则返回 <code>true</code>，否则返回 <code>false</code>。</p><p>注意选项会影响结果。如果设置了选项 <code>noext:true</code>，则 <code>+(a|b)</code> 不会视为魔法模式。如果模式包含大括号展开式，比如 <code>a/{b/c,x/y}</code>，则认为是魔法的，除非设置了选项 <code>nobrace:true</code>。</p><h2 id="glob-pattern-options-cb"><a href="#glob-pattern-options-cb" class="headerlink" title="glob(pattern, [options], cb)"></a>glob(pattern, [options], cb)</h2><ul><li><code>pattern</code> <code>{String}</code> 待匹配的模式</li><li><code>options</code> <code>{Object}</code></li><li><code>cb {Function}</code><ul><li><code>err</code> <code>{Error | null}</code></li><li><code>matches</code> <code>{Array&lt;String&gt;}</code> 匹配模式的文件名</li></ul></li></ul><p>进行一个异步的 glob 搜索。</p><h2 id="glob-sync-pattern-options"><a href="#glob-sync-pattern-options" class="headerlink" title="glob.sync(pattern, [options])"></a>glob.sync(pattern, [options])</h2><ul><li><code>pattern</code> <code>{String}</code> 待匹配的模式</li><li><code>options</code> <code>{Object}</code></li><li>return: <code>{Array&lt;String&gt;}</code> 匹配模式的文件名</li></ul><p>进行一个同步的 glob 搜索。</p><h2 id="Class-glob-Glob"><a href="#Class-glob-Glob" class="headerlink" title="Class: glob.Glob"></a>Class: glob.Glob</h2><p>实例化 <code>glob.Glob</code> 类，创建一个 Glob 对象。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var Glob = require(&quot;glob&quot;).Glob</span><br><span class="line">var mg = new Glob(pattern, options, cb)</span><br></pre></td></tr></table></figure><p>这是一个 EventEmitter 对象，立刻开始遍历文件系统搜索匹配。</p><h3 id="new-glob-Glob-pattern-options-cb"><a href="#new-glob-Glob-pattern-options-cb" class="headerlink" title="new glob.Glob(pattern, [options], [cb])"></a>new glob.Glob(pattern, [options], [cb])</h3><ul><li><p><code>pattern</code> <code>{String}</code> 待匹配的模式</p></li><li><p><code>options</code> <code>{Object}</code></p></li><li><p><code>cb {Function}</code></p><p>当遇到错误或找到匹配时调用</p><ul><li><code>err</code> <code>{Error | null}</code></li><li><code>matches</code> <code>{Array&lt;String&gt;}</code> 匹配模式的文件名</li></ul></li></ul><p>注意，如果设置了选项 <code>sync</code>，则匹配将立即添加到 <code>g.found</code>。</p><h3 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h3><ul><li><code>minimatch</code> glob 所用的 minimatch 对象。</li><li><code>options</code> 传入的选项。</li><li><code>aborted</code> 布尔值，当调用 <code>abort()</code> 时设为 true。取消之后不能继续 glob 搜索，不过可以通过重用 statCache 避免重复调用 syscall。</li><li><code>cache</code> 缓存。每个字段都可以取下面的值：<ul><li><code>false</code> - 路径不存在</li><li><code>true</code> - 路径存在</li><li><code>&#39;FILE&#39;</code> - 路径存在，并且不是目录</li><li><code>&#39;DIR&#39;</code> - 路径存在，并且是目录</li><li><code>[file, entries, ...]</code> - 路径存在, 并且是目录，数组值是 <code>fs.readdir</code> 的结果</li></ul></li><li><code>statCache</code> 缓存 <code>fs.stat</code> 的结果，阻止多次读取同一路径的信息。</li><li><code>symlinks</code> 记录哪些路径是符号链接，与 <code>**</code> 解析相关。</li><li><code>realpathCache</code> 可选对象，传给 <code>fs.realpath</code>，以减少不必要的 syscall。它保存在 Glob 实例上，可以重用。</li></ul><h3 id="事件"><a href="#事件" class="headerlink" title="事件"></a>事件</h3><ul><li><code>end</code> 当结束搜索匹配时触发此事件，包含所有的匹配。如果设置了选项 <code>nonull</code>，并且没有找到匹配，则 <code>matches</code> 包含原来的模式。匹配经过排序，除非设置了选项 <code>nosort</code>。</li><li><code>match</code> 每当找到一个匹配时以这个匹配触发此事件，匹配没有去重，也没有解析为真实路径。</li><li><code>error</code> 当遇到一个异常时, 或者在设置了 <code>options.strict</code> 的情况下遇到 fs 错误时触发此事件。</li><li><code>abort</code> 当调用 <code>abort()</code> 时触发此事件。</li></ul><h3 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h3><ul><li><code>pause</code> 暂停搜索。</li><li><code>resume</code> 继续搜索。</li><li><code>abort</code> 取消搜索。</li></ul><h3 id="选项"><a href="#选项" class="headerlink" title="选项"></a>选项</h3><p>所有可以传给 Minimatch 的选项也可以传给 Glob，选项会改变匹配行为。有些选项是新加的，有些选项是 glob 特定选项。</p><p>所有选项默认是 false, 除非特别说明。</p><p>所有选项也会添加给 Glob 对象。</p><p>如果运行多个 <code>glob</code> 操作，可以将一个 Glob 对象作为 <code>options</code> 参数传递给后面的操作，以简化一些 <code>stat</code> 和 <code>readdir</code> 的调用。在最新的版本里，你可以传入共享的 <code>symlinks</code>, <code>statCache</code>, <code>realpathCache</code>, <code>cache</code> 选项，这样并行的 glob 操作将因为共享文件系统的信息而提速。</p><ul><li><code>cwd</code> String，搜索的工作目录，默认为 <code>process.cwd()</code>。</li><li><code>root</code> String，以 <code>/</code> 开始的模式的挂载目录，默认为 <code>path.resolve(options.cwd, &quot;/&quot;)</code> (Unix 系统下为 <code>/</code>，Windows 系统下为 <code>C:\</code> 或其它磁盘根目录。)</li><li><code>dot</code> 在常规匹配与 <code>globstar</code> 匹配中包含点文件。注意，<code>.</code> 在模式片断中始终匹配点文件。</li><li><code>nomount</code> 以 <code>/</code> 开始的模式默认挂载到 root 选项设置的目录上，因而返回一个合法的文件系统路径。设置此选项禁止此行为。</li><li><code>mark</code> 给匹配的目录添加一个 <code>/</code> 字符。注意这会调用 <code>stat</code>。</li><li><code>nosort</code> 不排序结果。</li><li><code>stat</code> stat 所有的结果。这多少会降低性能，完全没必要，除非认为 <code>readdir</code> 不能作为文件存在的可靠指示。</li><li><code>silent</code> 当读取目录时遇到一个不常见的错误，将打印一条警告到 stderr。设置此选项可取消打印。</li><li><code>strict</code> 当读取目录时遇到一个不常见的错误，进程将继续搜索其它匹配。设置此选项可抛出错误。</li><li><code>cache</code> Object, 见上文。传入之前生成的缓存对象可以节省一些 fs 调用。</li><li><code>statCache</code> Object, 匹配结果的文件系统信息的缓存，用来阻止不必要的 <code>stat</code> 调用。通常不需要设置此选项。不过如果知道文件系统在不同的 glob() 调用之间不会变化，可以将一个 glob() 调用的 statCache 传给另一个调用的选项（见下面“竞态条件”）。</li><li><code>symlinks</code> Object, 已知的符号链接的缓存。可以传入一个之前生成的 <code>symlinks</code> 对象，在匹配 <code>**</code> 时节省 <code>lstat</code> 调用。</li><li><code>sync</code> 废弃，可以用 <code>glob.sync(pattern, opts)</code>。</li><li><code>nounique</code> 在有些情况下，大括号展开式会导致在结果里面同一文件出现多次。本实现默认阻止结果里面出现重复。此选项禁止此行为。</li><li><code>nonull</code> 不返回空集，返回一个包含模式的集合，这是 glob(3) 的默认行为。</li><li><code>debug</code> 启用 minimatch 和 glob 调试。</li><li><code>nobrace</code> 不展开 <code>{a,b}</code> 和 <code>{1..3}</code> 这样的集合。</li><li><code>noglobstar</code> 不支持 “globstar” 模式，这时 <code>**</code> 不匹配多级文件名，像普通的 <code>*</code> 一样对待。</li><li><code>noext</code> 不支持 “extglob” 模式，比如 <code>+(a|b)</code>。</li><li><code>nocase</code> 匹配不区分大小写。注意：在不区分大小写的系统里，默认匹配没有特殊字符的模式，因为 <code>stat</code> 和 <code>readdir</code> 不会抛出异常。</li><li><code>matchBase</code> 如果模式不包含斜杠则匹配基名字。例如 <code>*.js</code> 将视为 <code>**/*.js</code>，匹配所有目录下的 js 文件。</li><li><code>nodir</code> 不匹配目录，只匹配文件。注意如果只匹配目录，简单地在模式的末尾放一个 <code>/</code> 即可。</li><li><code>ignore</code> 添加一个模式或一个 glob 模式数组，用来排除匹配。注意：<code>ignore</code> 模式<strong>始终</strong>认为 <code>dot:true</code>，不管其它的配置是怎样的。</li><li><code>follow</code> 在展开 <code>**</code> 时追踪符号链接目录。注意这可能导致大量重复的引用（循环链接）。</li><li><code>realpath</code> 在所有的结果上调用 <code>fs.realpath</code>，在不能解析符号链接的情况下，返回匹配文件的全路径，不过它常常是一个损坏的符号链接。</li><li><code>absolute</code> 设为 true 时始终得到匹配文件的绝对地址。不同于 <code>realpath</code>，这同时影响 <code>match</code> 事件的返回值。</li></ul><h2 id="与其它-fnmatch-glob-实现的比较"><a href="#与其它-fnmatch-glob-实现的比较" class="headerlink" title="与其它 fnmatch/glob 实现的比较"></a>与其它 fnmatch/glob 实现的比较</h2><p>严格地兼容现实规范是值得追求的目标，不过 node-glob 与其它实现之间存在差异，并且是有意的。</p><p>默认支持 <code>**</code>，除非设置了选项 <code>noglobstar</code>。这也是 bsdglob 和 bash 4.3 的方式。只有当 <code>**</code> 是单独的一个路径片段时它才有这种特殊意义。例如 <code>a/**/b</code> 匹配 <code>a/x/y/b</code>，但是 <code>a/**b</code> 不会。</p><p>注意，<code>**</code> 不会搜索符号链接目录，尽管它们可能匹配模式的其它片断。这可以防止无限循环、重复等。</p><p>如果转义的模式没有找到匹配，并且设置了选项 <code>nonull</code>，则 glob 原样返回模式，而不是转义后的模式。例如 <code>glob.match([], &quot;\\*a\\?&quot;)</code> 返回 <code>&quot;\\*a\\?&quot;</code> 而不是 <code>&quot;*a?&quot;</code>。默认的行为类似于在 bash 里设置 <code>nullglob</code> 选项，除了 bash 不会解析转义的模式。</p><p>如果没有禁止展开大括号，则在解析 glob 的其它模式之前先展开它。例如 <code>+(a|{b),c)}</code>，在 bash 或 zsh 下面是无效的，在这儿会先展开为 <code>+(a|b)</code> 和 <code>+(a|c)</code>，再检查这两个模式的有效性。既然它们是有效的，则进行匹配。</p><h3 id="注释与排除"><a href="#注释与排除" class="headerlink" title="注释与排除"></a>注释与排除</h3><p>在之前的版本中，如果模式以 <code>#</code> 开始则它是一个注释。标记为注释。如果模式以 <code>!</code> 开始则它是一个排除模式。</p><p>v5 已经废弃了选项 <code>nonegate</code> 和 <code>nocomment</code>。v6 则删除了这两个选项。</p><p>如果想排除某些文件，可以使用选项 <code>ignore</code> 。</p><h2 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h2><p><strong>请在 glob 表达式里只使用斜杠。</strong></p><p>译注：斜杠（forward-slashe “/“）是顺时针方向，反斜杠（backward-slashe “”）是逆时针方向。</p><p>尽管 Windows 可以用 <code>/</code> 或 <code>\</code> 作为路径分隔符，但是本实现只使用 <code>/</code>。在 glob 表达式里必须只使用斜杠。反斜杠始终视为转义符，而不是路径分隔符。</p><p>绝对路径模式比如 <code>/foo/*</code>，匹配结果挂载到选项 root 设置的目录上（使用 <code>path.join()</code>）。 在 Windows 下，在默认的情况下，<code>/foo/*</code> 可以匹配到 <code>C:\foo\bar.txt</code>（译注：此时 cwd 在 C 盘下）。</p><h2 id="竞态条件"><a href="#竞态条件" class="headerlink" title="竞态条件"></a>竞态条件</h2><p>Glob 搜索本质上容易受竞态条件（race conditions）的影响，因为它建立在目录遍历等上面。</p><p>因此，当 glob 搜索某个文件时它是存在的，然后在返回结果时它可能被删除或被修改。</p><p>作为内部实现的一部分，为了降低系统开销，此实现缓存了所有的 stat 和 readdir 的结果。但是，这也导致它更加容易受竞态条件的影响，特别是在多个 glob 调用之间重用 cache 或 statCache 对象时。</p><p>在面对快速的变化时，建议用户不要将 glob 结果作为文件系统状态的担保。对于绝大多数的操作，这绝不会是一个问题。</p><h2 id="贡献"><a href="#贡献" class="headerlink" title="贡献"></a>贡献</h2><p>对程序行为的任何改变（包含补丁）必须同时提交测试。</p><p>测试失败的或降低性能的补丁将被拒绝。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># to run tests</span></span><br><span class="line">npm <span class="built_in">test</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># to re-generate test fixtures</span></span><br><span class="line">npm run <span class="built_in">test</span>-regen</span><br><span class="line"></span><br><span class="line"><span class="comment"># to benchmark against bash/zsh</span></span><br><span class="line">npm run bench</span><br><span class="line"></span><br><span class="line"><span class="comment"># to profile javascript</span></span><br><span class="line">npm run prof</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Node-glob语法&quot;&gt;&lt;a href=&quot;#Node-glob语法&quot; class=&quot;headerlink&quot; title=&quot;Node glob语法&quot;&gt;&lt;/a&gt;Node glob语法&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;原文地址：&lt;a href=&quot;https:/
      
    
    </summary>
    
      <category term="node" scheme="https://betgar.github.io/categories/node/"/>
    
    
      <category term="node" scheme="https://betgar.github.io/tags/node/"/>
    
  </entry>
  
  <entry>
    <title>TypeScript 和 Babel 7</title>
    <link href="https://betgar.github.io/2019/07/29/typescript-and-babel-7/"/>
    <id>https://betgar.github.io/2019/07/29/typescript-and-babel-7/</id>
    <published>2019-07-29T14:00:00.000Z</published>
    <updated>2019-07-30T05:50:54.975Z</updated>
    
    <content type="html"><![CDATA[<h1 id="TypeScript-和-Babel-7"><a href="#TypeScript-和-Babel-7" class="headerlink" title="TypeScript 和 Babel 7"></a>TypeScript 和 Babel 7</h1><blockquote><p>作者：Daniel</p><p>日期：August 27th, 2018</p><p>原文：<a href="https://devblogs.microsoft.com/typescript/typescript-and-babel-7/" target="_blank" rel="noopener">https://devblogs.microsoft.com/typescript/typescript-and-babel-7/</a></p></blockquote><p>今天我们很高兴为Babel用户宣布一些特别的东西。一年前，我们开始着手发现用户在使用TypeScript时遇到的最大困难，我们发现Babel用户的一个共同问题是尝试设置好TypeScript 太难了。 原因通常各不相同，但对于许多开发人员来说，重写已经正在使用的构建配置可能是一项艰巨的任务。<br>Babel是一个出色的工具，拥有一个充满活力的生态系统，通过将最新的JavaScript特性转换为旧的运行时和浏览器，为数百万开发人员提供服 但它不进行类型检查，我们的团队认为可以将这种体验带到另一个层次。 虽然TypeScript本身可以同时执行这两项操作，但我们希望在不强制用户从Babel切换的情况下更轻松地获得该体验。</p><p>这就是为什么在过去的一年里我们与Babel团队合作，今天我们很高兴联合宣布Babel 7现在提供TypeScript支持！</p><h2 id="我怎么使用它？"><a href="#我怎么使用它？" class="headerlink" title="我怎么使用它？"></a>我怎么使用它？</h2><p>如果你已经在使用Babel并且你从未尝试过TypeScript，那么现在是你的机会，因为它比以往更容易。 至少，您需要安装TypeScript插件。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev @babel/preset-typescript</span><br></pre></td></tr></table></figure><p>您可能还想获得TypeScript支持的其他ECMAScript特性：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev @babel/preset-typescript @babel/preset-env @babel/plugin-proposal-class-properties @babel/plugin-proposal-object-rest-spread</span><br></pre></td></tr></table></figure><p>确保你的<code>.babelrc</code>中的presets和plugins配置正确：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    "presets": [</span><br><span class="line">        "@babel/env",</span><br><span class="line">        "@babel/preset-typescript"</span><br><span class="line">    ],</span><br><span class="line">    "plugins": [</span><br><span class="line">        "@babel/proposal-class-properties",</span><br><span class="line">        "@babel/proposal-object-rest-spread"</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>一个使用<code>@babel/cli</code>编译的样例，你仅需要执行：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">babel ./src --out-dir lib --extensions ".ts,.tsx"</span><br></pre></td></tr></table></figure><p>你的文件现在构建并生成到了<code>lib</code>文件夹中。</p><p>使用<code>TypeScript</code>检查类型，需要创建一个<code>tsconfig.json</code>文件：</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"compilerOptions"</span>: &#123;</span><br><span class="line">    // Target latest version of ECMAScript.</span><br><span class="line">    "target": "esnext",</span><br><span class="line">    // Search under node_modules for non-relative imports.</span><br><span class="line">    "moduleResolution": "node",</span><br><span class="line">    // Process &amp; infer types from .js files.</span><br><span class="line">    "allowJs": true,</span><br><span class="line">    // Don't emit; allow Babel to transform files.</span><br><span class="line">    "noEmit": true,</span><br><span class="line">    // Enable strictest settings like strictNullChecks &amp; noImplicitAny.</span><br><span class="line">    "strict": true,</span><br><span class="line">    // Disallow features that require cross-file information for emit.</span><br><span class="line">    "isolatedModules": true,</span><br><span class="line">    // Import non-ES modules as default imports.</span><br><span class="line">    "esModuleInterop": true</span><br><span class="line">  &#125;,</span><br><span class="line">  "include": [</span><br><span class="line">    <span class="string">"src"</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后执行<code>tsc</code>，仅仅就是这样！<code>tsc</code>将会对你的<code>.ts</code>和<code>.tsx</code>进行类型检查</p><p>随意添加–watch标志到任一工具，以便在任何变化时获得即时反馈。 <a href="https://github.com/Microsoft/TypeScript-Babel-Starter" target="_blank" rel="noopener">您可以在此示例存储库中查看如何设置更复杂的构建，该存储库与Webpack等工具集成</a>。<a href="https://babeljs.io/repl/#?babili=false&amp;browsers=&amp;build=&amp;builtIns=false&amp;spec=false&amp;loose=false&amp;code_lz=EQVwzgpgBGAuBOBLAxrYBuAUJxA7WE8AZgIbLQDCi8yANtAN6ZRTwkAmi4AXFLiAFsARoSwBfbERC5UiAPa4oJeBBIAKZLyo16ASihMWK2CHiKAsiVgALAHQAFAJJQAVFGS22ncK7cAmcSA&amp;debug=false&amp;forceAllTransforms=false&amp;shippedProposals=false&amp;circleciRepo=&amp;evaluate=true&amp;fileSize=true&amp;timeTravel=false&amp;sourceType=module&amp;lineWrap=true&amp;presets=typescript%2Cenv&amp;prettier=false&amp;targets=&amp;version=7.0.0-beta.42&amp;envVersion=7.0.0-beta.42" target="_blank" rel="noopener"> 您也可以在Babel的在线REPL上使用TypeScript预设</a>。</p><h2 id="这对我意味着什么？"><a href="#这对我意味着什么？" class="headerlink" title="这对我意味着什么？"></a>这对我意味着什么？</h2><p>使用TypeScript编译器仍然是构建TypeScript的首选方法。 虽然Babel可以接管编译/转换 - 执行诸如擦除类型和重写最新的ECMAScript功能以在较旧的运行时中工作 - 它没有内置类型检查，并且仍然需要使用TypeScript来实现这一点。 因此，即使Babel构建成功，您也可能需要使用TypeScript介入以捕获类型错误。 出于这个原因，我们认为tsc和compiler pipeline周围的工具仍然可以为大多数项目提供最好集成和一致的体验。</p><p>因此，如果您已经在使用TypeScript，那么这对您来说可能没什么变化。 但是，如果您已经在使用Babel，或者对Babel生态系统感兴趣，并希望获得TypeScript的好处，例如捕获拼写错误，错误检查以及您可能在Visual Studio和Visual Studio等中看到的编辑体验 代码，这是给你的！</p><h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><p>正如我们上面提到的，用户应该注意的第一件事是Babel不会对TypeScript代码执行类型检查;它只会转换你的代码，无论是否存在类型错误，它都会编译。虽然这意味着Babel不会像读取.d.ts文件那样做并确保你的类型兼容，但可能你会想要一些工具来做到这一点，所以你仍然需要TypeScript。这可以在后台作为单独的tsc –watch任务完成，也可以是构建中的lint / CI步骤的一部分。幸运的是，通过正确的编辑器支持，您甚至可以在保存之前发现大多数错误。</p><p>其次，有些结构Babel 7没有正确的编译。具体来说，</p><ul><li>namespaces</li><li>括号风格的类型断言/强制转换语法，当启用JSX时可以忽略它们。（即，如果打开JSX支持，写入<foo>  x即使在.ts文件中也不起作用，但您可以将<code>x as Foo</code>）。</foo></li><li>跨多个声明的枚举（即枚举合并）</li><li>遗留式导入/导出语法（即import foo = require（…）和export = foo）</li></ul><p>这些遗漏主要基于Babel的单文件发射架构中的技术限制。我们相信大多数用户会发现这种体验是完全可以接受的。要确保TypeScript可以调出其中的一些遗漏，您应该确保TypeScript使用–isolatedModules标志。</p><h2 id="接下来做什么？"><a href="#接下来做什么？" class="headerlink" title="接下来做什么？"></a>接下来做什么？</h2><p>您可以在发布博客文章中阅读Babel方面的详细信息。 我们很高兴我们有机会与Babel团队的人们合作，如Henry Zhu，Andrew Levine，Logan Smyth，Daniel Tschinder，James Henry，Diogo Franco，Ivan Babak，NicolòRibaudo，Brian Ng和Vladimir Kurchatkin。 我们甚至有机会加速Babylon，Babel的解析器，并帮助调整James Henry在typescript-eslint-parser上的工作，该解析器现在支持Prettier’s TypeScript。 如果我们遗漏没有提到你，我们很抱歉，但我们很感激，我们感谢所有人们共同投入的帮助！</p><p>我们的团队将为TypeScript插件的未来更新做出贡献，我们期待为所有TypeScript用户带来出色的体验。 展望未来，我们很乐意听到您对Babel中这种新TypeScript支持的反馈，以及我们如何使其更易于使用。 在Twitter上@typescriptlang或下面的评论中给我们一个声音。</p><p>快乐的黑客！</p><h2 id="资源"><a href="#资源" class="headerlink" title="资源"></a>资源</h2><blockquote><p>Babel+TypeScript以及其它工具的配置参考</p></blockquote><p><a href="https://github.com/Microsoft/TypeScript-Babel-Starter" target="_blank" rel="noopener">TypeScript-Babel-Starter</a></p><p><a href="https://github.com/a-tarasyuk/react-webpack-typescript-babel" target="_blank" rel="noopener">react-webpack-typescript-babel</a></p><p><a href="https://github.com/a-tarasyuk/webpack-typescript-babel" target="_blank" rel="noopener">webpack-typescript-babel</a></p><p><a href="https://github.com/xitu/gold-miner/blob/master/TODO1/typescript-with-babel-a-beautiful-marriage.md" target="_blank" rel="noopener">TypeScript With Babel: A Beautiful Marriage </a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;TypeScript-和-Babel-7&quot;&gt;&lt;a href=&quot;#TypeScript-和-Babel-7&quot; class=&quot;headerlink&quot; title=&quot;TypeScript 和 Babel 7&quot;&gt;&lt;/a&gt;TypeScript 和 Babel 7&lt;/h1&gt;&lt;
      
    
    </summary>
    
      <category term="typescript" scheme="https://betgar.github.io/categories/typescript/"/>
    
      <category term="babel" scheme="https://betgar.github.io/categories/typescript/babel/"/>
    
    
      <category term="babel" scheme="https://betgar.github.io/tags/babel/"/>
    
      <category term="typescript" scheme="https://betgar.github.io/tags/typescript/"/>
    
  </entry>
  
  <entry>
    <title>babel的配置的默认套路</title>
    <link href="https://betgar.github.io/2019/07/15/babel-plugin-preset-default-configration/"/>
    <id>https://betgar.github.io/2019/07/15/babel-plugin-preset-default-configration/</id>
    <published>2019-07-15T05:00:00.000Z</published>
    <updated>2019-07-20T06:16:18.589Z</updated>
    
    <content type="html"><![CDATA[<h1 id="babel的配置的默认套路"><a href="#babel的配置的默认套路" class="headerlink" title="babel的配置的默认套路"></a>babel的配置的默认套路</h1><blockquote><p>我是一个标题党，这篇文章介绍一点babel的默认配置套路，总结了一点遇到的项目管理问题。</p></blockquote><h2 id="babel的bug刺激了我"><a href="#babel的bug刺激了我" class="headerlink" title="babel的bug刺激了我"></a>babel的bug刺激了我</h2><ul><li>现象：项目编译没有任何问题，打开页面才报错 问题现象console报错：<code>_objectSpread is not defined</code></li><li>原因：根据输出的错误，我猜测是babel的问题，因为<code>_objectSpread</code>就是使用了新的对象展开的语法<code>...obj</code>，编译之后才出现的。当然这里我也调试了编译后打代码。【如果你想看编译打包后代码，介绍一篇文章给你:   <a href="http://f2e.souche.com/blog/webpackbian-yi-vuexiang-mu-sheng-cheng-de-dai-ma-tan-suo/" target="_blank" rel="noopener">webpack编译vue项目生成的代码探索</a>】</li><li>分析：通过<code>git log</code>快速分析<code>package.json</code>的变更，发现只更新过<code>babel</code>相关。所以实锤是<code>babel</code>问题。</li></ul><p>分析<code>git log</code>时，我们当时做的<code>commit message style</code>统一的作用就发挥出来了，所有的工具链相关变更，统一都是<code>chore</code>开头，所以才能做到快速定位。顺便看看我们项目的<code>commit message</code></p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https://raw.githubusercontent.com/betgar/betgar.github.io/master/img/picgo/20190718201526.jpg" alt="commit message style" title="">                </div>                <div class="image-caption">commit message style</div>            </figure><ul><li><p>场景重现：<a href="https://babeljs.io/repl/version/7.4.4#?babili=false&amp;browsers=&amp;build=&amp;builtIns=false&amp;spec=false&amp;loose=false&amp;code_lz=MYewdgzgLgBCCuUAOiDC4BmBLA5jAvDAN4wB05CyiMAvgNwBQoksz2ehJ5pOApmLwBOAQwA26MO1p0gA&amp;debug=false&amp;forceAllTransforms=true&amp;shippedProposals=false&amp;circleciRepo=&amp;evaluate=false&amp;fileSize=false&amp;timeTravel=false&amp;sourceType=module&amp;lineWrap=false&amp;presets=&amp;prettier=false&amp;targets=&amp;version=7.1.6&amp;externalPlugins=%40babel%2Fplugin-proposal-object-rest-spread%407.5.3" target="_blank" rel="noopener">babel repl demo链接</a></p><p><img src="https://raw.githubusercontent.com/betgar/betgar.github.io/master/img/picgo/20190718204821.jpg" alt=""></p></li></ul><blockquote><p>真实原因：对象展开的语法，babel编译之后注入了<code>_objectSpread</code>或者<code>_objectSpread2</code>函数来处理，维护的小伙伴没有把所有的分支都覆盖。修复这个issues的小伙伴也挺幽默，估计也是被折腾的够呛，说了一句玩笑话<strong>I’ll now go hiding myself somewhere and I won’t touch an helper for a few months 😆</strong></p><p>而且此bug是<code>babel v7.5.4</code>修复的，而且在低版本的<code>@babel/core</code>使用了高版本的<code>@babel/plugin-proposal-object-rest-spread</code>才能重现。</p><p><code>_objectSpread</code>官方issues相关链接：</p></blockquote><p><a href="https://github.com/babel/babel/issues/10179#issuecomment-509700433" target="_blank" rel="noopener">ReferenceError: _objectSpread is not defined after update</a>  </p><p><a href="https://github.com/babel/babel/issues/10187" target="_blank" rel="noopener">Missing helpers only throw once</a> </p><p><a href="https://github.com/babel/babel/pull/10188" target="_blank" rel="noopener">Fix _objectSpread2 for real</a></p><blockquote><p>找的问题的根源了，新问题来了，我怎么更新<code>@babel/core</code>呢？</p><p>因为不是项目直接依赖的<code>@babel/core</code>，而是其它工具依赖，我更新了也不一定起作用。</p></blockquote><p>介绍<code>npm</code>两个非常有用的命令：</p><ul><li><p>查看项目中安装的package版本和依赖关系</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm ls @babel/core</span><br><span class="line">`-- @vue/cli-plugin-babel@3.9.2</span><br><span class="line">  `-- @babel/core@7.5.4</span><br></pre></td></tr></table></figure><p>知道了依赖@babel/core是<code>@vue/cli-plugin-babel</code>，那升级<code>@vue/cli-plugin-babel</code>就行了。</p></li></ul><ul><li><p>查看<code>npm</code>仓库的package版本和依赖</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm show @babel/core</span><br></pre></td></tr></table></figure></li><li><p>推荐一个<code>npm-check</code>工具，专门用来更新依赖。</p><p><img src="https://raw.githubusercontent.com/betgar/betgar.github.io/master/img/picgo/20190718231123.jpg" alt="npm-check"></p><blockquote><p>可以执行<code>npm-check -u</code>来进行交互式选择更新，而且还列出了官方文档，可以直接看看release log之后再决定是否更新。</p></blockquote></li></ul><h2 id="babel的plugin和preset配置默认套路"><a href="#babel的plugin和preset配置默认套路" class="headerlink" title="babel的plugin和preset配置默认套路"></a><code>babel</code>的plugin和preset配置默认套路</h2><blockquote><p>本来我就比较懒，一直在计划学习的路上，基本都没落实行动。这次项目出现问题，我不得不去了解了一下，babel配置的那些套路。Babel的v7版本所有包都重命名了，所以还是要做到了解。</p></blockquote><h3 id="babel-v7"><a href="#babel-v7" class="headerlink" title="babel v7"></a>babel v7</h3><blockquote><p><a href="https://babel.docschina.org/docs/en/v7-migration" target="_blank" rel="noopener">官方升级文档链接</a></p><p>包含的内容太多，仔细过一遍才行，很多配置或者包名称命名规则都修改了。</p></blockquote><h3 id="babel-v7-4支持core-js-3"><a href="#babel-v7-4支持core-js-3" class="headerlink" title="babel v7.4支持core-js@3"></a><code>babel v7.4</code>支持<code>core-js@3</code></h3><blockquote><p>babel v7.4支持core-js@3，尤其是对<code>@babel/polyfill</code>和<code>@babel/preset-env</code>又带来了很多改变。</p></blockquote><ul><li><p>新的<code>corejs</code>配置项</p><blockquote><p>corejs配置项链接<a href="https://babeljs.io/docs/en/next/babel-preset-env#corejs" target="_blank" rel="noopener">options corejs</a></p></blockquote><p>当项目中的babel升级到v7.4+时会出现下面的警告：</p><blockquote><p>WARNING: We noticed you’re using the <code>useBuiltIns</code> option without declaring a core-js version. Currently, we assume version 2.x when no version is passed. Since this default version will likely change in future versions of Babel, we recommend explicitly setting the core-js version you are using via the <code>corejs</code> option.</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用core-js@3的babel.config.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> (<span class="params">api</span>) </span>&#123;</span><br><span class="line">    api.cache(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> presets =  [</span><br><span class="line">        [<span class="string">"@babel/preset-env"</span>,</span><br><span class="line">            &#123;</span><br><span class="line">            <span class="string">"useBuiltIns"</span>: <span class="string">"usage"</span>,</span><br><span class="line">            <span class="string">"corejs"</span>:<span class="number">3</span>, <span class="comment">// 指定版本</span></span><br><span class="line">            <span class="string">"targets"</span>:&#123;</span><br><span class="line">                <span class="string">"browsers"</span>:[<span class="string">"&gt; 1%"</span>, <span class="string">"last 2 versions"</span>, <span class="string">"not ie &lt;= 8"</span>]</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    ];</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        presets,</span><br><span class="line">        <span class="comment">// plugins</span></span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>注意：</strong>把相应的core-js安装到项目依赖中，<code>npm i core-js@2</code> 或者<code>npm i core-js@3</code></p></li></ul><ul><li><p><code>@babel/polyfill</code>不支持从core-js2升级到core-js3，所以v7.4开始<code>@babel/polyfill</code>变成过时(deprecated)</p><blockquote><p>如果项目中使用core-js@3，则应该修改导入配置</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">"@babel/polyfill"</span>;</span><br></pre></td></tr></table></figure><p>替换为：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">"core-js/stable"</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">"regenerator-runtime/runtime"</span>;</span><br></pre></td></tr></table></figure><p>直接安装依赖到项目：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i --save core-js regenerator-runtime</span><br></pre></td></tr></table></figure></li></ul><blockquote><p>因为babel和core-js绑定的很紧密，所以推荐看一下core-js作者的文章：<a href="https://github.com/zloirock/core-js/blob/master/docs/2019-03-19-core-js-3-babel-and-a-look-into-the-future.md" target="_blank" rel="noopener">core-js-3-babel-and-a-look-into-the-future</a>详细介绍了core-js@3版本带来的改变，以及解决的问题。</p></blockquote><h3 id="Plugin配置套路"><a href="#Plugin配置套路" class="headerlink" title="Plugin配置套路"></a>Plugin配置套路</h3><blockquote><p>syntax plugins允许babel去parse特定的类型的syntax而不是去转换变形（transform）</p><p>注意：transform plugins会自动启用syntax plugins。 因此，如果已经使用了相应的transform plugins，则无需指定syntax plugins。</p></blockquote><h4 id="Plugin-路径"><a href="#Plugin-路径" class="headerlink" title="Plugin 路径"></a>Plugin 路径</h4><p>如果 plugin 在 npm 上，你可以传入预设名称，babel 将检查它是否已安装在 <code>node_modules</code> 中</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"plugins"</span>: [<span class="string">"babel-plugin-myPlugin"</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>还可以指定的相对/绝对路径。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"plugins"</span>: [<span class="string">"./node_modules/asdf/plugin"</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Plugin-简写-官方非常不推荐"><a href="#Plugin-简写-官方非常不推荐" class="headerlink" title="Plugin 简写(官方非常不推荐)"></a>Plugin 简写(官方非常不推荐)</h4><p>如果包的名称以 <code>babel-plugin-</code> 为前缀，可以使用简写：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"plugins"</span>: [</span><br><span class="line">    <span class="string">"myPlugin"</span>,</span><br><span class="line">    <span class="string">"babel-plugin-myPlugin"</span> <span class="comment">// equivalent</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这也适用于 scoped 包：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"plugins"</span>: [</span><br><span class="line">    <span class="string">"@org/babel-plugin-name"</span>,</span><br><span class="line">    <span class="string">"@org/name"</span> <span class="comment">// equivalent</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Plugin执行顺序"><a href="#Plugin执行顺序" class="headerlink" title="Plugin执行顺序"></a>Plugin执行顺序</h4><blockquote><p>如果两个transforms都访问“程序”节点，则transforms将以plugin或preset顺序运行。</p><ul><li>plugin在preset之前运行。</li><li>plugin执行顺序是第一个到最后一个。</li><li>preset顺序相反（从最后到第一个）。</li></ul></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"plugins"</span>: [<span class="string">"transform-decorators-legacy"</span>, <span class="string">"transform-class-properties"</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>先执行<code>transform-decorators-legacy</code>后<code>transform-class-properties</code></p><h4 id="Plugin-选项"><a href="#Plugin-选项" class="headerlink" title="Plugin 选项"></a>Plugin 选项</h4><blockquote><p>plugins和 presets 都可以通过将名称和选项对象放在配置中的数组中来指定选项。</p><p>对于不指定选项，这些都是等同的：</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"plugins"</span>: [<span class="string">"pluginA"</span>, [<span class="string">"pluginA"</span>], [<span class="string">"pluginA"</span>, &#123;&#125;]]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>要指定选项，请使用选项名称作为 key 传递对象。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"plugins"</span>: [</span><br><span class="line">    [</span><br><span class="line">      <span class="string">"transform-async-to-module-method"</span>,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="string">"module"</span>: <span class="string">"bluebird"</span>,</span><br><span class="line">        <span class="string">"method"</span>: <span class="string">"coroutine"</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="preset配置套路"><a href="#preset配置套路" class="headerlink" title="preset配置套路"></a>preset配置套路</h3><blockquote><p>preset是一个插件数组</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    plugins: [</span><br><span class="line">      <span class="string">"pluginA"</span>,</span><br><span class="line">      <span class="string">"pluginB"</span>,</span><br><span class="line">      <span class="string">"pluginC"</span>,</span><br><span class="line">    ]</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>Presets 可以包含其他的 presets 以及带有选项的插件。</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="params">()</span> =&gt;</span> (&#123;</span><br><span class="line">  presets: [</span><br><span class="line">    <span class="built_in">require</span>(<span class="string">"@babel/preset-env"</span>),</span><br><span class="line">  ],</span><br><span class="line">  plugins: [</span><br><span class="line">    [<span class="built_in">require</span>(<span class="string">"@babel/plugin-proposal-class-properties"</span>), &#123; <span class="attr">loose</span>: <span class="literal">true</span> &#125;],</span><br><span class="line">    <span class="built_in">require</span>(<span class="string">"@babel/plugin-proposal-object-rest-spread"</span>),</span><br><span class="line">  ],</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h4 id="Preset-路径"><a href="#Preset-路径" class="headerlink" title="Preset 路径"></a>Preset 路径</h4><p>如果 preset 在 npm 上，你可以传入预设名称，babel 将检查它是否已安装在 <code>node_modules</code> 中</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"presets"</span>: [<span class="string">"babel-preset-myPreset"</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>还可以指定 presets 的相对/绝对路径。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"presets"</span>: [<span class="string">"./myProject/myPreset"</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Preset-简写-官方非常不推荐"><a href="#Preset-简写-官方非常不推荐" class="headerlink" title="Preset 简写(官方非常不推荐)"></a>Preset 简写(官方非常不推荐)</h4><p>如果包的名称以 <code>babel-preset-</code> 为前缀，可以使用简写：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"presets"</span>: [</span><br><span class="line">    <span class="string">"myPreset"</span>,</span><br><span class="line">    <span class="string">"babel-preset-myPreset"</span> <span class="comment">// 等同</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这也适用于 scoped 包：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"presets"</span>: [</span><br><span class="line">    <span class="string">"@org/babel-preset-name"</span>,</span><br><span class="line">    <span class="string">"@org/name"</span> <span class="comment">// 等同</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// vue-cli生成的babel.config.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  presets: [</span><br><span class="line">    [</span><br><span class="line">      <span class="string">'@vue/app'</span>, <span class="comment">// 对应 @vue/babel-preset-app,当时害的我找来找去都没找到包</span></span><br><span class="line">      &#123;</span><br><span class="line">        useBuiltIns: <span class="string">'entry'</span>,</span><br><span class="line">        corejs: <span class="number">2</span>, <span class="comment">// @see https://babeljs.io/docs/en/babel-preset-env#corejs</span></span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="Preset执行顺序相反"><a href="#Preset执行顺序相反" class="headerlink" title="Preset执行顺序相反"></a>Preset执行顺序相反</h4><blockquote><p>Preset 的顺序是相反的(从最后一个到第一个).</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"presets"</span>: [</span><br><span class="line">    <span class="string">"a"</span>,</span><br><span class="line">    <span class="string">"b"</span>,</span><br><span class="line">    <span class="string">"c"</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>将会按照以下顺序运行：<code>c</code>, <code>b</code>, 然后 <code>a</code>。</p><h4 id="Preset-选项"><a href="#Preset-选项" class="headerlink" title="Preset 选项"></a>Preset 选项</h4><blockquote><p>插件和 presets 都可以通过将名称和选项对象放在配置中的数组中来指定选项。</p><p>对于不指定选项，这些都是等同的：</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"presets"</span>: [</span><br><span class="line">    <span class="string">"presetA"</span>,</span><br><span class="line">    [<span class="string">"presetA"</span>],</span><br><span class="line">    [<span class="string">"presetA"</span>, &#123;&#125;],</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>要指定选项，请使用选项名称作为 key 传递对象。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"presets"</span>: [</span><br><span class="line">    [<span class="string">"@babel/preset-env"</span>, &#123;</span><br><span class="line">      <span class="string">"loose"</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">"modules"</span>: <span class="literal">false</span></span><br><span class="line">    &#125;]</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><blockquote><p>前端的知识链太长，技术更新越来越快。前端的投资风险还是很大，所以谨慎选择框架，分配一点时间投资在业界公认的工具上也是不错的，例如：webpack, babel, vs code, scss等。这些都是现代前端工程的构建工具，所以生命周期会比某一个框架更长远。</p></blockquote><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://github.com/jamiebuilds/babel-handbook/blob/master/translations/zh-Hans/plugin-handbook.md" target="_blank" rel="noopener">babel-plugin-handbook</a></p><p><a href="https://github.com/jamiebuilds/babel-handbook/blob/master/translations/zh-Hans/user-handbook.md" target="_blank" rel="noopener">babel-user-handbook</a></p><p><a href="https://github.com/babel/babel/issues/10179#issuecomment-510080288" target="_blank" rel="noopener">强制jest使用新的babel</a></p><p><a href="https://babeljs.io/docs/en/next/babel-preset-env#corejs" target="_blank" rel="noopener">options corejs</a></p><p><a href="https://segmentfault.com/a/1190000019718925" target="_blank" rel="noopener">Babel 7使用总结</a></p><p><a href="https://github.com/zloirock/core-js/blob/master/docs/2019-03-19-core-js-3-babel-and-a-look-into-the-future.md" target="_blank" rel="noopener">core-js-3-babel-and-a-look-into-the-future</a></p><p><a href="https://github.com/babel/babel-preset-env" target="_blank" rel="noopener">babel-preset-env官方仓库</a></p><p><a href="https://www.cnblogs.com/itlkNote/p/6830682.html" target="_blank" rel="noopener">npm 常用命令详解</a></p><p><a href="https://www.sitepoint.com/beginners-guide-node-package-manager" target="_blank" rel="noopener">A Beginner’s Guide to npm — the Node Package Manager</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;babel的配置的默认套路&quot;&gt;&lt;a href=&quot;#babel的配置的默认套路&quot; class=&quot;headerlink&quot; title=&quot;babel的配置的默认套路&quot;&gt;&lt;/a&gt;babel的配置的默认套路&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;我是一个标题党，这篇文章介
      
    
    </summary>
    
      <category term="babel" scheme="https://betgar.github.io/categories/babel/"/>
    
    
      <category term="babel" scheme="https://betgar.github.io/tags/babel/"/>
    
  </entry>
  
  <entry>
    <title>babel的配置的默认套路</title>
    <link href="https://betgar.github.io/2019/07/15/learn-babel-guide/"/>
    <id>https://betgar.github.io/2019/07/15/learn-babel-guide/</id>
    <published>2019-07-15T05:00:00.000Z</published>
    <updated>2019-07-20T06:16:18.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="babel的配置的默认套路"><a href="#babel的配置的默认套路" class="headerlink" title="babel的配置的默认套路"></a>babel的配置的默认套路</h1><blockquote><p>我是一个标题党，这篇文章介绍一点babel的默认配置套路，总结了一点遇到的项目管理问题。</p></blockquote><h2 id="babel的bug刺激了我"><a href="#babel的bug刺激了我" class="headerlink" title="babel的bug刺激了我"></a>babel的bug刺激了我</h2><ul><li>现象：项目编译没有任何问题，打开页面才报错 问题现象console报错：<code>_objectSpread is not defined</code></li><li>原因：根据输出的错误，我猜测是babel的问题，因为<code>_objectSpread</code>就是使用了新的对象展开的语法<code>...obj</code>，编译之后才出现的。当然这里我也调试了编译后打代码。【如果你想看编译打包后代码，介绍一篇文章给你:   <a href="http://f2e.souche.com/blog/webpackbian-yi-vuexiang-mu-sheng-cheng-de-dai-ma-tan-suo/" target="_blank" rel="noopener">webpack编译vue项目生成的代码探索</a>】</li><li>分析：通过<code>git log</code>快速分析<code>package.json</code>的变更，发现只更新过<code>babel</code>相关。所以实锤是<code>babel</code>问题。</li></ul><p>分析<code>git log</code>时，我们当时做的<code>commit message style</code>统一的作用就发挥出来了，所有的工具链相关变更，统一都是<code>chore</code>开头，所以才能做到快速定位。顺便看看我们项目的<code>commit message</code></p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https://raw.githubusercontent.com/betgar/betgar.github.io/master/img/picgo/20190718201526.jpg" alt="commit message style" title="">                </div>                <div class="image-caption">commit message style</div>            </figure><ul><li><p>场景重现：<a href="https://babeljs.io/repl/version/7.4.4#?babili=false&amp;browsers=&amp;build=&amp;builtIns=false&amp;spec=false&amp;loose=false&amp;code_lz=MYewdgzgLgBCCuUAOiDC4BmBLA5jAvDAN4wB05CyiMAvgNwBQoksz2ehJ5pOApmLwBOAQwA26MO1p0gA&amp;debug=false&amp;forceAllTransforms=true&amp;shippedProposals=false&amp;circleciRepo=&amp;evaluate=false&amp;fileSize=false&amp;timeTravel=false&amp;sourceType=module&amp;lineWrap=false&amp;presets=&amp;prettier=false&amp;targets=&amp;version=7.1.6&amp;externalPlugins=%40babel%2Fplugin-proposal-object-rest-spread%407.5.3" target="_blank" rel="noopener">babel repl demo链接</a></p><p><img src="https://raw.githubusercontent.com/betgar/betgar.github.io/master/img/picgo/20190718204821.jpg" alt=""></p></li></ul><blockquote><p>真实原因：对象展开的语法，babel编译之后注入了<code>_objectSpread</code>或者<code>_objectSpread2</code>函数来处理，维护的小伙伴没有把所有的分支都覆盖。修复这个issues的小伙伴也挺幽默，估计也是被折腾的够呛，说了一句玩笑话<strong>I’ll now go hiding myself somewhere and I won’t touch an helper for a few months 😆</strong></p><p>而且此bug是<code>babel v7.5.4</code>修复的，而且在低版本的<code>@babel/core</code>使用了高版本的<code>@babel/plugin-proposal-object-rest-spread</code>才能重现。</p><p><code>_objectSpread</code>官方issues相关链接：</p></blockquote><p><a href="https://github.com/babel/babel/issues/10179#issuecomment-509700433" target="_blank" rel="noopener">ReferenceError: _objectSpread is not defined after update</a>  </p><p><a href="https://github.com/babel/babel/issues/10187" target="_blank" rel="noopener">Missing helpers only throw once</a> </p><p><a href="https://github.com/babel/babel/pull/10188" target="_blank" rel="noopener">Fix _objectSpread2 for real</a></p><blockquote><p>找的问题的根源了，新问题来了，我怎么更新<code>@babel/core</code>呢？</p><p>因为不是项目直接依赖的<code>@babel/core</code>，而是其它工具依赖，我更新了也不一定起作用。</p></blockquote><p>介绍<code>npm</code>两个非常有用的命令：</p><ul><li><p>查看项目中安装的package版本和依赖关系</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm ls @babel/core</span><br><span class="line">`-- @vue/cli-plugin-babel@3.9.2</span><br><span class="line">  `-- @babel/core@7.5.4</span><br></pre></td></tr></table></figure><p>知道了依赖@babel/core是<code>@vue/cli-plugin-babel</code>，那升级<code>@vue/cli-plugin-babel</code>就行了。</p></li></ul><ul><li><p>查看<code>npm</code>仓库的package版本和依赖</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm show @babel/core</span><br></pre></td></tr></table></figure></li><li><p>推荐一个<code>npm-check</code>工具，专门用来更新依赖。</p><p><img src="https://raw.githubusercontent.com/betgar/betgar.github.io/master/img/picgo/20190718231123.jpg" alt="npm-check"></p><blockquote><p>可以执行<code>npm-check -u</code>来进行交互式选择更新，而且还列出了官方文档，可以直接看看release log之后再决定是否更新。</p></blockquote></li></ul><h2 id="babel的plugin和preset配置默认套路"><a href="#babel的plugin和preset配置默认套路" class="headerlink" title="babel的plugin和preset配置默认套路"></a><code>babel</code>的plugin和preset配置默认套路</h2><blockquote><p>本来我就比较懒，一直在计划学习的路上，基本都没落实行动。这次项目出现问题，我不得不去了解了一下，babel配置的那些套路。Babel的v7版本所有包都重命名了，所以还是要做到了解。</p></blockquote><h3 id="babel-v7"><a href="#babel-v7" class="headerlink" title="babel v7"></a>babel v7</h3><blockquote><p><a href="https://babel.docschina.org/docs/en/v7-migration" target="_blank" rel="noopener">官方升级文档链接</a></p><p>包含的内容太多，仔细过一遍才行，很多配置或者包名称命名规则都修改了。</p></blockquote><h3 id="babel-v7-4支持core-js-3"><a href="#babel-v7-4支持core-js-3" class="headerlink" title="babel v7.4支持core-js@3"></a><code>babel v7.4</code>支持<code>core-js@3</code></h3><blockquote><p>babel v7.4支持core-js@3，尤其是对<code>@babel/polyfill</code>和<code>@babel/preset-env</code>又带来了很多改变。</p></blockquote><ul><li><p>新的<code>corejs</code>配置项</p><blockquote><p>corejs配置项链接<a href="https://babeljs.io/docs/en/next/babel-preset-env#corejs" target="_blank" rel="noopener">options corejs</a></p></blockquote><p>当项目中的babel升级到v7.4+时会出现下面的警告：</p><blockquote><p>WARNING: We noticed you’re using the <code>useBuiltIns</code> option without declaring a core-js version. Currently, we assume version 2.x when no version is passed. Since this default version will likely change in future versions of Babel, we recommend explicitly setting the core-js version you are using via the <code>corejs</code> option.</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用core-js@3的babel.config.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> (<span class="params">api</span>) </span>&#123;</span><br><span class="line">    api.cache(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> presets =  [</span><br><span class="line">        [<span class="string">"@babel/preset-env"</span>,</span><br><span class="line">            &#123;</span><br><span class="line">            <span class="string">"useBuiltIns"</span>: <span class="string">"usage"</span>,</span><br><span class="line">            <span class="string">"corejs"</span>:<span class="number">3</span>, <span class="comment">// 指定版本</span></span><br><span class="line">            <span class="string">"targets"</span>:&#123;</span><br><span class="line">                <span class="string">"browsers"</span>:[<span class="string">"&gt; 1%"</span>, <span class="string">"last 2 versions"</span>, <span class="string">"not ie &lt;= 8"</span>]</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    ];</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        presets,</span><br><span class="line">        <span class="comment">// plugins</span></span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>注意：</strong>把相应的core-js安装到项目依赖中，<code>npm i core-js@2</code> 或者<code>npm i core-js@3</code></p></li></ul><ul><li><p><code>@babel/polyfill</code>不支持从core-js2升级到core-js3，所以v7.4开始<code>@babel/polyfill</code>变成过时(deprecated)</p><blockquote><p>如果项目中使用core-js@3，则应该修改导入配置</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">"@babel/polyfill"</span>;</span><br></pre></td></tr></table></figure><p>替换为：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">"core-js/stable"</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">"regenerator-runtime/runtime"</span>;</span><br></pre></td></tr></table></figure><p>直接安装依赖到项目：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i --save core-js regenerator-runtime</span><br></pre></td></tr></table></figure></li></ul><blockquote><p>因为babel和core-js绑定的很紧密，所以推荐看一下core-js作者的文章：<a href="https://github.com/zloirock/core-js/blob/master/docs/2019-03-19-core-js-3-babel-and-a-look-into-the-future.md" target="_blank" rel="noopener">core-js-3-babel-and-a-look-into-the-future</a>详细介绍了core-js@3版本带来的改变，以及解决的问题。</p></blockquote><h3 id="Plugin配置套路"><a href="#Plugin配置套路" class="headerlink" title="Plugin配置套路"></a>Plugin配置套路</h3><blockquote><p>syntax plugins允许babel去parse特定的类型的syntax而不是去转换变形（transform）</p><p>注意：transform plugins会自动启用syntax plugins。 因此，如果已经使用了相应的transform plugins，则无需指定syntax plugins。</p></blockquote><h4 id="Plugin-路径"><a href="#Plugin-路径" class="headerlink" title="Plugin 路径"></a>Plugin 路径</h4><p>如果 plugin 在 npm 上，你可以传入预设名称，babel 将检查它是否已安装在 <code>node_modules</code> 中</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"plugins"</span>: [<span class="string">"babel-plugin-myPlugin"</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>还可以指定的相对/绝对路径。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"plugins"</span>: [<span class="string">"./node_modules/asdf/plugin"</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Plugin-简写-官方非常不推荐"><a href="#Plugin-简写-官方非常不推荐" class="headerlink" title="Plugin 简写(官方非常不推荐)"></a>Plugin 简写(官方非常不推荐)</h4><p>如果包的名称以 <code>babel-plugin-</code> 为前缀，可以使用简写：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"plugins"</span>: [</span><br><span class="line">    <span class="string">"myPlugin"</span>,</span><br><span class="line">    <span class="string">"babel-plugin-myPlugin"</span> <span class="comment">// equivalent</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这也适用于 scoped 包：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"plugins"</span>: [</span><br><span class="line">    <span class="string">"@org/babel-plugin-name"</span>,</span><br><span class="line">    <span class="string">"@org/name"</span> <span class="comment">// equivalent</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Plugin执行顺序"><a href="#Plugin执行顺序" class="headerlink" title="Plugin执行顺序"></a>Plugin执行顺序</h4><blockquote><p>如果两个transforms都访问“程序”节点，则transforms将以plugin或preset顺序运行。</p><ul><li>plugin在preset之前运行。</li><li>plugin执行顺序是第一个到最后一个。</li><li>preset顺序相反（从最后到第一个）。</li></ul></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"plugins"</span>: [<span class="string">"transform-decorators-legacy"</span>, <span class="string">"transform-class-properties"</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>先执行<code>transform-decorators-legacy</code>后<code>transform-class-properties</code></p><h4 id="Plugin-选项"><a href="#Plugin-选项" class="headerlink" title="Plugin 选项"></a>Plugin 选项</h4><blockquote><p>plugins和 presets 都可以通过将名称和选项对象放在配置中的数组中来指定选项。</p><p>对于不指定选项，这些都是等同的：</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"plugins"</span>: [<span class="string">"pluginA"</span>, [<span class="string">"pluginA"</span>], [<span class="string">"pluginA"</span>, &#123;&#125;]]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>要指定选项，请使用选项名称作为 key 传递对象。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"plugins"</span>: [</span><br><span class="line">    [</span><br><span class="line">      <span class="string">"transform-async-to-module-method"</span>,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="string">"module"</span>: <span class="string">"bluebird"</span>,</span><br><span class="line">        <span class="string">"method"</span>: <span class="string">"coroutine"</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="preset配置套路"><a href="#preset配置套路" class="headerlink" title="preset配置套路"></a>preset配置套路</h3><blockquote><p>preset是一个插件数组</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    plugins: [</span><br><span class="line">      <span class="string">"pluginA"</span>,</span><br><span class="line">      <span class="string">"pluginB"</span>,</span><br><span class="line">      <span class="string">"pluginC"</span>,</span><br><span class="line">    ]</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>Presets 可以包含其他的 presets 以及带有选项的插件。</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="params">()</span> =&gt;</span> (&#123;</span><br><span class="line">  presets: [</span><br><span class="line">    <span class="built_in">require</span>(<span class="string">"@babel/preset-env"</span>),</span><br><span class="line">  ],</span><br><span class="line">  plugins: [</span><br><span class="line">    [<span class="built_in">require</span>(<span class="string">"@babel/plugin-proposal-class-properties"</span>), &#123; <span class="attr">loose</span>: <span class="literal">true</span> &#125;],</span><br><span class="line">    <span class="built_in">require</span>(<span class="string">"@babel/plugin-proposal-object-rest-spread"</span>),</span><br><span class="line">  ],</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h4 id="Preset-路径"><a href="#Preset-路径" class="headerlink" title="Preset 路径"></a>Preset 路径</h4><p>如果 preset 在 npm 上，你可以传入预设名称，babel 将检查它是否已安装在 <code>node_modules</code> 中</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"presets"</span>: [<span class="string">"babel-preset-myPreset"</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>还可以指定 presets 的相对/绝对路径。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"presets"</span>: [<span class="string">"./myProject/myPreset"</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Preset-简写-官方非常不推荐"><a href="#Preset-简写-官方非常不推荐" class="headerlink" title="Preset 简写(官方非常不推荐)"></a>Preset 简写(官方非常不推荐)</h4><p>如果包的名称以 <code>babel-preset-</code> 为前缀，可以使用简写：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"presets"</span>: [</span><br><span class="line">    <span class="string">"myPreset"</span>,</span><br><span class="line">    <span class="string">"babel-preset-myPreset"</span> <span class="comment">// 等同</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这也适用于 scoped 包：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"presets"</span>: [</span><br><span class="line">    <span class="string">"@org/babel-preset-name"</span>,</span><br><span class="line">    <span class="string">"@org/name"</span> <span class="comment">// 等同</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// vue-cli生成的babel.config.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  presets: [</span><br><span class="line">    [</span><br><span class="line">      <span class="string">'@vue/app'</span>, <span class="comment">// 对应 @vue/babel-preset-app,当时害的我找来找去都没找到包</span></span><br><span class="line">      &#123;</span><br><span class="line">        useBuiltIns: <span class="string">'entry'</span>,</span><br><span class="line">        corejs: <span class="number">2</span>, <span class="comment">// @see https://babeljs.io/docs/en/babel-preset-env#corejs</span></span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="Preset执行顺序相反"><a href="#Preset执行顺序相反" class="headerlink" title="Preset执行顺序相反"></a>Preset执行顺序相反</h4><blockquote><p>Preset 的顺序是相反的(从最后一个到第一个).</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"presets"</span>: [</span><br><span class="line">    <span class="string">"a"</span>,</span><br><span class="line">    <span class="string">"b"</span>,</span><br><span class="line">    <span class="string">"c"</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>将会按照以下顺序运行：<code>c</code>, <code>b</code>, 然后 <code>a</code>。</p><h4 id="Preset-选项"><a href="#Preset-选项" class="headerlink" title="Preset 选项"></a>Preset 选项</h4><blockquote><p>插件和 presets 都可以通过将名称和选项对象放在配置中的数组中来指定选项。</p><p>对于不指定选项，这些都是等同的：</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"presets"</span>: [</span><br><span class="line">    <span class="string">"presetA"</span>,</span><br><span class="line">    [<span class="string">"presetA"</span>],</span><br><span class="line">    [<span class="string">"presetA"</span>, &#123;&#125;],</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>要指定选项，请使用选项名称作为 key 传递对象。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"presets"</span>: [</span><br><span class="line">    [<span class="string">"@babel/preset-env"</span>, &#123;</span><br><span class="line">      <span class="string">"loose"</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">"modules"</span>: <span class="literal">false</span></span><br><span class="line">    &#125;]</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><blockquote><p>前端的知识链太长，技术更新越来越快。前端的投资风险还是很大，所以谨慎选择框架，分配一点时间投资在业界公认的工具上也是不错的，例如：webpack, babel, vs code, scss等。这些都是现代前端工程的构建工具，所以生命周期会比某一个框架更长远。</p></blockquote><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://github.com/jamiebuilds/babel-handbook/blob/master/translations/zh-Hans/plugin-handbook.md" target="_blank" rel="noopener">babel-plugin-handbook</a></p><p><a href="https://github.com/jamiebuilds/babel-handbook/blob/master/translations/zh-Hans/user-handbook.md" target="_blank" rel="noopener">babel-user-handbook</a></p><p><a href="https://github.com/babel/babel/issues/10179#issuecomment-510080288" target="_blank" rel="noopener">强制jest使用新的babel</a></p><p><a href="https://babeljs.io/docs/en/next/babel-preset-env#corejs" target="_blank" rel="noopener">options corejs</a></p><p><a href="https://segmentfault.com/a/1190000019718925" target="_blank" rel="noopener">Babel 7使用总结</a></p><p><a href="https://github.com/zloirock/core-js/blob/master/docs/2019-03-19-core-js-3-babel-and-a-look-into-the-future.md" target="_blank" rel="noopener">core-js-3-babel-and-a-look-into-the-future</a></p><p><a href="https://github.com/babel/babel-preset-env" target="_blank" rel="noopener">babel-preset-env官方仓库</a></p><p><a href="https://www.cnblogs.com/itlkNote/p/6830682.html" target="_blank" rel="noopener">npm 常用命令详解</a></p><p><a href="https://www.sitepoint.com/beginners-guide-node-package-manager" target="_blank" rel="noopener">A Beginner’s Guide to npm — the Node Package Manager</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;babel的配置的默认套路&quot;&gt;&lt;a href=&quot;#babel的配置的默认套路&quot; class=&quot;headerlink&quot; title=&quot;babel的配置的默认套路&quot;&gt;&lt;/a&gt;babel的配置的默认套路&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;我是一个标题党，这篇文章介
      
    
    </summary>
    
      <category term="babel" scheme="https://betgar.github.io/categories/babel/"/>
    
    
      <category term="babel" scheme="https://betgar.github.io/tags/babel/"/>
    
  </entry>
  
  <entry>
    <title>前端开发VSCode插件推荐</title>
    <link href="https://betgar.github.io/2019/07/10/the-vscode-plugins/"/>
    <id>https://betgar.github.io/2019/07/10/the-vscode-plugins/</id>
    <published>2019-07-10T11:00:00.000Z</published>
    <updated>2019-07-12T14:58:04.880Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前端开发VSCode插件推荐"><a href="#前端开发VSCode插件推荐" class="headerlink" title="前端开发VSCode插件推荐"></a>前端开发<code>VSCode</code>插件推荐</h1><blockquote><p><code>VSCode</code>社区的繁荣发展，插件社区也是热闹非凡，插件多了选择就多了，这里推荐一下我常用的插件。我用<code>Vue</code>开发，所以一些插件和<code>Vue</code>相关。</p></blockquote><h2 id="插件"><a href="#插件" class="headerlink" title="插件"></a>插件</h2><h2 id="VSCode相关"><a href="#VSCode相关" class="headerlink" title="VSCode相关"></a><code>VSCode</code>相关</h2><ul><li><p>one dark pro主题</p><blockquote><p><a href="https://marketplace.visualstudio.com/items?itemName=zhuangtongfa.Material-theme" target="_blank" rel="noopener">https://marketplace.visualstudio.com/items?itemName=zhuangtongfa.Material-theme</a></p></blockquote><p><img src="https://camo.githubusercontent.com/48f39d862900e54913410490e566a9e761bc5ad5/68747470733a2f2f7773332e73696e61696d672e636e2f6c617267652f303036744e6252776779316676776b7236693139396a33316b7731366f7461742e6a7067" alt="one dark pro"></p></li></ul><ul><li><p>GlassIt-VSC（毛玻璃透明效果）</p><blockquote><p> <a href="https://marketplace.visualstudio.com/items?itemName=s-nlf-fh.glassit" target="_blank" rel="noopener">https://marketplace.visualstudio.com/items?itemName=s-nlf-fh.glassit</a></p></blockquote><p><img src="https://raw.githubusercontent.com/betgar/betgar.github.io/master/img/picgo/20190710220714.jpg" alt=""></p></li><li><p>vscode-icons</p><blockquote><p><a href="https://marketplace.visualstudio.com/items?itemName=vscode-icons-team.vscode-icons" target="_blank" rel="noopener">https://marketplace.visualstudio.com/items?itemName=vscode-icons-team.vscode-icons</a></p></blockquote><p><img src="https://raw.githubusercontent.com/vscode-icons/vscode-icons/master/images/screenshot.gif" alt=""></p></li></ul><ul><li><p>local history ( vscode拥有本地恢复的某一时刻能力)</p><blockquote><p><a href="https://marketplace.visualstudio.com/items?itemName=xyz.local-history" target="_blank" rel="noopener">https://marketplace.visualstudio.com/items?itemName=xyz.local-history</a></p></blockquote><p><img src="https://github.com/zabel-xyz/local-history/raw/master/images/Tree.png" alt=""></p></li></ul><h2 id="code相关"><a href="#code相关" class="headerlink" title="code相关"></a>code相关</h2><ul><li><p>codeif(变量起名)</p><blockquote><p><a href="https://marketplace.visualstudio.com/items?itemName=unbug.codelf" target="_blank" rel="noopener">https://marketplace.visualstudio.com/items?itemName=unbug.codelf</a></p></blockquote></li></ul><ul><li><p>search node_modules</p><blockquote><p><a href="https://marketplace.visualstudio.com/items?itemName=jasonnutter.search-node-modules" target="_blank" rel="noopener">https://marketplace.visualstudio.com/items?itemName=jasonnutter.search-node-modules</a></p></blockquote><p><img src="https://raw.githubusercontent.com/jasonnutter/vscode-search-node-modules/master/img/demo.gif" alt=""></p></li><li><p>path-intellisense</p><blockquote><p><a href="https://marketplace.visualstudio.com/items?itemName=christian-kohler.path-intellisense" target="_blank" rel="noopener">https://marketplace.visualstudio.com/items?itemName=christian-kohler.path-intellisense</a></p></blockquote><p><img src="http://i.giphy.com/iaHeUiDeTUZuo.gif" alt="path-intellisense"></p></li><li><p>vscode-element-helper</p><blockquote><p><a href="https://marketplace.visualstudio.com/items?itemName=ElemeFE.vscode-element-helper" target="_blank" rel="noopener">https://marketplace.visualstudio.com/items?itemName=ElemeFE.vscode-element-helper</a></p></blockquote><p><img src="https://user-images.githubusercontent.com/1659577/27990774-4b7b3662-6494-11e7-83a4-9e6ed3ef698a.gif" alt=""></p></li><li><p>ant-design-vue-helper</p><blockquote><p><a href="https://marketplace.visualstudio.com/items?itemName=ant-design-vue.vscode-ant-design-vue-helper" target="_blank" rel="noopener">https://marketplace.visualstudio.com/items?itemName=ant-design-vue.vscode-ant-design-vue-helper</a></p></blockquote><p><img src="https://user-images.githubusercontent.com/4122593/50880828-ac10d400-141a-11e9-8a43-5b724d3a24e6.gif" alt=""></p></li><li><p>font awesome icons</p><blockquote><p><a href="https://marketplace.visualstudio.com/items?itemName=idleberg.icon-fonts" target="_blank" rel="noopener">https://marketplace.visualstudio.com/items?itemName=idleberg.icon-fonts</a></p></blockquote><p><img src="https://raw.githubusercontent.com/idleberg/vscode-icon-fonts/master/images/screenshot.gif" alt=""></p></li><li><p>auto-close-tag</p><blockquote><p><a href="https://marketplace.visualstudio.com/items?itemName=formulahendry.auto-close-tag" target="_blank" rel="noopener">https://marketplace.visualstudio.com/items?itemName=formulahendry.auto-close-tag</a></p></blockquote><p><img src="https://github.com/formulahendry/vscode-auto-close-tag/raw/master/images/close-tag.gif" alt="close tag"></p></li><li><p>auto-rename-tag</p><blockquote><p><a href="https://marketplace.visualstudio.com/items?itemName=formulahendry.auto-rename-tag" target="_blank" rel="noopener">https://marketplace.visualstudio.com/items?itemName=formulahendry.auto-rename-tag</a></p></blockquote><p><img src="https://github.com/formulahendry/vscode-auto-rename-tag/raw/master/images/usage.gif" alt=""></p></li><li><p>自动导入(import) (TypeScript &amp; TSX)</p><blockquote><p><a href="https://marketplace.visualstudio.com/items?itemName=steoates.autoimport" target="_blank" rel="noopener">https://marketplace.visualstudio.com/items?itemName=steoates.autoimport</a></p></blockquote></li></ul><ul><li><p>成对的括号自动添加颜色（bracket-pair-colorizer）</p><blockquote><p><a href="https://marketplace.visualstudio.com/items?itemName=CoenraadS.bracket-pair-colorizer" target="_blank" rel="noopener">https://marketplace.visualstudio.com/items?itemName=CoenraadS.bracket-pair-colorizer</a></p></blockquote><p><img src="https://github.com/CoenraadS/BracketPair/raw/master/images/example.png" alt=""></p></li><li><p>颜色高亮显示</p><blockquote><p><a href="https://marketplace.visualstudio.com/items?itemName=naumovs.color-highlight" target="_blank" rel="noopener">https://marketplace.visualstudio.com/items?itemName=naumovs.color-highlight</a></p></blockquote><p><img src="https://naumovs.gallerycdn.vsassets.io/extensions/naumovs/color-highlight/2.3.0/1499789961213/Microsoft.VisualStudio.Services.Icons.Default" alt=""></p></li><li><p>npm-intellisense</p><blockquote><p><a href="https://marketplace.visualstudio.com/items?itemName=christian-kohler.npm-intellisense" target="_blank" rel="noopener">https://marketplace.visualstudio.com/items?itemName=christian-kohler.npm-intellisense</a></p></blockquote><p><img src="https://github.com/ChristianKohler/NpmIntellisense/raw/master/images/auto_complete.gif" alt=""></p><p><img src="https://raw.githubusercontent.com/ChristianKohler/NpmIntellisense/master/images/require_withname.gif" alt=""></p></li></ul><p>​    </p><h2 id="debugger-系列"><a href="#debugger-系列" class="headerlink" title="debugger 系列"></a>debugger 系列</h2><ul><li><p>debugger for chrome</p><blockquote><p><a href="https://marketplace.visualstudio.com/items?itemName=msjsdiag.debugger-for-chrome" target="_blank" rel="noopener">https://marketplace.visualstudio.com/items?itemName=msjsdiag.debugger-for-chrome</a></p></blockquote></li><li><p>debugger for edge(Edge HTML &amp; edge Chromium)</p><blockquote><p><a href="https://marketplace.visualstudio.com/items?itemName=msjsdiag.debugger-for-edge" target="_blank" rel="noopener">https://marketplace.visualstudio.com/items?itemName=msjsdiag.debugger-for-edge</a></p></blockquote></li><li><p>debugger for firefox</p><blockquote><p><a href="https://marketplace.visualstudio.com/items?itemName=hbenl.vscode-firefox-debug" target="_blank" rel="noopener">https://marketplace.visualstudio.com/items?itemName=hbenl.vscode-firefox-debug</a></p></blockquote></li></ul><h2 id="配置文件系列"><a href="#配置文件系列" class="headerlink" title="配置文件系列"></a>配置文件系列</h2><ul><li><p><code>.env</code>配置文件</p><blockquote><p>编辑以.env结尾的文件.</p><p><a href="https://marketplace.visualstudio.com/items?itemName=mikestead.dotenv" target="_blank" rel="noopener">https://marketplace.visualstudio.com/items?itemName=mikestead.dotenv</a></p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// setting.json添加这么一句，所有以.env开头的全都匹配</span></span><br><span class="line"><span class="comment">// vue下的环境配置文件命名推荐：</span></span><br><span class="line"><span class="comment">// .env.production .env.development </span></span><br><span class="line"><span class="comment">// .env.alpha .env.beta .env.rc</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"files.associations"</span>: &#123;</span><br><span class="line"><span class="string">".env*"</span>: <span class="string">"dotenv"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://github.com/mikestead/vscode-dotenv/raw/master/images/screenshot.png" alt=""></p></li><li><p><code>.editorconfig</code>配置文件插件</p><blockquote><p><a href="https://marketplace.visualstudio.com/items?itemName=EditorConfig.EditorConfig" target="_blank" rel="noopener">https://marketplace.visualstudio.com/items?itemName=EditorConfig.EditorConfig</a></p></blockquote></li></ul><h2 id="代码格式化"><a href="#代码格式化" class="headerlink" title="代码格式化"></a>代码格式化</h2><ul><li><p>eslint</p><blockquote><p><a href="https://marketplace.visualstudio.com/items?itemName=dbaeumer.vscode-eslint" target="_blank" rel="noopener">https://marketplace.visualstudio.com/items?itemName=dbaeumer.vscode-eslint</a></p></blockquote></li><li><p>htmlHint</p><blockquote><p><a href="https://marketplace.visualstudio.com/items?itemName=mkaufman.HTMLHint" target="_blank" rel="noopener">https://marketplace.visualstudio.com/items?itemName=mkaufman.HTMLHint</a></p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// setting.json</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"files.associations"</span>: &#123;</span><br><span class="line">    <span class="string">"*.vue"</span>: <span class="string">"html"</span>, <span class="comment">// 我没试过，因为有vetur</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Microsoft/vscode-htmlhint/master/htmlhint/images/hero.png" alt=""></p></li><li><p>prettier</p><blockquote><p><a href="https://marketplace.visualstudio.com/items?itemName=esbenp.prettier-vscode" target="_blank" rel="noopener">https://marketplace.visualstudio.com/items?itemName=esbenp.prettier-vscode</a></p></blockquote></li></ul><ul><li><p>Beautify(prettier 选择其一)</p><blockquote><p><a href="https://marketplace.visualstudio.com/items?itemName=HookyQR.beautify" target="_blank" rel="noopener">https://marketplace.visualstudio.com/items?itemName=HookyQR.beautify</a></p></blockquote></li></ul><h2 id="git相关"><a href="#git相关" class="headerlink" title="git相关"></a>git相关</h2><ul><li><p>Git History</p><blockquote><p><a href="https://marketplace.visualstudio.com/items?itemName=donjayamanne.githistory" target="_blank" rel="noopener">https://marketplace.visualstudio.com/items?itemName=donjayamanne.githistory</a></p></blockquote><p><img src="https://raw.githubusercontent.com/DonJayamanne/gitHistoryVSCode/master/images/gitLogv2.gif" alt="git history"></p></li></ul><ul><li><p>gitlens</p><blockquote><p><a href="https://marketplace.visualstudio.com/items?itemName=eamodio.gitlens" target="_blank" rel="noopener">https://marketplace.visualstudio.com/items?itemName=eamodio.gitlens</a></p></blockquote><p><img src="https://raw.githubusercontent.com/eamodio/vscode-gitlens/master/images/docs/gitlens-preview.gif" alt="gitlens-preview"></p></li></ul><h2 id="Vue相关"><a href="#Vue相关" class="headerlink" title="Vue相关"></a><code>Vue</code>相关</h2><ul><li><p>vue-peek</p><blockquote><p><a href="https://marketplace.visualstudio.com/items?itemName=dariofuzinato.vue-peek" target="_blank" rel="noopener">https://marketplace.visualstudio.com/items?itemName=dariofuzinato.vue-peek</a></p></blockquote><p><img src="https://github.com/fussinatto/vscode-vue-peek/raw/master/images/vue-peek-demo.gif" alt=""></p></li><li><p>vetur</p><blockquote><p><a href="https://marketplace.visualstudio.com/items?itemName=octref.vetur" target="_blank" rel="noopener">https://marketplace.visualstudio.com/items?itemName=octref.vetur</a></p></blockquote></li></ul><h2 id="辅助工具"><a href="#辅助工具" class="headerlink" title="辅助工具"></a>辅助工具</h2><ul><li><p>setting sync (墙裂推荐)</p><blockquote><p>如果你有多台电脑，想在不同电脑之间同步<code>VSCode</code>配置，就用它吧。</p><p><strong><em>注意：</em></strong> 使用gist 时记得使用private，防止私有token泄露。</p></blockquote><blockquote><p><a href="https://marketplace.visualstudio.com/items?itemName=Shan.code-settings-sync" target="_blank" rel="noopener">https://marketplace.visualstudio.com/items?itemName=Shan.code-settings-sync</a></p></blockquote><p><img src="https://media.giphy.com/media/xT9Iglsi3CS9noE8tW/source.gif" alt=""></p></li><li><p>todo tree</p><blockquote><p> <a href="https://marketplace.visualstudio.com/items?itemName=Gruntfuggly.todo-tree" target="_blank" rel="noopener">https://marketplace.visualstudio.com/items?itemName=Gruntfuggly.todo-tree</a></p></blockquote><p><img src="https://raw.githubusercontent.com/Gruntfuggly/todo-tree/master/resources/screenshot.png" alt=""></p></li><li><p>live server</p><blockquote><p><a href="https://marketplace.visualstudio.com/items?itemName=ritwickdey.LiveServer" target="_blank" rel="noopener">https://marketplace.visualstudio.com/items?itemName=ritwickdey.LiveServer</a></p></blockquote></li></ul><p>  <img src="https://github.com/ritwickdey/vscode-live-server/raw/master/images/Screenshot/vscode-live-server-animated-demo.gif" alt=""></p><ul><li><p>jira plugin</p><blockquote><p><a href="https://marketplace.visualstudio.com/items?itemName=gioboa.jira-plugin" target="_blank" rel="noopener">https://marketplace.visualstudio.com/items?itemName=gioboa.jira-plugin</a></p></blockquote><p><img src="https://raw.githubusercontent.com/gioboa/jira-plugin/master/images/readme/setup.gif" alt="setup"></p><p><img src="https://github.com/gioboa/jira-plugin/raw/master/images/readme/set-working-project.gif" alt="set-working-project"></p><p><img src="https://github.com/gioboa/jira-plugin/raw/master/images/readme/issue-commands.png" alt="issue-commands"></p></li></ul><ul><li><p>powershell</p><blockquote><p><a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode.PowerShell" target="_blank" rel="noopener">https://marketplace.visualstudio.com/items?itemName=ms-vscode.PowerShell</a></p></blockquote></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;前端开发VSCode插件推荐&quot;&gt;&lt;a href=&quot;#前端开发VSCode插件推荐&quot; class=&quot;headerlink&quot; title=&quot;前端开发VSCode插件推荐&quot;&gt;&lt;/a&gt;前端开发&lt;code&gt;VSCode&lt;/code&gt;插件推荐&lt;/h1&gt;&lt;blockquote&gt;
      
    
    </summary>
    
      <category term="vscode" scheme="https://betgar.github.io/categories/vscode/"/>
    
    
      <category term="vscode" scheme="https://betgar.github.io/tags/vscode/"/>
    
  </entry>
  
  <entry>
    <title>前端小纠结--Event Bus模块约定</title>
    <link href="https://betgar.github.io/2019/07/08/the-event-layer-design/"/>
    <id>https://betgar.github.io/2019/07/08/the-event-layer-design/</id>
    <published>2019-07-08T11:30:00.000Z</published>
    <updated>2019-07-10T00:06:57.965Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前端小纠结–Event-Bus模块约定"><a href="#前端小纠结–Event-Bus模块约定" class="headerlink" title="前端小纠结–Event Bus模块约定"></a>前端小纠结–Event Bus模块约定</h1><blockquote><p>本文只是给一个针对某一类问题的处理思路。</p></blockquote><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>标题有点大，本文产生的背景是，因为在封装<code>Axios</code>的时候，对于服务端的异常或者需要根据业务上异常code，进行不同的处理逻辑。但是基于<code>Axios</code>做的封装作为<strong>跨项目、跨框架</strong>模块使用所以不能和具体的router或者store等模块耦合，所以使用<code>Event Bus</code>，在整个<code>Web</code>范围中来解耦各个组件。</p><h2 id="为什么使用Event-Bus？"><a href="#为什么使用Event-Bus？" class="headerlink" title="为什么使用Event Bus？"></a>为什么使用Event Bus？</h2><blockquote><p>Event Bus有特殊的使用场景，不止在view组件之间的通信使用；Event Bus设计作为整个SPA应用的事件（消息）投递层使用。</p></blockquote><ul><li><p>模块通信</p><blockquote><p>解决模块之间的通信问题，view组件层面，父子组件、兄弟组件通信都可以使用event bus处理。</p></blockquote></li><li><p>模块解耦</p><blockquote><p>storage change事件，cookie change事件，view组件的事件等，全部转换</p><p>使用Event Bus来订阅和发布，这样就统一了整个应用不同模块之间的通信接口问题。</p></blockquote></li><li><p>父子页面通信</p><blockquote><p><code>window.postMessage</code> + Event Bus</p></blockquote></li><li><p>多页面通信</p><blockquote><p>storage change + Event Bus</p></blockquote></li></ul><h2 id="Event-Bus模块封装"><a href="#Event-Bus模块封装" class="headerlink" title="Event Bus模块封装"></a>Event Bus模块封装</h2><h3 id="Event-Bus接口设计"><a href="#Event-Bus接口设计" class="headerlink" title="Event Bus接口设计"></a>Event Bus接口设计</h3><blockquote><p>参考<code>jQuery</code>和<code>Vue</code></p></blockquote><p>方法： <code>on</code>, <code>off</code>, <code>once</code>, <code>publish(可选trigger/dispatch/emit)</code></p><ul><li>如果你使用<code>vue</code>框架，就使用<code>Vue</code>对象或者使用<a href="https://github.com/ytftianwen/dynamic-vue-bus" target="_blank" rel="noopener">dynamic-vue-bus</a>包（其实也是包装了下Vue，实现自动destroy handler）。</li><li>如果搞一个框架无关的，兼容性好的就基于<a href="https://github.com/mroderick/PubSubJS" target="_blank" rel="noopener"><code>PubSubJS</code></a> 封装。</li></ul><h3 id="BusEvent元数据模型设计"><a href="#BusEvent元数据模型设计" class="headerlink" title="BusEvent元数据模型设计"></a><code>BusEvent</code>元数据模型设计</h3><blockquote><p>参考DOM中的Event对象</p></blockquote><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 服务端返回的元数据模型(responeBody)</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> ResponseResult&lt;T = any&gt; &#123;</span><br><span class="line">  message: <span class="built_in">string</span>;</span><br><span class="line">  code: <span class="built_in">number</span>;</span><br><span class="line">  data: T;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> BusEvent&lt;T = any&gt; <span class="keyword">extends</span> ResponseResult&lt;T&gt; &#123;</span><br><span class="line">  <span class="keyword">type</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> BusEventHandler = <span class="function">(<span class="params">data: BusEvent</span>) =&gt;</span> <span class="built_in">any</span>;</span><br></pre></td></tr></table></figure><blockquote><p>这里的<code>message</code>是参考Error来设计的，因为当我们程序异常或者业务上异常时，就可以统一直接使用<code>new Error()</code>进行处理。</p></blockquote><h2 id="封装实现"><a href="#封装实现" class="headerlink" title="封装实现"></a>封装实现</h2><blockquote><p>项目中实现选择一种即可。</p></blockquote><h3 id="基于Vue封装实现"><a href="#基于Vue封装实现" class="headerlink" title="基于Vue封装实现"></a>基于<code>Vue</code>封装实现</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> EventBus <span class="keyword">from</span> <span class="string">'dynamic-vue-bus'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; isFunction &#125; <span class="keyword">from</span> <span class="string">'lodash-es'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 基于Vue实现</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> VueBus = &#123;</span><br><span class="line">  originBus: EventBus,</span><br><span class="line">  on(topic: <span class="built_in">string</span> | <span class="built_in">string</span>[], handler: BusEventHandler): <span class="built_in">string</span>[] &#123;</span><br><span class="line">    <span class="comment">// @ts-ignore</span></span><br><span class="line">    <span class="keyword">this</span>.originBus.$on(topic, handler)</span><br><span class="line">    <span class="keyword">return</span> [];</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  off(topic: <span class="built_in">string</span> | <span class="built_in">string</span>[], handler?: <span class="built_in">any</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> length = <span class="built_in">arguments</span>.length;</span><br><span class="line">    <span class="keyword">switch</span> (length) &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">this</span>.originBus.$off(topic);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">this</span>.originBus.$off(topic, handler);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">this</span>.originBus.$off();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  once(topic: <span class="built_in">string</span>, handler: BusEventHandler) &#123;</span><br><span class="line">    <span class="comment">// @ts-ignore</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.originBus.$once(topic, handler);</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  publish(topic: <span class="built_in">string</span>, data: BusEvent) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.originBus.$emit(topic, data);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><blockquote><p>使用：</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">wsHandler</span>(<span class="params">evt: BusEvent</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(evt);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> topic = <span class="string">'ws.100021'</span>;</span><br><span class="line">VueBus.on(topic, wsHandler);</span><br><span class="line"><span class="comment">// VueBus.once(topic, wsHandler);</span></span><br><span class="line"></span><br><span class="line">VueBus.publish(topic, &#123;</span><br><span class="line">   code: <span class="number">100021</span>,</span><br><span class="line">   type: <span class="string">'ws'</span>,</span><br><span class="line">   message: <span class="string">''</span>,</span><br><span class="line">   data: &#123;</span><br><span class="line">        result: [&#123;</span><br><span class="line">            id: <span class="number">1</span>,</span><br><span class="line">            name: <span class="string">'junna'</span></span><br><span class="line">        &#125;]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// VueBus.off();</span></span><br><span class="line">VueBus.off(topic);</span><br><span class="line"><span class="comment">// VueBus.off(topic, wsHandler);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用原生的Vue</span></span><br><span class="line"><span class="keyword">const</span> eventBus = PubSubBus.originBus;</span><br></pre></td></tr></table></figure><h3 id="基于PubSubJS实现"><a href="#基于PubSubJS实现" class="headerlink" title="基于PubSubJS实现"></a>基于<code>PubSubJS</code>实现</h3><blockquote><p>以下代码并没测试</p></blockquote><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> PubSubBus = &#123;</span><br><span class="line">  originBus: PubSub,</span><br><span class="line">  on(topic: <span class="built_in">string</span> | <span class="built_in">string</span>[], handler: BusEventHandler): <span class="built_in">string</span>[] &#123;</span><br><span class="line">    <span class="keyword">if</span> (!topic) &#123;</span><br><span class="line">      <span class="keyword">return</span> [];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// @ts-ignore</span></span><br><span class="line">    <span class="keyword">let</span> events: <span class="built_in">string</span>[] = [].concat(topic);</span><br><span class="line">    <span class="keyword">return</span> events.map(<span class="function"><span class="params">evt</span> =&gt;</span></span><br><span class="line">      PubSub.subscribe(evt, <span class="function"><span class="params">()</span> =&gt;</span> (topic: <span class="built_in">string</span>, data: BusEvent) =&gt;</span><br><span class="line">        handler(data)</span><br><span class="line">      )</span><br><span class="line">    );</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 不兼容这种模式：PubSubBus.off('ws.001', handler);</span></span><br><span class="line"><span class="comment">   * 因为PubSubJS使用token来off这种操作</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  off(tokenOrHandler?: <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">void</span> | <span class="built_in">string</span> | <span class="built_in">string</span>[]) &#123;</span><br><span class="line">    <span class="keyword">let</span> length = <span class="built_in">arguments</span>.length,</span><br><span class="line">      evts: <span class="built_in">string</span>[],</span><br><span class="line">      listener;</span><br><span class="line">    <span class="keyword">if</span> (length === <span class="number">0</span>) &#123;</span><br><span class="line">      PubSub.clearAllSubscriptions();</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// PubSubBus.off(handler);</span></span><br><span class="line">      <span class="keyword">if</span> (isFunction(tokenOrHandler)) &#123;</span><br><span class="line">        PubSub.unsubscribe(listener);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// @ts-ignore</span></span><br><span class="line">        evts = [].concat(tokenOrHandler);</span><br><span class="line">        evts.forEach(<span class="function"><span class="params">evt</span> =&gt;</span> PubSub.unsubscribe(evt));</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  once(topic: <span class="built_in">string</span>, handler: BusEventHandler) &#123;</span><br><span class="line">    <span class="comment">// @ts-ignore</span></span><br><span class="line">    <span class="keyword">return</span> PubSub.subscribeOnce(topic, handler);</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  publish(topic: <span class="built_in">string</span>, data: BusEvent, sync = <span class="literal">false</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> sync ? PubSub.publishSync(topic, data) : PubSub.publish(topic, data);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><blockquote><p>使用：</p></blockquote><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">wsHandler</span>(<span class="params">evt: BusEvent</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(evt);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> topic = <span class="string">'ws.100021'</span>;</span><br><span class="line"><span class="keyword">const</span> tokens: <span class="built_in">string</span>[] = PubSubBus.on(topic, wsHandler);</span><br><span class="line"><span class="comment">// PubSubBus.once(topic, wsHandler);</span></span><br><span class="line"></span><br><span class="line">PubSubBus.publish(topic, &#123;</span><br><span class="line">   code: <span class="number">100021</span>,</span><br><span class="line">   <span class="keyword">type</span>: <span class="string">'ws'</span>,</span><br><span class="line">   message: <span class="string">''</span>,</span><br><span class="line">   data: &#123;</span><br><span class="line">        result: [&#123;</span><br><span class="line">            id: <span class="number">1</span>,</span><br><span class="line">            name: <span class="string">'junna'</span></span><br><span class="line">        &#125;]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// PubSubBus.off();</span></span><br><span class="line">PubSubBus.off(topic);</span><br><span class="line"><span class="comment">// PubSubBus.off(tokens[0]); // 等价于VueBus.off(topic, wsHandler);</span></span><br><span class="line"><span class="comment">// PubSubBus.off(wsHandler); // 移除多个topic使用的同一个handler.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用原生的PubSubJS</span></span><br><span class="line"><span class="keyword">const</span> PubSub = PubSubBus.originBus;</span><br></pre></td></tr></table></figure><h2 id="Event相关约定"><a href="#Event相关约定" class="headerlink" title="Event相关约定"></a>Event相关约定</h2><h3 id="BusEvent-type类型约定"><a href="#BusEvent-type类型约定" class="headerlink" title="BusEvent#type类型约定"></a><code>BusEvent#type</code>类型约定</h3><blockquote><p>事件类型的约定参考：</p><ul><li><code>ws</code>： <code>WebSocket</code>事件</li><li>storage: 储存事件, <code>sessionStorage</code>, <code>localStorage</code></li><li>cs: cache storage</li><li><code>ap</code>: application cache</li><li>cookie: cookie事件</li><li>biz: 业务事件</li><li>system: 系统事件</li><li><code>ui</code>: 界面</li><li><code>cmp</code>： components事件</li></ul></blockquote><h3 id="BusEvent-code范围约定"><a href="#BusEvent-code范围约定" class="headerlink" title="BusEvent#code范围约定"></a><code>BusEvent#code</code>范围约定</h3><blockquote><p>code范围约定只是参考，因为这个约定需要和服务端小伙伴，甚至系统设计时规划决定。<br>（瞎写）</p><ul><li><code>ws</code>： 10000~19999</li><li>storage: 20000~29999, <code>sessionStorage</code>: 22000~22999, <code>localStorage</code>: 23000~23999</li><li>cs: 24000~24999</li><li><code>ap</code>: 25000~25999</li><li>cookie: 26000~26999</li><li>biz: 30000~31000</li><li>system: 40000~41000</li><li><code>ui</code>: 42000~42999</li><li><code>cmp</code>： 43000~44999</li></ul></blockquote><h2 id="统一处理EventBus事件"><a href="#统一处理EventBus事件" class="headerlink" title="统一处理EventBus事件"></a>统一处理EventBus事件</h2><blockquote><p>有了约定，就可以统一发布相关的事件</p></blockquote><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 模拟WebSocket的消息</span></span><br><span class="line"><span class="keyword">const</span> data = [&#123;</span><br><span class="line">   code: <span class="number">100021</span>,</span><br><span class="line">   <span class="keyword">type</span>: <span class="string">'ws'</span>,</span><br><span class="line">   message: <span class="string">''</span>,</span><br><span class="line">   data: &#123;</span><br><span class="line">        result: [&#123;</span><br><span class="line">            id: <span class="number">1</span>,</span><br><span class="line">            name: <span class="string">'junna'</span></span><br><span class="line">        &#125;]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,&#123;</span><br><span class="line">   code: <span class="number">100022</span>,</span><br><span class="line">   <span class="keyword">type</span>: <span class="string">'ws'</span>,</span><br><span class="line">   message: <span class="string">''</span>,</span><br><span class="line">   data: &#123;</span><br><span class="line">        result: [&#123;</span><br><span class="line">            id: <span class="number">1</span>,</span><br><span class="line">            name: <span class="string">'junna'</span></span><br><span class="line">        &#125;]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line">data.forEach(<span class="function"><span class="params">event</span> =&gt;</span> PubSubBus.publish(<span class="string">`<span class="subst">$&#123;event.type&#125;</span>.<span class="subst">$&#123;event.code&#125;</span>`</span>), event));</span><br></pre></td></tr></table></figure><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><blockquote><p>通过对Event Bus的统一封装，对外提供统一的接口，统一整个SPA事件系统（非DOM层面），完成了模块之间的解耦。</p></blockquote><p>缺点：</p><ul><li>基于<code>Vue</code>封装实现的不支持<code>namespace</code></li><li>基于<code>Vue</code>封装实现和<code>PubSubJS</code>接口参数和返回值有差异，所以选择一种即可</li></ul><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://alligator.io/vuejs/global-event-bus/" target="_blank" rel="noopener">global-event-bus</a></p><p><a href="https://github.com/mroderick/PubSubJS" target="_blank" rel="noopener">PubSubJS</a></p><p><a href="https://github.com/ytftianwen/dynamic-vue-bus" target="_blank" rel="noopener">dynamic-vue-bus</a></p><p><a href="https://zhuanlan.zhihu.com/p/39537979" target="_blank" rel="noopener">让在Vue中使用的EventBus也有生命周期</a></p><p><a href="http://dev-test.nemikor.com/web-storage/support-test/" target="_blank" rel="noopener">Web Storage Support Test</a></p><p><a href="https://www.html5rocks.com/en/tutorials/offline/quota-research/" target="_blank" rel="noopener">Working with quota on mobile browsers</a></p><p><a href="https://demo.agektmr.com/storage/" target="_blank" rel="noopener">Browser Storage Abuser</a></p><p><a href="https://github.com/agektmr/BrowserStorageAbuser" target="_blank" rel="noopener">BrowserStorageAbuser github</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;前端小纠结–Event-Bus模块约定&quot;&gt;&lt;a href=&quot;#前端小纠结–Event-Bus模块约定&quot; class=&quot;headerlink&quot; title=&quot;前端小纠结–Event Bus模块约定&quot;&gt;&lt;/a&gt;前端小纠结–Event Bus模块约定&lt;/h1&gt;&lt;bloc
      
    
    </summary>
    
      <category term="fe" scheme="https://betgar.github.io/categories/fe/"/>
    
      <category term="vue" scheme="https://betgar.github.io/categories/fe/vue/"/>
    
    
      <category term="fe" scheme="https://betgar.github.io/tags/fe/"/>
    
      <category term="vue" scheme="https://betgar.github.io/tags/vue/"/>
    
  </entry>
  
  <entry>
    <title>看过去前端技术流行趋势，布局未来前端技术</title>
    <link href="https://betgar.github.io/2019/07/04/look-at-past-front-end-trends-and-prepare-for-future-front-end-technologies/"/>
    <id>https://betgar.github.io/2019/07/04/look-at-past-front-end-trends-and-prepare-for-future-front-end-technologies/</id>
    <published>2019-07-04T12:30:00.000Z</published>
    <updated>2019-07-10T11:04:24.630Z</updated>
    
    <content type="html"><![CDATA[<h1 id="看过去前端技术流行趋势，布局未来前端技术"><a href="#看过去前端技术流行趋势，布局未来前端技术" class="headerlink" title="看过去前端技术流行趋势，布局未来前端技术"></a>看过去前端技术流行趋势，布局未来前端技术</h1><blockquote><p>标题党，为啥？因为只是记录一下，提供前端技术流行趋势的网站资料来源。给准备进入前端领域或者刚如入门的前端小伙伴，一点大方向上的指引。</p></blockquote><h2 id="前端技术趋势资料"><a href="#前端技术趋势资料" class="headerlink" title="前端技术趋势资料"></a>前端技术趋势资料</h2><ul><li><p>JavaScript社区的趋势（方方面面）</p><blockquote><p><a href="https://stateofjs.com/" target="_blank" rel="noopener">https://stateofjs.com/</a></p></blockquote></li><li><p>CSS社区的技术趋势（方方面面）</p><blockquote><p><a href="https://stateofcss.com/" target="_blank" rel="noopener">https://stateofcss.com/</a></p></blockquote></li><li><p>每年JavaScript的明星项目</p><blockquote><p><a href="https://risingstars.js.org/" target="_blank" rel="noopener">https://risingstars.js.org/</a></p></blockquote></li><li><p>JavaScript项目的受欢迎程度（方方面面）</p><blockquote><p> <a href="https://bestofjs.org/" target="_blank" rel="noopener">https://bestofjs.org/</a></p></blockquote></li><li><p>Web开发者路线图谱（Front-end, DevOps, Back-end）</p><blockquote><p><a href="https://github.com/kamranahmedse/developer-roadmap" target="_blank" rel="noopener">https://github.com/kamranahmedse/developer-roadmap</a></p></blockquote></li><li><p>前端开发手册（指导性，每年一本）</p><blockquote><p><a href="https://github.com/FrontendMasters/front-end-handbook-2019" target="_blank" rel="noopener">https://github.com/FrontendMasters/front-end-handbook-2019</a></p></blockquote></li><li><p>CSS in js</p><blockquote><p><a href="http://michelebertoli.github.io/css-in-js/" target="_blank" rel="noopener">http://michelebertoli.github.io/css-in-js/</a></p></blockquote></li></ul><h2 id="未来的机会和方向（吹牛皮）"><a href="#未来的机会和方向（吹牛皮）" class="headerlink" title="未来的机会和方向（吹牛皮）"></a>未来的机会和方向（吹牛皮）</h2><blockquote><p>从 比较热门浏览器的API来看未来的趋势。</p></blockquote><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https://raw.githubusercontent.com/betgar/betgar.github.io/master/img/picgo/20190704205141.jpg" alt="hot-browser-api" title="">                </div>                <div class="image-caption">hot-browser-api</div>            </figure><ul><li>渐进式的Web Apps</li><li>Web组件化</li><li>可视化（WebGL, 动画, 音频，实时通信, 语音， VR）</li></ul><blockquote><p>加上今年的5G开通，对于整个行业和生态链都是机会和挑战。你敢预测以后的Web或者浏览器功能有多强大吗？<strong><em>告诉你个消息，腾讯直播在用微信小程序做直播，很流畅。</em></strong> 如果很多公众号博主直接进入直播平台，那是自带流量，你说是不是机会？</p></blockquote><p>如果有能力多关注这些领域：</p><ul><li><p>流媒体(直播,短视频)</p></li><li><p>可视化</p></li><li><p>VR/AR</p></li><li><p>IoT</p></li><li><p>图形学</p></li></ul><h2 id="Vue生态相关资源和工具列举"><a href="#Vue生态相关资源和工具列举" class="headerlink" title="Vue生态相关资源和工具列举"></a>Vue生态相关资源和工具列举</h2><blockquote><p>列举一下Vue生态的相关学习和进阶资源</p></blockquote><ul><li><p>Vue（jsx &amp; render &amp; async component）</p></li><li><p>vue-cli3 &amp; Webpack &amp; Rollup</p></li><li><p>vue-router</p></li><li><p>vuex</p></li><li><p>vue-i18n</p></li><li><p>Sass &amp; less</p></li><li><p>CSS Modules &amp; PostCSS</p></li><li><p>lodash &amp; moment.js (day.js)</p></li><li><p>element-ui</p></li><li><p>ant-design-vue</p></li><li><p>nuxt.js</p></li><li><p>vuepress</p></li><li><p>TypeScript</p></li><li><p>Babel</p></li><li><p>vue-test-utils</p></li><li><p>Jest &amp; Mocha</p></li><li><p>cypress</p></li></ul><p>附：<a href="https://zhuanlan.zhihu.com/p/23134551" target="_blank" rel="noopener">新手向：Vue 2.0 的建议学习顺序</a></p><blockquote><p>吹牛皮完毕。</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;看过去前端技术流行趋势，布局未来前端技术&quot;&gt;&lt;a href=&quot;#看过去前端技术流行趋势，布局未来前端技术&quot; class=&quot;headerlink&quot; title=&quot;看过去前端技术流行趋势，布局未来前端技术&quot;&gt;&lt;/a&gt;看过去前端技术流行趋势，布局未来前端技术&lt;/h1&gt;&lt;
      
    
    </summary>
    
      <category term="fe" scheme="https://betgar.github.io/categories/fe/"/>
    
    
      <category term="fe" scheme="https://betgar.github.io/tags/fe/"/>
    
  </entry>
  
  <entry>
    <title>重新认识Cookie的限制</title>
    <link href="https://betgar.github.io/2019/07/03/ie11-lost-cookie-when-domain-is-localhost/"/>
    <id>https://betgar.github.io/2019/07/03/ie11-lost-cookie-when-domain-is-localhost/</id>
    <published>2019-07-03T00:00:00.000Z</published>
    <updated>2019-07-10T00:07:06.024Z</updated>
    
    <content type="html"><![CDATA[<h1 id="重新认识Cookie的限制"><a href="#重新认识Cookie的限制" class="headerlink" title="重新认识Cookie的限制"></a>重新认识Cookie的限制</h1><blockquote><p>背景是在使用vue-cli3开发模式启动的服务，登录成功服务端返回了信息，并且设置了cookie，但是在IE11下却无法找到服务端设置的cookie信息，自己代码中添加的cookie反而成功了。又是潜在的坑？</p></blockquote><h2 id="vue-cli3使用development模式启动的配置"><a href="#vue-cli3使用development模式启动的配置" class="headerlink" title="vue-cli3使用development模式启动的配置"></a>vue-cli3使用development模式启动的配置</h2><blockquote><p>vue.config.js配置</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  devServer: &#123;</span><br><span class="line">    proxy: &#123;</span><br><span class="line">      <span class="string">'/api'</span>: &#123;</span><br><span class="line">        target: <span class="string">'api.com'</span>, <span class="comment">// 开发环境</span></span><br><span class="line">        changeOrigin: <span class="literal">true</span>,</span><br><span class="line">        pathRewrite: &#123;</span><br><span class="line">          <span class="string">'^/api'</span>: <span class="string">'/api'</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        cookieDomainRewrite: &#123;</span><br><span class="line">          <span class="string">'api.com'</span>: <span class="string">'localhost'</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h2><blockquote><p>原因就是<code>Set-Cookie</code>中的<code>Domain=localhost</code>的问题，因为规范规定domain必须是一个至少含有两个dot的，但是还不能是<code>ip</code>。其实呢，IE没错，错在自己不知道规范和套路。</p></blockquote><h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h2><blockquote><p>修改<code>vue.config</code>的配置，重定向给null, false, ‘’, 或者localhost.cn (etc/hosts文件里面配置下)</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  devServer: &#123;</span><br><span class="line">    proxy: &#123;</span><br><span class="line">      <span class="string">'/api'</span>: &#123;</span><br><span class="line">        target: <span class="string">'api.com'</span>, <span class="comment">// 开发环境</span></span><br><span class="line">        changeOrigin: <span class="literal">true</span>,</span><br><span class="line">        pathRewrite: &#123;</span><br><span class="line">          <span class="string">'^/api'</span>: <span class="string">'/api'</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        cookieDomainRewrite: &#123;</span><br><span class="line">          <span class="string">'api.com'</span>: <span class="literal">null</span>, <span class="comment">// '' 或 null 或 false都行</span></span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="重新认识cookie的限制"><a href="#重新认识cookie的限制" class="headerlink" title="重新认识cookie的限制"></a>重新认识cookie的限制</h2><blockquote><p>虽然cookie浏览器都支持，但是还是有一堆的潜规则。</p></blockquote><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https://raw.githubusercontent.com/betgar/betgar.github.io/master/img/picgo/20190705170758.jpg" alt="cookie的属性" title="">                </div>                <div class="image-caption">cookie的属性</div>            </figure><h3 id="cookie属性值和属性名称编码"><a href="#cookie属性值和属性名称编码" class="headerlink" title="cookie属性值和属性名称编码"></a>cookie属性值和属性名称编码</h3><blockquote><p>所有在 cookie 名称或 cookie 值中不允许的特殊字符都使用百分比编码对每个字符的 UTF-8 十六进制等效项进行编码。<br>Cookie 名称或 Cookie 值中允许并且仍然编码的唯一字符是百分比字符,它将转义以将百分比输入解释为文本。</p></blockquote><h3 id="IE下cookie的path不能包含文件名"><a href="#IE下cookie的path不能包含文件名" class="headerlink" title="IE下cookie的path不能包含文件名"></a>IE下cookie的path不能包含文件名</h3><p><a href="http://blogs.msdn.com/b/ieinternals/archive/2009/08/20/wininet-ie-cookie-internals-faq.aspx" target="_blank" rel="noopener">http://blogs.msdn.com/b/ieinternals/archive/2009/08/20/wininet-ie-cookie-internals-faq.aspx</a><br>Q8: Are there any limits to the HTML DOM document.cookie property?</p><blockquote><p>由于基础 WinINET InternetGetCookie 实现中存在一个模糊的 bug,IE 的文档.cookie 如果使用包含文件名的路径属性设置,则不会返回 Cookie。</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Set-Cookie: HTTPSet-PathCookie=PASS;path=/check.htm</span><br></pre></td></tr></table></figure><p>这个cookie不会出现在document.cookie中，但是HTTP requests还是会附带上。</p><h3 id="为什么我的-Cookie-被删除"><a href="#为什么我的-Cookie-被删除" class="headerlink" title="为什么我的 Cookie 被删除?"></a>为什么我的 Cookie 被删除?</h3><p><a href="https://github.com/js-cookie/js-cookie/wiki/Frequently-Asked-Questions#why-are-my-cookies-being-deleted" target="_blank" rel="noopener">https://github.com/js-cookie/js-cookie/wiki/Frequently-Asked-Questions#why-are-my-cookies-being-deleted</a></p><blockquote><p>它们可能太大,或者同一域中的 Cookie 太多。</p></blockquote><p>根据<code>RFC 6265</code>,这是浏览器为 Cookie 实现的规范:</p><p>实际的用户代理实现对它们可以存储的 Cookie 的数量和大小有限制。通用用户代理应提供以下每个最低功能:</p><ul><li>每个 Cookie 至少 4096 字节(以 Cookie 的名称、值和属性的长度之和来衡量)。</li><li>每个域最多 50 个 Cookie。</li><li>总共最多3000个cookie。</li></ul><p>不要超过 RFC 中规定的强制限制，这意味着浏览器可能会由于此大小限制而截断 Cookie。</p><h3 id="设置两个同名的-Cookie-吗"><a href="#设置两个同名的-Cookie-吗" class="headerlink" title="设置两个同名的 Cookie 吗?"></a>设置两个同名的 Cookie 吗?</h3><p><a href="https://github.com/js-cookie/js-cookie/issues/226" target="_blank" rel="noopener">https://github.com/js-cookie/js-cookie/issues/226</a></p><p>不可以，会有意想不到效果。</p><h3 id="cookie不会被删除的情况"><a href="#cookie不会被删除的情况" class="headerlink" title="cookie不会被删除的情况"></a>cookie不会被删除的情况</h3><blockquote><p>这个问题我真的遇到了，当时还很奇怪，又纠结了。</p></blockquote><h4 id="会话期Cookie"><a href="#会话期Cookie" class="headerlink" title="会话期Cookie"></a>会话期Cookie</h4><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Cookies#%E4%BC%9A%E8%AF%9D%E6%9C%9FCookie" target="_blank" rel="noopener">https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Cookies#%E4%BC%9A%E8%AF%9D%E6%9C%9FCookie</a><br>会话期Cookie是最简单的Cookie：浏览器关闭之后它会被自动删除，也就是说它仅在会话期内有效。会话期Cookie不需要指定过期时间（Expires）或者有效期（Max-Age）。需要注意的是，有些浏览器提供了会话恢复功能，这种情况下即使关闭了浏览器，会话期Cookie也会被保留下来，就好像浏览器从来没有关闭一样。</p><p><strong>注意</strong> ：如果你这样设置，会话期cookie也不会删除，所以前端一定要做好判断，这个坑我又踩了</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https://raw.githubusercontent.com/betgar/betgar.github.io/master/img/picgo/20190705170642-chrome-setting-startup.jpg" alt="Continue where you left off" title="">                </div>                <div class="image-caption">Continue where you left off</div>            </figure><h4 id="持久性Cookie"><a href="#持久性Cookie" class="headerlink" title="持久性Cookie"></a>持久性Cookie</h4><p>和关闭浏览器便失效的会话期Cookie不同，持久性Cookie可以指定一个特定的过期时间（Expires）或有效期（Max-Age）。</p><h3 id="cookie的Secure和HttpOnly属性"><a href="#cookie的Secure和HttpOnly属性" class="headerlink" title="cookie的Secure和HttpOnly属性"></a>cookie的Secure和HttpOnly属性</h3><blockquote><p>标记为 Secure 的Cookie只应通过被HTTPS协议加密过的请求发送给服务端。<br>从 Chrome 52 和 Firefox 52 开始，不安全的站点（http:）无法使用Cookie的 Secure 标记。<br>HttpOnly 标记的Cookie，只能在HTTP request headers里面，JavaScript不能获取。</p></blockquote><h3 id="判断当前页面是否启用cookie"><a href="#判断当前页面是否启用cookie" class="headerlink" title="判断当前页面是否启用cookie"></a>判断当前页面是否启用cookie</h3><blockquote><p>navigator.cookieEnabled 返回一个布尔值，来表示当前页面是否启用了 cookie。本属性为只读属性。</p></blockquote><h3 id="Cookie-SameSite属性"><a href="#Cookie-SameSite属性" class="headerlink" title="Cookie SameSite属性"></a>Cookie SameSite属性</h3><blockquote><p><strong><em>如果所有现代浏览器默认SameSite=Strict，嘿嘿一堆应用会出问题。</em></strong><br>别人的文章<a href="https://mp.weixin.qq.com/s/4zVrM5bKlRhWER90iZjP-A" target="_blank" rel="noopener">Chrome默认启用Cookie Samesite属性</a></p></blockquote><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https://raw.githubusercontent.com/betgar/betgar.github.io/master/img/picgo/20190705174243-caniuse-cookie-samesite.jpg" alt="cookie-samesite-attribute" title="">                </div>                <div class="image-caption">cookie-samesite-attribute</div>            </figure><blockquote><p>微软你有毛病，IE11还区分Windows版本，SameSite功能部分支持。</p></blockquote><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><blockquote><p>没想到普遍支持的cookie，还有如此多的限制，恨自己的经验不足。</p></blockquote><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://stackoverflow.com/a/56048266/10371129" target="_blank" rel="noopener">internet-explorer-11-wont-set-cookies-on-a-site</a></p><p><a href="https://blogs.msdn.microsoft.com/ieinternals/2010/04/04/understanding-session-lifetime/" target="_blank" rel="noopener">understanding-session-lifetime/</a></p><p><a href="https://curl.haxx.se/rfc/cookie_spec.html" target="_blank" rel="noopener">cookie_spec</a></p><p><a href="https://stackoverflow.com/questions/1134290/cookies-on-localhost-with-explicit-domain/1188145#1188145" target="_blank" rel="noopener">cookies-on-localhost-with-explicit-domain</a></p><p><a href="https://stackoverflow.com/questions/1134290/cookies-on-localhost-with-explicit-domain/32210291#32210291" target="_blank" rel="noopener">cookie-domain</a></p><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS" target="_blank" rel="noopener">MDN_HTTP_Access_control_CORS</a></p><p><a href="http://www.ruanyifeng.com/" target="_blank" rel="noopener">阮一峰–跨域资源共享 CORS 详解</a></p><p><a href="https://www.html5rocks.com/en/tutorials/cors/" target="_blank" rel="noopener">cors-tutorials</a></p><p><a href="https://www.w3.org/TR/cors/#preflight-request" target="_blank" rel="noopener">preflight-request</a></p><p><a href="https://segmentfault.com/a/1190000011145364" target="_blank" rel="noopener">前端常见跨域方案</a></p><p><a href="https://majing.io/posts/10000010111185" target="_blank" rel="noopener">Spring mvc解决跨域请求：Response to preflight request doesn’t pass access control check</a></p><p><a href="https://github.com/hfpp2012/cors-tutorial" target="_blank" rel="noopener">什么是浏览器跨域，如何解决跨域问题，什么是 CORS？从入门到精通</a></p><p><a href="https://mp.weixin.qq.com/s/4zVrM5bKlRhWER90iZjP-A" target="_blank" rel="noopener">Chrome默认启用Cookie Samesite属性</a></p><p><a href="https://github.com/nodejitsu/node-http-proxy#options" target="_blank" rel="noopener">node-http-proxy#options</a></p><p><a href="https://tools.ietf.org/html/rfc6265" target="_blank" rel="noopener">HTTP Cookie and Set-Cookie header fields</a></p><p><a href="https://github.com/js-cookie/js-cookie" target="_blank" rel="noopener">js-cookie</a><br><a href="https://github.com/js-cookie/js-cookie/wiki/Frequently-Asked-Questions#why-are-my-cookies-being-deleted" target="_blank" rel="noopener">Frequently-Asked-Questions#why-are-my-cookies-being-deleted</a><br><a href="http://blogs.msdn.com/b/ieinternals/archive/2009/08/20/wininet-ie-cookie-internals-faq.aspx" target="_blank" rel="noopener">Internet Explorer Cookie Internals (FAQ)</a><br><a href="https://stackoverflow.com/a/10772420/10371129" target="_blank" rel="noopener">Chrome doesn’t delete session cookies</a><br><a href="https://juejin.im/post/5c8a33dcf265da2dc538fc7d" target="_blank" rel="noopener">【译】Cookie的SameSite属性</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;重新认识Cookie的限制&quot;&gt;&lt;a href=&quot;#重新认识Cookie的限制&quot; class=&quot;headerlink&quot; title=&quot;重新认识Cookie的限制&quot;&gt;&lt;/a&gt;重新认识Cookie的限制&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;背景是在使用vue-cli
      
    
    </summary>
    
      <category term="ie" scheme="https://betgar.github.io/categories/ie/"/>
    
      <category term="cookie" scheme="https://betgar.github.io/categories/ie/cookie/"/>
    
    
      <category term="cookie" scheme="https://betgar.github.io/tags/cookie/"/>
    
      <category term="ie" scheme="https://betgar.github.io/tags/ie/"/>
    
  </entry>
  
  <entry>
    <title>自带“歧视性”的IE11 input事件</title>
    <link href="https://betgar.github.io/2019/07/02/the-weird-input-event-in-ie11/"/>
    <id>https://betgar.github.io/2019/07/02/the-weird-input-event-in-ie11/</id>
    <published>2019-07-02T12:30:00.000Z</published>
    <updated>2019-07-03T07:25:44.062Z</updated>
    
    <content type="html"><![CDATA[<h1 id="自带“歧视性”的IE11-input事件"><a href="#自带“歧视性”的IE11-input事件" class="headerlink" title="自带“歧视性”的IE11 input事件"></a>自带“歧视性”的IE11 input事件</h1><blockquote><p>第一次碰到自带的歧视的bug，IE 11泥潭不解释。</p></blockquote><h2 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h2><blockquote><p><code>ant-design-vue</code>的<code>RangePicker</code>在IE11下calendar panel无法正常展开，看图。</p></blockquote><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https://raw.githubusercontent.com/betgar/betgar.github.io/master/img/picgo/20190703083034-date-picker-range.gif" alt="RangePicker" title="">                </div>                <div class="image-caption">RangePicker</div>            </figure><blockquote><p>具体的相关讨论看参考链接中的<code>ant-design-vue</code>部分。</p></blockquote><p>因为我知道IE和firefox、chrome下时间处理有问题（es5之前），以为是Date的问题，所以我的调试方向就走偏了，顺便介绍下Date.parse的行为，new Date(‘字符串’)，内部使用Date.parse解析。</p><h2 id="Date-parse行为诡异"><a href="#Date-parse行为诡异" class="headerlink" title="Date.parse行为诡异"></a>Date.parse行为诡异</h2><blockquote><p><strong>参考链接</strong>部分有大量的Date知识总结，多多浏览。</p><p><code>Date.parse</code>在ES5之前不同浏览器，行为差异很大。现在我只能重现一下IE下的，Chrome和firefox版本都太高，已经修正这个问题。如果想看以前的兼容性问题，看这篇博客<a href="http://blog.dygraphs.com/2012/03/javascript-and-dates-what-mess.html" target="_blank" rel="noopener">javascript-and-dates-what-mess</a></p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 控制台</span></span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Date</span>(<span class="string">'2019-07-02'</span>)</span><br><span class="line"><span class="comment">// Tue Jul 02 2019 08:00:00 GMT+0800 (中国标准时间)</span></span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Date</span>(<span class="string">'2019/07/02'</span>)</span><br><span class="line"><span class="comment">// Tue Jul 02 2019 00:00:00 GMT+0800 (中国标准时间)</span></span><br></pre></td></tr></table></figure><p>看到区别了吗？time部分，一个从0点开始，一个从8点开始，为啥呢？看看MDN怎么说吧。</p><blockquote><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Date/parse" target="_blank" rel="noopener">MDN文档</a>不推荐在ES5之前使用Date.parse方法，因为字符串的解析完全取决于实现。直到至今，不同宿主在如何解析日期字符串上仍存在许多差异，因此最好还是手动解析日期字符串（在需要适应不同格式时库能起到很大帮助）。</p></blockquote><p><strong>注意</strong>：如果你要兼容IE，对日期处理，请使用专门的类库，例如：<code>moment.js, day.js</code>之类。</p><h3 id="Date-toString"><a href="#Date-toString" class="headerlink" title="Date#toString()"></a>Date#toString()</h3><blockquote><p>顺便提一下，Date#toString()竟然有规范，看这里<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/toString#Description" target="_blank" rel="noopener">Date.toString</a>，所以从Date字符串中解析提取一些字符可以放心大胆的用。以后推荐使用<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Intl" target="_blank" rel="noopener">Intl对象是 ECMAScript 国际化 API 的一个命名空间，它提供了精确的字符串对比、数字格式化，和日期时间格式化</a></p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 提取GMT时区</span></span><br><span class="line"><span class="comment"> * @param date</span></span><br><span class="line"><span class="comment"> * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/toString#Description</span></span><br><span class="line"><span class="comment"> * @returns ''或者GMT，或者GMT+0000或者GMT-0000；其中0000代表GMT偏移量，是四位前两位表示hours小时，后两位表示minuts分钟.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">extractTimezoneOffsetWithGMT</span>(<span class="params">date</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!date) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">const</span> dateTimeStr = date.toString(); <span class="comment">// Thu May 23 2019 14:52:15 GMT+0800 (中国标准时间)</span></span><br><span class="line">  <span class="keyword">const</span> gmtIndexStart = dateTimeStr.indexOf(<span class="string">'GMT'</span>);</span><br><span class="line">  <span class="keyword">const</span> timezoneEnd = dateTimeStr.indexOf(<span class="string">' '</span>, gmtIndexStart);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> dateTimeStr.substring(gmtIndexStart, timezoneEnd);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="placeholder和input事件"><a href="#placeholder和input事件" class="headerlink" title="placeholder和input事件"></a>placeholder和input事件</h2><blockquote><p>和<code>ant-design-vue</code>维护者沟通之后，得知这个bug在<code>ant-design-vue</code>的英文语言模式下不会有问题，维护的小伙伴，推测语言环境不同，有可能导致编译的代码不同（也有道理，现在js都上编译器，你不知道编译后代码有多大变化，当时已经提到了placeholder，我没注意）。</p></blockquote><p>思路：英文版和中文版，最大的不同应该是语言文件，涉及到<code>RangePicker</code>只有<strong>时间格式</strong>和<strong>placeholder</strong>，时间格式已经怀疑过，因为底层使用moment库处理，所以没问题。所以只能看看placeholder兼容性。</p><blockquote><p>placeholder兼容性</p></blockquote><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https://raw.githubusercontent.com/betgar/betgar.github.io/master/img/picgo/20190703135734-placeholder.jpg" alt="caniuse-placeholder" title="">                </div>                <div class="image-caption">caniuse-placeholder</div>            </figure><p><strong>注意</strong>：看下<strong>Known issues</strong>的tab页签，看到第二条，我震惊了，为啥当placeholder为中文时会触发input事件？？？</p><blockquote><p>input事件的兼容性</p></blockquote><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https://raw.githubusercontent.com/betgar/betgar.github.io/master/img/picgo/20190703135916-input-event.jpg" alt="caniuse-input-event" title="">                </div>                <div class="image-caption">caniuse-input-event</div>            </figure><blockquote><p>重现IE11当placeholder=”中文”时，触发input事件</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>placeholder<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"content"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">placeholder</span>=<span class="string">"english"</span> <span class="attr">id</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">placeholder</span>=<span class="string">"中文"</span> <span class="attr">id</span>=<span class="string">"cn"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> enInput = <span class="built_in">document</span>.getElementById(<span class="string">'en'</span>);</span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> cnInput = <span class="built_in">document</span>.getElementById(<span class="string">'cn'</span>);</span></span><br><span class="line"><span class="javascript">      enInput.addEventListener(<span class="string">'input'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">evt</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">'en inpu'</span>);</span></span><br><span class="line"><span class="undefined">      &#125;);</span></span><br><span class="line"><span class="javascript">      cnInput.addEventListener(<span class="string">'input'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">evt</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">'cn input'</span>);</span></span><br><span class="line"><span class="undefined">      &#125;);</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https://raw.githubusercontent.com/betgar/betgar.github.io/master/img/picgo/20190703141746-reproduce.gif" alt="placeholder-fire-input-event" title="">                </div>                <div class="image-caption">placeholder-fire-input-event</div>            </figure><h3 id="临时处理方案"><a href="#临时处理方案" class="headerlink" title="临时处理方案"></a>临时处理方案</h3><blockquote><p>知道了原因就很容易处理了，只要input的placeholder=””就搞定了，虽然不好看，总比有bug好。</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 重置placeholder，因为默认有语言文件，placeholder默认有文字的 --&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">a-range-picker</span> @<span class="attr">change</span>=<span class="string">"onChange"</span> <span class="attr">:placeholder</span>=<span class="string">"['', '']"</span>/&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>到这里才找到真正造成<code>RangePicker</code>问题的原因，反馈给了<code>ant-desing-vue</code>维护小伙伴，他们下次修复上线。</p></blockquote><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>解决问题的思路很重要，很重要，以后如果碰到IE下的问题，第一时间<code>https://caniuse.com/</code>网站看兼容性，被IE坑怕了，兼容IE，就是在浪费生命。</p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Date/parse" target="_blank" rel="noopener">Date.parse</a></p><p><a href="http://javascript.ruanyifeng.com/stdlib/date.html#toc4" target="_blank" rel="noopener">阮一峰 JavaScript标准参考教程 Date对象</a></p><p><a href="http://blog.dygraphs.com/2012/03/javascript-and-dates-what-mess.html" target="_blank" rel="noopener">javascript-and-dates-what-mess</a></p><p><a href="http://chitanda.me/2015/08/21/the-trivia-of-js-date-function/" target="_blank" rel="noopener">JS原生Date类型方法的一些冷知识</a></p><p><a href="https://github.com/wx-chevalier/ProgrammingLanguage-Series/blob/master/JavaScript/数据结构/时间与日期.md" target="_blank" rel="noopener">wxyyxc1992–时间与日期</a></p><p><a href="https://github.com/vueComponent/ant-design-vue/issues/608" target="_blank" rel="noopener">IE11日历选择框有值的情况无法打开选择框</a><br><a href="https://github.com/vueComponent/ant-design-vue/issues/626" target="_blank" rel="noopener">ie11下组件DatePicker 日期选择框不显示且控制台报错</a><br><a href="https://github.com/vueComponent/ant-design-vue/issues/865" target="_blank" rel="noopener">IE下点击RangePicker会闪一下关闭，openChange执行3次</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;自带“歧视性”的IE11-input事件&quot;&gt;&lt;a href=&quot;#自带“歧视性”的IE11-input事件&quot; class=&quot;headerlink&quot; title=&quot;自带“歧视性”的IE11 input事件&quot;&gt;&lt;/a&gt;自带“歧视性”的IE11 input事件&lt;/h1&gt;&lt;
      
    
    </summary>
    
      <category term="ie" scheme="https://betgar.github.io/categories/ie/"/>
    
      <category term="input" scheme="https://betgar.github.io/categories/ie/input/"/>
    
    
      <category term="ie" scheme="https://betgar.github.io/tags/ie/"/>
    
      <category term="input" scheme="https://betgar.github.io/tags/input/"/>
    
  </entry>
  
  <entry>
    <title>前端小纠结--IE11下SVG元素默认focusable=true</title>
    <link href="https://betgar.github.io/2019/07/02/svg-elements-default-focusable-in-ie11/"/>
    <id>https://betgar.github.io/2019/07/02/svg-elements-default-focusable-in-ie11/</id>
    <published>2019-07-02T04:00:00.000Z</published>
    <updated>2019-07-02T12:25:34.870Z</updated>
    
    <content type="html"><![CDATA[<h1 id="IE11下SVG元素默认focusable-true"><a href="#IE11下SVG元素默认focusable-true" class="headerlink" title="IE11下SVG元素默认focusable=true"></a>IE11下SVG元素默认focusable=true</h1><blockquote><p>本来我也不太关注一些交互的问题，但是在处理IE11下的svg能够focus(就是tab时候能够获取焦点)时候，发现原来tabindex也是大坑。每一次兼容性问题背后，都是有相关问题的好几个标准，一个标准还有好几个版本，不同的时期的浏览器，实现的又有差异，只要有一个浏览器和其它浏览器行为不同，就会被定义为你有bug。PS: 最近搞兼容性好累。</p></blockquote><h2 id="tabindex值的范围"><a href="#tabindex值的范围" class="headerlink" title="tabindex值的范围"></a>tabindex值的范围</h2><blockquote><p>使用之前先看看这篇文章<a href="http://adrianroselli.com/2014/11/dont-use-tabindex-greater-than-0.html" target="_blank" rel="noopener">dont-use-tabindex-greater-than-0</a></p><p>tabindex 的最大值不应超过 32767。如果没有指定，它的默认值为 -1。</p><p>还有一个好玩的z-index属性，真可怕。</p></blockquote><p>具体取决于整数的值：</p><ul><li>tabindex=负值 (通常是tabindex=“-1”)，表示元素是可聚焦的，但是不能通过键盘导航来访问到该元素，用JS做页面小组件内部键盘导航的时候非常有用。</li><li><code>tabindex=&quot;0&quot;</code> ，表示元素是可聚焦的，并且可以通过键盘导航来聚焦到该元素，它的相对顺序是当前处于的DOM结构来决定的。</li><li>tabindex=正值，表示元素是可聚焦的，并且可以通过键盘导航来访问到该元素；它的相对顺序按照<strong>tabindex</strong> 的数值递增而滞后获焦。如果多个元素拥有相同的 <strong>tabindex</strong>，它们的相对顺序按照他们在当前DOM中的先后顺序决定。</li></ul><p>根据键盘序列导航的顺序，值为 <code>0</code> 、非法值、或者没有 <strong>tabindex</strong> 值的元素应该放置在 <strong>tabindex</strong> 值为正值的元素后面。</p><h2 id="element的tabbable和focusable"><a href="#element的tabbable和focusable" class="headerlink" title="element的tabbable和focusable"></a>element的tabbable和focusable</h2><blockquote><p>元素还分为focusable和非focusable，如果使用了tabindex就可以改变相关的行为，看参考链接的资料，这里做一下记录，方便以后回顾。</p></blockquote><h2 id="focusable和tabbable的相关解释"><a href="#focusable和tabbable的相关解释" class="headerlink" title="focusable和tabbable的相关解释"></a>focusable和tabbable的相关解释</h2><blockquote><p>不翻译了，直接上链接<a href="https://allyjs.io/what-is-focusable.html" target="_blank" rel="noopener">what-is-focusable</a></p></blockquote><h3 id="focusable的兼容性表格"><a href="#focusable的兼容性表格" class="headerlink" title="focusable的兼容性表格"></a>focusable的兼容性表格</h3><blockquote><p><a href="https://allyjs.io/data-tables/focusable.html" target="_blank" rel="noopener">兼容性表格</a>，看着兼容性表格还是比较喜人。</p></blockquote><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https://raw.githubusercontent.com/betgar/betgar.github.io/master/img/picgo/20190702125526-focusable-table.gif" alt="focusable-table" title="">                </div>                <div class="image-caption">focusable-table</div>            </figure><h2 id="IE11下SVG元素默认可以focusable"><a href="#IE11下SVG元素默认可以focusable" class="headerlink" title="IE11下SVG元素默认可以focusable"></a>IE11下SVG元素默认可以focusable</h2><blockquote><p>IE11下有一个奇怪的现象，就是svg默认可以获取焦点(focus)，尤其是在登录界面，input前后有prefix和suffix时，尤其别扭。官方一直到<code>EdgeHTML</code>时代的某个版本才修复，看这里<a href="https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/8090208/" target="_blank" rel="noopener">microsoft-edge Support tabindex in SVG, don’t make every <svg> focusable by default</svg></a></p></blockquote><h3 id="问题的原因"><a href="#问题的原因" class="headerlink" title="问题的原因"></a>问题的原因</h3><blockquote><p>IE 11下的svg元素默认是focusable的，也就是说其它浏览器svg元素默认是不能获取焦点的，这就造成了，当input有prefix和suffix的svg时，tab进行表单输入切换就很麻烦，被认为是bug。</p></blockquote><p>例如：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">svg</span>&gt;</span><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">svg</span>&gt;</span><span class="tag">&lt;/<span class="name">svg</span>&gt;</span>   </span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h3><blockquote><p>解决方案也很简单</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">focusable</span>=<span class="string">"false"</span>&gt;</span><span class="tag">&lt;<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>如果全局很多svg就很难受了，所以推荐使用<code>ally.js</code>解决。</p></blockquote><h2 id="ant-design组件库"><a href="#ant-design组件库" class="headerlink" title="ant-design组件库"></a>ant-design组件库</h2><blockquote><p>因为工作中使用的是<code>ant-design-vue</code>所以顺便了解了下，发现</p><p><code>ant-design</code>的已经解决了这个事情看<a href="https://github.com/ant-design/ant-design-icons/pull/54" target="_blank" rel="noopener"><strong>ant-design-icons</strong> Set svg default focusable=false</a> 这里。</p></blockquote><h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a href="https://github.com/medialize/ally.js" target="_blank" rel="noopener">ally.js - making accessibility simpler</a></p><p><a href="https://allyjs.io/data-tables/focusable.html" target="_blank" rel="noopener">focusable table</a></p><p><a href="https://allyjs.io/tests/focusable/test.html" target="_blank" rel="noopener">focusable-test</a></p><p><a href="https://stackoverflow.com/questions/29393144/how-to-prevent-svg-elements-from-gaining-focus-with-tabs-in-ie11" target="_blank" rel="noopener">how-to-prevent-svg-elements-from-gaining-focus-with-tabs-in-ie11</a></p><p><a href="https://stackoverflow.com/questions/18646111/disable-onfocus-event-for-svg-element" target="_blank" rel="noopener">disable-onfocus-event-for-svg-element</a></p><p><a href="https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/8090208/" target="_blank" rel="noopener">microsoft-edge Support tabindex in SVG, don’t make every <svg> focusable by default</svg></a></p><p><a href="https://nemisj.com/focusable/" target="_blank" rel="noopener">Focus, tabIndex and behavior of browsers</a></p><p><a href="https://github.com/ant-design/ant-design-icons/pull/54" target="_blank" rel="noopener"><strong>ant-design-icons</strong> Set svg default focusable=false</a></p><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Global_attributes/tabindex" target="_blank" rel="noopener">tabindex attributes</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;IE11下SVG元素默认focusable-true&quot;&gt;&lt;a href=&quot;#IE11下SVG元素默认focusable-true&quot; class=&quot;headerlink&quot; title=&quot;IE11下SVG元素默认focusable=true&quot;&gt;&lt;/a&gt;IE11下SVG
      
    
    </summary>
    
      <category term="ie" scheme="https://betgar.github.io/categories/ie/"/>
    
      <category term="focus" scheme="https://betgar.github.io/categories/ie/focus/"/>
    
    
      <category term="ie" scheme="https://betgar.github.io/tags/ie/"/>
    
      <category term="focus" scheme="https://betgar.github.io/tags/focus/"/>
    
  </entry>
  
  <entry>
    <title>前端小纠结--Browser&amp;WebView调试工具和文档整理</title>
    <link href="https://betgar.github.io/2019/06/29/the-browser-debugger-documents-and-tools-collect/"/>
    <id>https://betgar.github.io/2019/06/29/the-browser-debugger-documents-and-tools-collect/</id>
    <published>2019-06-29T01:20:00.000Z</published>
    <updated>2019-06-29T13:53:05.466Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前端小纠结–Browser-amp-WebView调试工具和文档整理"><a href="#前端小纠结–Browser-amp-WebView调试工具和文档整理" class="headerlink" title="前端小纠结–Browser&amp;WebView调试工具和文档整理"></a>前端小纠结–Browser&amp;WebView调试工具和文档整理</h1><blockquote><p>为什么又这篇文章呢？因为最近在做IE 11的兼容性测试，の有生之年还会做IE 适配，我没想到。</p><p>期间遇到了一个小问题，没想到竟然没搞定。这么简单，我竟然搞不定…..我对自己的经验和技术水平产生了怀疑，所以决定整理一下，浏览器调试方面的工具和资料。</p></blockquote><h2 id="调试协议-devtools-protocol"><a href="#调试协议-devtools-protocol" class="headerlink" title="调试协议(devtools-protocol)"></a>调试协议(devtools-protocol)</h2><blockquote><p>首先说我知道的，远程调试协议(devtools-protocol)很重要，因为只要浏览器或者<code>webview</code>实现了调试协议，我们不管用什么工具都可以方便的调试，好像目前这方面没有标准， 如果有大家告诉我，<code>chrome-devtools-protocol</code>做的最好。</p></blockquote><ul><li><p><a href="https://chromedevtools.github.io/devtools-protocol/" target="_blank" rel="noopener">chrome-devtools-protocol</a></p></li><li><p><a href="https://github.com/WICG/devtools-protocol" target="_blank" rel="noopener">WICG-devtools-protocol</a></p></li><li><p><a href="https://remotedebug.org/" target="_blank" rel="noopener">remotedebug</a></p><blockquote><p>官网提供了很多不同浏览器调试协议的<a href="https://remotedebug.org/adaptors/" target="_blank" rel="noopener">Protocol Adaptors</a>和<a href="https://remotedebug.org/integrations/" target="_blank" rel="noopener">integrations</a>，可以在这里看到兼容性<a href="http://compatibility.remotedebug.org/" target="_blank" rel="noopener">compatibility</a></p></blockquote></li></ul><h2 id="VS-Code-debugger-plugins"><a href="#VS-Code-debugger-plugins" class="headerlink" title="VS Code debugger plugins"></a>VS Code debugger plugins</h2><blockquote><p>因为VS Code的流行，所以诞生了一个针对调试的debugger for xxx系列的插件。很多插件还是Microsoft自己开发的，微软YES.</p></blockquote><ul><li><p><a href="https://marketplace.visualstudio.com/items?itemName=msjsdiag.debugger-for-edge" target="_blank" rel="noopener">Debugger-for-edge</a></p><blockquote><p>支持EdgeHTML和Chromium版本</p></blockquote></li><li><p><a href="https://marketplace.visualstudio.com/items?itemName=msjsdiag.debugger-for-chrome" target="_blank" rel="noopener">Debugger-for-chrome</a></p></li><li><p><a href="https://marketplace.visualstudio.com/items?itemName=hbenl.vscode-firefox-debug" target="_blank" rel="noopener">Debugger for Firefox</a></p></li><li><p><a href="https://github.com/RemoteDebug/remotedebug-ios-webkit-adapter" target="_blank" rel="noopener">ios-webkit-adapter-Safari</a></p><blockquote><p>RemoteDebug出品，微软在<a href="https://github.com/Microsoft/vscode-ios-web-debug" target="_blank" rel="noopener">vscode-ios-web-debug</a>上推荐.</p></blockquote><p><img src="https://raw.githubusercontent.com/betgar/betgar.github.io/master/img/picgo/20190629214222.jpg" alt="RemoteDebug结构图"></p></li></ul><h2 id="vscode官方列表"><a href="#vscode官方列表" class="headerlink" title="vscode官方列表"></a><a href="https://github.com/Microsoft/vscode-chrome-debug-core/blob/master/README.md" target="_blank" rel="noopener">vscode官方列表</a></h2><blockquote><p>有一些已经过时，并且有推荐的替代的地址。</p></blockquote><ul><li><a href="https://github.com/Microsoft/vscode-chrome-debug" target="_blank" rel="noopener">VS Code Chrome Debugger</a></li><li><a href="https://github.com/Microsoft/vscode-ios-web-debug" target="_blank" rel="noopener">VS Code iOS Web Debugger</a></li><li><a href="https://github.com/iradul/vscode-phantomjs-debug" target="_blank" rel="noopener">VS Code PhantomJS Debugger</a></li><li><a href="https://github.com/Microsoft/vscode-node-debug2" target="_blank" rel="noopener">VS Code Node Debugger</a></li><li><a href="https://github.com/Microsoft/vscode-edge-debug" target="_blank" rel="noopener">VS Code Edge Debugger</a></li><li><a href="https://github.com/karikera/vscode-nwjs" target="_blank" rel="noopener">VS Code NWjs Debugger</a></li><li><a href="https://github.com/Microsoft/vscode-cordova" target="_blank" rel="noopener">VS Code Cordova</a></li><li><a href="https://github.com/NativeScript/nativescript-vscode-extension" target="_blank" rel="noopener">VS Code NativeScript debugger</a></li><li>Visual Studio 2017 Update 2 Node.js Debugger</li></ul><h2 id="Chrome"><a href="#Chrome" class="headerlink" title="Chrome"></a>Chrome</h2><p>Chrome没啥介绍的调试工具官方做的最好，没有之一。</p><h2 id="Firefox"><a href="#Firefox" class="headerlink" title="Firefox"></a>Firefox</h2><ul><li><p><a href="https://getfirebug.com/releases/lite/1.2/" target="_blank" rel="noopener">firebug</a></p><blockquote><p>以前做的非常好的工具，以至于最后直接集成到firefox内部。</p></blockquote></li></ul><h2 id="IE"><a href="#IE" class="headerlink" title="IE"></a>IE</h2><blockquote><p>介绍一个IE 11版本的，其它低于IE 11的我推荐你使用<code>google chrome frame</code>，虽然谷歌已经在2013停止维护了，但是对于低于IE 11的还是有很大的帮助的。微软官方提供的<a href="https://github.com/Microsoft/IEDiagnosticsAdapter/" target="_blank" rel="noopener">IEDiagnosticsAdapter</a>，虽然现在已经停止维护了，但是它最后更新在2015年，IE 11好像是2013年发布的（当时我在上大学…..），实现了<code>chrome-devtools-protocol v1.1</code>，我特意看了一下现在协议发展到<code>v1.3</code>，所以可以使用chrome devtools调试IE，本来很大希望，后来发现就是鸡肋，哎，聊胜于无了。</p></blockquote><p><strong>低于IE 11版本</strong></p><ul><li><a href="https://coderwall.com/p/az72jq/using-firebug-to-inspect-element-in-internet-explorer" target="_blank" rel="noopener">using-firebug-to-inspect-element-in-internet-explorer</a></li><li><p><a href="https://www.my-debugbar.com/wiki/" target="_blank" rel="noopener">debugbar</a></p></li><li><p><a href="https://github.com/Microsoft/IEDiagnosticsAdapter/" target="_blank" rel="noopener">IEDiagnosticsAdapter</a></p><blockquote><p>官方的介绍工具的博客文章：<a href="https://blogs.msdn.microsoft.com/ie/2015/04/02/introducing-the-ie-diagnostics-adapter-for-third-party-developer-tools/" target="_blank" rel="noopener">introducing-the-ie-diagnostics-adapter-for-third-party-developer-tools</a></p></blockquote></li></ul><p>​        <img src="https://raw.githubusercontent.com/betgar/betgar.github.io/master/img/picgo/20190629173207.gif" alt="官方的介绍的gif"></p><blockquote><p>但是我亲自试了一下发现效果没这么好，查看DOM元素已经没有互动效果了，难道我的Chrome版本太高了？？？Chrome v75，可能Chrome版本太高，devtools协议版本较高，有机会找个低版本Chrome尝试下。</p></blockquote><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https://raw.githubusercontent.com/betgar/betgar.github.io/master/img/picgo/20190629173406.gif" alt="测试的结果" title="">                </div>                <div class="image-caption">测试的结果</div>            </figure><h2 id="VS-Code调试IE-11尝试"><a href="#VS-Code调试IE-11尝试" class="headerlink" title="VS Code调试IE 11尝试"></a>VS Code调试IE 11尝试</h2><blockquote><p>我思考，既然IE Diagnostics Adapter实现了devtools protocol v1.1，做了代理转发，debugger for chrome也是实现的devtools protocol ，我是否可以使用VS Code的debug模式，开启chrome attach模式试一下呢？</p></blockquote><p>思路：VS Code –&gt;debugger for chrome –&gt; attach port 9222 –&gt; IE Diagnostics Adapter –&gt; IE 11</p><p>结论：VS Code 通过debugger for chrome的attach模式，成功链接。但是就成功一次，其余的尝试导致IE Diagnostics Adapter一直奔溃。虽然失败了，但是我还是很高兴，因为至少说明我的思路是正确的，解决问题的时候，思路（方向）最重要，要是方向搞错了，那可要浪费很多精力咯。:)</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><blockquote><p>折腾了大半天，还是有点收获，最少收获了解决问题的思路和VS Code的debugger系列。希望这篇文章对还在和IE 11互相折磨的同行有点帮助。</p></blockquote><blockquote><p>关注公众号，发现更多精彩内容。</p></blockquote><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https://raw.githubusercontent.com/betgar/betgar.github.io/master/img/picgo/20190629215238.png" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://chromedevtools.github.io/devtools-protocol/" target="_blank" rel="noopener">chrome-devtools-protocol</a></p><p><a href="https://remotedebug.org/" target="_blank" rel="noopener">remotedebug</a></p><p><a href="https://github.com/Microsoft/vscode-chrome-debug-core/blob/master/README.md" target="_blank" rel="noopener">vscode-chrome-debug-core</a></p><p><a href="https://github.com/WICG/devtools-protocol" target="_blank" rel="noopener">WICG-devtools-protocol</a></p><p><a href="https://github.com/Microsoft/vscode-chrome-debug-core/blob/master/README.md" target="_blank" rel="noopener">vscode-chrome-debug-core</a></p><p><a href="https://github.com/Microsoft/IEDiagnosticsAdapter/" target="_blank" rel="noopener">IEDiagnosticsAdapter</a></p><p><a href="https://stackoverflow.com/questions/45241746/how-to-attach-vs-code-debugger-to-internet-explorer-11-for-javascript-html" target="_blank" rel="noopener">attach-vs-code-debugger-to-internet-explorer</a></p><p><a href="https://docs.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/" target="_blank" rel="noopener">ie-developer</a></p><p><a href="https://stackoverflow.com/questions/45241746/how-to-attach-vs-code-debugger-to-internet-explorer-11-for-javascript-html" target="_blank" rel="noopener">how-to-attach-vs-code-debugger-to-internet-explorer-11</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;前端小纠结–Browser-amp-WebView调试工具和文档整理&quot;&gt;&lt;a href=&quot;#前端小纠结–Browser-amp-WebView调试工具和文档整理&quot; class=&quot;headerlink&quot; title=&quot;前端小纠结–Browser&amp;amp;WebVie
      
    
    </summary>
    
      <category term="vue" scheme="https://betgar.github.io/categories/vue/"/>
    
      <category term="debug" scheme="https://betgar.github.io/categories/vue/debug/"/>
    
    
      <category term="vue" scheme="https://betgar.github.io/tags/vue/"/>
    
      <category term="debug" scheme="https://betgar.github.io/tags/debug/"/>
    
  </entry>
  
  <entry>
    <title>vue-devtools在IE11中的使用</title>
    <link href="https://betgar.github.io/2019/06/27/vue-remote-devtools/"/>
    <id>https://betgar.github.io/2019/06/27/vue-remote-devtools/</id>
    <published>2019-06-27T11:00:00.000Z</published>
    <updated>2019-06-29T10:27:01.698Z</updated>
    
    <content type="html"><![CDATA[<h1 id="vue-devtools在IE11中的使用"><a href="#vue-devtools在IE11中的使用" class="headerlink" title="vue-devtools在IE11中的使用"></a>vue-devtools在IE11中的使用</h1><blockquote><p>IE下的调试一直都很头痛，本来vue官方没有提供ie下的开发工具插件，后来还是不死心去官网看了下，结果有了意外的收获。</p><p>vue官方独立的<code>vue-devtools</code>应用程序，可用于调试任何Vue应用程序，无论环境如何。 现在，您可以调试在移动浏览器，Safari，本机脚本等中打开的应用程序，而不仅仅是桌面chrome或firefox。</p></blockquote><h2 id="查看IE下Vue组件状态"><a href="#查看IE下Vue组件状态" class="headerlink" title="查看IE下Vue组件状态"></a>查看IE下Vue组件状态</h2><blockquote><p>文档中已经提到了怎么在开发环境使用了，现在使用<code>vue-cli3</code>进行根据环境变量来差异化编译<code>index.html</code>模板。参考<a href="[https://cli.vuejs.org/zh/guide/html-and-static-assets.html#%E6%8F%92%E5%80%BC](https://cli.vuejs.org/zh/guide/html-and-static-assets.html#插值">HTML和静态文件章节</a>)</p></blockquote><ul><li>index.html文件添加<script>标签</li></ul><blockquote><p>最简单的修改：</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"http://localhost:8089"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>为了实现差异化编译(development生成，production不生成调试script)可以这样做：</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- /public/index.html --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"IE=edge"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width,initial-scale=1.0"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"icon"</span> <span class="attr">href</span>=<span class="string">"&lt;%= BASE_URL %&gt;favicon.ico"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">%</span> <span class="attr">if</span> (<span class="attr">VUE_APP_REMOTE_DEBUG_ENABLE</span> === <span class="string">'true'</span>) &#123; %&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"&lt;%= VUE_APP_REMOTE_DEBUG_HOST + ':' + VUE_APP_REMOTE_DEBUG_PORT%&gt;"</span>&gt;</span><span class="undefined">         </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">%</span> &#125; %&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>debug<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 环境变量文件  .env</span><br><span class="line">VUE_APP_REMOTE_DEBUG_ENABLE=false</span><br><span class="line">VUE_APP_REMOTE_DEBUG_HOST=http://localhost</span><br><span class="line">VUE_APP_REMOTE_DEBUG_PORT=8089</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># .env.development</span><br><span class="line">VUE_APP_REMOTE_DEBUG_ENABLE=true</span><br></pre></td></tr></table></figure><blockquote><p>效果图：</p></blockquote><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https://raw.githubusercontent.com/betgar/betgar.github.io/master/img/picgo/20190629175924.gif" alt="vue-devtools查看IE 11下Vue组件的状态" title="">                </div>                <div class="image-caption">vue-devtools查看IE 11下Vue组件的状态</div>            </figure><h2 id="原理猜想"><a href="#原理猜想" class="headerlink" title="原理猜想"></a>原理猜想</h2><blockquote><p>工具原理的猜想是使用WebSocket链接，把vue component的状态序列化发送到host:8089端口，本地启动的devtools在8089进行实时的解析显示。</p></blockquote><p><strong><em>以下是官方README翻译，可以略过</em></strong></p><h2 id="💿安装"><a href="#💿安装" class="headerlink" title="💿安装"></a>💿安装</h2><p>全局安装包：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g @vue/devtools</span><br></pre></td></tr></table></figure><p>或在本地作为项目依赖：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev @vue/devtools</span><br></pre></td></tr></table></figure><h2 id="🚀用法"><a href="#🚀用法" class="headerlink" title="🚀用法"></a>🚀用法</h2><h3 id="使用全局包"><a href="#使用全局包" class="headerlink" title="使用全局包"></a>使用全局包</h3><p>在全局安装软件包后，运行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vue-devtools</span><br></pre></td></tr></table></figure><p>然后加：</p><p><script src="http://localhost:8098"> </script><br>或者，如果要远程调试设备：<p></p><p><script><br>  window .<strong> VUE_DEVTOOLS_HOST</strong> =’<your-local-ip>‘//默认值：localhost<br>  window .<strong> VUE_DEVTOOLS_PORT</strong> =’<devtools-port>‘//默认值：8098<br></script></p><p><script src="http://<your-local-ip>:8098"></script><br>到您应用的<head>部分。 （在部署到生产之前不要忘记将其删除！）</head></p><p><your-local-ip>通常如下所示：192.168.x.x.</your-local-ip></p><h3 id="作为依赖安装"><a href="#作为依赖安装" class="headerlink" title="作为依赖安装"></a>作为依赖安装</h3><p>将程序包安装为项目依赖项后，运行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./node_modules/.bin/vue-devtools</span><br></pre></td></tr></table></figure><p>您还可以使用全局<code>vue-devtools</code>来启动应用程序，但您可能需要检查本地版本是否与此方案中的全局版本匹配，以避免任何不兼容性。</p><p>然后直接在您的应用中导入它：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> devtools <span class="keyword">from</span> <span class="string">'@vue/devtools'</span></span><br><span class="line"><span class="comment">// import Vue from 'vue'</span></span><br></pre></td></tr></table></figure><p>确保在Vue之前导入devtools，否则它可能无法按预期工作。</p><p>并连接到主机：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (process.env.NODE_ENV === <span class="string">'development'</span>) &#123;</span><br><span class="line">  devtools.connect(<span class="comment">/* host, port */</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>host  - 是一个可选参数，它告诉应用程序devtools中间件服务器正在运行的位置，如果你在计算机上调试app，则不必设置它（默认为http:// localhost），但是如果要调试您的移动设备上的应用，您可能想要传递本地IP（例如192.168.1.12）。</p></li><li><p>port  - 是一个可选参数，它告诉应用程序devtools中间件服务器正在运行的端口。如果使用代理服务器，则可能需要将其设置为null，以便端口不会添加到连接URL。</p></li></ul><p>常问问题：</p><ol><li><p>如何更改正在运行devtools服务器端口？</p><p>您可以在运行之前通过设置环境变量来更改它：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PORT=8000 vue-devtools</span><br></pre></td></tr></table></figure><p>然后在您的应用程序中，您将必须设置：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.__ VUE_DEVTOOLS_PORT__=<span class="number">8000</span></span><br></pre></td></tr></table></figure><p>或者使用新端口更新connect方法：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">devtools.connect（/ * host * <span class="regexp">/，8000）</span></span><br></pre></td></tr></table></figure></li><li><p>如何远程检查(<strong>inspect</strong>)服务器上的页面？</p><pre><code>为此，您可以使用`ngrok`代理。您可以在这里下载。   一旦你启动`vue-devtools`运行：</code></pre></li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ngrok http 8098</span><br></pre></td></tr></table></figure><p>   然后相应地更新您的主机和端口：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">devtools.connect（<span class="string">'example.ngrok.io'</span>，null）</span><br></pre></td></tr></table></figure><p>​      确保将port设置为null或false，因为ngrok主机已经代理到我们在第一个命令中定义的正确端口。</p><ol start="3"><li>如何检查通过HTTPS提供的页面？</li></ol><p>为此，您还可以使用ngrok，因为它会自动将https请求代理到http。请查看问题2以获取说明。</p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://github.com/vuejs/vue-devtools/blob/master/shells/electron/README.md" target="_blank" rel="noopener">调试工具官方仓库</a></p></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;vue-devtools在IE11中的使用&quot;&gt;&lt;a href=&quot;#vue-devtools在IE11中的使用&quot; class=&quot;headerlink&quot; title=&quot;vue-devtools在IE11中的使用&quot;&gt;&lt;/a&gt;vue-devtools在IE11中的使用&lt;/
      
    
    </summary>
    
      <category term="vue" scheme="https://betgar.github.io/categories/vue/"/>
    
      <category term="debug" scheme="https://betgar.github.io/categories/vue/debug/"/>
    
    
      <category term="vue" scheme="https://betgar.github.io/tags/vue/"/>
    
      <category term="debug" scheme="https://betgar.github.io/tags/debug/"/>
    
  </entry>
  
  <entry>
    <title>VS Code调试配置分享</title>
    <link href="https://betgar.github.io/2019/06/26/vscode-debug-configuration/"/>
    <id>https://betgar.github.io/2019/06/26/vscode-debug-configuration/</id>
    <published>2019-06-26T04:00:00.000Z</published>
    <updated>2019-06-29T13:33:54.762Z</updated>
    
    <content type="html"><![CDATA[<h1 id="VS-Code调试配置分享"><a href="#VS-Code调试配置分享" class="headerlink" title="VS Code调试配置分享"></a>VS Code调试配置分享</h1><blockquote><p>这不是一篇科普文，只是一篇浏览器调试配置的分享（主要对准对准vs code调试）</p></blockquote><h2 id="调试配置"><a href="#调试配置" class="headerlink" title="调试配置"></a>调试配置</h2><blockquote><p>使用vs code插件<a href="https://marketplace.visualstudio.com/items?itemName=msjsdiag.debugger-for-chrome" target="_blank" rel="noopener">debugger-for-chrome</a>和<a href="https://marketplace.visualstudio.com/items?itemName=msjsdiag.debugger-for-edge" target="_blank" rel="noopener">debugger-for-edge(EdgeHTML&amp;Chromium)</a>调试之前，会自动在工程下添加<code>.vscode</code>文件夹，里面的<code>launch.json</code>就是配置调试参数的位置。</p></blockquote><h3 id="launch-json"><a href="#launch-json" class="headerlink" title="launch.json"></a>launch.json</h3><blockquote><p>很多的配置参数，具体看参考章节的<strong>nodejs-debugging</strong>和<strong>debugging-protocol</strong>。</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="comment">// Use IntelliSense to learn about possible attributes.</span></span><br><span class="line">  <span class="comment">// Hover to view descriptions of existing attributes.</span></span><br><span class="line">  <span class="comment">// For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387</span></span><br><span class="line">  <span class="string">"version"</span>: <span class="string">"0.2.0"</span>,</span><br><span class="line">  <span class="string">"configurations"</span>: [</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"type"</span>: <span class="string">"chrome"</span>,</span><br><span class="line">      <span class="string">"request"</span>: <span class="string">"launch"</span>,</span><br><span class="line">      <span class="string">"name"</span>: <span class="string">"vuejs: launch chrome"</span>,</span><br><span class="line">      <span class="string">"url"</span>: <span class="string">"http://localhost:8080"</span>,</span><br><span class="line">      <span class="string">"webRoot"</span>: <span class="string">"$&#123;workspaceFolder&#125;/src"</span>,</span><br><span class="line">      <span class="string">"userDataDir"</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">"breakOnLoad"</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">"sourceMapPathOverrides"</span>: &#123;</span><br><span class="line">        <span class="string">"webpack:///./src/*"</span>: <span class="string">"$&#123;webRoot&#125;/*"</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"type"</span>: <span class="string">"chrome"</span>,</span><br><span class="line">      <span class="string">"request"</span>: <span class="string">"attach"</span>,</span><br><span class="line">      <span class="string">"name"</span>: <span class="string">"vuejs: attach chrome"</span>,</span><br><span class="line">      <span class="string">"webRoot"</span>: <span class="string">"$&#123;workspaceFolder&#125;/src"</span>,</span><br><span class="line">      <span class="string">"port"</span>: <span class="number">9222</span>,</span><br><span class="line">      <span class="string">"sourceMapPathOverrides"</span>: &#123;</span><br><span class="line">        <span class="string">"webpack:///./src/*"</span>: <span class="string">"$&#123;webRoot&#125;/*"</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"type"</span>: <span class="string">"edge"</span>,</span><br><span class="line">      <span class="string">"request"</span>: <span class="string">"launch"</span>,</span><br><span class="line">      <span class="string">"name"</span>: <span class="string">"vuejs: launch EdgeHTML"</span>,</span><br><span class="line">      <span class="string">"url"</span>: <span class="string">"http://localhost:8080"</span>,</span><br><span class="line">      <span class="string">"webRoot"</span>: <span class="string">"$&#123;workspaceFolder&#125;/src"</span>,</span><br><span class="line">      <span class="string">"userDataDir"</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">"breakOnLoad"</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">"sourceMapPathOverrides"</span>: &#123;</span><br><span class="line">        <span class="string">"webpack:///./src/*"</span>: <span class="string">"$&#123;webRoot&#125;/*"</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"type"</span>: <span class="string">"edge"</span>,</span><br><span class="line">      <span class="string">"request"</span>: <span class="string">"attach"</span>,</span><br><span class="line">      <span class="string">"name"</span>: <span class="string">"vuejs: attach EdgeHTML"</span>,</span><br><span class="line">      <span class="string">"webRoot"</span>: <span class="string">"$&#123;workspaceFolder&#125;/src"</span>,</span><br><span class="line">      <span class="string">"port"</span>: <span class="number">2015</span>,</span><br><span class="line">      <span class="string">"sourceMapPathOverrides"</span>: &#123;</span><br><span class="line">        <span class="string">"webpack:///./src/*"</span>: <span class="string">"$&#123;webRoot&#125;/*"</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"type"</span>: <span class="string">"edge"</span>,</span><br><span class="line">      <span class="string">"request"</span>: <span class="string">"attach"</span>,</span><br><span class="line">      <span class="string">"version"</span>: <span class="string">"dev"</span>, <span class="comment">// dev, beta, or canary</span></span><br><span class="line">      <span class="string">"name"</span>: <span class="string">"vuejs: attach Edge(Chromium)"</span>,</span><br><span class="line">      <span class="string">"webRoot"</span>: <span class="string">"$&#123;workspaceFolder&#125;/src"</span>,</span><br><span class="line">      <span class="string">"port"</span>: <span class="number">9223</span>,</span><br><span class="line">      <span class="string">"sourceMapPathOverrides"</span>: &#123;</span><br><span class="line">        <span class="string">"webpack:///./src/*"</span>: <span class="string">"$&#123;webRoot&#125;/*"</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"type"</span>: <span class="string">"edge"</span>,</span><br><span class="line">      <span class="string">"request"</span>: <span class="string">"launch"</span>,</span><br><span class="line">      <span class="string">"version"</span>: <span class="string">"dev"</span>,</span><br><span class="line">      <span class="string">"name"</span>: <span class="string">"vuejs: launch Edge(Chromium)"</span>,</span><br><span class="line">      <span class="string">"url"</span>: <span class="string">"http://localhost:8080"</span>,</span><br><span class="line">      <span class="string">"webRoot"</span>: <span class="string">"$&#123;workspaceFolder&#125;/src"</span>,</span><br><span class="line">      <span class="string">"userDataDir"</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">"breakOnLoad"</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">"sourceMapPathOverrides"</span>: &#123;</span><br><span class="line">        <span class="string">"webpack:///./src/*"</span>: <span class="string">"$&#123;webRoot&#125;/*"</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"type"</span>: <span class="string">"firefox"</span>,</span><br><span class="line">      <span class="string">"request"</span>: <span class="string">"launch"</span>,</span><br><span class="line">      <span class="string">"name"</span>: <span class="string">"vuejs: firefox"</span>,</span><br><span class="line">      <span class="string">"url"</span>: <span class="string">"http://localhost:8080"</span>,</span><br><span class="line">      <span class="string">"webRoot"</span>: <span class="string">"$&#123;workspaceFolder&#125;/src"</span>,</span><br><span class="line">      <span class="string">"pathMappings"</span>: [&#123; <span class="string">"url"</span>: <span class="string">"webpack:///src/"</span>, <span class="string">"path"</span>: <span class="string">"$&#123;webRoot&#125;/"</span> &#125;]</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="launch模式"><a href="#launch模式" class="headerlink" title="launch模式"></a>launch模式</h2><blockquote><p>launch模式就是重新打开一个浏览器实例（不是tab）。</p></blockquote><h2 id="attach模式"><a href="#attach模式" class="headerlink" title="attach模式"></a>attach模式</h2><blockquote><p>attach模式，是附加到现在已经打开的浏览器调试端口上，所以需要你在已经打开的浏览器中访问<code>launch.json</code>中配置的网站地址。</p></blockquote><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https://raw.githubusercontent.com/betgar/betgar.github.io/master/img/picgo/debugging-attach.jpg" alt="attach模式的tab窗口选择" title="">                </div>                <div class="image-caption">attach模式的tab窗口选择</div>            </figure><h3 id="chrome配置"><a href="#chrome配置" class="headerlink" title="chrome配置"></a>chrome配置</h3><ul><li>windows</li></ul><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https://raw.githubusercontent.com/betgar/betgar.github.io/master/img/picgo/debugging-for-chrome.jpg" alt="chrome配置远程调试端口" title="">                </div>                <div class="image-caption">chrome配置远程调试端口</div>            </figure><ul><li><p>mac</p><blockquote><p>终端执行: <code>/Applications/Google\ Chrome.app/Contents/MacOS/Google\ Chrome --remote-debugging-port=9222</code></p></blockquote></li><li><p>Linux</p><blockquote><p>终端执行： <code>google-chrome --remote-debugging-port=9222</code></p></blockquote></li></ul><h3 id="Edge-Chromium"><a href="#Edge-Chromium" class="headerlink" title="Edge(Chromium)"></a>Edge(Chromium)</h3><ul><li>windows</li></ul><p><img src="https://raw.githubusercontent.com/betgar/betgar.github.io/master/img/picgo/debugging-for-edge-chromium.jpg" alt="Edge(Chromium)调试端口配置"></p><blockquote><p>命令行：<code>msedge.exe --remote-debugging-port=2015</code></p></blockquote><ul><li>mac和Liunx现在官方没说怎么调试…..</li></ul><h3 id="Microsoft-Edge-EdgeHTML"><a href="#Microsoft-Edge-EdgeHTML" class="headerlink" title="Microsoft Edge (EdgeHTML)"></a>Microsoft Edge (EdgeHTML)</h3><ul><li><p>windows</p><blockquote><p>命令行： <code>microsoftedge.exe --devtools-server-port=2015</code></p><p>竟然不能快捷方式配置，不科学。</p></blockquote></li></ul><h2 id="个人建议"><a href="#个人建议" class="headerlink" title="个人建议"></a>个人建议</h2><blockquote><p>个人建议平时开发，把端口配置到快捷方式，使用attach模式可以共享使用已经安装的浏览器插件。</p></blockquote><p>具体还有很多参数配置，可以参考官方文档。</p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://marketplace.visualstudio.com/items?itemName=msjsdiag.debugger-for-chrome" target="_blank" rel="noopener">debugger-for-chrome</a></p><p><a href="https://marketplace.visualstudio.com/items?itemName=msjsdiag.debugger-for-edge" target="_blank" rel="noopener">debugger-for-edge</a></p><p><a href="https://github.com/Microsoft/vscode-chrome-debug" target="_blank" rel="noopener">vscode-chrome-debug-github</a></p><p><a href="https://github.com/Microsoft/vscode-recipes" target="_blank" rel="noopener">vscode-recipes</a></p><p><a href="https://docs.microsoft.com/zh-cn/microsoft-edge/devtools-protocol-chromium" target="_blank" rel="noopener">devtools-protocol-chromium</a></p><p><a href="https://docs.microsoft.com/en-us/microsoft-edge/devtools-protocol/" target="_blank" rel="noopener">devtools-protocol-edge</a></p><p><a href="https://code.visualstudio.com/docs/nodejs/nodejs-debugging" target="_blank" rel="noopener">nodejs-debugging</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;VS-Code调试配置分享&quot;&gt;&lt;a href=&quot;#VS-Code调试配置分享&quot; class=&quot;headerlink&quot; title=&quot;VS Code调试配置分享&quot;&gt;&lt;/a&gt;VS Code调试配置分享&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;这不是一篇科普文，只是一篇
      
    
    </summary>
    
      <category term="vscode" scheme="https://betgar.github.io/categories/vscode/"/>
    
    
      <category term="vscode" scheme="https://betgar.github.io/tags/vscode/"/>
    
  </entry>
  
  <entry>
    <title>前端小纠结--common模块设计</title>
    <link href="https://betgar.github.io/2019/06/20/frontend-little-tangle-common-module-design/"/>
    <id>https://betgar.github.io/2019/06/20/frontend-little-tangle-common-module-design/</id>
    <published>2019-06-20T10:00:00.000Z</published>
    <updated>2019-06-29T13:33:54.761Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前端小纠结–common模块设计"><a href="#前端小纠结–common模块设计" class="headerlink" title="前端小纠结–common模块设计"></a>前端小纠结–common模块设计</h1><p>承接上一篇<a href="https://betgar.github.io/2019/06/12/frontend-little-tangle-vue-project-code-organization-conventional-style-guideline/">前端小纠结–Vue项目代码组织和风格约定</a></p><blockquote><p><code>common</code>模块的单独拿出来说一下，因为<code>common</code>模块设计的好，可以跨项目使用，甚至在部署成自己的私有的<code>package</code>。</p><p><code>common</code>目标：主要是为了在<strong>第三方库</strong>之上做一层简单的封装，<strong>预置配置</strong>，做一层隔离，也可以在调用第三方组件时做一些<strong>埋点</strong>统一处理一些逻辑。</p></blockquote><h2 id="设计原则"><a href="#设计原则" class="headerlink" title="设计原则"></a>设计原则</h2><ol><li>不能有任何的业务逻辑</li><li>不能耦合工程的<strong>业务状态</strong></li><li>不能依赖<strong>组件库</strong>，可以依赖独立的<code>UI</code>组件（例如: <code>nprogress</code>）</li><li>可以依赖<code>vue</code>框架，不能依赖<code>router</code>实例和<code>vuex</code>实例组件（如果依赖就说明耦合业务）</li></ol><h3 id="common参考结构"><a href="#common参考结构" class="headerlink" title="common参考结构"></a><code>common</code>参考结构</h3><blockquote><p>这个是我使用的<code>common</code>层的目录结构，仅供参考。</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">src/common</span><br><span class="line">├── ajax</span><br><span class="line">│   ├── Ajax.ts</span><br><span class="line">│   ├── AjaxConfig.ts</span><br><span class="line">│   ├── AjaxUtils.ts</span><br><span class="line">│   ├── interceptors</span><br><span class="line">│   │   ├── BackendInterceptor.ts</span><br><span class="line">│   │   ├── CacheInterceptor.ts</span><br><span class="line">│   │   ├── Interceptors.ts</span><br><span class="line">│   │   └── LoadingInterceptor.ts</span><br><span class="line">│   └── transformer</span><br><span class="line">│       ├── RequestTransformer.ts</span><br><span class="line">│       ├── ResponseTransformer.ts</span><br><span class="line">│       └── Transformers.ts</span><br><span class="line">├── axios</span><br><span class="line">│   ├── axios.ts</span><br><span class="line">│   └── index.d.ts</span><br><span class="line">├── cookie</span><br><span class="line">│   └── Cookies.ts</span><br><span class="line">├── datetime</span><br><span class="line">│   └── Datetime.ts</span><br><span class="line">├── day</span><br><span class="line">│   └── day.ts</span><br><span class="line">├── downloader</span><br><span class="line">│   └── Downloader.ts</span><br><span class="line">├── event-bus</span><br><span class="line">│   ├── EventBus.ts</span><br><span class="line">│   └── index.d.ts</span><br><span class="line">├── http</span><br><span class="line">│   └── Http.ts</span><br><span class="line">├── index.ts</span><br><span class="line">├── localforage</span><br><span class="line">│   └── Localforage.ts</span><br><span class="line">├── logger</span><br><span class="line">│   └── Logger.ts</span><br><span class="line">├── numberal</span><br><span class="line">│   └── numberal.ts</span><br><span class="line">├── pager</span><br><span class="line">│   └── Pager.ts</span><br><span class="line">├── patterns</span><br><span class="line">│   ├── numeric.ts</span><br><span class="line">│   ├── patterns.ts</span><br><span class="line">│   └── strings.ts</span><br><span class="line">├── storage</span><br><span class="line">│   ├── index.d.ts</span><br><span class="line">│   └── Storage.ts</span><br><span class="line">├── text</span><br><span class="line">│   ├── formatter</span><br><span class="line">│   │   └── formatter.ts</span><br><span class="line">│   └── Text.ts</span><br><span class="line">├── token</span><br><span class="line">│   └── Token.ts</span><br><span class="line">├── utils</span><br><span class="line">│   └── Utils.ts</span><br><span class="line">└── validation</span><br><span class="line">    ├── email</span><br><span class="line">    │   └── EmailValidator.ts</span><br><span class="line">    ├── numeric</span><br><span class="line">    │   └── NumericValidator.ts</span><br><span class="line">    ├── phone</span><br><span class="line">    │   └── PhoneValidator.ts</span><br><span class="line">    └── Validation.ts</span><br></pre></td></tr></table></figure><h2 id="封装实践示例"><a href="#封装实践示例" class="headerlink" title="封装实践示例"></a>封装实践示例</h2><h3 id="示例：根据运行环境调整组件配置参数"><a href="#示例：根据运行环境调整组件配置参数" class="headerlink" title="示例：根据运行环境调整组件配置参数"></a>示例：根据运行环境调整组件配置参数</h3><blockquote><p>logger模块简单封装，根据部署环境调整日志级别。</p></blockquote><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Logger <span class="keyword">from</span> <span class="string">'js-logger'</span>;</span><br><span class="line"></span><br><span class="line">Logger.useDefaults();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 可以发送到日志服务器，自己搭建个sentry日志服务</span></span><br><span class="line"><span class="comment">// https://sentry.io/for/javascript/</span></span><br><span class="line">Logger.setHandler(<span class="function"><span class="keyword">function</span> (<span class="params">messages, context</span>) </span>&#123;</span><br><span class="line"><span class="comment">// Send messages to a custom logging endpoint for analysis.</span></span><br><span class="line"><span class="comment">// <span class="doctag">TODO:</span> Add some security? (nah, you worry too much! :P)</span></span><br><span class="line">jQuery.post(<span class="string">'/logs'</span>, &#123; message: messages[<span class="number">0</span>], level: context.level &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调整日志级别</span></span><br><span class="line"><span class="keyword">if</span> (process.env.NODE_ENV === <span class="string">'production'</span>) &#123;</span><br><span class="line">  Logger.setLevel(Logger.ERROR);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  Logger.setLevel(Logger.DEBUG);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> Logger;</span><br></pre></td></tr></table></figure><h3 id="示例：按需添加依赖"><a href="#示例：按需添加依赖" class="headerlink" title="示例：按需添加依赖"></a>示例：按需添加依赖</h3><blockquote><p>示例按需添加：很多组件内部也分成多个子组件，而且都是可以按需添加</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// storejs</span></span><br><span class="line"><span class="keyword">const</span> store: StoreJsAPI = <span class="built_in">require</span>(<span class="string">'store/dist/store.modern.min'</span>);</span><br><span class="line"><span class="keyword">const</span> expirePlugin = <span class="built_in">require</span>(<span class="string">'store/plugins/expire'</span>);</span><br><span class="line"><span class="keyword">const</span> eventsPlugin = <span class="built_in">require</span>(<span class="string">'store/plugins/events'</span>);</span><br><span class="line"><span class="keyword">const</span> updatePlugin = <span class="built_in">require</span>(<span class="string">'store/plugins/update'</span>);</span><br><span class="line"><span class="comment">// const observePlugin = require('store/plugins/observe');</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 添加插件.</span></span><br><span class="line">store.addPlugin(expirePlugin);</span><br><span class="line">store.addPlugin(eventsPlugin);</span><br><span class="line">store.addPlugin(updatePlugin);</span><br><span class="line"><span class="comment">// store.addPlugin(observePlugin);</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store;</span><br></pre></td></tr></table></figure><h3 id="示例：装饰原有接口，增强功能"><a href="#示例：装饰原有接口，增强功能" class="headerlink" title="示例：装饰原有接口，增强功能"></a>示例：装饰原有接口，增强功能</h3><blockquote><p><code>cookies</code>和<code>storage</code>这两个模块也做一些简单封装，可以做到，对写在客户端可见的数据进行<strong>编码加密</strong>，增强安全性，提高解析门槛。</p></blockquote><ol><li><p>进行统一封装，自动加解密</p></li><li><p>封装<code>clear</code>和<code>remove</code>方法，添加白名单</p><blockquote><p>当退出网站或者关闭网页时，进行清理时可以排除白名单属性。</p></blockquote></li></ol><blockquote><p>示例：</p></blockquote><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Cookies, &#123; CookieAttributes &#125; <span class="keyword">from</span> <span class="string">'js-cookie'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> NodeRSA = <span class="built_in">require</span>(<span class="string">'node-rsa'</span>);</span><br><span class="line"><span class="keyword">const</span> rsaKey = <span class="keyword">new</span> NodeRSA(&#123;b: <span class="number">512</span>&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> cookieGet = Cookies.get;</span><br><span class="line"><span class="keyword">const</span> cookieSet = Cookies.set;</span><br><span class="line"></span><br><span class="line"><span class="comment">// @ts-ignore</span></span><br><span class="line">Cookies.get = <span class="function"><span class="keyword">function</span> (<span class="params">key: <span class="built_in">string</span></span>): <span class="title">string</span> | <span class="title">undefined</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> rsaKey.decrypt(cookieGet(key), <span class="string">'base64'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Cookies.set = <span class="function"><span class="keyword">function</span> (<span class="params">name: <span class="built_in">string</span>, value: <span class="built_in">any</span>, options?: CookieAttributes</span>) </span>&#123;</span><br><span class="line">  cookieSet(name, rsaKey.encrypt(value, <span class="string">'base64'</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> cookies = Cookies;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;前端小纠结–common模块设计&quot;&gt;&lt;a href=&quot;#前端小纠结–common模块设计&quot; class=&quot;headerlink&quot; title=&quot;前端小纠结–common模块设计&quot;&gt;&lt;/a&gt;前端小纠结–common模块设计&lt;/h1&gt;&lt;p&gt;承接上一篇&lt;a href=&quot;
      
    
    </summary>
    
      <category term="fe" scheme="https://betgar.github.io/categories/fe/"/>
    
    
      <category term="fe" scheme="https://betgar.github.io/tags/fe/"/>
    
  </entry>
  
  <entry>
    <title>前端小纠结--Vue项目代码组织和风格约定</title>
    <link href="https://betgar.github.io/2019/06/12/frontend-little-tangle-vue-project-code-organization-conventional-style-guideline/"/>
    <id>https://betgar.github.io/2019/06/12/frontend-little-tangle-vue-project-code-organization-conventional-style-guideline/</id>
    <published>2019-06-12T10:00:00.000Z</published>
    <updated>2019-06-29T13:33:54.759Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前端小纠结–Vue项目代码组织和风格约定"><a href="#前端小纠结–Vue项目代码组织和风格约定" class="headerlink" title="前端小纠结–Vue项目代码组织和风格约定"></a>前端小纠结–Vue项目代码组织和风格约定</h1><blockquote><p><code>风格约定</code>但不限于<code>代码风格</code>，还有一些其他的<code>默认约定</code>。</p></blockquote><h2 id="代码组织和分层"><a href="#代码组织和分层" class="headerlink" title="代码组织和分层"></a>代码组织和分层</h2><blockquote><p>代码组织是一个仁者见仁，智者见智的话题，没有<strong>银弹</strong>。不过不管怎么变化，指导思想还是不变的<strong>高内聚，低耦合</strong>。</p><p>强烈推荐两篇文章，能够拓宽你的视野，带你走向新高度。</p><p><a href="https://juejin.im/post/5cb00b1c6fb9a068a256b37c" target="_blank" rel="noopener">用 Feature First 的方式管理前端项目复杂度</a></p></blockquote><p><strong><em>代码组织的优雅，模块化才能够做好。</em></strong></p><h3 id="分层"><a href="#分层" class="headerlink" title="分层"></a>分层</h3><blockquote><p>按照<strong>职能的不同</strong>进行不同维度进行层级划分，层级划分之后，进行进一步的<strong>模块划分</strong>（原则上，每一个文件夹都是一个模块）</p></blockquote><h2 id="文件夹和文件命名"><a href="#文件夹和文件命名" class="headerlink" title="文件夹和文件命名"></a>文件夹和文件命名</h2><blockquote><p>选择适合自己的风格。</p></blockquote><ol><li><p>文件夹和文件都使用<strong>kebab-case</strong></p><blockquote><p><strong>kebab-case</strong>重度使用者可以选择这种。</p></blockquote></li><li><p>文件夹使用<strong>kebab-case</strong>， 文件使用<strong>Pascal Case</strong></p><blockquote><p>建议使用这种。</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">文件夹：event-bus</span><br><span class="line">文件：EventBus.ts</span><br></pre></td></tr></table></figure></li><li><p>例外</p><ul><li>index文件不受上述约束</li><li>工具自动生成的文件（自己考虑是否受约束）</li></ul></li></ol><h2 id="模块化原则"><a href="#模块化原则" class="headerlink" title="模块化原则"></a>模块化原则</h2><blockquote><p>模块化代码首先要做到代码的分层、隔离、抽象。</p><p>不同模块完成不同的职能，不同职能之间相互协作。</p></blockquote><ol><li><p>每个模块保持一个入口和出口</p><blockquote><p>对于外部模块来说，尽量保证一个入口</p><p>对于内部子模块来说，尽量保证一个出口</p><p>如果按照<strong>文件夹</strong>作为模块界限，每个文件夹下都有一个出口（可以默认为index文件）</p></blockquote></li><li><p>模块的入口名称默认index或者文件夹名字的文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// 例如： group文件夹</span><br><span class="line">group/</span><br><span class="line">|---index.ts   // A. 默认作为入口</span><br><span class="line">|---group.ts   // B. 也可以默认作为入口</span><br><span class="line"></span><br><span class="line">二者任选其一就好，A方案应该是大家默认的方案；B方案，检索代码的时候更方便</span><br></pre></td></tr></table></figure></li></ol><ol start="3"><li><p>模块内部分层</p><blockquote><p>模块内部还可以有<code>base</code>, <code>common</code>, <code>components</code>, <code>helper</code>,<code>utils</code>,<code>filter</code>,<code>config</code>等层级（词穷了…..）</p></blockquote></li></ol><h2 id="import和export原则"><a href="#import和export原则" class="headerlink" title="import和export原则"></a><code>import</code>和<code>export</code>原则</h2><ol><li><p><code>import</code>导入，指定到文件</p><blockquote><p>指定到文件能够提高编译打包的速度</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 指定到index文件</span></span><br><span class="line"><span class="keyword">import</span> &#123; Logger &#125; <span class="keyword">from</span> <span class="string">'./common/index'</span>;</span><br></pre></td></tr></table></figure></li></ol><h2 id="common模块"><a href="#common模块" class="headerlink" title="common模块"></a><code>common</code>模块</h2><blockquote><p>独立文章说明。</p></blockquote><h2 id="router模块"><a href="#router模块" class="headerlink" title="router模块"></a><code>router</code>模块</h2><blockquote><p><code>router</code>模块的风格约定。</p></blockquote><h3 id="模块结构"><a href="#模块结构" class="headerlink" title="模块结构"></a>模块结构</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">router</span><br><span class="line">├── helper</span><br><span class="line">│   ├── ImportRoute.ts</span><br><span class="line">│   └── RouteGenerator.ts</span><br><span class="line">├── modules</span><br><span class="line">│   ├── AboutRoutes.ts</span><br><span class="line">│   └── HomeRoutes.ts</span><br><span class="line">├── router.ts</span><br><span class="line">└── Routes.ts</span><br></pre></td></tr></table></figure><ul><li><p>helper: 帮助工具方法</p></li><li><p>modules: 不同的业务模块</p></li><li><p>router: vue-router初始化的地方，也是模块入口</p></li><li><p>Routes: <code>RouteConfig</code>的出口，其它模块都从这里获取<code>route</code>配置，从而达到解耦的目的，尤其是不同的<code>views</code>里面的路由跳转，使用<code>Routes</code>配置达到解耦的目的。</p><p>例子：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; HomeRoute &#125; <span class="keyword">from</span> <span class="string">'Routes'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 跳转,这样没有硬编码任何的route信息，全部都是从Routes配置来，达到解耦的目的。</span></span><br><span class="line"><span class="keyword">this</span>.$router.push(&#123;</span><br><span class="line">    name: HomeRoute.name</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li></ul><h3 id="modules子模块"><a href="#modules子模块" class="headerlink" title="modules子模块"></a><code>modules</code>子模块</h3><blockquote><p>文件名：<code>views</code>下文件夹名（模块名） + Routes结尾</p><p><strong>modules下的文件，最好和views下文件夹一一对应，方便维护</strong>（对模块切分有较高的理解）</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">例如：</span><br><span class="line">views</span><br><span class="line">├── group</span><br><span class="line">│   ├── xxx1.vue</span><br><span class="line">│   └── xxx2.vue</span><br><span class="line">├── report</span><br><span class="line">│   ├── xxx3.vue</span><br><span class="line">│   └── xxx4.vue</span><br><span class="line">├── Home.vue</span><br></pre></td></tr></table></figure><blockquote><p><code>modules</code>对应的就是</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">例如：</span><br><span class="line">router</span><br><span class="line">├── modules</span><br><span class="line">│   ├── GroupRoutes.ts</span><br><span class="line">|   ├── ReportRoutes.ts</span><br><span class="line">│   └── HomeRoutes.ts</span><br></pre></td></tr></table></figure><blockquote><p>导出模块配置：</p></blockquote><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// HomeRoutes.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> HomeRoute = &#123;</span><br><span class="line">  path: <span class="string">'/'</span>,</span><br><span class="line">  name: <span class="string">'HomeRoute'</span>,</span><br><span class="line">  component: <span class="string">'Home'</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 必须导出一个数组，因为是一个模块的配置信息，可能有多个配置，还可以进行配置层级关系</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> [HomeRoute];</span><br></pre></td></tr></table></figure><p><strong>注意：</strong> 这只是个思路，具体的操作还要灵活运用。</p><h3 id="RouteConfig风格约定"><a href="#RouteConfig风格约定" class="headerlink" title="RouteConfig风格约定"></a><code>RouteConfig</code>风格约定</h3><ol><li><p><code>RouteConfig</code>变量名</p><blockquote><p><code>vue</code>文件名+Route结尾</p></blockquote><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 文件Home.vue</span></span><br><span class="line"><span class="comment">// 变量名HomeRoute</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> HomeRoute = &#123;</span><br><span class="line">  path: <span class="string">'/'</span>,</span><br><span class="line">  name: <span class="string">'HomeRoute'</span>,</span><br><span class="line">  component: <span class="string">'Home'</span>,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li></ol><ol start="2"><li><p><code>name</code>属性</p><blockquote><p>和<code>RouteConfig</code>变量名保持一致</p></blockquote></li><li><p><code>component</code>属性</p><blockquote><p>如果<strong>异步加载</strong>，<code>component</code>需要使用相对于<code>views</code>的<code>path</code>格式，因为在<code>ImportRoute</code>中统一处理。</p></blockquote><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ImportRoute.ts统一处理</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">importRoute</span>(<span class="params">file: <span class="built_in">string</span></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// @see https://github.com/webpack/webpack/issues/1949</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">import</span>(<span class="comment">/* webpackChunkName: "chunk-[request][index]" */</span> <span class="string">'@/views/'</span> + file + <span class="string">'.vue'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><ol start="4"><li><p><code>path</code>属性</p><blockquote><p>没有最佳实践，最好使用<code>restful</code>风格约束</p><p>如果使用<code>route.query</code>等之类的参数传递，<strong>面包屑导航</strong>很难处理。</p></blockquote></li><li><p><code>meta</code>属性</p><blockquote><p>没有最佳实践，多数情况下有这么几个属性</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> HomeRoute = &#123;</span><br><span class="line">  path: <span class="string">'/'</span>,</span><br><span class="line">  name: <span class="string">'HomeRoute'</span>,</span><br><span class="line">  component: <span class="string">'Home'</span>, <span class="comment">// component: () =&gt; import('@/views/Home.vue')</span></span><br><span class="line">  meta: &#123;</span><br><span class="line">      <span class="comment">// title的值可以为`i18n`的语言文件key，方便做国际化</span></span><br><span class="line">      title: <span class="string">'首页'</span>, <span class="comment">// 作为menu.title和breadcrumb.title备选</span></span><br><span class="line">      icon: <span class="string">''</span>, <span class="comment">// icon的class,作为menu.icon和breadcrumb.icon备选</span></span><br><span class="line">      menu: &#123;</span><br><span class="line">          title: <span class="string">'首页'</span>,</span><br><span class="line">          visible: <span class="literal">true</span>,</span><br><span class="line">          icon: <span class="string">''</span>,  <span class="comment">// icon的class</span></span><br><span class="line">      &#125;,</span><br><span class="line">      breadcrumb: &#123;</span><br><span class="line">          title: <span class="string">'路径名'</span>,</span><br><span class="line">          visible: <span class="literal">false</span>, <span class="comment">// 有的时候不需要在面包屑上渲染</span></span><br><span class="line">          icon: <span class="string">''</span>, <span class="comment">// icon的class</span></span><br><span class="line">      &#125;,</span><br><span class="line">      auth: &#123;</span><br><span class="line">          roles: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li></ol><ol start="6"><li><p><code>props</code>属性</p><blockquote><p><a href="https://router.vuejs.org/zh/guide/essentials/passing-props.html" target="_blank" rel="noopener">路由组件传参</a>，更多高级用法，请查看<a href="https://github.com/vuejs/vue-router/blob/dev/examples/route-props/app.js" target="_blank" rel="noopener">例子</a></p><p>使用<code>props</code>方式把<code>components</code>和<code>$route</code>解耦，这样<code>components</code>既可以单独使用，也可以当作<strong>子组件使用</strong>，而且方便测试。</p><p>特殊场景可以不使用<code>props</code>，例如本来就不是通用的组件，是需要组合在一起使用的父子组件，是可以和<code>route</code>耦合的。</p></blockquote><p><strong><em>如果 <code>props</code> 被设置为 <code>true</code>，<code>route.params</code> 将会被设置为组件属性。</em></strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 函数式(动态)</span></span><br><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> VueRouter(&#123;</span><br><span class="line">  routes: [&#123; </span><br><span class="line">        path: <span class="string">'/search'</span>, </span><br><span class="line">     component: SearchUser, </span><br><span class="line">        <span class="comment">// route是SearchUser内部的this.$route</span></span><br><span class="line">     props: <span class="function">(<span class="params">route</span>) =&gt;</span> (&#123; <span class="attr">query</span>: route.query.q &#125;) </span><br><span class="line">    &#125;]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 静态</span></span><br><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> VueRouter(&#123;</span><br><span class="line">  routes: [&#123; </span><br><span class="line">        path: <span class="string">'/promotion/from-newsletter'</span>,</span><br><span class="line">        component: Promotion, </span><br><span class="line">        props: &#123; <span class="attr">newsletterPopup</span>: <span class="literal">false</span> &#125; </span><br><span class="line">    &#125;]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li></ol><h2 id="store模块"><a href="#store模块" class="headerlink" title="store模块"></a><code>store</code>模块</h2><blockquote><p><code>vue</code>应用的状态模块</p></blockquote><h3 id="模块结构-1"><a href="#模块结构-1" class="headerlink" title="模块结构"></a>模块结构</h3><blockquote><p><a href="https://vuex.vuejs.org/zh/guide/structure.html" target="_blank" rel="noopener">参考官方文件结构</a></p><p><a href="https://github.com/vuejs/vuex/tree/dev/examples/shopping-cart" target="_blank" rel="noopener">官方购物车例子</a></p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">store</span><br><span class="line">├── StoreTypes.ts       # actions mutations getters类型</span><br><span class="line">├── Actions.ts          # 根级别的 action</span><br><span class="line">├── Mutations.ts        # 根级别的 Mutations</span><br><span class="line">├── Getters.ts          # 根级别的 getters</span><br><span class="line">├── modules             # 模块</span><br><span class="line">│   ├── xxxStore.ts     # 子模块</span><br><span class="line">│   ├── SystemStore.ts  # SystemStore子模块</span><br><span class="line">├── index.ts            # 入口</span><br></pre></td></tr></table></figure><ul><li><p><code>index</code>： 作为入口</p></li><li><p><code>StoreTypes</code>作为类型的常量文件</p><blockquote><p><a href="https://vuex.vuejs.org/zh/guide/mutations.html#使用常量替代-mutation-事件类型" target="_blank" rel="noopener">参考使用常量替代-mutation-事件类型</a></p><p>所以mutation和action的类型全部使用常量，方便其它模块和store模块的解耦。</p></blockquote></li></ul><h3 id="modules子模块-1"><a href="#modules子模块-1" class="headerlink" title="modules子模块"></a>modules子模块</h3><blockquote><p>文件名：模块名 + Store结尾</p><p><strong>modules下的业务store，最好和views下文件夹对应，方便维护</strong></p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 例子： </span><br><span class="line">LocaleStore.ts    # i18n模块</span><br><span class="line">LoginStore.ts     # 登录模块</span><br><span class="line">UserStore.ts      # 用户模块</span><br></pre></td></tr></table></figure><h3 id="Store-module约定"><a href="#Store-module约定" class="headerlink" title="Store module约定"></a><code>Store module</code>约定</h3><blockquote><p><a href="https://vuex.vuejs.org/zh/guide/modules.html" target="_blank" rel="noopener"> 参考Store Module</a></p><p>主要约定<code>module</code>内部代码结构大致如下：</p><p><code>SystemStore</code>为例：</p></blockquote><ul><li><p>需要使用前缀的地方使用模块名作为前缀</p><blockquote><p>例子中<strong>模块名</strong>为<code>System</code></p></blockquote></li></ul><blockquote><p><strong>约定声明大致顺序如下</strong>：除state部分外其他都是可选</p></blockquote><ul><li>state声明（例如：<code>systemState</code>）</li><li>getter types声明（可选，灵活运用）</li><li>getters声明（可选, 灵活运用）</li><li>mutation types 声明（可选）</li><li>mutations声明（可选）</li><li>action types声明（可选）</li><li>actions声明（可选）</li><li>store options导出</li></ul><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 例子: SystemStore.ts</span></span><br><span class="line"><span class="comment">// 声明state</span></span><br><span class="line"><span class="keyword">const</span> systemState: SystemState = &#123;</span><br><span class="line">  initialized: <span class="literal">false</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 声明GetterTypes </span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> SystemGetterTypes = &#123;</span><br><span class="line">  IS_SYSTEM_INITIALIZED: <span class="string">'IS_SYSTEM_INITIALIZED'</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 声明getters</span></span><br><span class="line"><span class="keyword">const</span> getters = &#123;</span><br><span class="line">    [SystemGetterTypes.IS_SYSTEM_INITIALIZED](state: SystemState, getters: <span class="built_in">any</span>, rootState: <span class="built_in">any</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> state.initialized;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 声明MutationTypes</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> SystemMutationTypes = &#123;</span><br><span class="line">  SYSTEM_SET_INITIALIZED: <span class="string">'SYSTEM_SET_INITIALIZED'</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 声明mutations</span></span><br><span class="line"><span class="keyword">const</span> mutations: MutationTree&lt;SystemState&gt; = &#123;</span><br><span class="line">  [SystemMutationTypes.SYSTEM_SET_INITIALIZED]: (</span><br><span class="line">    state: SystemState,</span><br><span class="line">    payload: <span class="built_in">boolean</span></span><br><span class="line">  ) =&gt; &#123;</span><br><span class="line">    state.initialized = payload;</span><br><span class="line">    logger.log(<span class="string">'system-store.initialized: '</span> + payload);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 声明ActionTypes</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> SystemActionTypes = &#123;</span><br><span class="line">  SYSTEM_UPDATE_INITIALIZED: <span class="string">'SYSTEM_UPDATE_INITIALIZED'</span>,</span><br><span class="line">  SYSTEM_RESET: <span class="string">'SYSTEM_RESET'</span>,</span><br><span class="line">  SYSTEM_INIT: <span class="string">'SYSTEM_INIT'</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 声明actions</span></span><br><span class="line"><span class="keyword">const</span> actions = &#123;</span><br><span class="line">  [SystemActionTypes.SYSTEM_UPDATE_INITIALIZED]: (</span><br><span class="line">    &#123; commit &#125;: ActionContext&lt;SystemState, <span class="built_in">any</span>&gt;,</span><br><span class="line">    initialized: <span class="built_in">boolean</span></span><br><span class="line">  ) =&gt; &#123;</span><br><span class="line">    commit(SystemMutationTypes.SYSTEM_SET_INITIALIZED, initialized);</span><br><span class="line">  &#125;,</span><br><span class="line">  [SystemActionTypes.SYSTEM_RESET]: (&#123;</span><br><span class="line">    commit,</span><br><span class="line">    dispatch,</span><br><span class="line">  &#125;: ActionContext&lt;SystemState, <span class="built_in">any</span>&gt;) =&gt; &#123;</span><br><span class="line">    <span class="comment">// 清空所有使用store储存的数据.</span></span><br><span class="line">  &#125;,</span><br><span class="line">  [SystemActionTypes.SYSTEM_INIT]: (</span><br><span class="line">    &#123; commit, dispatch &#125;: ActionContext&lt;SystemState, <span class="built_in">any</span>&gt;,</span><br><span class="line">    payload: &#123;</span><br><span class="line">      user: UserModel;</span><br><span class="line">      userCookie: UserCookie;</span><br><span class="line">    &#125;</span><br><span class="line">  ) =&gt; &#123;</span><br><span class="line">      <span class="comment">// 初始化数据</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导出storeOptions</span></span><br><span class="line"><span class="keyword">const</span> storeOptions = &#123;</span><br><span class="line">  state: systemState,</span><br><span class="line">  getters,</span><br><span class="line">  mutations,</span><br><span class="line">  actions,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> storeOptions;</span><br></pre></td></tr></table></figure><p><strong>注意</strong>：其中的action types, mutation types和  getter types 不强制要求，在<code>es6</code>环境中使用官方的<code>mapState</code>，<code>mapGetters</code>, <code>mapActions</code>, <code>mapMutations</code>工具函数更方便。</p><h2 id="api模块"><a href="#api模块" class="headerlink" title="api模块"></a><code>api</code>模块</h2><blockquote><p><code>api</code>模块是接口服务层，主要做一些对参数的转换处理，同时解耦其它业务层。</p></blockquote><h3 id="模块结构-2"><a href="#模块结构-2" class="headerlink" title="模块结构"></a>模块结构</h3><blockquote><p>模块的大致参考结构</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">api</span><br><span class="line">├── api.ts    # 入口</span><br><span class="line">└── modules   # 子模块</span><br><span class="line">    ├── DictionaryService.ts   # 具体的业务模块</span><br><span class="line">    ├── GroupService.ts</span><br><span class="line">    ├── HistoryService.ts</span><br></pre></td></tr></table></figure><h3 id="service-module约定"><a href="#service-module约定" class="headerlink" title="service module约定"></a><code>service module</code>约定</h3><blockquote><p>文件名：模块名 + Service结尾</p><p><strong>modules下的业务service，和views下文件夹对应，方便维护</strong></p><p>如果单个service文件对应的业务模块接口太多，可以使用文件夹来进一步分割。</p></blockquote><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//例子：LoginService</span></span><br><span class="line"><span class="comment">// 声明url，导出url方便mock模块使用</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> GET_SIGN_IN = <span class="string">'/api/login'</span>;</span><br><span class="line"><span class="comment">// 声明service函数</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">signIn</span>(<span class="params">data: &#123;account: <span class="built_in">string</span>; pass: <span class="built_in">string</span>&#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> ajax(&#123;</span><br><span class="line">      url: GET_SIGN_IN,</span><br><span class="line">      data, </span><br><span class="line">      method: <span class="string">'post'</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>URL前缀约定：</strong></p><blockquote><p>查询：使用<code>GET</code>作为前缀（特殊情况例外）</p><p>更新：使用<code>UPDATE</code></p><p>新增：使用<code>ADD</code></p><p>删除：使用<code>DELETE</code></p><p>其它：EXPORT，IMPORT，UPLOAD，DOWNLOAD等</p></blockquote><p><strong>service 函数</strong>名前缀约定：</p><ul><li>对于单个<strong>实体</strong>可以考虑使用get, add, update, delete作为前缀</li></ul><h2 id="i18n模块"><a href="#i18n模块" class="headerlink" title="i18n模块"></a><code>i18n</code>模块</h2><blockquote><p>主要是建议下代码的分割的约定。</p></blockquote><h3 id="模块结构-3"><a href="#模块结构-3" class="headerlink" title="模块结构"></a>模块结构</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">i18n</span><br><span class="line">├── i18n.ts</span><br><span class="line">├── index.d.ts</span><br><span class="line">└── locales</span><br><span class="line">    ├── en_US.js</span><br><span class="line">    ├── modules</span><br><span class="line">    │   └── actions</span><br><span class="line">    │       ├── en_US.js</span><br><span class="line">    │       └── zh_CN.js</span><br><span class="line">    └── zh_CN.js</span><br></pre></td></tr></table></figure><h3 id="语言文件组织"><a href="#语言文件组织" class="headerlink" title="语言文件组织"></a>语言文件组织</h3><blockquote><p>语言模块的组织，主要按照模块（文件夹层次）来组织，能够最小的减少冲突可能性。</p></blockquote><p><strong>语言文件约定：</strong></p><ul><li>方言文件放置在<code>locals</code>文件夹下</li><li>文件以<strong>方言编码</strong>命名</li></ul><p>层级组织的例子：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">views</span><br><span class="line">├── account</span><br><span class="line">│   ├── Account.vue</span><br><span class="line">│   ├── locales</span><br><span class="line">│   │   ├── en_US.js</span><br><span class="line">│   │   └── zh_CN.js</span><br><span class="line">│   └── XXX.vue</span><br><span class="line">├── feedback</span><br><span class="line">│   ├── locales</span><br><span class="line">│   │   ├── en_US.js</span><br><span class="line">│   │   └── zh_CN.js</span><br><span class="line">│   └── Suggestion.vue</span><br><span class="line">├── locales</span><br><span class="line">│   │   ├── en_US.js</span><br><span class="line">│   │   └── zh_CN.js</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// views/feedback/locales/zh_CN.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> feedbackModule = &#123;</span><br><span class="line">  <span class="comment">// 语言模块属性：模块名+module结尾</span></span><br><span class="line">  <span class="comment">// 可选的方式就是：严格按照文件夹层次来构造属性层级(缺点取属性值时太长，后期可以使用__dirname自动生成)</span></span><br><span class="line">  label: <span class="string">'您的意见:'</span>,</span><br><span class="line">    textarea: &#123;</span><br><span class="line">        placeholder: <span class="string">'请写下您的意见与建议, 500字符以内'</span></span><br><span class="line">  &#125;  </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// views/locales/zh_CN.js</span></span><br><span class="line"><span class="keyword">import</span> feedbackModule <span class="keyword">from</span> <span class="string">'../feedback/locales/zh_CN.js'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="comment">// 如果模块众多建议加上views  </span></span><br><span class="line">  <span class="comment">// views: &#123;</span></span><br><span class="line">  <span class="comment">//    ...feedbackModule,</span></span><br><span class="line">  <span class="comment">// &#125;</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 如果模块少，直接</span></span><br><span class="line">  feedbackModule,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// i18n/locales/zh_CN.js</span></span><br><span class="line"><span class="keyword">import</span> viewsLocales <span class="keyword">from</span> <span class="string">'../../views/locales/zh_CN'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    ...viewsLocales</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="mock模块"><a href="#mock模块" class="headerlink" title="mock模块"></a><code>mock</code>模块</h2><blockquote><p>mock模块主要做些数据模拟的工作</p></blockquote><h3 id="模块结构-4"><a href="#模块结构-4" class="headerlink" title="模块结构"></a>模块结构</h3><blockquote><p>子模块的大致参考结构</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mock</span><br><span class="line">├── mock.js   # 入口</span><br><span class="line">└── modules   # 子模块</span><br><span class="line">    ├── LoginMock.js   # 具体的业务模块</span><br></pre></td></tr></table></figure><h3 id="mock-module约定"><a href="#mock-module约定" class="headerlink" title="mock module约定"></a><code>mock module</code>约定</h3><blockquote><p>文件名：模块名 + mock结尾</p><p><strong>modules下的mock文件，和<code>api</code>模块下文件对应，方便维护</strong></p></blockquote><p><strong>方法约定：</strong></p><ul><li><p><code>mock</code>模块方法和<code>service</code>请求方法对应</p><blockquote><p>例如：<code>LoginService</code>的<code>signIn</code> mock模块对应也叫<code>signIn</code></p></blockquote></li><li><p><code>mock module</code>需要提供<code>setup</code>方法</p><blockquote><p>setup方法供外部统一调用，作为mock module的开关</p></blockquote></li></ul><blockquote><p>例子：</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// LoginMock.js</span></span><br><span class="line"><span class="keyword">import</span> Mock <span class="keyword">from</span> <span class="string">'mockjs'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; genSuccessResult, genFailResult &#125; <span class="keyword">from</span> <span class="string">'./mock-utils'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; GET_SIGN_IN &#125; <span class="keyword">from</span> <span class="string">'../api/api'</span>;</span><br><span class="line"><span class="keyword">import</span> Cookies  <span class="keyword">from</span> <span class="string">'js-cookie'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> signIn = <span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">    Cookies.set(<span class="string">'SESSIONID'</span>, <span class="string">'mock SESSIONID'</span>);</span><br><span class="line">    <span class="keyword">return</span> genSuccessResult(&#123;</span><br><span class="line">      msg: <span class="string">'登陆成功'</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line">      </span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  setup() &#123;</span><br><span class="line">      Mock.mock(GET_SIGN_IN, <span class="string">'post'</span>, signIn);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// mock.js</span></span><br><span class="line"><span class="keyword">import</span> loginMocker <span class="keyword">from</span> <span class="string">'./modules/login'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> start = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  loginMocker.setup();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="keyword">import</span> mocker <span class="keyword">from</span> <span class="string">'./mock/mock'</span></span><br><span class="line"><span class="keyword">if</span> (process.env.NODE_ENV === <span class="string">'development'</span>) &#123;</span><br><span class="line">  mocker.start();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="其它模块"><a href="#其它模块" class="headerlink" title="其它模块"></a>其它模块</h2><blockquote><p>其它模块如<code>filters</code>，<code>directives</code>,<code>test</code>目前没有总结，以后补充。</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;前端小纠结–Vue项目代码组织和风格约定&quot;&gt;&lt;a href=&quot;#前端小纠结–Vue项目代码组织和风格约定&quot; class=&quot;headerlink&quot; title=&quot;前端小纠结–Vue项目代码组织和风格约定&quot;&gt;&lt;/a&gt;前端小纠结–Vue项目代码组织和风格约定&lt;/h1&gt;&lt;
      
    
    </summary>
    
      <category term="fe" scheme="https://betgar.github.io/categories/fe/"/>
    
    
      <category term="fe" scheme="https://betgar.github.io/tags/fe/"/>
    
  </entry>
  
  <entry>
    <title>windows 10 锁屏壁纸保存方法</title>
    <link href="https://betgar.github.io/2019/06/12/save-the-windows-spotlight/"/>
    <id>https://betgar.github.io/2019/06/12/save-the-windows-spotlight/</id>
    <published>2019-06-12T01:00:00.000Z</published>
    <updated>2019-06-29T13:33:54.760Z</updated>
    
    <content type="html"><![CDATA[<h1 id="分享必应壁纸"><a href="#分享必应壁纸" class="headerlink" title="分享必应壁纸"></a>分享必应壁纸</h1><h1 id="windows-10-锁屏壁纸保存方法"><a href="#windows-10-锁屏壁纸保存方法" class="headerlink" title="windows 10 锁屏壁纸保存方法"></a>windows 10 锁屏壁纸保存方法</h1><blockquote><p>windows 锁屏壁纸功能叫做<code>spotlight</code>，其实壁纸都下载在本地电脑上，只需要拷贝出来就行了。</p></blockquote><h3 id="脚本"><a href="#脚本" class="headerlink" title="脚本"></a>脚本</h3><blockquote><p>保存为  <code>spotlight.ps1</code>  ，使用右键<code>powershell</code>运行</p><p>在个人文件夹的<code>Pictures</code>下有两个Horizontal和Vertical保存着图片</p></blockquote><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">add-type</span> -AssemblyName System.Drawing</span><br><span class="line"><span class="built_in">New-Item</span> <span class="string">"$(<span class="variable">$env:USERPROFILE</span>)\Pictures\Spotlight"</span> -ItemType directory -Force;</span><br><span class="line"><span class="built_in">New-Item</span> <span class="string">"$(<span class="variable">$env:USERPROFILE</span>)\Pictures\Spotlight\CopyAssets"</span> -ItemType directory -Force;</span><br><span class="line"><span class="built_in">New-Item</span> <span class="string">"$(<span class="variable">$env:USERPROFILE</span>)\Pictures\Spotlight\Horizontal"</span> -ItemType directory -Force;</span><br><span class="line"><span class="built_in">New-Item</span> <span class="string">"$(<span class="variable">$env:USERPROFILE</span>)\Pictures\Spotlight\Vertical"</span> -ItemType directory -Force;</span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$file</span> <span class="keyword">in</span> (<span class="built_in">Get-Item</span> <span class="string">"$(<span class="variable">$env:LOCALAPPDATA</span>)\Packages\Microsoft.Windows.ContentDeliveryManager_cw5n1h2txyewy\LocalState\Assets\*"</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> ((<span class="built_in">Get-Item</span> <span class="variable">$file</span>).length <span class="nomarkup">-lt</span> <span class="number">100</span>kb) &#123; <span class="keyword">continue</span> &#125;</span><br><span class="line">    <span class="built_in">Copy-Item</span> <span class="variable">$file</span>.FullName <span class="string">"$(<span class="variable">$env:USERPROFILE</span>)\Pictures\Spotlight\CopyAssets\$(<span class="variable">$file</span>.Name).jpg"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$newfile</span> <span class="keyword">in</span> (<span class="built_in">Get-Item</span> <span class="string">"$(<span class="variable">$env:USERPROFILE</span>)\Pictures\Spotlight\CopyAssets\*"</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$image</span> = <span class="built_in">New-Object</span> -comObject WIA.ImageFile;</span><br><span class="line">    <span class="variable">$image</span>.LoadFile(<span class="variable">$newfile</span>.FullName);</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$image</span>.Width.ToString() <span class="nomarkup">-eq</span> <span class="string">"1920"</span>)&#123; <span class="built_in">Move-Item</span> <span class="variable">$newfile</span>.FullName <span class="string">"$(<span class="variable">$env:USERPROFILE</span>)\Pictures\Spotlight\Horizontal"</span> -Force; &#125;</span><br><span class="line">    <span class="keyword">elseif</span>(<span class="variable">$image</span>.Width.ToString() <span class="nomarkup">-eq</span> <span class="string">"1080"</span>)&#123; <span class="built_in">Move-Item</span> <span class="variable">$newfile</span>.FullName <span class="string">"$(<span class="variable">$env:USERPROFILE</span>)\Pictures\Spotlight\Vertical"</span> -Force; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Remove-Item</span> <span class="string">"$(<span class="variable">$env:USERPROFILE</span>)\Pictures\Spotlight\CopyAssets\*"</span>;</span><br></pre></td></tr></table></figure><h2 id="必应缤纷桌面"><a href="#必应缤纷桌面" class="headerlink" title="必应缤纷桌面"></a>必应缤纷桌面</h2><blockquote><p>微软出品<a href="https://www.microsoft.com/zh-cn/download/details.aspx?id=35844" target="_blank" rel="noopener">必应缤纷桌面</a></p><p><a href="https://bing.ioliu.cn/" target="_blank" rel="noopener">收集必应壁纸的网站</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;分享必应壁纸&quot;&gt;&lt;a href=&quot;#分享必应壁纸&quot; class=&quot;headerlink&quot; title=&quot;分享必应壁纸&quot;&gt;&lt;/a&gt;分享必应壁纸&lt;/h1&gt;&lt;h1 id=&quot;windows-10-锁屏壁纸保存方法&quot;&gt;&lt;a href=&quot;#windows-10-锁屏壁纸保存方
      
    
    </summary>
    
      <category term="windows" scheme="https://betgar.github.io/categories/windows/"/>
    
    
      <category term="windows" scheme="https://betgar.github.io/tags/windows/"/>
    
  </entry>
  
  <entry>
    <title>nvs使用的注意事项</title>
    <link href="https://betgar.github.io/2019/06/06/nvs-usage-considerations/"/>
    <id>https://betgar.github.io/2019/06/06/nvs-usage-considerations/</id>
    <published>2019-06-05T16:00:00.000Z</published>
    <updated>2019-06-29T13:33:54.758Z</updated>
    
    <content type="html"><![CDATA[<h1 id="nvs使用的注意事项"><a href="#nvs使用的注意事项" class="headerlink" title="nvs使用的注意事项"></a><code>nvs</code>使用的注意事项</h1><blockquote><p>在使用<code>nvs</code>之前一直使用的是<a href="https://github.com/coreybutler/nvm-windows" target="_blank" rel="noopener"><code>nvm windows</code></a>这款工具，用着也挺爽的，前不久看到科普文，所以也想试试，试了之后在<code>windows</code>上翻车了，所以这里记录一下。先看<a href="https://zhuanlan.zhihu.com/p/63403762" target="_blank" rel="noopener">科普文：使用 nvs 管理本地 Node.js 版本</a></p></blockquote><h2 id="windows下安装"><a href="#windows下安装" class="headerlink" title="windows下安装"></a><code>windows</code>下安装</h2><blockquote><p><a href="https://github.com/jasongin/nvs/blob/master/doc/SETUP.md#manual-setup---command-prompt" target="_blank" rel="noopener">推荐cmd手动安装步骤</a></p></blockquote><h3 id="git-bash环境配置"><a href="#git-bash环境配置" class="headerlink" title="git bash环境配置"></a>git bash环境配置</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ~/.bashrc 添加下面的环境配置</span></span><br><span class="line"><span class="comment"># 根据你安装的路径选择$ProgramData 或者 $LOCALAPPDATA</span></span><br><span class="line"><span class="built_in">export</span> NVS_HOME=<span class="variable">$LOCALAPPDATA</span>/nvs</span><br><span class="line">. <span class="variable">$NVS_HOME</span>/nvs.sh</span><br></pre></td></tr></table></figure><h3 id="git-bash中nvs报错找不到命令"><a href="#git-bash中nvs报错找不到命令" class="headerlink" title="git bash中nvs报错找不到命令"></a>git bash中<code>nvs</code>报错找不到命令</h3><blockquote><p><code>nvs v1.5.1</code>使用<code>MSI</code>或者<code>choco install nvs</code>安装之后可以正常使用，但是会缺失<code>nvs.sh</code>，如果你在<code>git bash</code>下使用<code>nvs</code>会出现找不到命令，后续版本会修复这个问题。<a href="https://github.com/jasongin/nvs/blob/master/doc/SETUP.md#manual-setup---command-prompt" target="_blank" rel="noopener">推荐cmd手动安装步骤</a>则没有这个问题。</p></blockquote><h3 id="nvs和npm命令不生效"><a href="#nvs和npm命令不生效" class="headerlink" title="nvs和npm命令不生效"></a><code>nvs</code>和<code>npm</code>命令不生效</h3><blockquote><p>安装之后在新的终端窗口中<code>nvs</code>和<code>npm</code>不生效时，注意注销重新登录，或者重新启动一次系统。</p></blockquote><p><strong>注意：</strong> 尤其是第一次使用<code>nvs link</code>之后，发现<code>node</code>和<code>npm</code>不会生效，最好注销重新登录。</p><h2 id="共用npm全局模块"><a href="#共用npm全局模块" class="headerlink" title="共用npm全局模块"></a>共用<code>npm</code>全局模块</h2><blockquote><p>首先不建议大家跨版本公用全局模块，除非你知道你在干什么。</p><p><a href="https://zhuanlan.zhihu.com/p/63403762" target="_blank" rel="noopener">科普文：使用 nvs 管理本地 Node.js 版本</a>  这里有介绍怎么设置。</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用git bash创建</span></span><br><span class="line">mkdir -p ~/.npm-global</span><br><span class="line">npm config <span class="built_in">set</span> prefix ~/.npm-global</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># .bashrc中添加全局模块的路径</span></span><br><span class="line"><span class="comment"># 注意~/.npm-global/   不是~/.npm-global/bin</span></span><br><span class="line"><span class="comment"># windows 10下没有bin文件夹，所以最好检查下。。。</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"export PATH=~/.npm-global/:<span class="variable">$PATH</span>"</span> &gt;&gt; ~/.bashrc</span><br><span class="line"></span><br><span class="line"><span class="built_in">source</span> ~/.bashrc</span><br></pre></td></tr></table></figure><p><strong>注意：</strong> (<code>nvs v1.5.1</code>)</p><ol><li>注意检查全局模块的配置路径，是否正确（坑）</li></ol><h3 id="cmd和power-shell下添加全局模块环境变量"><a href="#cmd和power-shell下添加全局模块环境变量" class="headerlink" title="cmd和power shell下添加全局模块环境变量"></a><code>cmd</code>和<code>power shell</code>下添加全局模块环境变量</h3><blockquote><p>通过以上的配置在<code>git bash</code>下，全局安装的<code>npm</code>模块工作的很正常，但是在<code>cmd</code>或者<code>power shell</code>会发现找不到命令，尝试过添加到<strong>系统变量</strong>，但是依然不生效，最后提个issues，<a href="https://github.com/jasongin/nvs/issues/137#issuecomment-499944995" target="_blank" rel="noopener">官方给了解决方案</a>。</p></blockquote><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 设置完如果不生效，新开一个命令行窗口尝试（如果不行，注销重新登录）</span></span><br><span class="line">setx PATH <span class="string">"%PATH%;%USERPROFILE%\.npm-global"</span></span><br></pre></td></tr></table></figure><p>设置之后：<code>cmder</code>, <code>cmd</code> , <code>powershell</code>, <code>cygwin</code>通通生效了</p><p><strong>注意：</strong></p><ol><li><code>nvs use</code> 是改变当前<code>shell</code>窗口的<code>node</code>版本，不是全局环境（nvm的区别）</li><li><code>nvs link</code>是改变全局环境的<code>node</code>版本</li></ol><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://zhuanlan.zhihu.com/p/63403762" target="_blank" rel="noopener">科普文：使用 nvs 管理本地 Node.js 版本</a></p><p><a href="https://ukn.me/cong-nvm-qian-yi-dao-nvs.html" target="_blank" rel="noopener">从 nvm 迁移到 nvs</a></p><p><a href="https://github.com/cmderdev/cmder/issues/565" target="_blank" rel="noopener">cmder using  .bashrc</a></p><p><a href="https://github.com/jasongin/nvs/blob/master/doc/VSCODE.md" target="_blank" rel="noopener">VS Code Support - Node Version Switcher</a></p><p><a href="https://github.com/xizhibei/blog/issues/38" target="_blank" rel="noopener">xizhibei Node Version Manager </a></p><p><a href="https://github.com/jasongin/nvs/issues/137" target="_blank" rel="noopener">Windows: when use npm prefix share global modules fails</a></p><p><a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/setx" target="_blank" rel="noopener">setx</a></p><p><a href="https://ss64.com/nt/setx.html" target="_blank" rel="noopener">ss64 setx</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;nvs使用的注意事项&quot;&gt;&lt;a href=&quot;#nvs使用的注意事项&quot; class=&quot;headerlink&quot; title=&quot;nvs使用的注意事项&quot;&gt;&lt;/a&gt;&lt;code&gt;nvs&lt;/code&gt;使用的注意事项&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;在使用&lt;code&gt;nvs
      
    
    </summary>
    
      <category term="node" scheme="https://betgar.github.io/categories/node/"/>
    
      <category term="nvs" scheme="https://betgar.github.io/categories/node/nvs/"/>
    
    
      <category term="node" scheme="https://betgar.github.io/tags/node/"/>
    
      <category term="nvs" scheme="https://betgar.github.io/tags/nvs/"/>
    
  </entry>
  
  <entry>
    <title>前端小纠结--集成gitflow和standard-version使用</title>
    <link href="https://betgar.github.io/2019/05/21/frontend-little-tangle-integrate-git-flow-and-standard-version/"/>
    <id>https://betgar.github.io/2019/05/21/frontend-little-tangle-integrate-git-flow-and-standard-version/</id>
    <published>2019-05-21T00:00:00.000Z</published>
    <updated>2019-06-29T13:33:54.757Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前端小纠结–集成gitflow和standard-version使用"><a href="#前端小纠结–集成gitflow和standard-version使用" class="headerlink" title="前端小纠结–集成gitflow和standard-version使用"></a>前端小纠结–集成<code>gitflow</code>和<code>standard-version</code>使用</h1><blockquote><p>请看上一篇<a href="https://betgar.github.io/2019/05/20/frontend-little-tangle-conventional-commit-and-generate-changelog/">前端小纠结–约定式提交和自动生成<code>changelog</code></a></p></blockquote><h3 id="git-flow工作流对比"><a href="#git-flow工作流对比" class="headerlink" title="git flow工作流对比"></a><code>git flow</code>工作流对比</h3><blockquote><p><a href="http://blog.jobbole.com/76843/" target="_blank" rel="noopener">Git工作流指南</a></p></blockquote><h2 id="git-flow-介绍"><a href="#git-flow-介绍" class="headerlink" title="git flow 介绍"></a><code>git flow 介绍</code></h2><blockquote><p><code>git flow</code>源自这篇文章<a href="https://nvie.com/posts/a-successful-git-branching-model/" target="_blank" rel="noopener">a-successful-git-branching-model</a>，大神！！！。</p><p>关于<code>git flow</code>的使用，请看以下链接，非常多的文章，写的非常好。</p></blockquote><p><a href="http://www.cnblogs.com/cnblogsfans/p/5075073.html" target="_blank" rel="noopener">如何正确的使用git flow</a></p><p><a href="https://danielkummer.github.io/git-flow-cheatsheet/index.zh_CN.html" target="_blank" rel="noopener">git-flow 备忘清单</a></p><blockquote><p>git-branching-model 如图</p></blockquote><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https://raw.githubusercontent.com/betgar/betgar.github.io/master/img/picgo/20190521102909-git-flow-nvie.png" alt="git-flow-nvie" title="">                </div>                <div class="image-caption">git-flow-nvie</div>            </figure><h3 id="git-flow常用的分支"><a href="#git-flow常用的分支" class="headerlink" title="git flow常用的分支"></a><code>git flow</code>常用的分支</h3><blockquote><p>以下部分内容来自<a href="http://www.cnblogs.com/cnblogsfans/p/5075073.html" target="_blank" rel="noopener">如何正确的使用git flow</a>博客和<a href="https://gitversion.readthedocs.io/en/latest/git-branching-strategies/gitflow-examples/" target="_blank" rel="noopener">gitflow-examples</a></p></blockquote><ul><li><code>develop</code> :  这个分支是我们是我们的主开发分支，包含所有要发布到下一个Release的代码，这个主要合并与其他分支，比如Feature分支</li><li><code>release/*</code> : 当你需要一个发布一个新Release的时候，我们基于Develop分支创建一个Release分支，完成Release后，我们合并到Master和Develop分支</li><li><code>master</code> : 也就是我们经常使用的Master分支，这个分支最近发布到生产环境的代码，最近发布的Release， 这个分支只能从其他分支合并，不能在这个分支直接修改</li><li><code>hotfix/*</code> 当我们在生产环境(master)发现新的Bug时候，我们需要创建一个Hotfix, 完成Hotfix后，我们合并回Master和Develop分支，所以Hotfix的改动会进入下一个Release</li><li>feature/* : 这个分支主要是用来开发一个新的功能，一旦开发完成，我们合并回Develop分支进入下一个Release</li></ul><h3 id="git-Flow如何工作"><a href="#git-Flow如何工作" class="headerlink" title="git Flow如何工作"></a>git Flow如何工作</h3><blockquote><p>所有在Master分支上的Commit应该Tag</p></blockquote><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https://raw.githubusercontent.com/betgar/betgar.github.io/master/img/picgo/20190521103213-git-workflow-release-cycle-1historical.png" alt="git-workflow-release-cycle-1historical" title="">                </div>                <div class="image-caption">git-workflow-release-cycle-1historical</div>            </figure><h4 id="feature分支"><a href="#feature分支" class="headerlink" title="feature分支"></a><code>feature</code>分支</h4><blockquote><p>分支名 feature/*</p><p>Feature分支做完后，必须合并回Develop分支, 合并完分支后一般会删点这个Feature分支</p></blockquote><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https://raw.githubusercontent.com/betgar/betgar.github.io/master/img/picgo/20190521103229-git-workflow-release-cycle-2feature.png" alt="git-workflow-release-cycle-2feature" title="">                </div>                <div class="image-caption">git-workflow-release-cycle-2feature</div>            </figure><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https://raw.githubusercontent.com/betgar/betgar.github.io/master/img/picgo/20190521105032-feature-branch.png" alt="feature-branch" title="">                </div>                <div class="image-caption">feature-branch</div>            </figure><h4 id="release分支"><a href="#release分支" class="headerlink" title="release分支"></a><code>release</code>分支</h4><blockquote><p>分支名 release/*</p><p>Release分支基于Develop分支创建，打完Release分之后，我们可以在这个Release分支上测试，修改Bug等。同时，其它开发人员可以基于开发新的Feature (记住：<strong>一旦打了Release分支之后不要从Develop分支上合并新的改动到Release分支</strong>)</p><p>发布Release分支时，合并Release到Master和Develop， 同时在Master分支上打个Tag记住Release版本号，然后可以删除Release分支了。</p></blockquote><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https://raw.githubusercontent.com/betgar/betgar.github.io/master/img/picgo/20190521103240-git-workflow-release-cycle-3release.png" alt="git-workflow-release-cycle-3release" title="">                </div>                <div class="image-caption">git-workflow-release-cycle-3release</div>            </figure><blockquote><p>minor版本发布</p></blockquote><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https://raw.githubusercontent.com/betgar/betgar.github.io/master/img/picgo/20190521105209-minor-release.png" alt="minor-release" title="">                </div>                <div class="image-caption">minor-release</div>            </figure><blockquote><p>major版本发布</p></blockquote><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https://raw.githubusercontent.com/betgar/betgar.github.io/master/img/picgo/20190521105223-major-release.png" alt="major-release" title="">                </div>                <div class="image-caption">major-release</div>            </figure><h4 id="hotfix分支"><a href="#hotfix分支" class="headerlink" title="hotfix分支"></a><code>hotfix</code>分支</h4><blockquote><p>分支名 hotfix/*</p><p>hotfix分支基于Master分支创建，开发完后需要合并回Master和Develop分支，同时在Master上打一个tag</p></blockquote><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https://raw.githubusercontent.com/betgar/betgar.github.io/master/img/picgo/20190521103251-git-workflow-release-cycle-4maintenance.png" alt="git-workflow-release-cycle-4maintenance" title="">                </div>                <div class="image-caption">git-workflow-release-cycle-4maintenance</div>            </figure><blockquote><p>hotfix修复分支</p></blockquote><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https://raw.githubusercontent.com/betgar/betgar.github.io/master/img/picgo/20190521105905-hotfix-branch.png" alt="hotfix-branch" title="">                </div>                <div class="image-caption">hotfix-branch</div>            </figure><h4 id="support分支"><a href="#support分支" class="headerlink" title="support分支"></a><code>support</code>分支</h4><blockquote><p>GitFlow没有真正涵盖<code>support</code>分支，如果需要同时维护多个主要版本，则必不可少。 您也可以使用<code>support</code>分支来支持<code>minor</code>版本。 如果您只是支持<code>major</code>，命名<code>support/&lt;major&gt;.x</code>，minor版本为<code>support/&lt;major&gt;.&lt;minor&gt;.x</code></p></blockquote><h4 id="多版本hotfix修复"><a href="#多版本hotfix修复" class="headerlink" title="多版本hotfix修复"></a>多版本hotfix修复</h4><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https://raw.githubusercontent.com/betgar/betgar.github.io/master/img/picgo/20190521111135-support-hotfix.png" alt="support-hotfix" title="">                </div>                <div class="image-caption">support-hotfix</div>            </figure><h4 id="多版本的release"><a href="#多版本的release" class="headerlink" title="多版本的release"></a>多版本的release</h4><blockquote><p>多版本的<code>git flow</code>的<code>release</code>流程只是把master替换为需要维护的分支。</p></blockquote><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https://raw.githubusercontent.com/betgar/betgar.github.io/master/img/picgo/20190521111047-support-minor.png" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><h2 id="git-flow工具的使用"><a href="#git-flow工具的使用" class="headerlink" title="git flow工具的使用"></a><code>git flow</code>工具的使用</h2><blockquote><p>windows和mac建议使用<code>sourcetree</code>客户端，内置了<code>git flow</code>流程，具体的使用方法，请自行搜索.</p><p>当然windows下的git for windows(git bash中)也内置了gitflow-scripts，请参考<a href="https://github.com/petervanderdoes/git-flow-completion" target="_blank" rel="noopener">升级版git-flow-completion</a>完成自动补全功能</p><p>如果使用linux，内置了gitflow-scripts（不知道是那个版本），很不负责任的建议使用<a href="https://github.com/petervanderdoes/gitflow-avh" target="_blank" rel="noopener">升级版gitflow-avh</a>.</p><p>关于使用git flow工具使用可以参考<a href="http://www.cnblogs.com/cnblogsfans/p/5075073.html" target="_blank" rel="noopener">如何正确使用Git Flow</a>这篇博客文章</p></blockquote><p><img src="https://raw.githubusercontent.com/betgar/betgar.github.io/master/img/picgo/20190521140451-sourcetree-git-flow.jpg" alt="sourcetree-git-flow"></p><blockquote><p>上图是sourcetree中git flow的菜单</p></blockquote><h2 id="git-flow和standard-version搭配使用"><a href="#git-flow和standard-version搭配使用" class="headerlink" title="git flow和standard-version搭配使用"></a><code>git flow</code>和<code>standard-version</code>搭配使用</h2><blockquote><p>请务必在熟悉<code>git flow</code>的基础上集成使用<code>standard-version</code>，因为两个工具的使用不当，会造成冲突。</p></blockquote><h3 id="git-flow流程中standard-version使用"><a href="#git-flow流程中standard-version使用" class="headerlink" title="git flow流程中standard-version使用"></a><code>git flow</code>流程中<code>standard-version</code>使用</h3><blockquote><p><code>standard-version</code>的作用就是生成<code>changelog</code>更新<code>package.json</code>和<code>package.lock.json</code>中的<code>version</code>字段。所以它在<code>git flow</code>中使用受<code>git flow</code>的流程限制。<br>目前我的经验是只能在<code>git flow</code>的<code>release/*</code>和<code>hotfix/*</code>分支中使用。<br>因为只有这两个分支涉及到发版流程，而<code>changelog</code>只有在发版时刻才生成。</p></blockquote><h3 id="git-flow和standard-version冲突的tag功能"><a href="#git-flow和standard-version冲突的tag功能" class="headerlink" title="git flow和standard-version冲突的tag功能"></a><code>git flow</code>和<code>standard-version</code>冲突的tag功能</h3><blockquote><p><code>git flow</code>和<code>standard-version</code>在使用的过程中，都有自动打<code>tag</code>的功能，但是两者都支持跳过<code>tag</code>阶段，所以这也是这两个工具冲突的地方，建议从两者中<strong>选取其一</strong>。</p><p><strong><em>强烈推荐 standard-version 自动 tag，不推荐使用git flow的tag功能</em></strong></p><p><strong>使用<code>git flow</code>自动tag必须保证tag格式<code>standard-version</code>能够识别，<code>standard-version</code>使用<a href="https://github.com/conventional-changelog/conventional-changelog/tree/master/packages/git-semver-tags" target="_blank" rel="noopener">git-semver-tags</a>解析tag，参考<a href="https://github.com/conventional-changelog/conventional-changelog/blob/master/packages/git-semver-tags/test.js" target="_blank" rel="noopener">git-semver-tags支持的格式</a></strong></p><p>如果standard-version识别tag出现遗漏，会造成生成的<code>changelog</code>内容重复。standard-version默认的tag前缀是<code>v</code>，可以自定义。</p></blockquote><ul><li><p><code>standard-version</code>跳过<code>tag</code>方法</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 方法一： package.json添加配置</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">"standard-version"</span>: &#123;</span><br><span class="line">        <span class="string">"skip"</span>: &#123;</span><br><span class="line">            <span class="string">"tag"</span>: <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 方法二：命令行中添加参数</span></span><br><span class="line">standard-version -r minor --skip.tag</span><br></pre></td></tr></table></figure></li><li><p><code>git flow</code>跳过<code>tag</code>的方法</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 跳过tag，并且可以自定义commit message(为了让commit message符合约定提交的格式规范)</span></span><br><span class="line">git flow release finish v0.2.0 -n -m <span class="string">"chore(release): 0.2.0"</span></span><br></pre></td></tr></table></figure></li></ul><h3 id="standard-version运行时机"><a href="#standard-version运行时机" class="headerlink" title="standard-version运行时机"></a><code>standard-version</code>运行时机</h3><ol><li>release 分支流程中运行</li></ol><blockquote><p><code>git flow</code>在<code>release finish</code>阶段是把<code>release/*</code>分支合并到<code>master</code>和<code>develop</code>，所以<code>standard-version</code>就是要在<code>finish</code>结束之前<strong>运行</strong>生成<code>changelog</code>.</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 模拟一个release流程</span></span><br><span class="line">git flow release start v0.2.0</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 做一些修改或者commit</span></span><br><span class="line">git commit -m <span class="string">'fix(src): 修复问题'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. （可选）如果需要在release/* 分支生成beta测试阶段的changelog</span></span><br><span class="line">npx standard-version -p beta</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. release finish 之前</span></span><br><span class="line"><span class="comment"># 强烈推荐 standard-version 自动tag，不推荐使用git flow的tag功能</span></span><br><span class="line">npx standard-version -r v0.2.0</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. 正式发布release，自定义commit message为了符合约定式提交的格式</span></span><br><span class="line">git flow release finish v0.2.0 -m <span class="string">"chore(release): 0.2.0"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果你使用了standard-version的tag功能，git flow应该跳过tag</span></span><br><span class="line"><span class="comment"># git flow release finish v0.2.0 -n -m "chore(release): 0.2.0"</span></span><br></pre></td></tr></table></figure><ol start="2"><li>hotfix分支流程中运行</li></ol><blockquote><p><code>hotfix finish</code>阶段和<code>release</code>非常像是把<code>hotfix/*</code>分支合并到<code>master</code>和<code>develop</code>，<strong>但是是否在<code>hotfix</code>分支生成<code>changelog</code>还需要自行决定（<u><em>有冲突的风险</em></u>）</strong></p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 模拟一个hotfix流程</span></span><br><span class="line">git flow hotfix start v0.2.1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 做一些修改或者commit</span></span><br><span class="line">git commit -m <span class="string">'fix(src): 修复问题'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. hotfix finish 之前</span></span><br><span class="line"><span class="comment"># 强烈推荐 standard-version 自动tag，不推荐使用git flow的tag功能</span></span><br><span class="line">npx standard-version -r v0.2.1 </span><br><span class="line"><span class="comment"># patch版本号可以使用 patch 替代</span></span><br><span class="line"><span class="comment"># npx standard-version -r patch</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 正式发布hotfix，自定义commit message为了符合约定式提交的格式</span></span><br><span class="line">git flow hotfix finish v0.2.1 -m <span class="string">"chore(release): 0.2.1"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果你使用了standard-version的tag功能，git flow应该跳过tag</span></span><br><span class="line"><span class="comment"># git flow hotfix finish v0.2.0 -n -m "chore(release): 0.2.1"</span></span><br></pre></td></tr></table></figure><h3 id="standard-version在git-flow不同流程阶段注意的问题"><a href="#standard-version在git-flow不同流程阶段注意的问题" class="headerlink" title="standard-version在git flow不同流程阶段注意的问题"></a><code>standard-version</code>在<code>git flow</code>不同流程阶段注意的问题</h3><ol><li><p><code>standard-version</code>在<code>release</code>流程中注意事项：</p><ul><li><p>release中生成beta版本的<code>changelog</code></p><blockquote><p>前置条件：</p><ul><li>release 在hotfix之前创建</li><li>hotfix中生成changelog</li><li>release中生成beta版的changelog</li></ul><p>release分支的创建时机很重要，<code>git flow</code>流程中release在<code>hotfix</code>之后创建</p><p>如果创建release分支<strong>之后</strong>，出现并修复hotfix并且在hotfix生成changelog，<code>hotfix finish</code>之后<code>release finish</code>就会造成release合并到master和develop时出现<strong>冲突</strong>.</p><p>解决方案：</p><p>   release 分支包含<code>hotfix</code>内容（release 分支在hotfix之后创建，或者hotfix提取成patch，在release分支上apply）（<strong>git flow流程中hotfix是包含在next release中的</strong>）</p><ul><li>如果有更好的方法请告诉我 ~):</li></ul></blockquote></li></ul></li><li><p><code>standard-version</code>在<code>hotfix</code>流程中注意事项：</p><ul><li><p><code>hotfix</code>中生成changelog</p><blockquote><ul><li>release分支在<code>hotfix finish</code> <strong><em>之前建立</em></strong>，会出现在release分支一样的问题</li></ul></blockquote></li><li><p><code>hotfix</code>分支不生成changelog</p><blockquote><ul><li>release分支在hotfix finish <strong><em>之前建立</em></strong>，会造成<code>hotfix</code>修复的的日志无法出现在changelog中</li></ul></blockquote></li></ul><blockquote><p>解决方法：</p><p>release 分支包含<code>hotfix</code>内容（release 分支在hotfix之后创建，或者hotfix提取成patch，在release分支上apply）</p></blockquote></li><li><p><code>standard-version</code>不带参数使用</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 如果直接在分支上，使用</span></span><br><span class="line">standard-version</span><br></pre></td></tr></table></figure><p>如果不指定参数直接使用<code>standard-version</code>命令，<code>standard-version</code>会自动分析<code>commit message</code>类型，如果包含patch就累加patch，有feat就自动累加minor，有<code>break change</code>就自动生成 major版本号，<strong>风险较大，建议指定参数</strong>。</p></li></ol><h2 id="建议"><a href="#建议" class="headerlink" title="建议"></a>建议</h2><blockquote><p>工具和流程模型都是根据使用场景，灵活多变的，所以不要局限于工具和流程模型，实践出适合自己的流程模型才是最重要的。</p></blockquote><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://nvie.com/posts/a-successful-git-branching-model/" target="_blank" rel="noopener">a-successful-git-branching-model</a></p><p><a href="https://github.com/nvie/gitflow" target="_blank" rel="noopener">原版git flow scripts弃坑状态不建议使用</a></p><p><a href="https://github.com/bobthecow/git-flow-completion" target="_blank" rel="noopener">原版git-flow-completion</a></p><p><a href="https://github.com/petervanderdoes/gitflow-avh" target="_blank" rel="noopener">升级版gitflow-avh</a></p><p><a href="https://github.com/petervanderdoes/git-flow-completion" target="_blank" rel="noopener">升级版git-flow-completion</a></p><p><a href="https://www.conventionalcommits.org/" target="_blank" rel="noopener">约定式提交规范</a></p><p><a href="https://danielkummer.github.io/git-flow-cheatsheet/index.zh_CN.html" target="_blank" rel="noopener">git-flow 备忘清单</a></p><p><a href="https://github.com/devdigital/git-flow-standard-version" target="_blank" rel="noopener">git-flow-standard-version</a></p><p><a href="http://digital-cult.com/releasing-js-library-github-git-flow-conventional-commits/" target="_blank" rel="noopener">git-flow-conventional-commits</a></p><p><a href="http://www.cnblogs.com/cnblogsfans/p/5075073.html" target="_blank" rel="noopener">如何正确使用Git Flow</a></p><p><a href="https://segmentfault.com/q/1010000000430041" target="_blank" rel="noopener">git rebase保持代码树整洁</a></p><p><a href="http://blog.jobbole.com/76847/" target="_blank" rel="noopener">集中式工作流</a></p><p><a href="http://blog.jobbole.com/76857/" target="_blank" rel="noopener">功能分支工作流</a></p><p><a href="http://blog.jobbole.com/76867/" target="_blank" rel="noopener">Gitflow工作流</a></p><p><a href="http://blog.jobbole.com/76861/" target="_blank" rel="noopener">Forking工作流</a></p><p><a href="https://www.atlassian.com/git/tutorials/comparing-workflows" target="_blank" rel="noopener">comparing-workflows</a><br><a href="https://gitversion.readthedocs.io/en/latest/git-branching-strategies/gitflow-examples/" target="_blank" rel="noopener">gitflow-examples</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;前端小纠结–集成gitflow和standard-version使用&quot;&gt;&lt;a href=&quot;#前端小纠结–集成gitflow和standard-version使用&quot; class=&quot;headerlink&quot; title=&quot;前端小纠结–集成gitflow和standard
      
    
    </summary>
    
      <category term="gitflow" scheme="https://betgar.github.io/categories/gitflow/"/>
    
      <category term="fe" scheme="https://betgar.github.io/categories/gitflow/fe/"/>
    
    
      <category term="fe" scheme="https://betgar.github.io/tags/fe/"/>
    
      <category term="gitflow" scheme="https://betgar.github.io/tags/gitflow/"/>
    
      <category term="standard-version" scheme="https://betgar.github.io/tags/standard-version/"/>
    
  </entry>
  
  <entry>
    <title>前端小纠结--约定式提交和自动生成changelog</title>
    <link href="https://betgar.github.io/2019/05/20/frontend-little-tangle-conventional-commit-and-generate-changelog/"/>
    <id>https://betgar.github.io/2019/05/20/frontend-little-tangle-conventional-commit-and-generate-changelog/</id>
    <published>2019-05-20T00:00:00.000Z</published>
    <updated>2019-06-29T13:33:54.756Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前端小纠结–约定式提交和自动生成changelog"><a href="#前端小纠结–约定式提交和自动生成changelog" class="headerlink" title="前端小纠结–约定式提交和自动生成changelog"></a>前端小纠结–约定式提交和自动生成<code>changelog</code></h1><h2 id="约定式提交"><a href="#约定式提交" class="headerlink" title="约定式提交"></a>约定式提交</h2><blockquote><p>约定式提交：每次使用<code>git commit</code> 的时候都需要写<code>commit message</code>,如果message style是按照固定的模版格式书写，对于后期的维护和编写<code>changelog</code>都有巨大的好处。<br>而且现在的很多自动生成<code>changelog</code>的工具，都是建立在<strong>约定式提交</strong>的基础之上。</p></blockquote><h3 id="约定式提交校验配置"><a href="#约定式提交校验配置" class="headerlink" title="约定式提交校验配置"></a>约定式提交校验配置</h3><blockquote><p>约定式提交不需要任何的配置，只需要严格遵守其规范就可以了。<br>为了保证每次提交的<code>commit message</code>都是遵守<code>conventional commit spec</code>所以添加了校验配置.</p></blockquote><h4 id="约定式提交工具"><a href="#约定式提交工具" class="headerlink" title="约定式提交工具"></a>约定式提交工具</h4><blockquote><p>约定式提交使用交互式提交工具（例如： <code>commitizen</code>），使用工具能够保证<code>约定式提交</code>个格式是满足规范的。</p></blockquote><ol><li><p>推荐使用vs code 插件<a href="https://marketplace.visualstudio.com/items?itemName=KnisterPeter.vscode-commitizen" target="_blank" rel="noopener"><code>commitizen</code></a></p></li><li><p>命令行方式的<code>commitizen</code>配置(<code>vscode commitizen</code>和命令行方式任选其一即可)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev commitizen</span><br></pre></td></tr></table></figure></li></ol>   <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// package.json配置</span></span><br><span class="line">&#123;</span><br><span class="line">    scripts: &#123;</span><br><span class="line">        <span class="string">"commit"</span>: <span class="string">"git-cz"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>   <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用</span></span><br><span class="line">npm run commit   <span class="comment"># 进入交互式, 如果commit message在console中换行，请使用'开始</span></span><br></pre></td></tr></table></figure><ol start="3"><li><p><code>commitizen</code>的适配器<code>cz-conventional-changelog</code></p><blockquote><p><code>commitizen</code>只是一个提交的工具，只有添加了约定格式的适配器才能按照固定格式进行交互式提交，<br>否则就和普通的<code>git commit</code>一样了。（还有其他适配器可选，请参考官方文档）<br>不同的适配器，提供的约定标准有差异。</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 建议安装npx这个神器 npm i npx -g</span></span><br><span class="line">npx commitizen init cz-conventional-changelog --save-dev --save-exact</span><br></pre></td></tr></table></figure><blockquote><p><code>commitizen</code>工具会在<code>package.json</code>中自动添加配置：</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"config"</span>: &#123;</span><br><span class="line">        <span class="string">"commitizen"</span>: &#123;</span><br><span class="line">            <span class="comment">// "path": "cz-conventional-changelog" // 全局安装模式</span></span><br><span class="line">            <span class="string">"path"</span>: <span class="string">"./node_modules/cz-conventional-changelog"</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><p>   <img src="https://raw.githubusercontent.com/betgar/betgar.github.io/master/img/picgo/commitizen.jpg" alt="commitizen"></p><h4 id="约定式提交格式校验"><a href="#约定式提交格式校验" class="headerlink" title="约定式提交格式校验"></a>约定式提交格式校验</h4><blockquote><p>为了防止出现不满足格式要求的<code>commit message</code>出现，还是需要添加上必要的格式校验.</p></blockquote><ol><li><p><code>commitlint</code>校验约定式提交格式</p><blockquote><p><code>commitlint</code>是在<code>commit message</code>之前进行校验格式，格式不对不进行提交。</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装</span></span><br><span class="line">npm install --save-dev @commitlint/config-conventional @commitlint/cli</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 添加配置文件commitlint.config.js,工程根目录</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"module.exports = &#123;extends: ['@commitlint/config-conventional']&#125;"</span> &gt; commitlint.config.js</span><br></pre></td></tr></table></figure></li></ol><ol start="2"><li><p><code>husky</code>配置<code>git hooks</code></p><blockquote><p><a href="https://github.com/typicode/husky" target="_blank" rel="noopener">husky官网</a>   <a href="https://github.com/typicode/husky/blob/master/DOCS.md" target="_blank" rel="noopener">husky配置</a></p><p>有了<code>git hooks</code>我们可以做很多提交之前的验证。</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装</span></span><br><span class="line">npm i husky --save-dev</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// package.json 配置</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="string">"husky"</span>: &#123;</span><br><span class="line">    <span class="string">"hooks"</span>: &#123;</span><br><span class="line">      <span class="string">"commit-msg"</span>: <span class="string">"commitlint -E HUSKY_GIT_PARAMS"</span>, <span class="comment">// 配合commitlint使用</span></span><br><span class="line">      <span class="comment">// "pre-commit": "lint-staged" // 配置lint-staged</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><ol start="3"><li><p><code>lint-staged</code>配置(可选)</p><blockquote><p><a href="https://github.com/okonet/lint-staged" target="_blank" rel="noopener">lint-staged</a></p><p><code>list-staged</code>主要配合<code>linter</code>用来格式化代码（统一的代码风格），这部是<strong>可选</strong>的。</p><p><code>lint-staged</code>是用来让格式化工具只<code>lint</code>需要提交的文件，其它文件忽略，这样能够提高效率。</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i lint-staged --save-dev</span><br></pre></td></tr></table></figure></li></ol>   <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// package.json 配置</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">"lint-staged"</span>: &#123;</span><br><span class="line">        <span class="string">"src/**/*.&#123;js,ts,css,vue,tsx,jsx&#125;"</span>: [</span><br><span class="line">            <span class="string">"vue-cli-service lint"</span>, <span class="comment">// npm run lint</span></span><br><span class="line">            <span class="string">"git add"</span></span><br><span class="line">        ]</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="自动生成changelog"><a href="#自动生成changelog" class="headerlink" title="自动生成changelog"></a>自动生成<code>changelog</code></h2><blockquote><p>自动生成<code>changelog</code>是建立在约定式提交的基础上。</p></blockquote><p>自动生成<code>changelog</code>有两种方式：</p><ol><li><p><code>conventional-changelog-cli</code>生成<code>changelog</code></p></li><li><p><code>standard-version</code>生成<code>changelog</code></p><blockquote><p><code>standard-version</code>帮你做了自动打tag，自动生成<code>changelog</code>等过程.</p></blockquote></li></ol><h3 id="conventional-changelog-cli配置"><a href="#conventional-changelog-cli配置" class="headerlink" title="conventional-changelog-cli配置"></a><code>conventional-changelog-cli</code>配置</h3><blockquote><p>在约定式提交的基础上来自动生成<code>changelog</code>，工具类库开发，推荐直接使用<code>standard-version</code>，高度集成了所有东西。</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install conventional-changelog-cli --save-dev</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 基本使用，其它参数参考官方网站</span></span><br><span class="line">conventional-changelog -p angular -i CHANGELOG.md -s -r 0</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// package.json配置</span></span><br><span class="line">&#123;</span><br><span class="line">    scripts: &#123;</span><br><span class="line">        <span class="string">"changelog"</span>: <span class="string">"conventional-changelog -p angular -i CHANGELOG.md -s -r 0 &amp;&amp; git add CHANGELOG.md"</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用</span></span><br><span class="line">npm run changelog</span><br></pre></td></tr></table></figure><h3 id="standard-version配置"><a href="#standard-version配置" class="headerlink" title="standard-version配置"></a><code>standard-version</code>配置</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装</span></span><br><span class="line">npm install standard-version --save-dev</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// package.json 配置</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">"scripts"</span>: &#123;</span><br><span class="line">        <span class="string">"release"</span>: <span class="string">"standard-version"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// standard-version 好多配置看官方文档（可选）</span></span><br><span class="line">    <span class="string">"standard-version"</span>: &#123;</span><br><span class="line">        <span class="comment">// 可以配置不需要的环节</span></span><br><span class="line">        <span class="string">"skip"</span>: &#123;</span><br><span class="line">           <span class="comment">// bump, changelog, commit, tag</span></span><br><span class="line">          <span class="string">"tag"</span>: <span class="literal">true</span></span><br><span class="line">       &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 项目根目录下使用，自行安装npx 模块</span></span><br><span class="line"><span class="comment"># npm i npx -g </span></span><br><span class="line">npx standard-version --release-as major</span><br><span class="line">npx standard-version --release-as minor</span><br><span class="line">npx standard-version --release-as patch</span><br><span class="line"></span><br><span class="line">npx standard-version --prerelease alpha</span><br><span class="line">npx standard-version --prerelease beta</span><br><span class="line">npx standard-version --prerelease rc</span><br><span class="line"></span><br><span class="line">npm run release -- -r minor</span><br><span class="line">npm run release -- -p beta</span><br></pre></td></tr></table></figure><h2 id="package-json中的scripts命令组织"><a href="#package-json中的scripts命令组织" class="headerlink" title="package.json中的scripts命令组织"></a><code>package.json</code>中的<strong>scripts</strong>命令组织</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    scripts: &#123;</span><br><span class="line">        <span class="string">"commit"</span>: <span class="string">"git-cz"</span>,</span><br><span class="line">        <span class="string">"release"</span>: <span class="string">"standard-version"</span>,</span><br><span class="line">         <span class="string">"changelog"</span>: <span class="string">"conventional-changelog -p angular -i CHANGELOG.md -s -r 0 &amp;&amp; git add CHANGELOG.md"</span>,</span><br><span class="line">        <span class="string">"release:major"</span>: <span class="string">"standard-version -r major -n,</span></span><br><span class="line"><span class="string">        "</span>release:minor<span class="string">": "</span>standard-version -r minor -n,</span><br><span class="line">        <span class="string">"release:patch"</span>: <span class="string">"standard-version -r patch -n"</span>,</span><br><span class="line">        <span class="string">"prerelease:alpha"</span>: <span class="string">"standard-version -p alpha -n,</span></span><br><span class="line"><span class="string">        "</span>prerelease:beta<span class="string">": "</span>standard-version -p beta -n,</span><br><span class="line">        <span class="string">"prerelease:rc"</span>: <span class="string">"standard-version -p rc -n"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://www.conventionalcommits.org/" target="_blank" rel="noopener">约定式提交规范</a></p><p><a href="http://www.imziv.com/blog/article/read.htm?id=91" target="_blank" rel="noopener">git commit 、CHANGELOG 和版本发布的标准自动化</a></p><p><a href="http://www.ruanyifeng.com/blog/2016/01/commit_message_change_log.html" target="_blank" rel="noopener">Commit message 和 Change log 编写指南</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;前端小纠结–约定式提交和自动生成changelog&quot;&gt;&lt;a href=&quot;#前端小纠结–约定式提交和自动生成changelog&quot; class=&quot;headerlink&quot; title=&quot;前端小纠结–约定式提交和自动生成changelog&quot;&gt;&lt;/a&gt;前端小纠结–约定式提交
      
    
    </summary>
    
      <category term="git" scheme="https://betgar.github.io/categories/git/"/>
    
      <category term="fe" scheme="https://betgar.github.io/categories/git/fe/"/>
    
    
      <category term="git" scheme="https://betgar.github.io/tags/git/"/>
    
      <category term="conventionalcommit" scheme="https://betgar.github.io/tags/conventionalcommit/"/>
    
      <category term="fe" scheme="https://betgar.github.io/tags/fe/"/>
    
  </entry>
  
  <entry>
    <title>shell上显示当前git分支</title>
    <link href="https://betgar.github.io/2019/04/29/terminal-prompt-display-what-branch-you-are-currently-on/"/>
    <id>https://betgar.github.io/2019/04/29/terminal-prompt-display-what-branch-you-are-currently-on/</id>
    <published>2019-04-28T16:00:00.000Z</published>
    <updated>2019-06-29T13:33:54.755Z</updated>
    
    <content type="html"><![CDATA[<h1 id="shell上显示当前git分支"><a href="#shell上显示当前git分支" class="headerlink" title="shell上显示当前git分支"></a>shell上显示当前git分支</h1><blockquote><p>在当前终端上显示当前所在的分支，能够提供极大的便利。</p></blockquote><h2 id="修改bash的配置"><a href="#修改bash的配置" class="headerlink" title="修改bash的配置"></a>修改<code>bash</code>的配置</h2><blockquote><p><code>~/.bash_profile</code> 或者<code>~/.bashrc</code></p></blockquote><h3 id="原版"><a href="#原版" class="headerlink" title="原版"></a>原版</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">function</span> git-branch-name &#123;</span><br><span class="line">  git symbolic-ref HEAD 2&gt;/dev/null | cut -d<span class="string">"/"</span> -f 3</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> git-branch-prompt &#123;</span><br><span class="line">  <span class="built_in">local</span> branch=`git-branch-name`</span><br><span class="line">  <span class="keyword">if</span> [ <span class="variable">$branch</span> ]; <span class="keyword">then</span> <span class="built_in">printf</span> <span class="string">" [%s]"</span> <span class="variable">$branch</span>; <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line">PS1=<span class="string">"\u@\h \[\033[0;36m\]\W\[\033[0m\]\[\033[0;32m\]\$(git-branch-prompt)\[\033[0m\] \$ "</span></span><br></pre></td></tr></table></figure><h3 id="修改版"><a href="#修改版" class="headerlink" title="修改版"></a>修改版</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># terminal-prompt-display-what-branch-you-are-currently-on</span></span><br><span class="line"><span class="keyword">function</span> git-branch-name &#123;</span><br><span class="line">  git symbolic-ref --short -q HEAD 2&gt;/dev/null</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> git-branch-prompt &#123;</span><br><span class="line">  <span class="built_in">local</span> branch=`git-branch-name`</span><br><span class="line">  <span class="keyword">if</span> [ <span class="variable">$branch</span> ]; <span class="keyword">then</span> <span class="built_in">printf</span> <span class="string">" [%s]"</span> <span class="variable">$branch</span>; <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line">PS1=<span class="string">"\u@\h \[\033[0;36m\]\W\[\033[0m\]\[\033[0;32m\]\$(git-branch-prompt)\[\033[0m\] \$ "</span></span><br></pre></td></tr></table></figure><blockquote><p>把上面的脚步添加到shell配置文件中。</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 加载一下配置文件，使之生效</span></span><br><span class="line"><span class="built_in">source</span> ~/.bash_profile </span><br><span class="line"><span class="comment"># source ~/.bashrc</span></span><br></pre></td></tr></table></figure><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="http://thelucid.com/2008/12/02/git-setting-up-a-remote-repository-and-doing-an-initial-push/" target="_blank" rel="noopener">git-setting-up-a-remote-repository-and-doing-an-initial-push</a></p><p><a href="https://www.jianshu.com/p/82783f76a868" target="_blank" rel="noopener">让 Shell 命令提示符显示 Git 分支名称</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;shell上显示当前git分支&quot;&gt;&lt;a href=&quot;#shell上显示当前git分支&quot; class=&quot;headerlink&quot; title=&quot;shell上显示当前git分支&quot;&gt;&lt;/a&gt;shell上显示当前git分支&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;在当前终端
      
    
    </summary>
    
      <category term="git" scheme="https://betgar.github.io/categories/git/"/>
    
    
      <category term="git" scheme="https://betgar.github.io/tags/git/"/>
    
  </entry>
  
  <entry>
    <title>axios实现文件下载功能</title>
    <link href="https://betgar.github.io/2019/04/14/download-binary-file-use-axios/"/>
    <id>https://betgar.github.io/2019/04/14/download-binary-file-use-axios/</id>
    <published>2019-04-14T10:30:00.000Z</published>
    <updated>2019-04-14T02:54:37.587Z</updated>
    
    <content type="html"><![CDATA[<h1 id="axios实现文件下载功能"><a href="#axios实现文件下载功能" class="headerlink" title="axios实现文件下载功能"></a><code>axios</code>实现文件下载功能</h1><blockquote><p>在开发中遇到了需要实现文件下载的功能，起初以为只用<code>&lt;a&gt;</code>标签就能搞定，<code>&lt;a&gt;</code>标签确实能够搞定常见的场景。但是像<strong>导出</strong>或者在<code>header</code>里面添加了特殊字段的时候，使用<code>&lt;a&gt;</code>标签就搞不定了，又不想去使用原生<code>XMLHttpRequest</code>，因为又一堆的兼容性需求（技术能力不够ε=ε=ε=┏(゜ロ゜;)┛，有现成的兼容方案为啥要自己造轮子呢，说不定还爆胎&gt;逃666），所以萌生基于<code>Axios</code>封装。</p></blockquote><h2 id="Ajax无法下载文件的原因"><a href="#Ajax无法下载文件的原因" class="headerlink" title="Ajax无法下载文件的原因"></a>Ajax无法下载文件的原因</h2><p>浏览器的GET(frame、a)和POST(form)请求具有如下特点：</p><ul><li>response会交由浏览器处理</li><li>response内容可以为二进制文件、字符串等</li></ul><p>Ajax请求具有如下特点：</p><ul><li>response会交由Javascript处理</li><li>response内容仅可以为字符串</li></ul><p>Ajax本身设计的目标就是用来获取<strong>文本数据</strong>的，而不是用来搞二进制的。</p><h2 id="XMLHttpRequest-2-0新增的数据类型Blob"><a href="#XMLHttpRequest-2-0新增的数据类型Blob" class="headerlink" title="XMLHttpRequest 2.0新增的数据类型Blob"></a><code>XMLHttpRequest 2.0</code>新增的数据类型<code>Blob</code></h2><blockquote><p>看张老师的文章 <a href="https://www.zhangxinxu.com/wordpress/2013/10/understand-domstring-document-formdata-blob-file-arraybuffer/" target="_blank" rel="noopener">理解DOMString、Document、FormData、Blob、File、ArrayBuffer数据类型</a></p></blockquote><p>有了<code>Blob</code>类型之后，JavaScript处理二进制进一步增强，可以说以后想怎样就怎样（废话）。</p><h2 id="文件下载实现"><a href="#文件下载实现" class="headerlink" title="文件下载实现"></a>文件下载实现</h2><h3 id="response-header前提条件"><a href="#response-header前提条件" class="headerlink" title="response header前提条件"></a>response header前提条件</h3><blockquote><p>服务端返回的头部需要设置</p><p>Content-Disposition: “attachment; filename=xxxx.docx;”</p></blockquote><h3 id="lt-a-gt-标签的直接下载"><a href="#lt-a-gt-标签的直接下载" class="headerlink" title="&lt;a&gt;标签的直接下载"></a><code>&lt;a&gt;</code>标签的直接下载</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> qs <span class="keyword">from</span> <span class="string">'qs'</span>;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * downloadByUrl</span></span><br><span class="line"><span class="comment"> * @param config - 配置参数</span></span><br><span class="line"><span class="comment"> * @param config.url - 地址</span></span><br><span class="line"><span class="comment"> * @param config.params - querystring参数.</span></span><br><span class="line"><span class="comment"> * @param filename 文件名称,包括扩展名部分(不一定生效)</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * @description</span></span><br><span class="line"><span class="comment"> * 原理是使用&lt;a&gt;的href和download属性，所以filename不一定会生效, 浏览器机制问题.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * @see https://zhuanlan.zhihu.com/p/58888918</span></span><br><span class="line"><span class="comment"> * @see https://github.com/kennethjiang/js-file-download</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">downloadByUrl</span>(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">config: &#123;</span></span></span><br><span class="line"><span class="function"><span class="params">    url: <span class="built_in">string</span>;</span></span></span><br><span class="line"><span class="function"><span class="params">    params: <span class="built_in">any</span>;</span></span></span><br><span class="line"><span class="function"><span class="params">&#125;,</span></span></span><br><span class="line">  filename = ''</span><br><span class="line">): <span class="built_in">void</span> &#123;</span><br><span class="line">  <span class="keyword">var</span> tempLink = <span class="built_in">document</span>.createElement(<span class="string">'a'</span>);</span><br><span class="line">  tempLink.style.display = <span class="string">'none'</span>;</span><br><span class="line">  tempLink.href =</span><br><span class="line">    config.url + qs.stringify(config.params, &#123; addQueryPrefix: <span class="literal">true</span> &#125;);</span><br><span class="line">  tempLink.setAttribute(<span class="string">'download'</span>, filename);</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> tempLink.download === <span class="string">'undefined'</span>) &#123;</span><br><span class="line">    tempLink.setAttribute(<span class="string">'target'</span>, <span class="string">'_blank'</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">document</span>.body.appendChild(tempLink);</span><br><span class="line">  tempLink.click();</span><br><span class="line">  <span class="built_in">document</span>.body.removeChild(tempLink);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>主要是使用了<code>js-file-download</code>的代码，进行了简单的封装，而且去除了对<code>Blob</code>的依赖，主要为了兼容低版本的浏览器。同时使用了<code>qs</code>对<code>querystring</code>参数进行了简单的处理。</p></blockquote><h3 id="基于axios的实现"><a href="#基于axios的实现" class="headerlink" title="基于axios的实现"></a>基于<code>axios</code>的实现</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios, &#123; AxiosResponse, AxiosRequestConfig &#125; <span class="keyword">from</span> <span class="string">'axios'</span>;</span><br><span class="line"><span class="keyword">import</span> fileDownload <span class="keyword">from</span> <span class="string">'js-file-download'</span>;</span><br><span class="line"><span class="keyword">import</span> logger <span class="keyword">from</span> <span class="string">'js-logger'</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 提取文件名.</span></span><br><span class="line"><span class="comment"> * @param response axios的response</span></span><br><span class="line"><span class="comment"> * @description 从reponse header的content-disposition中提取文件名.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> extractFilenameFromResponseHeader = (response: AxiosResponse): <span class="function"><span class="params">string</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// content-disposition: "attachment; filename=xxxx.docx;"</span></span><br><span class="line">  <span class="keyword">const</span> contentDisposition = response.headers[<span class="string">'content-disposition'</span>];</span><br><span class="line">  <span class="keyword">const</span> patt = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">'filename=([^;]+\\.[^\\.;]+);*'</span>);</span><br><span class="line">  <span class="keyword">const</span> result = patt.exec(contentDisposition) <span class="keyword">as</span> RegExpExecArray;</span><br><span class="line">  <span class="keyword">let</span> filename = <span class="string">''</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (result) &#123;</span><br><span class="line">    filename = result.length &gt; <span class="number">0</span> ? result[<span class="number">1</span>] : <span class="string">''</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 解码之前尝试去除空格和双引号</span></span><br><span class="line">  <span class="comment">// content-disposition: "attachment; filename=\"xxxx.docx\";"</span></span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">decodeURIComponent</span>(filename.trim().replace(<span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">'"'</span>, <span class="string">'g'</span>), <span class="string">''</span>));</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> axiosInstance = axios.create(&#123;<span class="comment">/* </span></span><br><span class="line"><span class="comment">可以传递公共默认的axios配置，但是注意reponse interceptor中默认把reponse.data作为JSON解析的情况</span></span><br><span class="line"><span class="comment">*/</span>&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// https://www.zhihu.com/question/263323250</span></span><br><span class="line"><span class="comment">// https://github.com/axios/axios/issues/815#issuecomment-340972365</span></span><br><span class="line"><span class="keyword">const</span> downloadByAxios = <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">  config: AxiosRequestConfig,</span></span></span><br><span class="line">  filename = ''</span><br><span class="line">): <span class="built_in">Promise</span>&lt;<span class="built_in">any</span> | AxiosResponse&lt;<span class="built_in">any</span>&gt;&gt; &#123;</span><br><span class="line">  <span class="keyword">let</span> response = <span class="keyword">await</span> axiosInstance(&#123;</span><br><span class="line">    ...config,</span><br><span class="line">    responseType: <span class="string">'blob'</span>, <span class="comment">// 指定类型</span></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> resBlob = response.data; <span class="comment">// &lt;--- store the blob if it is</span></span><br><span class="line">  <span class="keyword">let</span> respData = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 如果确定接口response.data是二进制，所以请求失败时是JSON.</span></span><br><span class="line">  <span class="comment">// 这里只对response.data做JSON的尝试解析</span></span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> respText = <span class="keyword">await</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">let</span> reader = <span class="keyword">new</span> FileReader();</span><br><span class="line">      reader.addEventListener(<span class="string">'abort'</span>, reject);</span><br><span class="line">      reader.addEventListener(<span class="string">'error'</span>, reject);</span><br><span class="line">      reader.addEventListener(<span class="string">'loadend'</span>, <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        resolve(reader.result <span class="keyword">as</span> <span class="built_in">string</span>);</span><br><span class="line">      &#125;);</span><br><span class="line">      reader.readAsText(resBlob);</span><br><span class="line">    &#125;);</span><br><span class="line">    respData = <span class="built_in">JSON</span>.parse(respText <span class="keyword">as</span> <span class="built_in">string</span>); <span class="comment">// &lt;--- try to parse as json evantually</span></span><br><span class="line">  &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">    <span class="comment">// ignore</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 如果response.data能够确定是二进制，则respData = null说明请求成功</span></span><br><span class="line">  <span class="comment">// 否则 respData !== null说明请求失败</span></span><br><span class="line">  <span class="keyword">if</span> (respData <span class="keyword">as</span> ResponseData) &#123;</span><br><span class="line">    logger.error(respData);</span><br><span class="line">      </span><br><span class="line">    <span class="comment">// 方便调用者有进一步的 then().catch()处理</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(&#123;</span><br><span class="line">      ...respData,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 触发浏览器下载</span></span><br><span class="line">    <span class="comment">// 如果没有传递filename尝试从Content-Disposition提取</span></span><br><span class="line">    fileDownload(resBlob, filename || extractFilenameFromResponseHeader(</span><br><span class="line">      response</span><br><span class="line">    ));</span><br><span class="line">    <span class="comment">// 方便调用者有进一步的 then().catch()处理</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.resolve(&#123;</span><br><span class="line">      ...response,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><blockquote><p>代码大部分都是参考这个<a href="https://github.com/axios/axios/issues/815#issuecomment-340972365" target="_blank" rel="noopener">issue</a>实现的，只有少部分的个人代码。</p></blockquote><p>基于<code>axios</code>实现的功能：</p><ol><li>可以使用<code>axios</code>的所有参数，不管请求是<code>GET</code>或者<code>POST</code></li><li>解决了在<code>header</code>中添加额外的参数的需求</li><li>可以指定<code>filename</code>，如果服务端没有设置<code>content-disposition</code>的情况</li><li>返回<code>Promise</code>方便调用者进一步处理请求</li></ol><p>缺点：</p><ol><li><p>只能使用独立的<code>axios</code>实例，不能公用一个<code>axios</code></p><blockquote><p>本来想把<strong>下载功能</strong>使用<code>axios interceptor</code>拦截器实现，但是返回的<code>response.data</code>是<code>Blob</code>二进制，但是其它的<code>response interceptor</code>默认前提都是把<code>response.data</code>当作<code>JSON</code>处理，导致全部出现异常，所以把下载功能独立出来，更方便维护。</p></blockquote></li><li>使用独立的<code>axios</code>实例，所以项目中的<code>axios</code>默认配置需要重新配置一遍</li></ol><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Content-Disposition" target="_blank" rel="noopener">Content-Disposition</a></p><p><a href="https://www.zhihu.com/question/263323250" target="_blank" rel="noopener">axios.js实现下载功能</a></p><p><a href="https://github.com/axios/axios/issues/815#issuecomment-340972365" target="_blank" rel="noopener">axios.js #815实现</a></p><p><a href="https://github.com/jimmywarting/StreamSaver.js" target="_blank" rel="noopener">StreamSaver</a></p><p><a href="https://github.com/eligrey/FileSaver.js/" target="_blank" rel="noopener">FileSaver</a></p><p><a href="https://github.com/kennethjiang/js-file-download" target="_blank" rel="noopener">js-file-download</a><br><a href="https://www.zhangxinxu.com/wordpress/2013/10/understand-domstring-document-formdata-blob-file-arraybuffer/" target="_blank" rel="noopener">理解DOMString、Document、FormData、Blob、File、ArrayBuffer数据类型</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;axios实现文件下载功能&quot;&gt;&lt;a href=&quot;#axios实现文件下载功能&quot; class=&quot;headerlink&quot; title=&quot;axios实现文件下载功能&quot;&gt;&lt;/a&gt;&lt;code&gt;axios&lt;/code&gt;实现文件下载功能&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;
      
    
    </summary>
    
      <category term="axios" scheme="https://betgar.github.io/categories/axios/"/>
    
    
      <category term="axios" scheme="https://betgar.github.io/tags/axios/"/>
    
  </entry>
  
  <entry>
    <title>windows 10使用cygwin安装openssh服务端</title>
    <link href="https://betgar.github.io/2019/04/05/install-openssh-with-cygwin-on-windows-10/"/>
    <id>https://betgar.github.io/2019/04/05/install-openssh-with-cygwin-on-windows-10/</id>
    <published>2019-04-05T01:00:00.000Z</published>
    <updated>2019-04-06T01:56:44.443Z</updated>
    
    <content type="html"><![CDATA[<h1 id="windows-10使用cygwin安装openssh服务端"><a href="#windows-10使用cygwin安装openssh服务端" class="headerlink" title="windows 10使用cygwin安装openssh服务端"></a>windows 10使用cygwin安装openssh服务端</h1><blockquote><p>install-openssh-with-cygwin-on-windows-10</p></blockquote><p>本来windows10上已经有内置的<code>openssh</code>，我可能爱折腾不愿意使用内置的，所以使用<code>cygwin</code>重新安装了一个ssh服务.</p><h2 id="安装步骤总结"><a href="#安装步骤总结" class="headerlink" title="安装步骤总结"></a>安装步骤总结</h2><ol><li>安装cygwin</li><li>使用<strong>管理员权限</strong>运行cygwin安装<code>openssh</code>和<code>openssl</code></li><li>ssh-host-config命令开始配置ssh</li><li>windows10内置的<code>sshd</code>和<code>ssh-host-config</code>默认的服务名冲突解决</li><li>一系列ssh-host-config配置，包括daemon名称 <code>ntsec</code>和创建默认的<code>cyg_server</code>来运行<code>sshd</code>服务</li><li>ssh-user-config生成用户的密钥（非必须，可以使用密码登陆，用户就是windows的正常用户）</li><li>启动服务<code>net start cygsshd</code></li><li>使用putty登陆localhost测试</li><li>卸载<code>ssh</code></li><li>重新安装<code>ssh</code></li></ol><blockquote><p>注意：cygwin使用的是windows的用户和权限，所以默认<code>/etc/</code>下是没用<code>passwd</code>和<code>group</code>等文件的，不要太惊讶。</p><p>开始我也没用搞明白，而且<code>ssh-host-config</code>中创建一个<code>cyg_server</code>用户是真实的windows账户，但是需要<strong>组策略</strong>才能够看到，这个用户用来启动<code>sshd</code>服务的，而且不能用来登陆windows，因为是一个令牌用户，在<strong>组策略&gt;计算机配置&gt;windows配置&gt;安全设置&gt;本地策略&gt;用户权限分配&gt; 创建一个令牌对象</strong>中看到。</p></blockquote><h2 id="cygwin安装openssh和openssl"><a href="#cygwin安装openssh和openssl" class="headerlink" title="cygwin安装openssh和openssl"></a>cygwin安装openssh和openssl</h2><p>假设你已经安装了<code>cygwin</code>，使用cygwin安装openssh和openssl详情看参考:</p><p><a href="https://www.howtogeek.com/howto/41560/how-to-get-ssh-command-line-access-to-windows-7-using-cygwin/" target="_blank" rel="noopener">how-to-get-ssh-command-line-access-to-windows-7-using-cygwin/</a></p><h3 id="修复sshd-service-is-already-installed"><a href="#修复sshd-service-is-already-installed" class="headerlink" title="修复sshd service is already installed."></a>修复sshd service is already installed.</h3><blockquote><p>警告：<strong>sshd service is already installed.</strong></p></blockquote><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/img/2019-04-05-install-openssh-with-cygwin-on-windows-10/sshd-service-installed-error.png" alt="sshd-service-installed-error" title="">                </div>                <div class="image-caption">sshd-service-installed-error</div>            </figure><p><img src="/img/2019-04-05-install-openssh-with-cygwin-on-windows-10/windows10-build-in-openssh.png" alt="windows10-build-in-openssh"></p><blockquote><p>出现sshd service is already installed.的问题是因为windows 10内置了一个openssh，造成了冲突，现在只需要修改cygwin安装的openssh中的默认的sshd服务名称。</p></blockquote><h3 id="修改默认的sshd服务名"><a href="#修改默认的sshd服务名" class="headerlink" title="修改默认的sshd服务名"></a>修改默认的sshd服务名</h3><p>路径: <code>C:/cygwin64/bin/sshd-host-config</code> (32位的有所区别，找不到用everything搜索一下啊)</p><p>修改: service_name=sshd 为 service_name=cygsshd   (cygsshd自定义的)</p><p>修改完之后重新执行<code>ssh-host-config</code>,上面的问题解决.</p><p>下面是运行中的截图.</p><p><img src="/img/2019-04-05-install-openssh-with-cygwin-on-windows-10/ssh-host-config.png" alt="ssh-host-config"></p><p><img src="/img/2019-04-05-install-openssh-with-cygwin-on-windows-10/sshd-as-service-ntsec.png" alt="sshd-as-service-ntsec"></p><p>建议使用默认的<code>cyg_server</code>，没用必要重新自定义，我当时也是好奇，搞得走了很多弯路。</p><p><img src="/img/2019-04-05-install-openssh-with-cygwin-on-windows-10/config-user-name-password.png" alt="config-user-name-password"></p><h2 id="启动服务"><a href="#启动服务" class="headerlink" title="启动服务"></a>启动服务</h2><blockquote><p>也可以重启一下系统，服务会自动启动</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">net start cygsshd  <span class="comment"># cygsshd是自定义的service_name</span></span><br><span class="line"><span class="comment"># 或者使用cygwin运行</span></span><br><span class="line">cygrunsrv -S cygsshd</span><br></pre></td></tr></table></figure><h2 id="ssh-user-config"><a href="#ssh-user-config" class="headerlink" title="ssh-user-config"></a>ssh-user-config</h2><blockquote><p>选择生成用户的<code>RSA</code>口令就行了，<code>RSA</code>比较常用，其它的不是很常用。</p></blockquote><h2 id="卸载ssh服务"><a href="#卸载ssh服务" class="headerlink" title="卸载ssh服务"></a>卸载ssh服务</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 删除sshd服务, sshd时默认的服务名，如果你定义了，输入你的服务名</span></span><br><span class="line">cygrunsrv --stop sshd</span><br><span class="line">cygrunsrv --remove sshd</span><br><span class="line"></span><br><span class="line"><span class="comment"># Delete any sshd or related users (such as cyg_server) from /etc/passwd</span></span><br><span class="line"><span class="comment">#   (use your favorite editor)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Delete any sshd or related users (such as cyg_server) from the system</span></span><br><span class="line"><span class="comment"># 这里删除的是windows上的用户</span></span><br><span class="line">net user sshd /delete</span><br><span class="line"><span class="comment"># 如果ssh-host-config配置过程中没用使用cyg_server，请替换为你自定义的名字</span></span><br><span class="line">net user cyg_server /delete</span><br></pre></td></tr></table></figure><h2 id="重装ssh重新设置权限"><a href="#重装ssh重新设置权限" class="headerlink" title="重装ssh重新设置权限"></a>重装ssh重新设置权限</h2><blockquote><p>如果设置权限不行，删除sshd.log和empty文件夹.</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">chown &lt;USERNAME&gt; /var/<span class="built_in">log</span>/sshd.log</span><br><span class="line">chown -R &lt;USERNAME&gt; /var/empty</span><br><span class="line">chown &lt;USERNAME&gt; /etc/ssh*</span><br><span class="line">chmod 755 /var/empty</span><br><span class="line">chmod 644 /var/<span class="built_in">log</span>/sshd.log</span><br></pre></td></tr></table></figure><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://docs.oracle.com/cd/E24628_01/install.121/e22624/preinstall_req_cygwin_ssh.htm#EMBSC243" target="_blank" rel="noopener">Installing Cygwin and Starting the SSH Daemon</a></p><p><a href="https://www.howtogeek.com/howto/41560/how-to-get-ssh-command-line-access-to-windows-7-using-cygwin/" target="_blank" rel="noopener">how-to-get-ssh-command-line-access-to-windows-7-using-cygwin/</a></p><p><a href="https://microtechnology-services.github.io/2016/04/29/cygwin-sshd-on-windows-domain.html" target="_blank" rel="noopener">cygwin-sshd-on-windows-domain</a></p><p><a href="https://mike42.me/blog/how-to-regenerate-ssh-client-keys" target="_blank" rel="noopener">how-to-regenerate-ssh-client-keys</a></p><p><a href="https://cygwin.com/cygwin-ug-net/mkpasswd.html" target="_blank" rel="noopener">mkpasswd</a></p><p><a href="https://cygwin.com/cygwin-ug-net/mkgroup.html" target="_blank" rel="noopener">mkgroup</a></p><p><a href="https://superuser.com/questions/110726/how-to-uninstall-reinstall-cygwin-to-use-the-sshd" target="_blank" rel="noopener">how-to-uninstall-reinstall-cygwin-to-use-the-sshd</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;windows-10使用cygwin安装openssh服务端&quot;&gt;&lt;a href=&quot;#windows-10使用cygwin安装openssh服务端&quot; class=&quot;headerlink&quot; title=&quot;windows 10使用cygwin安装openssh服务端&quot;&gt;
      
    
    </summary>
    
      <category term="openssh" scheme="https://betgar.github.io/categories/openssh/"/>
    
      <category term="cygwin" scheme="https://betgar.github.io/categories/openssh/cygwin/"/>
    
    
      <category term="openssh" scheme="https://betgar.github.io/tags/openssh/"/>
    
      <category term="cygwin" scheme="https://betgar.github.io/tags/cygwin/"/>
    
  </entry>
  
  <entry>
    <title>deepin安装之后分配swap空间</title>
    <link href="https://betgar.github.io/2019/03/13/allocation-swap-partition-on-deepin-linux/"/>
    <id>https://betgar.github.io/2019/03/13/allocation-swap-partition-on-deepin-linux/</id>
    <published>2019-03-12T23:00:00.000Z</published>
    <updated>2019-06-29T13:33:54.753Z</updated>
    
    <content type="html"><![CDATA[<h1 id="deepin安装之后分配swap空间"><a href="#deepin安装之后分配swap空间" class="headerlink" title="deepin安装之后分配swap空间"></a>deepin安装之后分配swap空间</h1><p><a href="https://bbs.deepin.org/forum.php?mod=viewthread&amp;tid=44517&amp;page=1#pid264124" target="_blank" rel="noopener">参考这里的文章做个记录</a></p><p>增加swap文件作为空间，五步：</p><ol><li><p>第一步：成为超级用户；</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo su</span><br></pre></td></tr></table></figure></li><li><p>第二步：在根目录生成swap文件,count设定块数,bs设定块大小,生成4G的swap代码如下</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dd <span class="keyword">if</span>=/dev/zero of=/swapfile count=4096 bs=1024k</span><br></pre></td></tr></table></figure></li><li><p>第三步：设置交换分区，注意路径和上面的of=/swapfile的一致</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkswap /swapfile</span><br></pre></td></tr></table></figure></li></ol><ol start="4"><li><p>第四步：挂载交换分区，注意swap文件路径</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">swapon /swapfile</span><br></pre></td></tr></table></figure></li><li><p>第五步：开机自动挂载swap文件：</p><ul><li><p>1、用编辑器打开fstab文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/fstab</span><br></pre></td></tr></table></figure></li><li><p>2、在后面追加以下内容（注意swap文件路径）</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#开机挂载交换分区 </span></span><br><span class="line">/swapfile          swap                 swap    defaults 0 0</span><br></pre></td></tr></table></figure></li></ul></li><li><p>打开深度系统监视器查看一下是否生效了。</p></li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;deepin安装之后分配swap空间&quot;&gt;&lt;a href=&quot;#deepin安装之后分配swap空间&quot; class=&quot;headerlink&quot; title=&quot;deepin安装之后分配swap空间&quot;&gt;&lt;/a&gt;deepin安装之后分配swap空间&lt;/h1&gt;&lt;p&gt;&lt;a hre
      
    
    </summary>
    
      <category term="linux" scheme="https://betgar.github.io/categories/linux/"/>
    
      <category term="deepin" scheme="https://betgar.github.io/categories/linux/deepin/"/>
    
    
      <category term="linux" scheme="https://betgar.github.io/tags/linux/"/>
    
      <category term="deepin" scheme="https://betgar.github.io/tags/deepin/"/>
    
  </entry>
  
  <entry>
    <title>npm私有仓库verdaccio的部署</title>
    <link href="https://betgar.github.io/2019/03/09/deploy-private-npm-registry-verdaccio/"/>
    <id>https://betgar.github.io/2019/03/09/deploy-private-npm-registry-verdaccio/</id>
    <published>2019-03-09T03:00:00.000Z</published>
    <updated>2019-03-09T13:44:59.479Z</updated>
    
    <content type="html"><![CDATA[<h1 id="verdaccio"><a href="#verdaccio" class="headerlink" title="verdaccio"></a>verdaccio</h1><blockquote><p><strong>因为技术变革太快，注意知识的时效性。</strong></p><p><code>verdaccio</code>是基于<code>node</code>开发的一个库，用来搭建私有的<code>npm</code>仓库。因为<code>npm</code>仓库大多数是公有的免费的，私有仓库或者企业版是收费的，在单位内部或者个人一些私有的模块需要托管的时候就需要自己搭建一个私有的仓库，而<code>verdaccio</code>就是选择之一，最便捷的一种。</p></blockquote><h2 id="安装verdaccio"><a href="#安装verdaccio" class="headerlink" title="安装verdaccio"></a>安装verdaccio</h2><blockquote><p>参照<a href="https://verdaccio.org/docs/zh-CN/installation" target="_blank" rel="noopener">官方文档</a>，而且是中文版哟~~~。</p><p><strong>注意：</strong> <code>node.js</code>的版本要求</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 全局安装</span></span><br><span class="line">npm i -g verdaccio</span><br><span class="line"></span><br><span class="line"><span class="comment"># 启动</span></span><br><span class="line">verdaccio </span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用forever或者pm2能够启动verdaccio到后台</span></span><br><span class="line"><span class="comment"># 后台运行</span></span><br><span class="line">forever start `<span class="built_in">which</span> verdaccio`</span><br><span class="line"><span class="comment"># 或者</span></span><br><span class="line">pm2 start <span class="built_in">which</span> verdaccio</span><br></pre></td></tr></table></figure><h2 id="配置verdaccio"><a href="#配置verdaccio" class="headerlink" title="配置verdaccio"></a>配置verdaccio</h2><blockquote><p>配置文件路径参考：<a href="https://verdaccio.org/docs/zh-CN/cli" target="_blank" rel="noopener">https://verdaccio.org/docs/zh-CN/cli</a></p><p>windows: <code>C:\Users\用户名\.config\verdaccio\config.yaml</code></p></blockquote><h3 id="自定义端口号"><a href="#自定义端口号" class="headerlink" title="自定义端口号"></a>自定义端口号</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">listen:</span></span><br><span class="line">  <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span><span class="string">:10086</span></span><br></pre></td></tr></table></figure><h3 id="添加taobao源"><a href="#添加taobao源" class="headerlink" title="添加taobao源"></a>添加taobao源</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">uplinks:</span></span><br><span class="line"><span class="attr">  npmjs:</span></span><br><span class="line"><span class="attr">    url:</span> <span class="attr">https://registry.npmjs.org/</span></span><br><span class="line"><span class="attr">  taobao:</span></span><br><span class="line"><span class="attr">    url:</span> <span class="attr">https://registry.npm.taobao.org</span></span><br></pre></td></tr></table></figure><h3 id="配置packages"><a href="#配置packages" class="headerlink" title="配置packages"></a>配置packages</h3><blockquote><p><a href="https://verdaccio.org/docs/zh-CN/packages" target="_blank" rel="noopener">官方参考</a></p></blockquote><ol><li><p>配置私有包的规则</p><blockquote><p>建议私有的包都添加统一的<strong>前缀</strong>或者使用 <code>@npmuser/</code>  这样的小组范围类型。</p></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">packages:</span></span><br><span class="line">  <span class="string">'npmuser-*'</span><span class="string">:</span></span><br><span class="line"><span class="attr">    access:</span> <span class="string">npmuser</span></span><br><span class="line"><span class="attr">    publish:</span> <span class="string">npmuser</span></span><br></pre></td></tr></table></figure><blockquote><p>这样配置<code>npmuser-*</code>开头的包，发布的时候全部都发布到<code>verdaccio</code>中。而且之能<code>npmuser</code>这个用户使用。</p></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">packages:</span></span><br><span class="line">  <span class="string">'npmuser-*'</span><span class="string">:</span></span><br><span class="line"><span class="attr">    access:</span> <span class="string">$authenticated</span></span><br><span class="line"><span class="attr">    publish:</span> <span class="string">$authenticated</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># verdaccio内置使用htpasswd插件验证，内置的小组名称有：</span></span><br><span class="line">    <span class="comment"># '$all', '$anonymous', '@all', '@anonymous', 'all', 'undefined', 'anonymous'</span></span><br></pre></td></tr></table></figure><blockquote><p>这样配置就是<code>npmuser-*</code>包，只能登陆的用户使用。</p></blockquote></li><li><p>配置proxy</p><blockquote><p>修改默认的<code>proxy</code>为<code>uplinks</code>中的<code>taobao</code></p></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">packages:</span></span><br><span class="line">  <span class="string">'@*/*'</span><span class="string">:</span></span><br><span class="line">    <span class="comment"># scoped packages</span></span><br><span class="line"><span class="attr">    access:</span> <span class="string">$all</span></span><br><span class="line"><span class="attr">    publish:</span> <span class="string">$authenticated</span></span><br><span class="line"><span class="attr">    proxy:</span> <span class="string">taobao</span>  <span class="comment"># 引用了uplinks中的配置</span></span><br><span class="line"></span><br><span class="line">  <span class="string">'**'</span><span class="string">:</span></span><br><span class="line"><span class="attr">    access:</span> <span class="string">$all</span></span><br><span class="line"><span class="attr">    publish:</span> <span class="string">$authenticated</span></span><br><span class="line"><span class="attr">    proxy:</span> <span class="string">taobao</span> <span class="comment"># 引用了uplinks中的配置</span></span><br></pre></td></tr></table></figure></li></ol><h2 id="配置npm的registry"><a href="#配置npm的registry" class="headerlink" title="配置npm的registry"></a>配置<code>npm</code>的registry</h2><blockquote><p>建议使用<code>nrm</code>管理<code>registry</code></p><p><a href="https://betgar.github.io/2019/02/26/install-node-on-ubuntu/">详情参考这篇文章</a></p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 添加本地的verdaccio</span></span><br><span class="line">nrm add <span class="built_in">local</span> http://127.0.0.1:4873</span><br><span class="line"><span class="comment"># 切换到local</span></span><br><span class="line">nrm use <span class="built_in">local</span></span><br></pre></td></tr></table></figure><h2 id="私有模块发布和使用"><a href="#私有模块发布和使用" class="headerlink" title="私有模块发布和使用"></a>私有模块发布和使用</h2><blockquote><p>发布私有的模块前，要先使用<code>nrm</code>切换到<code>verdaccio</code>发布的<code>registry</code>，并且写先注册一个<code>用户</code>，然后才能发布模块</p></blockquote><ol><li><p>切换<code>registry</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nrm use <span class="built_in">local</span></span><br></pre></td></tr></table></figure></li><li><p>使用npm注册一个账户</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">npm adduser <span class="comment"># 注册用户</span></span><br><span class="line"><span class="comment"># 注意这个账户不是npmjs.com的账户，这个账户只是注册到自己发布的verdaccio服务中</span></span><br><span class="line"><span class="comment"># verdaccio使用htpasswd来验证用户密码</span></span><br><span class="line"><span class="comment"># verdaccio有插件可以使用自己搭建的gitlab用户来验证。</span></span><br></pre></td></tr></table></figure></li><li><p>发布模块</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 例如: node项目为node-demo</span></span><br><span class="line"><span class="comment"># node-demo目录下执行</span></span><br><span class="line"><span class="comment"># 发布之前注意修改package.json中的version版本号</span></span><br><span class="line">npm publish</span><br></pre></td></tr></table></figure></li><li><p>使用私有模块</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 例如：私有模块名称为：pvt-node</span></span><br><span class="line">npm i pvt-node</span><br></pre></td></tr></table></figure></li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;verdaccio&quot;&gt;&lt;a href=&quot;#verdaccio&quot; class=&quot;headerlink&quot; title=&quot;verdaccio&quot;&gt;&lt;/a&gt;verdaccio&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;因为技术变革太快，注意知识的时效性。&lt;/s
      
    
    </summary>
    
      <category term="npm" scheme="https://betgar.github.io/categories/npm/"/>
    
      <category term="verdaccio" scheme="https://betgar.github.io/categories/npm/verdaccio/"/>
    
    
      <category term="npm" scheme="https://betgar.github.io/tags/npm/"/>
    
      <category term="verdaccio" scheme="https://betgar.github.io/tags/verdaccio/"/>
    
  </entry>
  
  <entry>
    <title>Linux环境安装node,部署verdaccio私有npm仓库</title>
    <link href="https://betgar.github.io/2019/02/26/install-node-on-ubuntu/"/>
    <id>https://betgar.github.io/2019/02/26/install-node-on-ubuntu/</id>
    <published>2019-02-25T16:00:00.000Z</published>
    <updated>2019-07-10T23:56:28.190Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ubuntu-16-04-安装node环境"><a href="#ubuntu-16-04-安装node环境" class="headerlink" title="ubuntu(16.04)安装node环境"></a><code>ubuntu(16.04)</code>安装<code>node</code>环境</h1><blockquote><p>记录一下在<code>Linux</code>下安装<code>Node</code>环境的经过.</p></blockquote><h2 id="安装步骤"><a href="#安装步骤" class="headerlink" title="安装步骤"></a>安装步骤</h2><h3 id="更改ubuntu的镜像源（非必须）"><a href="#更改ubuntu的镜像源（非必须）" class="headerlink" title="更改ubuntu的镜像源（非必须）"></a>更改<code>ubuntu</code>的镜像源（非必须）</h3><blockquote><p>因为 <strong>网络环境的限制</strong> 更改镜像源可以加快包的下载</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="comment">## 要注意的是不同的版本对应的仓库是不同的。</span></span><br><span class="line">&gt; </span><br><span class="line">&gt; <span class="comment"># 备份镜像源</span></span><br><span class="line">&gt; sudo cp /etc/apt/sources.list /etc/apt/sources.list.bak</span><br><span class="line">&gt; </span><br><span class="line">&gt; <span class="comment"># 编辑source.list</span></span><br><span class="line">&gt; sodo vim /etc/apt/sources.list</span><br><span class="line">&gt; </span><br><span class="line">&gt; <span class="comment"># 可以使用网易源，搜狐源，阿里源</span></span><br><span class="line">&gt; <span class="comment"># 参考 https://mirrors.ustc.edu.cn/help/ubuntu.html</span></span><br><span class="line">&gt; <span class="comment"># http://mirrors.sohu.com/</span></span><br><span class="line">&gt; <span class="comment"># http://mirrors.163.com/</span></span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><h3 id="安装nvm"><a href="#安装nvm" class="headerlink" title="安装nvm"></a>安装<code>nvm</code></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.34.0/install.sh | bash</span><br></pre></td></tr></table></figure><blockquote><p>如果安装之后<code>nvm</code>，再命令行上使用<code>nvm</code>出现未找到命令，只需要重新打开一个<code>终端窗口</code>重试。</p></blockquote><h3 id="安装node"><a href="#安装node" class="headerlink" title="安装node"></a>安装<code>node</code></h3><blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; nvm install node <span class="comment"># 最新版本</span></span><br><span class="line">&gt; nvm install 6.14.4 <span class="comment"># 具体版本</span></span><br><span class="line">&gt; nvm ls-remote <span class="comment"># 有哪些版本</span></span><br><span class="line">&gt; nvm use node <span class="comment"># 使用具体的哪个版本</span></span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><h3 id="安装nrm"><a href="#安装nrm" class="headerlink" title="安装nrm"></a>安装<code>nrm</code></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g nrm --registry=https://registry.npm.taobao.org</span><br></pre></td></tr></table></figure><h3 id="安装python"><a href="#安装python" class="headerlink" title="安装python"></a>安装<code>python</code></h3><blockquote><p>因为<code>node-gyp</code>模块只支持<code>python2.x</code>所以需要安装<code>python</code>，如果<code>linux</code>已经安装，可以使用<code>node-gyp</code>制定配置<code>python</code>地址。</p></blockquote><p><a href="https://tecadmin.net/install-python-2-7-on-ubuntu-and-linuxmint/" target="_blank" rel="noopener">参考再ubuntu上安装python2.7</a></p><h3 id="安装node-gyp"><a href="#安装node-gyp" class="headerlink" title="安装node-gyp"></a>安装<code>node-gyp</code></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g node-gyp</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 配置python依赖</span></span><br><span class="line"><span class="comment"># 如果是直接命令调用node-gyp，就这样配置</span></span><br><span class="line">node-gyp --python /path/to/python2.7 <span class="comment"># python的地址</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果是通过npm工具间接调用node-gyp就这样配置</span></span><br><span class="line">npm config <span class="built_in">set</span> python /path/to/executable/python2.7</span><br></pre></td></tr></table></figure><h3 id="安装verdaccio"><a href="#安装verdaccio" class="headerlink" title="安装verdaccio"></a>安装<code>verdaccio</code></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装verdaccio</span></span><br><span class="line">npm install --global verdaccio</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用nrm添加名为local的registry</span></span><br><span class="line">nrm add <span class="built_in">local</span> http://localhost:4873/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 启动verdaccio</span></span><br><span class="line">verdaccio  <span class="comment"># 这样启动不能关闭命令行，所以我们使用pm2工具</span></span><br></pre></td></tr></table></figure><blockquote><p>具体的配置看<a href="https://verdaccio.org/" target="_blank" rel="noopener">verdaccio配置</a></p></blockquote><h3 id="安装pm2"><a href="#安装pm2" class="headerlink" title="安装pm2"></a>安装<code>pm2</code></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install pm2 -g</span><br></pre></td></tr></table></figure><h4 id="安装日志模块（pm2-logrotate）"><a href="#安装日志模块（pm2-logrotate）" class="headerlink" title="安装日志模块（pm2-logrotate）"></a>安装日志模块（pm2-logrotate）</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pm2 install pm2-logrotate</span><br></pre></td></tr></table></figure><h4 id="安装监控模块-pm2-server-monit"><a href="#安装监控模块-pm2-server-monit" class="headerlink" title="安装监控模块(pm2-server-monit)"></a>安装监控模块(pm2-server-monit)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pm2 install pm2-server-monit</span><br></pre></td></tr></table></figure><h4 id="pm2启动verdaccio"><a href="#pm2启动verdaccio" class="headerlink" title="pm2启动verdaccio"></a>pm2启动verdaccio</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">pm2 start <span class="built_in">which</span> verdaccio <span class="comment"># 启动之后可以关闭命令行，进程不会终止。</span></span><br><span class="line"><span class="comment"># pm2的其它功能参考文档</span></span><br><span class="line"><span class="comment"># pm2 show</span></span><br><span class="line"><span class="comment"># pm2 list</span></span><br><span class="line"><span class="comment"># pm2 stop</span></span><br><span class="line"><span class="comment"># pm2 restart</span></span><br></pre></td></tr></table></figure><h2 id="链接"><a href="#链接" class="headerlink" title="链接"></a>链接</h2><ul><li><a href="https://github.com/creationix/nvm" target="_blank" rel="noopener">nvm官网</a></li><li><a href="https://github.com/Pana/nrm" target="_blank" rel="noopener">nrm官网</a></li><li><a href="https://github.com/nodejs/node-gyp" target="_blank" rel="noopener">node-gyp官网</a></li><li><a href="https://github.com/verdaccio/verdaccio" target="_blank" rel="noopener">verdaccio官网</a></li><li><a href="https://github.com/Unitech/pm2" target="_blank" rel="noopener">pm2官网</a></li><li><a href="https://github.com/keymetrics/pm2-logrotate" target="_blank" rel="noopener">pm2-logrotate日志管理</a></li><li><a href="https://github.com/keymetrics/pm2-server-monit" target="_blank" rel="noopener">pm2-server-monit监控模块</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;ubuntu-16-04-安装node环境&quot;&gt;&lt;a href=&quot;#ubuntu-16-04-安装node环境&quot; class=&quot;headerlink&quot; title=&quot;ubuntu(16.04)安装node环境&quot;&gt;&lt;/a&gt;&lt;code&gt;ubuntu(16.04)&lt;/co
      
    
    </summary>
    
      <category term="linux" scheme="https://betgar.github.io/categories/linux/"/>
    
      <category term="node" scheme="https://betgar.github.io/categories/linux/node/"/>
    
    
      <category term="linux" scheme="https://betgar.github.io/tags/linux/"/>
    
      <category term="node" scheme="https://betgar.github.io/tags/node/"/>
    
      <category term="ubuntu" scheme="https://betgar.github.io/tags/ubuntu/"/>
    
  </entry>
  
  <entry>
    <title>Vue2+TypeScript实践准备</title>
    <link href="https://betgar.github.io/2019/02/13/vue2-typescript-action-prepare/"/>
    <id>https://betgar.github.io/2019/02/13/vue2-typescript-action-prepare/</id>
    <published>2019-02-12T16:00:00.000Z</published>
    <updated>2019-03-06T04:39:11.872Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Vue2-TypeScript实践准备"><a href="#Vue2-TypeScript实践准备" class="headerlink" title="Vue2 + TypeScript实践准备"></a>Vue2 + TypeScript实践准备</h1><blockquote><p>基于Vue2.5版本，Vue3.0可能有所改变.</p></blockquote><h2 id="知识准备"><a href="#知识准备" class="headerlink" title="知识准备"></a>知识准备</h2><ul><li><p>扎实的 JavaScript / HTML / CSS 基本功</p></li><li><p>通读Vue官方教程 (guide) 的基础篇</p></li><li><p>熟悉vue-router 和 vuex</p></li><li><p>熟悉ES6 modules</p></li><li><p>熟悉Node.js 基础</p></li><li><p>了解如何使用 / 配置 Babel 来将 ES2015 编译到 ES5 用于浏览器环境</p></li><li><p>熟悉 Webpack</p></li><li><p>vue-cli 来搭建Vue项目</p></li></ul><h2 id="Node-js"><a href="#Node-js" class="headerlink" title="Node.js"></a>Node.js</h2><h3 id="Node-js是什么？"><a href="#Node-js是什么？" class="headerlink" title="Node.js是什么？"></a>Node.js是什么？</h3><blockquote><p>Node.js 是一个基于 Chrome V8 引擎的 JavaScript 运行环境。<br>Node.js 使用了一个事件驱动、非阻塞式I/O 的模型，使其轻量又高效。</p></blockquote><h3 id="npm模块管理器"><a href="#npm模块管理器" class="headerlink" title="npm模块管理器"></a>npm模块管理器</h3><p><code>npm</code>有两层含义。一层含义是Node的开放式模块登记和管理系统，网址为<a href="http://npmjs.org/" target="_blank" rel="noopener">npmjs.org</a>。另一层含义是Node默认的模块管理器，是一个命令行下的软件，用来安装和管理Node模块。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">npm init</span><br><span class="line">npm install lodash-es</span><br><span class="line">npm uninstall lodash-es</span><br><span class="line">npm update lodash-es</span><br><span class="line"></span><br><span class="line">npm install lodash-es --save</span><br><span class="line">npm install lodash-es --save-dev</span><br></pre></td></tr></table></figure><h3 id="npm-run"><a href="#npm-run" class="headerlink" title="npm run"></a>npm run</h3><blockquote><p><code>npm</code>不仅可以用于模块管理，还可以用于执行脚本。<code>package.json</code>文件有一个<code>scripts</code>字段，可以用于指定脚本命令，供<code>npm</code>直接调用。</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// package.json</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">"scripts"</span>: &#123;</span><br><span class="line">        <span class="string">"serve"</span>: <span class="string">"vue-cli-service serve"</span>,</span><br><span class="line">        <span class="string">"build"</span>: <span class="string">"vue-cli-service build"</span>,</span><br><span class="line">        <span class="string">"lint"</span>: <span class="string">"vue-cli-service lint"</span>,</span><br><span class="line">        <span class="string">"test:unit"</span>: <span class="string">"vue-cli-service test:unit"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run serve</span><br></pre></td></tr></table></figure><h3 id="package-json文件"><a href="#package-json文件" class="headerlink" title="package.json文件"></a>package.json文件</h3><blockquote><p>每个项目的根目录下面，一般都有一个<code>package.json</code>文件，定义了这个项目所需要的各种模块，以及项目的配置信息（比如名称、版本、许可证等元数据）。<code>npm install</code>命令根据这个配置文件，自动下载所需的模块，也就是配置项目所需的运行和开发环境。</p></blockquote><ul><li><p>name：描述的是模块的名称</p></li><li><p>version: 描述模块的版本号（遵循语义化版本）</p></li><li><p>main: 指定入口文件，默认为index.js</p></li><li><p>dependencies:字段指定了项目运行所依赖的模块</p></li><li><p>devDependencies:指定项目开发所需要的模块。</p></li><li>scripts: npm run 执行的命令就是这里指定的。</li></ul><h2 id="CommonJS规范"><a href="#CommonJS规范" class="headerlink" title="CommonJS规范"></a>CommonJS规范</h2><blockquote><p>Node 应用由模块组成，采用 CommonJS 模块规范。</p><p>每个文件就是一个模块，有自己的作用域。在一个文件里面定义的变量、函数、类，都是私有的，对其他文件不可见。</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// example.js</span></span><br><span class="line"><span class="keyword">var</span> x = <span class="number">5</span>;</span><br><span class="line"><span class="keyword">var</span> addX = <span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> value + x;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导出之后才可见</span></span><br><span class="line"><span class="built_in">module</span>.exports.x = x;</span><br><span class="line"><span class="built_in">module</span>.exports.addX = addX;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用example模块</span></span><br><span class="line"><span class="keyword">var</span> example = <span class="built_in">require</span>(<span class="string">'./example.js'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(example.x); <span class="comment">// 5</span></span><br><span class="line"><span class="built_in">console</span>.log(example.addX(<span class="number">1</span>)); <span class="comment">// 6</span></span><br></pre></td></tr></table></figure><h2 id="TypeScript"><a href="#TypeScript" class="headerlink" title="TypeScript"></a>TypeScript</h2><blockquote><p>TypeScript具有类型系统，且是JavaScript的超集。 它可以编译成普通的JavaScript代码。 TypeScript支持任意浏览器，任意环境，任意系统并且是开源的。</p></blockquote><h3 id="基础类型"><a href="#基础类型" class="headerlink" title="基础类型"></a>基础类型</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// boolean</span></span><br><span class="line"><span class="keyword">let</span> isDone: boolean = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 数字</span></span><br><span class="line"><span class="keyword">let</span> decLiteral: number = <span class="number">6</span>;</span><br><span class="line"><span class="keyword">let</span> hexLiteral: number = <span class="number">0xf00d</span>;</span><br><span class="line"><span class="keyword">let</span> binaryLiteral: number = <span class="number">0b1010</span>;</span><br><span class="line"><span class="keyword">let</span> octalLiteral: number = <span class="number">0o744</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 字符串</span></span><br><span class="line"><span class="keyword">let</span> name: string = <span class="string">"bob"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 数组</span></span><br><span class="line"><span class="keyword">let</span> list: number[] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">let</span> list: <span class="built_in">Array</span>&lt;number&gt; = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 元组</span></span><br><span class="line"><span class="keyword">let</span> x: [string, number] = [<span class="string">'hello'</span>, <span class="number">10</span>]; <span class="comment">// OK</span></span><br><span class="line">x[<span class="number">3</span>] = <span class="string">'world'</span>; <span class="comment">// OK, 字符串可以赋值给(string | number)类型</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 枚举</span></span><br><span class="line">enum Color &#123;</span><br><span class="line">    Red, </span><br><span class="line">    Green, </span><br><span class="line">    Blue</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> c: Color = Color.Green;</span><br></pre></td></tr></table></figure><h3 id="任意值any"><a href="#任意值any" class="headerlink" title="任意值any"></a>任意值any</h3><blockquote><p>但是 Object 类型的变量只是允许你给它赋任意值 - 但是却不能够在<br>它上面调用任意的方法 .</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> notSure: any = <span class="number">4</span>;</span><br><span class="line">notSure.ifItExists(); <span class="comment">// okay, ifItExists might exist at runtime</span></span><br><span class="line">notSure.toFixed(); <span class="comment">// okay, toFixed exists (but the compiler doe</span></span><br><span class="line"><span class="comment">// sn't check)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> prettySure: <span class="built_in">Object</span> = <span class="number">4</span>;</span><br><span class="line">prettySure.toFixed(); <span class="comment">// Error: Property 'toFixed' doesn't exist</span></span><br><span class="line"><span class="comment">// on type 'Object'.</span></span><br></pre></td></tr></table></figure><h3 id="空值void"><a href="#空值void" class="headerlink" title="空值void"></a>空值void</h3><blockquote><p>void 类型像是与 any 类型相反，它表示没有任何类型 </p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">warnUser</span>(<span class="params"></span>): <span class="title">void</span> </span>&#123;</span><br><span class="line">alert(<span class="string">"This is my warning message"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 声明一个 void 类型的变量没有什么大用，因为你只能为它赋予 undefined 和 null</span></span><br><span class="line"><span class="keyword">let</span> unusable: <span class="keyword">void</span> = <span class="literal">undefined</span>;</span><br></pre></td></tr></table></figure><h3 id="null和undefined"><a href="#null和undefined" class="headerlink" title="null和undefined"></a>null和undefined</h3><blockquote><p>默认情况下 null 和 undefined 是所有类型的子类型。 就是说你可以<br>把 null 和 undefined 赋值给 number 类型的变量。 </p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> u: <span class="literal">undefined</span> = <span class="literal">undefined</span>;</span><br><span class="line"><span class="keyword">let</span> n: <span class="literal">null</span> = <span class="literal">null</span>;</span><br></pre></td></tr></table></figure><blockquote><p>注意：当你指定了 –strictNullChecks 标记， null 和 undefined 只能赋值给 void 和它们各自。 </p></blockquote><h3 id="Object"><a href="#Object" class="headerlink" title="Object"></a>Object</h3><blockquote><p>object 表示非原始类型，也就是除 number ， string ， boolean ， symbol ， null 或 undefined 之外的类型。 </p></blockquote><h3 id="强制类型转换"><a href="#强制类型转换" class="headerlink" title="强制类型转换"></a>强制类型转换</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> someValue: any = <span class="string">"this is a string"</span>;</span><br><span class="line"><span class="keyword">let</span> strLength: number = (<span class="xml"><span class="tag">&lt;<span class="name">string</span>&gt;</span>someValue).length;</span></span><br><span class="line"><span class="xml">// as 语法</span></span><br><span class="line"><span class="xml">let strLength: number = (someValue as string).length;</span></span><br></pre></td></tr></table></figure><h3 id="可选属性"><a href="#可选属性" class="headerlink" title="可选属性"></a>可选属性</h3><blockquote><p>可选属性使用<strong><code>?</code></strong>标识</p></blockquote><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Vue的ComponentOptions声明的一部分</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> ComponentOptions&lt;</span><br><span class="line">  V <span class="keyword">extends</span> Vue,</span><br><span class="line">  Data=DefaultData&lt;V&gt;,</span><br><span class="line">  Methods=DefaultMethods&lt;V&gt;,</span><br><span class="line">  Computed=DefaultComputed,</span><br><span class="line">  PropsDef=PropsDefinition&lt;DefaultProps&gt;,</span><br><span class="line">  Props=DefaultProps&gt; &#123;</span><br><span class="line">  data?: Data;</span><br><span class="line">  props?: PropsDef;</span><br><span class="line">  propsData?: object;</span><br><span class="line">  computed?: Accessors&lt;Computed&gt;;</span><br><span class="line">  methods?: Methods;</span><br><span class="line">  watch?: Record&lt;<span class="built_in">string</span>, WatchOptionsWithHandler&lt;<span class="built_in">any</span>&gt; | WatchHandler&lt;<span class="built_in">any</span>&gt; | <span class="built_in">string</span>&gt;;</span><br><span class="line">      <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="去除null和undefined类型断言使用-标识"><a href="#去除null和undefined类型断言使用-标识" class="headerlink" title="去除null和undefined类型断言使用!标识"></a>去除null和undefined类型断言使用<strong><code>!</code></strong>标识</h3><blockquote><p>有的时候TypeScript无法正确推导出类型时，需要手动去除<code>null</code>和<code>undefined</code></p></blockquote><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> Login <span class="keyword">extends</span> Vue &#123;</span><br><span class="line">    <span class="meta">@Mutation</span>(UserMutationTypes.SET_USER_NAME)</span><br><span class="line">    <span class="keyword">private</span> changeUserName!: <span class="function">(<span class="params">name: <span class="built_in">string</span></span>) =&gt;</span> <span class="built_in">void</span>;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="接口"><a href="#接口" class="headerlink" title="接口"></a>接口</h3><blockquote><p>在TypeScript里，接口的作用就是为这些类型命名和为你的代码或第三方代码定义契约。 </p></blockquote><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> LabelledValue &#123;</span><br><span class="line">  label: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">printLabel</span>(<span class="params">labelledObj: LabelledValue</span>) </span>&#123;</span><br><span class="line"><span class="built_in">console</span>.log(labelledObj.label);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// let myObj = &#123;size: 10, label: "Size 10 Object"&#125;;</span></span><br><span class="line"><span class="keyword">let</span> myObj = &#123;size: <span class="number">10</span>, label: <span class="string">"Size 10 Object"</span>&#125;;</span><br><span class="line">printLabel(myObj);</span><br></pre></td></tr></table></figure><h3 id="类"><a href="#类" class="headerlink" title="类"></a>类</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> Animal &#123;</span><br><span class="line">    move(distanceInMeters: <span class="built_in">number</span> = <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`Animal moved <span class="subst">$&#123;distanceInMeters&#125;</span>m.`</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">class</span> Dog <span class="keyword">extends</span> Animal &#123;</span><br><span class="line">    bark() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Woof! Woof!'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">const</span> dog = <span class="keyword">new</span> Dog();</span><br><span class="line">dog.bark();</span><br><span class="line">dog.move(<span class="number">10</span>);</span><br><span class="line">dog.bark();</span><br></pre></td></tr></table></figure><h3 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Named function</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">x, y</span>) </span>&#123;</span><br><span class="line"><span class="keyword">return</span> x + y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Anonymous function</span></span><br><span class="line"><span class="keyword">let</span> myAdd = <span class="function"><span class="keyword">function</span>(<span class="params">x, y</span>) </span>&#123; </span><br><span class="line">    <span class="keyword">return</span> x + y; </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">tsAdd</span>(<span class="params">x: <span class="built_in">number</span>, y: <span class="built_in">number</span></span>): <span class="title">number</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> x + y;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> tsMyAdd = <span class="function"><span class="keyword">function</span>(<span class="params">x: <span class="built_in">number</span>, y: <span class="built_in">number</span></span>): <span class="title">number</span> </span>&#123; </span><br><span class="line">    <span class="keyword">return</span> x +y; </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="声明合并"><a href="#声明合并" class="headerlink" title="声明合并"></a>声明合并</h3><blockquote><p>注意每组接口里的声明顺序保持不变，但各组接口之间的顺序是后来的接口重载出<br>现在靠前位置。</p></blockquote><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> Cloner &#123;</span><br><span class="line">clone(animal: Animal): Animal;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> Cloner &#123;</span><br><span class="line">clone(animal: Sheep): Sheep;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> Cloner &#123;</span><br><span class="line">    clone(animal: Dog): Dog;</span><br><span class="line">    clone(animal: Cat): Cat;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 这三个接口合并成一个声明：</span></span><br><span class="line"><span class="keyword">interface</span> Cloner &#123;</span><br><span class="line">    clone(animal: Dog): Dog;</span><br><span class="line">    clone(animal: Cat): Cat;</span><br><span class="line">    clone(animal: Sheep): Sheep;</span><br><span class="line">    clone(animal: Animal): Animal;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="扩充全局或者模块作用域"><a href="#扩充全局或者模块作用域" class="headerlink" title="扩充全局或者模块作用域"></a>扩充全局或者模块作用域</h3><blockquote><p>不论是模块扩充还是全局声明扩充都不能向顶级作用域添加新的项目 - 它们只能为<br>已经存在的声明添加 “补丁”.</p></blockquote><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// map.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; Observable &#125; <span class="keyword">from</span> <span class="string">"./observable"</span>;</span><br><span class="line"><span class="comment">// 扩充 "./observable"</span></span><br><span class="line"><span class="keyword">declare</span> <span class="keyword">module</span> "./observable" &#123;</span><br><span class="line"><span class="comment">// 使用接口合并扩充 'Observable' 类的定义</span></span><br><span class="line">    <span class="keyword">interface</span> Observable&lt;T&gt; &#123;</span><br><span class="line">    map&lt;U&gt;<span class="function">(<span class="params">proj: (<span class="params">el: T</span>) =&gt; U</span>): <span class="params">Observable</span>&lt;<span class="params">U</span>&gt;;</span></span><br><span class="line"><span class="function">    &#125;</span></span><br><span class="line"><span class="function">&#125;</span></span><br><span class="line"><span class="function"><span class="params">Observable</span>.<span class="params">prototype</span>.<span class="params">map</span> = /*...*/;</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">// <span class="params">declare</span> <span class="params">global</span> 声明被增强:</span></span><br><span class="line"><span class="function"><span class="params">declare</span> <span class="params">global</span> &#123;</span></span><br><span class="line"><span class="function">    <span class="params">interface</span> <span class="params">Array</span>&lt;<span class="params">T</span>&gt; &#123;</span></span><br><span class="line"><span class="function">    <span class="params">mapToNumbers</span><span class="params">()</span>: <span class="params">number</span>[];</span></span><br><span class="line"><span class="function">    &#125;</span></span><br><span class="line"><span class="function">&#125;</span></span><br><span class="line"><span class="function"><span class="params">Array</span>.<span class="params">prototype</span>.<span class="params">mapToNumbers</span> = <span class="params">function</span> <span class="params">()</span> &#123; /* ... */ &#125;</span></span><br></pre></td></tr></table></figure><h2 id="Vue对TypeScript的支持"><a href="#Vue对TypeScript的支持" class="headerlink" title="Vue对TypeScript的支持"></a>Vue对TypeScript的支持</h2><blockquote><p><a href="https://cn.vuejs.org/v2/guide/typescript.html" target="_blank" rel="noopener">Vue的TypeScript 支持</a></p></blockquote><h3 id="TypeScript识别Vue组件"><a href="#TypeScript识别Vue组件" class="headerlink" title="TypeScript识别Vue组件"></a>TypeScript识别Vue组件</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// vue-shim.d.ts</span></span><br><span class="line"><span class="keyword">declare</span> <span class="keyword">module</span> "*.vue" &#123;</span><br><span class="line">  <span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">"vue"</span>;</span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">default</span> Vue;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="TypeScript识别JSX"><a href="#TypeScript识别JSX" class="headerlink" title="TypeScript识别JSX"></a>TypeScript识别JSX</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 渲染函数 &amp; JSX</span></span><br><span class="line">Vue.component(<span class="string">'anchored-heading'</span>, &#123;</span><br><span class="line">  render: <span class="function"><span class="keyword">function</span> (<span class="params">createElement</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> createElement(</span><br><span class="line">      <span class="string">'h'</span> + <span class="keyword">this</span>.level,   <span class="comment">// 标签名称</span></span><br><span class="line">      <span class="keyword">this</span>.$slots.default <span class="comment">// 子元素数组</span></span><br><span class="line">    )</span><br><span class="line">  &#125;,</span><br><span class="line">  props: &#123;</span><br><span class="line">    level: &#123;</span><br><span class="line">      <span class="keyword">type</span>: <span class="built_in">Number</span>,</span><br><span class="line">      required: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// shims-tsx.d.ts</span></span><br><span class="line"><span class="keyword">declare</span> global &#123;</span><br><span class="line">  <span class="keyword">namespace</span> JSX &#123;</span><br><span class="line">    <span class="comment">// tslint:disable no-empty-interface</span></span><br><span class="line">    <span class="keyword">interface</span> Element <span class="keyword">extends</span> VNode &#123;&#125;</span><br><span class="line">    <span class="comment">// tslint:disable no-empty-interface</span></span><br><span class="line">    <span class="keyword">interface</span> ElementClass <span class="keyword">extends</span> Vue &#123;&#125;</span><br><span class="line">    <span class="keyword">interface</span> IntrinsicElements &#123;</span><br><span class="line">      [elem: <span class="built_in">string</span>]: <span class="built_in">any</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="扩展Vue类和原型声明书写"><a href="#扩展Vue类和原型声明书写" class="headerlink" title="扩展Vue类和原型声明书写"></a>扩展Vue类和原型声明书写</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 例子：</span></span><br><span class="line"><span class="keyword">declare</span> <span class="keyword">module</span> 'vue/types/vue' &#123;</span><br><span class="line">  <span class="keyword">interface</span> Vue &#123;</span><br><span class="line">    $axios: AxiosInstance</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">interface</span> VueConstructor &#123;</span><br><span class="line">    $axios: AxiosInstance</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Vue组件声明方式1"><a href="#Vue组件声明方式1" class="headerlink" title="Vue组件声明方式1"></a>Vue组件声明方式1</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"greeting"</span>&gt;</span>Hello &#123;&#123;name&#125;&#125;&#123;&#123;exclamationMarks&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">"decrement"</span>&gt;</span>-<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">"increment"</span>&gt;</span>+<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;<span class="regexp">/script&gt;&lt;script lang="ts"&gt;</span></span><br><span class="line"><span class="regexp">import Vue from "vue";</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default Vue.extend(&#123;</span></span><br><span class="line"><span class="regexp">    props: ['name', 'initialEnthusiasm'],</span></span><br><span class="line"><span class="regexp">    data() &#123;</span></span><br><span class="line"><span class="regexp">        return &#123;</span></span><br><span class="line"><span class="regexp">            enthusiasm: this.initialEnthusiasm,</span></span><br><span class="line"><span class="regexp">        &#125;</span></span><br><span class="line"><span class="regexp">    &#125;,</span></span><br><span class="line"><span class="regexp">    methods: &#123;</span></span><br><span class="line"><span class="regexp">        increment() &#123; this.enthusiasm++; &#125;,</span></span><br><span class="line"><span class="regexp">        decrement() &#123;</span></span><br><span class="line"><span class="regexp">            if (this.enthusiasm &gt; 1) &#123;</span></span><br><span class="line"><span class="regexp">                this.enthusiasm--;</span></span><br><span class="line"><span class="regexp">            &#125;</span></span><br><span class="line"><span class="regexp">        &#125;,</span></span><br><span class="line"><span class="regexp">    &#125;,</span></span><br><span class="line"><span class="regexp">    computed: &#123;</span></span><br><span class="line"><span class="regexp">        exclamationMarks(): string &#123;</span></span><br><span class="line"><span class="regexp">            return Array(this.enthusiasm + 1).join('!');</span></span><br><span class="line"><span class="regexp">        &#125;</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;);</span></span><br><span class="line"><span class="regexp">&lt;/</span>script&gt;</span><br></pre></td></tr></table></figure><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="selector-tag">style</span>&gt;</span><br><span class="line"><span class="selector-class">.greeting</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><h3 id="Vue组件声明方式2"><a href="#Vue组件声明方式2" class="headerlink" title="Vue组件声明方式2"></a>Vue组件声明方式2</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> Component <span class="keyword">from</span> <span class="string">'vue-class-component'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// @Component 修饰符注明了此类为一个 Vue 组件</span></span><br><span class="line">@Component(&#123;</span><br><span class="line">  <span class="comment">// 所有的组件选项都可以放在这里</span></span><br><span class="line">  template: <span class="string">'&lt;button @click="onClick"&gt;Click!&lt;/button&gt;'</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">MyComponent</span> <span class="keyword">extends</span> <span class="title">Vue</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 初始数据可以直接声明为实例的属性</span></span><br><span class="line">  message: string = <span class="string">'Hello!'</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 组件方法也可以直接声明为实例的方法</span></span><br><span class="line">  onClick (): <span class="keyword">void</span> &#123;</span><br><span class="line">    <span class="built_in">window</span>.alert(<span class="keyword">this</span>.message)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Vue组件使用注意事项"><a href="#Vue组件使用注意事项" class="headerlink" title="Vue组件使用注意事项"></a>Vue组件使用注意事项</h3><ul><li><p>Vue组件或者ts文件中导入*.vue文件时，需要完整文件名</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Toolbar <span class="keyword">from</span> <span class="string">'@/components/toolbar.vue'</span>;</span><br></pre></td></tr></table></figure></li><li><p><code>&lt;script lang=&quot;ts&quot;&gt;</code>标签必须带lang=“ts”</p></li><li><p><code>&lt;script&gt;</code>导出的对象必须是Vue的实例</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> HelloDecorator <span class="keyword">extends</span> Vue &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 或者</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> Vue.extend(&#123;</span><br><span class="line">    <span class="comment">// ComponentOptions</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li></ul><h3 id="vue-class-component注解的限制"><a href="#vue-class-component注解的限制" class="headerlink" title="vue-class-component注解的限制"></a>vue-class-component注解的限制</h3><ol><li><p><code>methods</code>直接声明为<strong>类方法成员</strong>.</p></li><li><p><strong>计算属性</strong>声明为<strong>类属性访问器</strong>.</p></li><li><p><code>data</code>声明为类的字段。</p></li><li><p><code>data</code> ， <code>render</code>和所有的<code>Vue生命周期钩子函数</code>都能可以直接声明为类成员方法。但是你不能在Vue实例上直接调用。当你声明自定义方法时，应该避免<code>声明周期钩子函数保留的名字</code></p></li><li><p>其它的<code>options</code>属性，使用传递给<code>@Component</code>装饰器函数。例如：<code>components属性</code></p></li></ol><h3 id="data属性声明注意事项"><a href="#data属性声明注意事项" class="headerlink" title="data属性声明注意事项"></a>data属性声明注意事项</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> Login <span class="keyword">extends</span> Vue &#123;</span><br><span class="line">    <span class="keyword">public</span> name: <span class="built_in">string</span> = <span class="string">'login'</span>;</span><br><span class="line">    <span class="comment">// 直接声明为类的字段</span></span><br><span class="line">    <span class="keyword">private</span> userName: <span class="built_in">string</span> = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">private</span> userPass: <span class="built_in">string</span> = <span class="string">''</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Mutation</span>(UserMutationTypes.SET_USER_NAME)</span><br><span class="line">    <span class="keyword">private</span> changeUserName!: <span class="function">(<span class="params">name: <span class="built_in">string</span></span>) =&gt;</span> <span class="built_in">void</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Vue默认的data函数返回属性</span></span><br><span class="line">    data() &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            labelPosition: <span class="string">'right'</span>,</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>如果data属性需要在<code>class</code>的<code>method</code>中修改时，声明为类的字段。</p><p>如果data属性只在<code>template</code>中使用，可以使用<code>data函数</code>返回.</p></blockquote><h2 id="TypeScript官方声明文件仓库"><a href="#TypeScript官方声明文件仓库" class="headerlink" title="TypeScript官方声明文件仓库"></a>TypeScript官方声明文件仓库</h2><ul><li><p><a href="https://github.com/DefinitelyTyped/DefinitelyTyped" target="_blank" rel="noopener">https://github.com/DefinitelyTyped/DefinitelyTyped</a></p></li><li><p>npm仓库为： @types/mockjs</p></li><li><p><a href="https://microsoft.github.io/TypeSearch/" target="_blank" rel="noopener">https://microsoft.github.io/TypeSearch/</a></p></li></ul><h3 id="引入第三方库（没有声明文件）"><a href="#引入第三方库（没有声明文件）" class="headerlink" title="引入第三方库（没有声明文件）"></a>引入第三方库（没有声明文件）</h3><blockquote><p>比如说我想引入<code>async-validator</code>,虽然已经在本地安装，但是typescript还是提示找不到模块。原因是typescript是从<code>node_modules/@types</code>目录下去找模块声明，有些库并没有提供typescript的声明文件，所以就需要自己去添加</p><p>解决办法：在<code>src/types</code>目前下建一个<code>async-validation.d.ts</code>文件，声明这个模块即可</p></blockquote><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span> <span class="keyword">module</span> 'async-validator' &#123;</span><br><span class="line">    <span class="keyword">export</span> <span class="keyword">type</span> AsyncValidator&lt;T = object&gt; = (</span><br><span class="line">      rule: RuleConfig,</span><br><span class="line">      value: <span class="built_in">any</span>,</span><br><span class="line">      callback: ValidatorCallback,</span><br><span class="line">      source: T,</span><br><span class="line">      options: &#123;</span><br><span class="line">        messages: object;</span><br><span class="line">      &#125;,</span><br><span class="line">    ) =&gt; <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 看看*.vue模块怎么声明的</span></span><br><span class="line"><span class="keyword">declare</span> <span class="keyword">module</span> '*.vue' &#123;</span><br><span class="line">  <span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span>;</span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">default</span> Vue;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="前端涉及的知识"><a href="#前端涉及的知识" class="headerlink" title="前端涉及的知识"></a>前端涉及的知识</h2><h3 id="前端基础"><a href="#前端基础" class="headerlink" title="前端基础"></a>前端基础</h3><ul><li><p>JavaScript / HTML / CSS</p></li><li><p>ES6 的使用</p></li></ul><h3 id="Vue部分"><a href="#Vue部分" class="headerlink" title="Vue部分"></a>Vue部分</h3><ul><li><p>Vue的基础知识</p></li><li><p>Vuex和Vue-Router使用</p></li><li><p>Vue工具链的相关知识</p><blockquote><p>vue-loader</p><p>vue-cli</p><p>vetur(vs code 插件)</p><p>vue.config.js</p><p>vue-property-decorator</p><p>vuex-class</p></blockquote></li><li><p>Vue生态链的组件库（例如： Element UI）</p></li></ul><h3 id="Node部分"><a href="#Node部分" class="headerlink" title="Node部分"></a>Node部分</h3><ul><li>Node.js模块知识</li><li>CommonJs规范(require, module, export)</li><li>npm基本使用</li><li>Node.js的package.json和模块知识</li></ul><h3 id="Webpack"><a href="#Webpack" class="headerlink" title="Webpack"></a>Webpack</h3><ul><li><p>了解Webpack配置</p></li><li><p>Webpack插件</p><blockquote><p>css-loader, style-loader, sass-node…</p></blockquote></li></ul><h3 id="TypeScript-1"><a href="#TypeScript-1" class="headerlink" title="TypeScript"></a>TypeScript</h3><ul><li>TypeScript基本语法</li><li>TypeScript类型声明文件*.d.ts写法</li><li>tsconfig.json文件配置</li><li>了解tslint.json</li></ul><h3 id="其它类库"><a href="#其它类库" class="headerlink" title="其它类库"></a>其它类库</h3><ul><li>Axios.js库的使用</li><li>Eslint</li></ul><h2 id="链接"><a href="#链接" class="headerlink" title="链接"></a>链接</h2><p><a href="http://javascript.ruanyifeng.com/nodejs/npm.html" target="_blank" rel="noopener">npm模块管理器</a></p><p><a href="http://www.ruanyifeng.com/blog/2016/01/npm-install.html" target="_blank" rel="noopener">npm 模块安装机制简介</a></p><p>vue-cli:</p><p><a href="https://cli.vuejs.org/zh/" target="_blank" rel="noopener">https://cli.vuejs.org/zh/</a></p><p>vue-router: </p><p><a href="https://router.vuejs.org/zh/" target="_blank" rel="noopener">https://router.vuejs.org/zh/</a></p><p>vuex:</p><p><a href="https://vuex.vuejs.org/zh/guide/" target="_blank" rel="noopener">https://vuex.vuejs.org/zh/guide/</a></p><p>vue-loader:</p><p><a href="https://vue-loader.vuejs.org/zh/spec.html" target="_blank" rel="noopener">https://vue-loader.vuejs.org/zh/spec.html</a></p><p>vue-class-component</p><p><a href="https://github.com/vuejs/vue-class-component" target="_blank" rel="noopener">https://github.com/vuejs/vue-class-component</a></p><p>vue-property-decorator</p><p><a href="https://github.com/kaorun343/vue-property-decorator" target="_blank" rel="noopener">https://github.com/kaorun343/vue-property-decorator</a></p><p>vuex-class</p><p><a href="https://github.com/ktsn/vuex-class/" target="_blank" rel="noopener">https://github.com/ktsn/vuex-class/</a></p><p>Axios.js</p><p><a href="https://github.com/axios/axios" target="_blank" rel="noopener">https://github.com/axios/axios</a></p><p>Vue的TypeScript支持</p><p><a href="https://cn.vuejs.org/v2/guide/typescript.html" target="_blank" rel="noopener">https://cn.vuejs.org/v2/guide/typescript.html</a></p><p>语义化版本</p><p><a href="https://semver.org/lang/zh-CN/" target="_blank" rel="noopener">https://semver.org/lang/zh-CN/</a></p><p>TypeScript+ Vue起步</p><p><a href="https://github.com/Microsoft/TypeScript-Vue-Starter#typescript-vue-starter" target="_blank" rel="noopener">https://github.com/Microsoft/TypeScript-Vue-Starter#typescript-vue-starter</a></p><p><a href="https://github.com/SimonZhangITer/vue-typescript-dpapp-demo" target="_blank" rel="noopener">https://github.com/SimonZhangITer/vue-typescript-dpapp-demo</a></p><p>vue + typescript 项目起手式</p><p><a href="https://segmentfault.com/a/1190000011744210" target="_blank" rel="noopener">https://segmentfault.com/a/1190000011744210</a></p><p><a href="https://segmentfault.com/a/1190000011878086" target="_blank" rel="noopener">https://segmentfault.com/a/1190000011878086</a></p><p><a href="https://github.com/ws456999/vue-typescript-starter" target="_blank" rel="noopener">https://github.com/ws456999/vue-typescript-starter</a></p><p><a href="https://www.zhihu.com/question/310485097" target="_blank" rel="noopener">https://www.zhihu.com/question/310485097</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Vue2-TypeScript实践准备&quot;&gt;&lt;a href=&quot;#Vue2-TypeScript实践准备&quot; class=&quot;headerlink&quot; title=&quot;Vue2 + TypeScript实践准备&quot;&gt;&lt;/a&gt;Vue2 + TypeScript实践准备&lt;/h1&gt;&lt;
      
    
    </summary>
    
      <category term="Vue" scheme="https://betgar.github.io/categories/Vue/"/>
    
      <category term="TypeScript" scheme="https://betgar.github.io/categories/Vue/TypeScript/"/>
    
    
      <category term="Vue" scheme="https://betgar.github.io/tags/Vue/"/>
    
      <category term="TypeScript" scheme="https://betgar.github.io/tags/TypeScript/"/>
    
  </entry>
  
  <entry>
    <title>Backbone.marionette新手入门系列</title>
    <link href="https://betgar.github.io/2018/10/24/the-beginner-of-backbone-marionette/"/>
    <id>https://betgar.github.io/2018/10/24/the-beginner-of-backbone-marionette/</id>
    <published>2018-10-24T10:00:00.000Z</published>
    <updated>2019-05-07T03:35:28.322Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Backbone-marionette新手入门系列"><a href="#Backbone-marionette新手入门系列" class="headerlink" title="Backbone.marionette新手入门系列"></a>Backbone.marionette新手入门系列</h1><blockquote><p>已经不用了，所以弃坑。</p></blockquote><h3 id="initialize-options-args"><a href="#initialize-options-args" class="headerlink" title="initialize(options, args...)"></a><code>initialize(options, args...)</code></h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> MyObject = MnObject.extend(&#123;</span><br><span class="line">  initialize(options, arg2) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(options.foo, <span class="keyword">this</span>.getOption(<span class="string">'foo'</span>), arg2);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> myObject = <span class="keyword">new</span> MyObject(&#123; <span class="attr">foo</span>: <span class="string">'bar'</span> &#125;, <span class="string">'baz'</span>); <span class="comment">// logs "bar" "bar" "baz"</span></span><br></pre></td></tr></table></figure><h3 id="extend"><a href="#extend" class="headerlink" title="extend"></a><code>extend</code></h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Backbone.extend === _.extend</span></span><br><span class="line"><span class="keyword">const</span> view = <span class="keyword">new</span> MyView();</span><br></pre></td></tr></table></figure><h2 id="triggerMethod-methodName-args"><a href="#triggerMethod-methodName-args" class="headerlink" title="triggerMethod(methodName, args...)"></a><code>triggerMethod(methodName, args...)</code></h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> MyObject = MnObject.extend(&#123;</span><br><span class="line">  initialize()&#123;</span><br><span class="line">    <span class="keyword">this</span>.triggerMethod(<span class="string">'foo'</span>, <span class="string">'baz'</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  onFoo(bar)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(bar);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> myObj = <span class="keyword">new</span> MyObject(); <span class="comment">// console.log "baz"</span></span><br><span class="line"></span><br><span class="line">myObj.triggerMethod(<span class="string">'foo'</span>, <span class="string">'qux'</span>); <span class="comment">// console.log "qux"</span></span><br></pre></td></tr></table></figure><h2 id="bindEvents-entity-events"><a href="#bindEvents-entity-events" class="headerlink" title="bindEvents(entity, events)"></a><code>bindEvents(entity, events)</code></h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Radio <span class="keyword">from</span> <span class="string">'backbone.radio'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; View &#125; <span class="keyword">from</span> <span class="string">'backbone.marionette'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> MyView = View.extend(&#123;</span><br><span class="line">  fooEvents: &#123;</span><br><span class="line">    <span class="string">'change:foo'</span>: <span class="string">'doSomething'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  initialize()&#123;</span><br><span class="line">    <span class="keyword">this</span>.fooChannel = Radio.channel(<span class="string">'foo'</span>);</span><br><span class="line">    <span class="keyword">this</span>.bindEvents(<span class="keyword">this</span>.fooChannel, <span class="keyword">this</span>.fooEvents);</span><br><span class="line">  &#125;,</span><br><span class="line">  doSomething()&#123;</span><br><span class="line">    <span class="comment">// the "change:foo" event was fired from the radio channel</span></span><br><span class="line">    <span class="comment">// respond to it appropriately, here.</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="unbindEvents-entity-hashMap"><a href="#unbindEvents-entity-hashMap" class="headerlink" title="unbindEvents(entity, [hashMap])"></a><code>unbindEvents(entity, [hashMap])</code></h2><h2 id="bindRequests-entity-hashMap"><a href="#bindRequests-entity-hashMap" class="headerlink" title="bindRequests(entity, hashMap)"></a><code>bindRequests(entity, hashMap)</code></h2><blockquote><p><code>bindRequests</code>:应该叫<code>bindReply</code>更贴切，绑定的是响应处理函数</p><p><code>hashMap</code> =&gt; <code>{ &#39;request:name&#39;: &#39;replyHandler&#39; }</code></p></blockquote><h2 id="unbindRequests-channel-hashMap"><a href="#unbindRequests-channel-hashMap" class="headerlink" title="unbindRequests(channel, [hashMap])"></a><code>unbindRequests(channel, [hashMap])</code></h2><blockquote><h3 id="39-request-name-39-39-replyHandler-39"><a href="#39-request-name-39-39-replyHandler-39" class="headerlink" title="{ &#39;request:name&#39;: &#39;replyHandler&#39; }"></a><code>{ &#39;request:name&#39;: &#39;replyHandler&#39; }</code></h3></blockquote><h2 id="normalizeMethods-hashMap"><a href="#normalizeMethods-hashMap" class="headerlink" title="normalizeMethods(hashMap)"></a><code>normalizeMethods(hashMap)</code></h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> hash = &#123;</span><br><span class="line">      <span class="string">'action:one'</span>: <span class="string">'handleActionOne'</span>, <span class="comment">// This will become a reference to `this.handleActionOne`</span></span><br><span class="line">      <span class="string">'action:two'</span>: <span class="keyword">this</span>.handleActionTwo</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">this</span>.normalizedHash = <span class="keyword">this</span>.normalizeMethods(hash);</span><br></pre></td></tr></table></figure><h2 id="getOption-optionName"><a href="#getOption-optionName" class="headerlink" title="getOption(optionName)"></a><code>getOption(optionName)</code></h2><blockquote><p>获取定义在<code>instance</code>上的<code>option</code>，如果<code>instance</code>没有，则优雅降级从<code>option</code>上查找。</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> View = View.extend(&#123;</span><br><span class="line">  classVal: <span class="string">'class value'</span>,</span><br><span class="line">  initialize()&#123;</span><br><span class="line">    <span class="keyword">this</span>.instanceVal = <span class="string">'instance value'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> view = <span class="keyword">new</span> View(&#123; <span class="attr">optVal</span>: <span class="string">'option value'</span> &#125;);</span><br><span class="line"></span><br><span class="line">view.getOption(<span class="string">'instanceVal'</span>); <span class="comment">// instance value</span></span><br><span class="line">view.getOption(<span class="string">'classVal'</span>); <span class="comment">// class value</span></span><br><span class="line">view.getOption(<span class="string">'optVal'</span>); <span class="comment">// option value</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> view2 = <span class="keyword">new</span> View(&#123; <span class="attr">instanceVal</span>: <span class="string">'foo'</span>, <span class="attr">classVal</span>: <span class="string">'bar'</span>, <span class="attr">optVal</span>: <span class="string">'baz'</span> &#125;);</span><br><span class="line"></span><br><span class="line">view.getOption(<span class="string">'instanceVal'</span>); <span class="comment">// foo</span></span><br><span class="line">view.getOption(<span class="string">'classVal'</span>); <span class="comment">// bar</span></span><br><span class="line">view.getOption(<span class="string">'optVal'</span>); <span class="comment">// baz</span></span><br></pre></td></tr></table></figure><h2 id="Falsey-values"><a href="#Falsey-values" class="headerlink" title="Falsey values"></a>Falsey values</h2><blockquote><p><code>getOption</code>将返回任何<code>falsey values</code>而不是<code>undefined</code>，如果<code>getOption</code>在<code>options</code>中无法获取属性，将会直接从<code>instance</code>实例中读取。</p></blockquote><h2 id="mergeOptions-options-props"><a href="#mergeOptions-options-props" class="headerlink" title="mergeOptions(options, props)"></a><code>mergeOptions(options, props)</code></h2><blockquote><p>把<code>options</code>中的<code>props</code>中的属性合并到<code>instances实例上</code></p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> MyObject = MnObject.extend(&#123;</span><br><span class="line">  initialize(options) &#123;</span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="keyword">this</span>.mergeOptions(options, [<span class="string">'model'</span>, <span class="string">'something'</span>]);</span><br><span class="line">    <span class="comment">// this.model and this.something will now be available</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> myObject = <span class="keyword">new</span> MyObject(&#123;</span><br><span class="line">  model: <span class="keyword">new</span> Backbone.Model(),</span><br><span class="line">  something: <span class="string">'test'</span>,</span><br><span class="line">  another: <span class="string">'value'</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(myObject.model);</span><br><span class="line"><span class="built_in">console</span>.log(myObject.something);</span><br><span class="line"><span class="built_in">console</span>.log(myObject.getOption(<span class="string">'another'</span>));</span><br></pre></td></tr></table></figure><h2 id="options"><a href="#options" class="headerlink" title="options"></a><code>options</code></h2><blockquote><p><code>initialize</code>中的<code>options</code>和对象<code>instance</code>实例化的<code>options</code>一样，所以在<code>initialize</code>中使用<code>options</code>，有必要使用<code>getOption</code>获取.</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> MyObject = MnObject.extend(&#123;</span><br><span class="line">  options: &#123;</span><br><span class="line">    foo: <span class="string">'bar'</span>,</span><br><span class="line">    another: <span class="string">'thing'</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  initialize(options) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(options.foo) <span class="comment">// undefined</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.getOption(<span class="string">'foo'</span>)) <span class="comment">// 'bar'</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.getOption(<span class="string">'another'</span>)) <span class="comment">// 'value'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> myObject = <span class="keyword">new</span> MyObject(&#123;</span><br><span class="line">  another: <span class="string">'value'</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="Marionette-View"><a href="#Marionette-View" class="headerlink" title="Marionette.View"></a>Marionette.View</h2><blockquote><p>属性：</p><p> <code>el</code>,  <code>id</code>, <code>tagName</code>,<code>attributes</code>,<code>className</code></p><p><code>model</code>, <code>modelEvents</code>, <code>collection</code>, <code>collectionEvents</code></p><p><code>events</code>, <code>triggers</code></p><p> <code>template</code>, <code>templateContext</code></p><p><code>childViewEventPrefix</code>,<code>childViewEvents</code>, <code>childViewTriggers</code></p><p><code>behaviors</code>,  <code>ui</code></p><p><code>regionClass</code>, <code>regions</code></p><p>注意：</p><p>因为所有的<code>events</code>都在<code>el</code>上代理，所以如果<code>events</code>中的<code>selector</code>和<code>childViewEvents</code>中的<code>selector</code>相同时，<code>events</code>中的<code>handle</code>能够同时响应<code>events</code>和<code>childViewEvents</code>中触发的事件，解决这个问题很简单，在<code>childViewEvents</code>的<code>handler</code>中<strong>阻止事件冒泡传播</strong></p></blockquote><h3 id="render"><a href="#render" class="headerlink" title="render"></a>render</h3><blockquote><p><code>Marionette.View.render</code>不能被<code>override</code>重写，只能通过<code>before:render</code></p></blockquote><h3 id="events"><a href="#events" class="headerlink" title="events"></a><code>events</code></h3><blockquote><p><code>Backbone</code>用来绑定<code>DOM</code>事件</p></blockquote><h3 id="triggers"><a href="#triggers" class="headerlink" title="triggers"></a><code>triggers</code></h3><blockquote><p>转换<code>DOM</code>事件=&gt;<code>Marionette Event</code>，就是把<code>DOM Event</code>变为<strong>通用的发布订阅事件</strong>，这样外部对象就和<strong>具体的DOM结构解耦</strong></p><p>场景适用：<code>childViewEvents</code> =&gt; <code>parentView</code>主要是解决父子<code>view</code>之间的<strong>事件传递</strong>.</p><p>作用：类似<code>Backbone.Model</code>对象，自身定义了很多<strong>Entity Event</strong>，<code>entity event</code>会在<code>model</code>的属性变化时触发；而<code>triggers</code>中定义的就是<strong>DOM事件</strong>到<strong>Class Event</strong>的一个映射关系，<strong>所以handler</strong>，可以是<code>view</code>内部（和<code>events</code>效果一样），或者<strong>外部其它的Marionette对象</strong>也可以处理。</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> MyView = View.extend(&#123;</span><br><span class="line">  triggers: &#123;</span><br><span class="line">    <span class="string">'click a'</span>: <span class="string">'click:link'</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  onClickLink(view, event) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Show the modal'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 也可以手动触发</span></span><br><span class="line">MyView.triggerMethod(<span class="string">'click a'</span>); <span class="comment">// onClickLink</span></span><br></pre></td></tr></table></figure><blockquote><p><code>childViewEvents</code> </p></blockquote><h3 id="ui"><a href="#ui" class="headerlink" title="ui"></a><code>ui</code></h3><blockquote><p>就是<code>query</code>出<code>view context</code>渲染之后的范围内<code>DOM Element</code>（this.$(selector)）</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Backbone-marionette新手入门系列&quot;&gt;&lt;a href=&quot;#Backbone-marionette新手入门系列&quot; class=&quot;headerlink&quot; title=&quot;Backbone.marionette新手入门系列&quot;&gt;&lt;/a&gt;Backbone.ma
      
    
    </summary>
    
      <category term="backbone" scheme="https://betgar.github.io/categories/backbone/"/>
    
    
      <category term="backbone" scheme="https://betgar.github.io/tags/backbone/"/>
    
      <category term="marionette" scheme="https://betgar.github.io/tags/marionette/"/>
    
  </entry>
  
  <entry>
    <title>jQuery Validation使用总结</title>
    <link href="https://betgar.github.io/2018/10/09/how-to-use-jquery-validation/"/>
    <id>https://betgar.github.io/2018/10/09/how-to-use-jquery-validation/</id>
    <published>2018-10-09T08:00:00.000Z</published>
    <updated>2018-10-13T12:24:51.725Z</updated>
    
    <content type="html"><![CDATA[<h1 id="jQuery-Validation使用总结"><a href="#jQuery-Validation使用总结" class="headerlink" title="jQuery Validation使用总结"></a>jQuery Validation使用总结</h1><blockquote><p>注意：表单元素必须含有<code>name</code>属性，不然<code>jQuery validation</code>不工作。</p></blockquote><h2 id="options配置"><a href="#options配置" class="headerlink" title="options配置"></a>options配置</h2><blockquote><p><code>jQuery.validator.defaults</code></p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">        debug : <span class="literal">false</span>,</span><br><span class="line">messages: &#123;&#125;,</span><br><span class="line">groups: &#123;&#125;,</span><br><span class="line">rules: &#123;&#125;,</span><br><span class="line">errorClass: <span class="string">"error"</span>,</span><br><span class="line">pendingClass: <span class="string">"pending"</span>,</span><br><span class="line">validClass: <span class="string">"valid"</span>,</span><br><span class="line">errorElement: <span class="string">"label"</span>,</span><br><span class="line">focusCleanup: <span class="literal">false</span>,</span><br><span class="line">focusInvalid: <span class="literal">true</span>,</span><br><span class="line">errorContainer: $( [] ),</span><br><span class="line">errorLabelContainer: $( [] ),</span><br><span class="line">onsubmit: <span class="literal">true</span>, <span class="comment">// 提交表单时验证</span></span><br><span class="line">ignore: <span class="string">":hidden"</span>, <span class="comment">// 需要忽略不验证的字段，可以自己写selector</span></span><br><span class="line">ignoreTitle: <span class="literal">false</span>, <span class="comment">// 不使用表单元素的title当提示信息</span></span><br><span class="line">onfocusin: <span class="function"><span class="keyword">function</span>(<span class="params"> element </span>) </span>&#123;</span><br><span class="line">&#125;,</span><br><span class="line">onfocusout: <span class="function"><span class="keyword">function</span>(<span class="params"> element </span>) </span>&#123;</span><br><span class="line">&#125;,</span><br><span class="line">onkeyup: <span class="function"><span class="keyword">function</span>(<span class="params"> element, event </span>) </span>&#123;</span><br><span class="line">&#125;,</span><br><span class="line">onclick: <span class="function"><span class="keyword">function</span>(<span class="params"> element </span>) </span>&#123;</span><br><span class="line">&#125;,</span><br><span class="line">highlight: <span class="function"><span class="keyword">function</span>(<span class="params"> element, errorClass, validClass </span>) </span>&#123;</span><br><span class="line">&#125;,</span><br><span class="line">unhighlight: <span class="function"><span class="keyword">function</span>(<span class="params"> element, errorClass, validClass </span>) </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h2><blockquote><p><code>jQuery.validator</code>有三类方法：</p><ol><li><p><code>$.validator</code>的<strong>静态方法</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;    $.validator.format(<span class="string">'请输入至少&#123;0&#125;个字符'</span>);</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></li></ol></blockquote><blockquote><ol start="2"><li><p><code>$(&#39;选择器&#39;).validate()</code>返回的<code>$.validator</code><strong>实例方法</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;    <span class="keyword">var</span> validator = $(<span class="string">'form'</span>).validate();</span><br><span class="line">&gt;    validator.form();</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></li></ol></blockquote><blockquote><ol start="3"><li><p>插件的方法</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;    $().validate();</span><br><span class="line">&gt;    $().valid();</span><br><span class="line">&gt;    $().rules();</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></li></ol></blockquote><h2 id="自定义的选择器"><a href="#自定义的选择器" class="headerlink" title="自定义的选择器"></a>自定义的选择器</h2><blockquote><p>插件扩展了<code>selector</code>选择器。</p></blockquote><ul><li><code>:blink</code></li><li><code>:filled</code></li><li><code>:unchecked</code></li></ul><h2 id="Validator实例的方法"><a href="#Validator实例的方法" class="headerlink" title="Validator实例的方法"></a><code>Validator</code>实例的方法</h2><blockquote><p><code>Validator</code>实例的公共方法。</p></blockquote><h3 id="form"><a href="#form" class="headerlink" title="form()"></a>form()</h3><blockquote><p>触发校验.</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> formValidator = $(<span class="string">'form'</span>).validate();</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (formValidator.form()) &#123;</span><br><span class="line">   <span class="built_in">console</span>.log(<span class="string">'valid form'</span>);    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="element-element"><a href="#element-element" class="headerlink" title="element(element)"></a>element(element)</h3><blockquote><p>校验单个表单元素</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> formValidator = $(<span class="string">'form'</span>).validate();</span><br><span class="line"><span class="keyword">if</span> (formValidator.element(<span class="string">'#startDate'</span>))&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'valid element'</span>);    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="resetForm"><a href="#resetForm" class="headerlink" title="resetForm()"></a>resetForm()</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> formValidator = $(<span class="string">'form'</span>).validate();</span><br><span class="line">formValidator.resetForm();</span><br></pre></td></tr></table></figure><h3 id="showErrors-errors"><a href="#showErrors-errors" class="headerlink" title="showErrors(errors)"></a>showErrors(errors)</h3><blockquote><p><code>errors</code>是<code>Object</code>类型， <code>key</code>是表单元素的<code>name</code>属性，<code>value</code>是要显示的消息</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> formValidator = $(<span class="string">'form'</span>).validate();</span><br><span class="line">formValidator.showErrors(&#123;</span><br><span class="line">    firstName: <span class="string">'请输入名字'</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="numberOfInvalids-errors"><a href="#numberOfInvalids-errors" class="headerlink" title="numberOfInvalids([errors])"></a>numberOfInvalids([errors])</h3><blockquote><p>返回<code>校验不通过的元素个数</code></p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> validator = $( <span class="string">"#myform"</span> ).validate(&#123;</span><br><span class="line">  invalidHandler: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    $( <span class="string">"#summary"</span> ).text( validator.numberOfInvalids() + <span class="string">" field(s) are invalid"</span> );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="destory"><a href="#destory" class="headerlink" title="destory()"></a>destory()</h3><blockquote><p>销毁<code>Validator</code>实例</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> validator = $( <span class="string">"#myform"</span> ).validate();</span><br><span class="line">validator.destroy();</span><br></pre></td></tr></table></figure><h2 id="Validator的静态方法"><a href="#Validator的静态方法" class="headerlink" title="Validator的静态方法"></a><code>Validator</code>的静态方法</h2><h3 id="validator-addMethod-name-method-message"><a href="#validator-addMethod-name-method-message" class="headerlink" title="$.validator.addMethod( name, method [, message ] )"></a>$.validator.addMethod( name, method [, message ] )</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// value: 元素值</span></span><br><span class="line"><span class="comment">// element：元素本身</span></span><br><span class="line"><span class="comment">// params：元素规则</span></span><br><span class="line">jQuery.validator.addMethod(<span class="string">"math"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">value, element, params</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.optional(element) || value == params[<span class="number">0</span>] + params[<span class="number">1</span>];</span><br><span class="line">&#125;, jQuery.validator.format(<span class="string">"Please enter the correct value for &#123;0&#125; + &#123;1&#125;"</span>));</span><br></pre></td></tr></table></figure><h3 id="validator-format-template-argument-argumentN…"><a href="#validator-format-template-argument-argumentN…" class="headerlink" title="$.validator.format( template, argument, argumentN… )"></a>$.validator.format( template, argument, argumentN… )</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> template = jQuery.validator.format(<span class="string">"&#123;0&#125; is not a valid value"</span>);</span><br><span class="line"><span class="comment">// later, results in 'abc is not a valid value'</span></span><br><span class="line">alert(template(<span class="string">"abc"</span>));</span><br></pre></td></tr></table></figure><h3 id="validator-setDefaults-options"><a href="#validator-setDefaults-options" class="headerlink" title="$.validator.setDefaults(options)"></a>$.validator.setDefaults(options)</h3><blockquote><p>options参考<code>validate(options)</code></p><p>重置全局<code>validator</code>配置</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">jQuery.validator.setDefaults(&#123;</span><br><span class="line">  debug: <span class="literal">true</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="validator-addClassRules"><a href="#validator-addClassRules" class="headerlink" title="$.validator.addClassRules()"></a>$.validator.addClassRules()</h3><blockquote><p>添加校验规则。</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">jQuery.validator.addClassRules(<span class="string">"name"</span>, &#123;</span><br><span class="line">  required: <span class="literal">true</span>,</span><br><span class="line">  minlength: <span class="number">2</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">jQuery.validator.addClassRules(&#123;</span><br><span class="line">  name: &#123;</span><br><span class="line">    required: <span class="literal">true</span>,</span><br><span class="line">    minlength: <span class="number">2</span></span><br><span class="line">  &#125;,</span><br><span class="line">  zip: &#123;</span><br><span class="line">    required: <span class="literal">true</span>,</span><br><span class="line">    digits: <span class="literal">true</span>,</span><br><span class="line">    minlength: <span class="number">5</span>,</span><br><span class="line">    maxlength: <span class="number">5</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="Validator内置的方法"><a href="#Validator内置的方法" class="headerlink" title="Validator内置的方法"></a><code>Validator</code>内置的方法</h2><h3 id="required"><a href="#required" class="headerlink" title="required"></a>required</h3><blockquote><p>适用: <code>input, select, checkbox, radio</code></p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 内部方法签名</span></span><br><span class="line">required();</span><br><span class="line">required(selector);</span><br><span class="line">required(callback);</span><br></pre></td></tr></table></figure><blockquote><p>input</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">"myform"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"field"</span>&gt;</span>Required: <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"left"</span> <span class="attr">id</span>=<span class="string">"field"</span> <span class="attr">name</span>=<span class="string">"field"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"Validate!"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// boolean</span></span><br><span class="line">$( <span class="string">"#myform"</span> ).validate(&#123;</span><br><span class="line">  rules: &#123;</span><br><span class="line">    field: &#123;</span><br><span class="line">      required: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><blockquote><p>Select</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">"myform"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"fruit"</span>&gt;</span>Please select a fruit<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"fruit"</span> <span class="attr">name</span>=<span class="string">"fruit"</span> <span class="attr">title</span>=<span class="string">"Please select something!"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">""</span>&gt;</span>Select...<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"1"</span>&gt;</span>Banana<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"2"</span>&gt;</span>Apple<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"3"</span>&gt;</span>Peach<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"Validate!"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$( <span class="string">"#myform"</span> ).validate(&#123;</span><br><span class="line">  rules: &#123;</span><br><span class="line">    fruit: &#123;</span><br><span class="line">      required: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><blockquote><p>radio</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">"myform"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"gender_male"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span>  <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">id</span>=<span class="string">"gender_male"</span> <span class="attr">value</span>=<span class="string">"m"</span> <span class="attr">name</span>=<span class="string">"gender"</span> /&gt;</span></span><br><span class="line">      Male</span><br><span class="line">    <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"gender_female"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span>  <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">id</span>=<span class="string">"gender_female"</span> <span class="attr">value</span>=<span class="string">"f"</span> <span class="attr">name</span>=<span class="string">"gender"</span>/&gt;</span></span><br><span class="line">      Female</span><br><span class="line">    <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"gender"</span> <span class="attr">class</span>=<span class="string">"error"</span>&gt;</span>Please select your gender<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"Validate!"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$( <span class="string">"#myform"</span> ).validate(&#123;</span><br><span class="line">  rules: &#123;</span><br><span class="line">    gender: &#123;</span><br><span class="line">      required: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><blockquote><p>checkbox</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">"myform"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"agree"</span>&gt;</span>Please agree to our policy<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">id</span>=<span class="string">"agree"</span> <span class="attr">title</span>=<span class="string">"Please agree to our policy!"</span> <span class="attr">name</span>=<span class="string">"agree"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"Validate!"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$( <span class="string">"#myform"</span> ).validate(&#123;</span><br><span class="line">  rules: &#123;</span><br><span class="line">    agree: &#123;</span><br><span class="line">      required: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><blockquote><p>依赖其它元素(dependence-expression)</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">"myform"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"other"</span>&gt;</span>Check to make next field required<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"other"</span> <span class="attr">type</span>=<span class="string">"checkbox"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"details"</span> <span class="attr">name</span>=<span class="string">"details"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"Validate!"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$( <span class="string">"#myform"</span> ).validate(&#123;</span><br><span class="line">  rules: &#123;</span><br><span class="line">    details: &#123;</span><br><span class="line">      required: <span class="string">"#other:checked"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><blockquote><p>function</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">"myform"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span>Age <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"age"</span> <span class="attr">name</span>=<span class="string">"age"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span>Parent <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"parent"</span> <span class="attr">name</span>=<span class="string">"parent"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"Validate!"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$( <span class="string">"#myform"</span> ).validate(&#123;</span><br><span class="line">  rules: &#123;</span><br><span class="line">    age: &#123;</span><br><span class="line">      required: <span class="literal">true</span>,</span><br><span class="line">      min: <span class="number">3</span></span><br><span class="line">    &#125;,</span><br><span class="line">    parent: &#123;</span><br><span class="line">      required: <span class="function"><span class="keyword">function</span>(<span class="params">element</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> $(<span class="string">"#age"</span>).val() &lt; <span class="number">13</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="minlength-length"><a href="#minlength-length" class="headerlink" title="minlength(length)"></a>minlength(length)</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$( <span class="string">"#myform"</span> ).validate(&#123;</span><br><span class="line">  rules: &#123;</span><br><span class="line">    field: &#123;</span><br><span class="line">      required: <span class="literal">true</span>,</span><br><span class="line">      minlength: <span class="number">3</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="maxlength-length"><a href="#maxlength-length" class="headerlink" title="maxlength(length)"></a>maxlength(length)</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$( <span class="string">"#myform"</span> ).validate(&#123;</span><br><span class="line">  rules: &#123;</span><br><span class="line">    field: &#123;</span><br><span class="line">      required: <span class="literal">true</span>,</span><br><span class="line">      maxlength: <span class="number">4</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="ranglength-Array"><a href="#ranglength-Array" class="headerlink" title="ranglength(Array)"></a>ranglength(Array)</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$( <span class="string">"#myform"</span> ).validate(&#123;</span><br><span class="line">  rules: &#123;</span><br><span class="line">    field: &#123;</span><br><span class="line">      required: <span class="literal">true</span>,</span><br><span class="line">      rangelength: [<span class="number">2</span>, <span class="number">6</span>]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="min-value"><a href="#min-value" class="headerlink" title="min(value)"></a>min(value)</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$( <span class="string">"#myform"</span> ).validate(&#123;</span><br><span class="line">  rules: &#123;</span><br><span class="line">    field: &#123;</span><br><span class="line">      required: <span class="literal">true</span>,</span><br><span class="line">      min: <span class="number">13</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="max-value"><a href="#max-value" class="headerlink" title="max(value)"></a>max(value)</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$( <span class="string">"#myform"</span> ).validate(&#123;</span><br><span class="line">  rules: &#123;</span><br><span class="line">    field: &#123;</span><br><span class="line">      required: <span class="literal">true</span>,</span><br><span class="line">      max: <span class="number">13</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="range-range"><a href="#range-range" class="headerlink" title="range( range )"></a>range( range )</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$( <span class="string">"#myform"</span> ).validate(&#123;</span><br><span class="line">  rules: &#123;</span><br><span class="line">    field: &#123;</span><br><span class="line">      required: <span class="literal">true</span>,</span><br><span class="line">      range: [<span class="number">13</span>, <span class="number">23</span>]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="step-value"><a href="#step-value" class="headerlink" title="step( value )"></a>step( value )</h3><blockquote><p>输入的数字是step的倍数</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$( <span class="string">"#myform"</span> ).validate(&#123;</span><br><span class="line">  rules: &#123;</span><br><span class="line">    field: &#123;</span><br><span class="line">      required: <span class="literal">true</span>,</span><br><span class="line">      step: <span class="number">10</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="email"><a href="#email" class="headerlink" title="email"></a>email</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$( <span class="string">"#myform"</span> ).validate(&#123;</span><br><span class="line">  rules: &#123;</span><br><span class="line">    field: &#123;</span><br><span class="line">      required: <span class="literal">true</span>,</span><br><span class="line">      email: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="url"><a href="#url" class="headerlink" title="url"></a>url</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$( <span class="string">"#myform"</span> ).validate(&#123;</span><br><span class="line">  rules: &#123;</span><br><span class="line">    field: &#123;</span><br><span class="line">      required: <span class="literal">true</span>,</span><br><span class="line">      url: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="number"><a href="#number" class="headerlink" title="number"></a>number</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$( <span class="string">"#myform"</span> ).validate(&#123;</span><br><span class="line">  rules: &#123;</span><br><span class="line">    field: &#123;</span><br><span class="line">      required: <span class="literal">true</span>,</span><br><span class="line">      number: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="digits"><a href="#digits" class="headerlink" title="digits"></a>digits</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$( <span class="string">"#myform"</span> ).validate(&#123;</span><br><span class="line">  rules: &#123;</span><br><span class="line">    field: &#123;</span><br><span class="line">      required: <span class="literal">true</span>,</span><br><span class="line">      digits: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="equalTo-Selector"><a href="#equalTo-Selector" class="headerlink" title="equalTo(Selector)"></a>equalTo(Selector)</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$( <span class="string">"#myform"</span> ).validate(&#123;</span><br><span class="line">  rules: &#123;</span><br><span class="line">    password: <span class="string">"required"</span>,</span><br><span class="line">    password_again: &#123;</span><br><span class="line">      equalTo: <span class="string">"#password"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="dateISO"><a href="#dateISO" class="headerlink" title="dateISO"></a>dateISO</h3><blockquote><p>字段是合法时间，非格式。</p><p>适用：<code>input</code></p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$( <span class="string">"#myform"</span> ).validate(&#123;</span><br><span class="line">  rules: &#123;</span><br><span class="line">    field: &#123;</span><br><span class="line">      required: <span class="literal">true</span>,</span><br><span class="line">      dateISO: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="additional-methods"><a href="#additional-methods" class="headerlink" title="additional-methods"></a>additional-methods</h2><blockquote><p>包含在<code>additional-methods.js</code> </p></blockquote><h3 id="accept-mimetype"><a href="#accept-mimetype" class="headerlink" title="accept(mimetype)"></a>accept(mimetype)</h3><blockquote><p> 校验文件后缀</p><p> 适用：<code>&lt;input type=&quot;file&quot;&gt;</code></p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$( <span class="string">"#myform"</span> ).validate(&#123;</span><br><span class="line">  rules: &#123;</span><br><span class="line">    field: &#123;</span><br><span class="line">      required: <span class="literal">true</span>,</span><br><span class="line">      accept: <span class="string">"audio/*"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="creditcard"><a href="#creditcard" class="headerlink" title="creditcard()"></a>creditcard()</h3><blockquote><p>校验信用卡号</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$( <span class="string">"#myform"</span> ).validate(&#123;</span><br><span class="line">  rules: &#123;</span><br><span class="line">    field: &#123;</span><br><span class="line">      required: <span class="literal">true</span>,</span><br><span class="line">      creditcard: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="phoneUS"><a href="#phoneUS" class="headerlink" title="phoneUS"></a>phoneUS</h3><blockquote><p>可以参考实现电话校验</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$( <span class="string">"#myform"</span> ).validate(&#123;</span><br><span class="line">  rules: &#123;</span><br><span class="line">    field: &#123;</span><br><span class="line">      required: <span class="literal">true</span>,</span><br><span class="line">      phoneUS: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="require-from-group"><a href="#require-from-group" class="headerlink" title="require_from_group"></a>require_from_group</h3><blockquote><p>一组至少填写几个。</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">"myform"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"mobile_phone"</span>&gt;</span>Mobile phone: <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">"left phone-group"</span> <span class="attr">id</span>=<span class="string">"mobile_phone"</span> <span class="attr">name</span>=<span class="string">"mobile_phone"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"home_phone"</span>&gt;</span>Home phone: <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">"left phone-group"</span> <span class="attr">id</span>=<span class="string">"home_phone"</span> <span class="attr">name</span>=<span class="string">"home_phone"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"work_phone"</span>&gt;</span>Work phone: <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">"left phone-group"</span> <span class="attr">id</span>=<span class="string">"work_phone"</span> <span class="attr">name</span>=<span class="string">"work_phone"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"Validate!"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$( <span class="string">"#myform"</span> ).validate(&#123;</span><br><span class="line">  rules: &#123;</span><br><span class="line">    mobile_phone: &#123;</span><br><span class="line">      require_from_group: [<span class="number">1</span>, <span class="string">".phone-group"</span>]</span><br><span class="line">    &#125;,</span><br><span class="line">    home_phone: &#123;</span><br><span class="line">      require_from_group: [<span class="number">1</span>, <span class="string">".phone-group"</span>]</span><br><span class="line">    &#125;,</span><br><span class="line">    work_phone: &#123;</span><br><span class="line">      require_from_group: [<span class="number">1</span>, <span class="string">".phone-group"</span>]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="extension-extension"><a href="#extension-extension" class="headerlink" title="extension( [extension ] )"></a>extension( [extension ] )</h3><blockquote><p>参数：<code>string</code></p><p>默认值： <code>png|jpe?g|gif</code></p><p>适用：<code>&lt;input&gt;</code></p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$( <span class="string">"#myform"</span> ).validate(&#123;</span><br><span class="line">  rules: &#123;</span><br><span class="line">    field: &#123;</span><br><span class="line">      required: <span class="literal">true</span>,</span><br><span class="line">      extension: <span class="string">"xls|csv"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="重构规则-组合规则"><a href="#重构规则-组合规则" class="headerlink" title="重构规则(组合规则)"></a>重构规则(组合规则)</h2><blockquote><p>重构规则，可以把多个规则组合起来，一起使用。</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// alias required to cRequired with new message</span></span><br><span class="line">$.validator.addMethod(<span class="string">"cRequired"</span>, $.validator.methods.required,</span><br><span class="line">  <span class="string">"Customer name required"</span>);</span><br><span class="line"><span class="comment">// alias minlength, too</span></span><br><span class="line">$.validator.addMethod(<span class="string">"cMinlength"</span>, $.validator.methods.minlength,</span><br><span class="line">  <span class="comment">// leverage parameter replacement for minlength, &#123;0&#125; gets replaced with 2</span></span><br><span class="line">  $.validator.format(<span class="string">"Customer name must have at least &#123;0&#125; characters"</span>));</span><br><span class="line"><span class="comment">// combine them both, including the parameter for minlength</span></span><br><span class="line">$.validator.addClassRules(<span class="string">"customer"</span>, &#123; <span class="attr">cRequired</span>: <span class="literal">true</span>, <span class="attr">cMinlength</span>: <span class="number">2</span> &#125;);</span><br></pre></td></tr></table></figure><h2 id="错误消息"><a href="#错误消息" class="headerlink" title="错误消息"></a>错误消息</h2><ul><li><p>错误消息有四种提供方式: options,  data-*,  element title,  default messages</p></li><li><p>错误消息的优先级：options &gt; element title属性 &gt; default messages</p></li><li><p>可以使用<strong>统一消息</strong>，也可以指定<strong>具体的规则消息</strong></p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">required</span> <span class="attr">data-msg</span>=<span class="string">"Please fill this field"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">data-rule-minlength</span>=<span class="string">"2"</span> <span class="attr">data-rule-maxlength</span>=<span class="string">"4"</span> <span class="attr">data-msg-minlength</span>=<span class="string">"At least two chars"</span> <span class="attr">data-msg-maxlength</span>=<span class="string">"At most fours chars"</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="跳过验证提交"><a href="#跳过验证提交" class="headerlink" title="跳过验证提交"></a>跳过验证提交</h2><blockquote><p>添加<code>formnovalidate</code>属性。</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">formnovalidate</span> <span class="attr">name</span>=<span class="string">"cancel"</span> <span class="attr">value</span>=<span class="string">"Cancel"</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="验证事件"><a href="#验证事件" class="headerlink" title="验证事件"></a>验证事件</h2><blockquote><p>默认情况下，<code>form</code>在用户点击<code>submit</code>按钮，或者<code>input</code>获得焦点时，按下<code>enter</code>键。</p><p>另外，如果一个<code>field</code>已经高亮并且<code>invalid</code>，当用户输入任何东西，它都会被验证（使用onkeyup）.</p><p>当用户在一个已经验证为<code>valid</code>的<code>field</code>中输入任何东西，在<code>field</code>失去焦点时被验证（onfoucsout）。</p></blockquote><h2 id="normalizer"><a href="#normalizer" class="headerlink" title="normalizer"></a>normalizer</h2><blockquote><p><code>normalizer</code>: 是非常有用的一个方法，因为<code>form</code>中的组件，不可能全是原生的组件，所以提供这个方法，用来返回组件的值。</p><p>注意：</p><ol><li>normalizer：不能改变组件的值，只能把改变后的值，给<code>validator</code>进行校验。</li><li>参数value，是<code>validator</code>内部获取<code>element</code>的值，<strong>在使用第三方组件时，很可能不正确</strong></li><li><code>this</code>时当前被校验的<code>DOMelement</code></li><li>返回值必须时一个<strong>string</strong>类型</li></ol></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$( <span class="string">"#myform"</span> ).validate( &#123;</span><br><span class="line">  rules: &#123;</span><br><span class="line">    field: &#123;</span><br><span class="line">      required: <span class="literal">true</span>,</span><br><span class="line">      normalizer: <span class="function"><span class="keyword">function</span>(<span class="params"> value </span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> dayjs($(<span class="keyword">this</span>).datepicker(<span class="string">'getDate'</span>)).format(<span class="string">'YYYY-MM-DD'</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125; );</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 全局的normalizer和local的normalizer同时使用</span></span><br><span class="line">$( <span class="string">"#myform"</span> ).validate( &#123;</span><br><span class="line">  normalizer: <span class="function"><span class="keyword">function</span>(<span class="params"> value </span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> $.trim( value );</span><br><span class="line">  &#125;,</span><br><span class="line">  rules: &#123;</span><br><span class="line">    username: &#123;</span><br><span class="line">      required: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    url_input: &#123;</span><br><span class="line">      required: <span class="literal">true</span>,</span><br><span class="line">      url: <span class="literal">true</span>,</span><br><span class="line">      normalizer: <span class="function"><span class="keyword">function</span>(<span class="params"> value </span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> url = value;</span><br><span class="line"><span class="comment">// 可以修改</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">'https://'</span> + url;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125; );</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;jQuery-Validation使用总结&quot;&gt;&lt;a href=&quot;#jQuery-Validation使用总结&quot; class=&quot;headerlink&quot; title=&quot;jQuery Validation使用总结&quot;&gt;&lt;/a&gt;jQuery Validation使用总结&lt;/
      
    
    </summary>
    
      <category term="Validation" scheme="https://betgar.github.io/categories/Validation/"/>
    
    
      <category term="Validation" scheme="https://betgar.github.io/tags/Validation/"/>
    
  </entry>
  
  <entry>
    <title>requirejs的快速入门</title>
    <link href="https://betgar.github.io/2018/09/12/the-quick-start-of-requirejs/"/>
    <id>https://betgar.github.io/2018/09/12/the-quick-start-of-requirejs/</id>
    <published>2018-09-11T16:00:00.000Z</published>
    <updated>2018-10-05T12:18:56.454Z</updated>
    
    <content type="html"><![CDATA[<h1 id="requirejs的快速入门"><a href="#requirejs的快速入门" class="headerlink" title="requirejs的快速入门"></a>requirejs的快速入门</h1><blockquote><p>阮一峰老师的入门系列。</p></blockquote><p><a href="http://javascript.ruanyifeng.com/tool/requirejs.html" target="_blank" rel="noopener">RequireJS和AMD规范</a></p><p><a href="http://www.ruanyifeng.com/blog/2012/10/javascript_module.html" target="_blank" rel="noopener">Javascript模块化编程（一）：模块的写法</a></p><p><a href="http://www.ruanyifeng.com/blog/2012/10/asynchronous_module_definition.html" target="_blank" rel="noopener">Javascript模块化编程（二）：AMD规范</a></p><p><a href="http://www.ruanyifeng.com/blog/2012/11/require_js.html" target="_blank" rel="noopener">Javascript模块化编程（三）：require.js的用法</a></p><h2 id="AMD规范"><a href="#AMD规范" class="headerlink" title="AMD规范"></a>AMD规范</h2><blockquote><p><code>AMD</code>规范对<code>loader</code>，<code>loader plugins</code>， <code>require</code>有详细的规定。详情见<a href="https://github.com/amdjs/amdjs-api/wiki" target="_blank" rel="noopener"> AMD 规范wiki</a>，这里还有中文版。</p></blockquote><h3 id="define函数"><a href="#define函数" class="headerlink" title="define函数"></a>define函数</h3><p><code>define(id?, dependencies?, factory)</code></p><blockquote><p>require, exports, module 三个模块是<strong>顶级模块</strong>。</p></blockquote><p>例子：</p><p>创建一个名为”alpha”的模块，使用了require，exports，和名为”beta”的模块:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">define(<span class="string">"alpha"</span>, [<span class="string">"require"</span>, <span class="string">"exports"</span>, <span class="string">"beta"</span>], <span class="function"><span class="keyword">function</span> (<span class="params">require, exports, beta</span>) </span>&#123;</span><br><span class="line">    exports.verb = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> beta.verb();</span><br><span class="line">        <span class="comment">//Or:</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">require</span>(<span class="string">"beta"</span>).verb();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>一个返回对象的匿名模块：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">define([<span class="string">"alpha"</span>], <span class="function"><span class="keyword">function</span> (<span class="params">alpha</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      verb: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> alpha.verb() + <span class="number">2</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>一个没有依赖性的模块可以直接定义对象：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">define(&#123;</span><br><span class="line">  add: <span class="function"><span class="keyword">function</span>(<span class="params">x, y</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x + y;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>一个使用了简单CommonJS转换的模块定义：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">define(<span class="function"><span class="keyword">function</span> (<span class="params">require, exports, module</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> a = <span class="built_in">require</span>(<span class="string">'a'</span>),</span><br><span class="line">      b = <span class="built_in">require</span>(<span class="string">'b'</span>);</span><br><span class="line"></span><br><span class="line">  exports.action = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="require函数"><a href="#require函数" class="headerlink" title="require函数"></a>require函数</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">define([<span class="string">'require'</span>], <span class="function"><span class="keyword">function</span> (<span class="params">require</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//the require in here is a local require.</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">define(<span class="function"><span class="keyword">function</span> (<span class="params">require, exports, module</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//the require in here is a local require.</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">define(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> $ = <span class="built_in">require</span>(<span class="string">'jquery'</span>); <span class="comment">// 全局require</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>全局require函数作用于全局，和define()类似。 全局require和局部require有着相同的行为，包含以下特征：</p><ul><li>模块ID应该认为是一个绝对的模块名称，而不是相对另一个模块的ID。</li><li>只有在异步的时候，才可以使用require(id, callback?)的回调形式。因为异步加载模块的方式是先发出一个异步请求，然后等主线程代码段执行完毕才能进行异步回调来处理加载好的模块。</li></ul><h4 id="require-String"><a href="#require-String" class="headerlink" title="require(String)"></a>require(String)</h4><blockquote><p>如果模块没有加载或者执行完成，就会抛出错误。特别需要指出的是，在同步加载的回调中，如果模块没有加载完成，禁止动态的获取模块，否则，就会抛出异常。</p><p>使用define()定义模块时，依赖项中可以找到一个AMD模块：</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">define(<span class="function"><span class="keyword">function</span> (<span class="params">require</span>) </span>&#123;</span><br><span class="line">       <span class="keyword">var</span> a = <span class="built_in">require</span>(<span class="string">'a'</span>);</span><br><span class="line">   &#125;);</span><br></pre></td></tr></table></figure><h4 id="require-Array-Function"><a href="#require-Array-Function" class="headerlink" title="require(Array, Function)"></a>require(Array, Function)</h4><blockquote><p>根据参数，<strong>同步</strong>地返回模块ID所代表的模块。</p><p>参数Array是一个由模块ID组成的数组。当模块ID所以代表的模块加载完成且可用时，回调函数Function才开始执行，并且只被执行一次。各个模块按照依赖数组中的位置顺序以参数的形式传入到Function里。</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">define(<span class="function"><span class="keyword">function</span> (<span class="params">require</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">require</span>([<span class="string">'a'</span>, <span class="string">'b'</span>], <span class="function"><span class="keyword">function</span> (<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">            <span class="comment">//modules a and b are now available for use.</span></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure><h4 id="require-toUrl-String"><a href="#require-toUrl-String" class="headerlink" title="require.toUrl(String)"></a>require.toUrl(String)</h4><blockquote><p>将形如<strong>[module ID] + ‘.extension’</strong>这种字符形式转化成URL路径。</p><p>require.toUrl()方法采用通用的模块ID路径转化规则,将模块ID字符解析成URL路径.但它不支持以”.js”这种扩展形式。所以，我们必须将’.extension’添加到了解析路径里。</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//cart.js contents:</span></span><br><span class="line">  define (<span class="function"><span class="keyword">function</span>(<span class="params">require</span>) </span>&#123;</span><br><span class="line">      <span class="comment">// 模块ID名 './templates/a'</span></span><br><span class="line">      <span class="comment">// 扩展名 '.html'</span></span><br><span class="line">      <span class="comment">// 模板路径大致以这样的形式结尾 'modules/cart/templates/a.html'</span></span><br><span class="line">      <span class="keyword">var</span> templatePath = <span class="built_in">require</span>.toUrl(<span class="string">'./templates/a.html'</span>);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><h3 id="config配置"><a href="#config配置" class="headerlink" title="config配置"></a>config配置</h3><p>公共项:</p><ul><li><p>模块id前缀：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">some/very/long/name</span><br></pre></td></tr></table></figure><p>例如：以下都是模块id前缀:</p><ul><li><code>some</code></li><li><code>some/very</code></li><li><code>some/very/long</code></li><li><code>some/very/long/name</code></li></ul></li><li><p><strong>模块id前缀的第一个段</strong>: 模块id，从第一个 <code>/</code>作为分割，之前的字符串部分全是。 </p></li></ul><h4 id="baseUrl"><a href="#baseUrl" class="headerlink" title="baseUrl"></a>baseUrl</h4><blockquote><p>字符串类型。给id到path转换指定一个根目录 。</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    baseUrl: <span class="string">'./js'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="paths"><a href="#paths" class="headerlink" title="paths"></a>paths</h4><blockquote><p>对象类型。给模块id前缀(module ID prefix)<strong>显式</strong>指定一个路径(path)。</p><p>paths对象的属性是一个<strong>绝对</strong>的模块ID前缀(module ID prefix)，属性值可以是：</p><p>字符串：字符串值是一个<strong>相对于baseUrl的路径</strong>。也可以是一个绝对路径，只要以 <code>/或者//或者http</code>开头。</p><p>数组：可选。提供一个可选的容错功能。如果数组第一个路径加载失败，则可以尝试从下一个路径加载，以此类推。</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 路径： js/lib/jquery.js</span></span><br><span class="line">&#123;</span><br><span class="line">    paths: &#123;</span><br><span class="line">        jquery: <span class="string">'./lib/jquery'</span></span><br><span class="line">        bootstrap: [</span><br><span class="line">            <span class="string">'https://cdn/bootstrap'</span>,</span><br><span class="line">            <span class="string">'./lib/bootstrap'</span></span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="packages"><a href="#packages" class="headerlink" title="packages"></a>packages</h4><p>package 配置对象的值是一个数组。因为CommonJS规范和AMD规范的loader查找路径方式的差异，所以package配置对象是为了使用实现了CommonJS规范的包。</p><p><strong>默认的查找规则</strong>：<code>baseUrl + &#39;module/id&#39; + .js</code>，其中<code>paths</code>配置可以用来映射<code>module/id</code>到另一个路径。</p><p><strong>包的查找规则</strong>：使用了一个<code>packageName</code>。所以一个包的主模块就是<code>baseUrl + &#39;packageName&#39; + .js</code></p><blockquote><p><code>main.js</code>默认作为一个package的入口.</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">baseUrl + (packageConfig.location || &apos;packageName&apos;) + &apos;/&apos; + (packageConfig.main || &apos;main&apos;) + &apos;.js&apos;</span><br></pre></td></tr></table></figure><p>对于<code>packageName/otherId</code>，规则和paths相似，但是<code>packageConfig</code>是这样实现的：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">baseUrl + (packageConfig.location || &apos;packageName&apos;) + &apos;/&apos; + &apos;otherId&apos; + &apos;.js&apos;</span><br></pre></td></tr></table></figure><p>package 配置对象可以是：</p><ul><li><p>字符串：例如：<code>bootstrap/modal</code>：其中<code>bootstrap</code>是<code>packageName</code>名称，<code>boostrap/modal</code>也是一个<code>packageName</code>。依赖<code>bootstrap/modal</code>时，查找规则如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">baseUrl + `bootstrap/modal` + main.js`</span><br></pre></td></tr></table></figure></li><li><p>对象: a configuration object that can have the following properties:</p><ul><li><strong>name</strong>: 字符串. 解析规则同<strong>上述字符串解析规则一样</strong>.</li><li><strong>location</strong>: 字符串，可选.相对于<code>baseUrl</code>的路径。</li><li><strong>main</strong>: 字符串. 可选.指定包入口。 默认为<code>main</code></li></ul></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;   </span><br><span class="line">packages: [</span><br><span class="line">    <span class="string">'main'</span>,</span><br><span class="line">        &#123;</span><br><span class="line">            name: <span class="string">'dojo'</span>,</span><br><span class="line">            location: <span class="string">'dojo/1.7.1'</span>,</span><br><span class="line">            main:<span class="string">'main'</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="config"><a href="#config" class="headerlink" title="config"></a>config</h4><blockquote><p>用来模块间传递一些信息使用的。</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    config: &#123;</span><br><span class="line">        <span class="string">'some/module/id'</span>: &#123;</span><br><span class="line">            limit: <span class="number">40</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">define([<span class="string">'some/module/id'</span>], <span class="function"><span class="keyword">function</span> (<span class="params">someModule</span>) </span>&#123;</span><br><span class="line">    someModule.config().limit === <span class="number">40</span> <span class="comment">// true</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h4 id="shim"><a href="#shim" class="headerlink" title="shim"></a>shim</h4><blockquote><p>解决那些非<code>AMD模块</code>之间的依赖。</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    shim: &#123;</span><br><span class="line">        <span class="comment">//This version just specifies the</span></span><br><span class="line">        <span class="comment">//dependency for the jQuery plugin. </span></span><br><span class="line">        <span class="comment">//Some implementations may be able to do</span></span><br><span class="line">        <span class="comment">//better error correction in older IE if</span></span><br><span class="line">        <span class="comment">//you specify the exports string value,</span></span><br><span class="line">        <span class="comment">//which in this case would be</span></span><br><span class="line">        <span class="comment">//exports: 'jQuery.fn.rotator'</span></span><br><span class="line">        <span class="string">'jquery.rotator'</span>: [<span class="string">'jquery'</span>],</span><br><span class="line"></span><br><span class="line">        underscore: &#123;</span><br><span class="line">            exports: <span class="string">'_'</span></span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line">        backbone: &#123;</span><br><span class="line">            deps: [<span class="string">'jquery'</span>, <span class="string">'underscore'</span>],</span><br><span class="line">            exports: <span class="string">'Backbone'</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="map"><a href="#map" class="headerlink" title="map"></a>map</h4><blockquote><p>解决模块间同时依赖不同版本的问题。</p><p><strong>限制</strong>： 这个功能只能用于那些，真正使用<code>define()</code>定义的AMD 模块并且是<strong>匿名模块</strong>.</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    map: &#123;</span><br><span class="line">        <span class="string">'*'</span>: &#123;</span><br><span class="line">            <span class="string">'foo'</span>: <span class="string">'foo1.2'</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">'some/oldmodule'</span>: &#123;</span><br><span class="line">            <span class="string">'foo'</span>: <span class="string">'foo1.0'</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    map: &#123;</span><br><span class="line">        <span class="string">'some/newmodule'</span>: &#123;</span><br><span class="line">            <span class="string">'foo'</span>: <span class="string">'foo1.2'</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">'some/oldmodule'</span>: &#123;</span><br><span class="line">            <span class="string">'foo'</span>: <span class="string">'foo1.0'</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="requirejs"><a href="#requirejs" class="headerlink" title="requirejs"></a>requirejs</h2><blockquote><p>路径解析：<code>baseUrl+paths</code>； </p><p><code>/</code>  ,   <code>http:</code>或者<code>https:</code>，<code>.js</code>结尾的除外。</p><p>requirejs加载脚本<strong>非依赖顺序加载</strong>，执行时是<strong>顺序执行</strong>。</p></blockquote><h3 id="data-main入口"><a href="#data-main入口" class="headerlink" title="data-main入口"></a>data-main入口</h3><h3 id="define函数-1"><a href="#define函数-1" class="headerlink" title="define函数"></a>define函数</h3><h4 id="定义一个对象"><a href="#定义一个对象" class="headerlink" title="定义一个对象"></a>定义一个对象</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">define(&#123;</span><br><span class="line">name: <span class="string">'test'</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h4 id="定义一个函数"><a href="#定义一个函数" class="headerlink" title="定义一个函数"></a>定义一个函数</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">define(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 初始化工作</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        name: <span class="string">'test'</span></span><br><span class="line">    &#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h4 id="requirejs-undef"><a href="#requirejs-undef" class="headerlink" title="requirejs.undef"></a>requirejs.undef</h4><blockquote><p>使用的场景比较少，主要在<strong>模块加载失败</strong>时使用较多</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 官方的demo</span></span><br><span class="line">requirejs.config(&#123;</span><br><span class="line">    enforceDefine: <span class="literal">true</span>,</span><br><span class="line">    paths: &#123;</span><br><span class="line">        jquery: <span class="string">'http://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Later</span></span><br><span class="line"><span class="built_in">require</span>([<span class="string">'jquery'</span>], <span class="function"><span class="keyword">function</span> (<span class="params">$</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//Do something with $ here</span></span><br><span class="line">&#125;, <span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//The errback, error callback</span></span><br><span class="line">    <span class="comment">//The error has a list of modules that failed</span></span><br><span class="line">    <span class="keyword">var</span> failedId = err.requireModules &amp;&amp; err.requireModules[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">if</span> (failedId === <span class="string">'jquery'</span>) &#123;</span><br><span class="line">        <span class="comment">//undef is function only on the global requirejs object.</span></span><br><span class="line">        <span class="comment">//Use it to clear internal knowledge of jQuery. Any modules</span></span><br><span class="line">        <span class="comment">//that were dependent on jQuery and in the middle of loading</span></span><br><span class="line">        <span class="comment">//will not be loaded yet, they will wait until a valid jQuery</span></span><br><span class="line">        <span class="comment">//does load.</span></span><br><span class="line">        requirejs.undef(failedId);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//Set the path to jQuery to local path</span></span><br><span class="line">        requirejs.config(&#123;</span><br><span class="line">            paths: &#123;</span><br><span class="line">                jquery: <span class="string">'local/jquery'</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//Try again. Note that the above require callback</span></span><br><span class="line">        <span class="comment">//with the "Do something with $ here" comment will</span></span><br><span class="line">        <span class="comment">//be called if this new attempt to load jQuery succeeds.</span></span><br><span class="line">        <span class="built_in">require</span>([<span class="string">'jquery'</span>], <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">//Some other error. Maybe show message to the user.</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h4 id="requirejs-config"><a href="#requirejs-config" class="headerlink" title="requirejs.config"></a>requirejs.config</h4><blockquote><p><code>requirejs</code>的配置项，内容较多，参考<a href="https://requirejs.org/docs/api.html" target="_blank" rel="noopener">reqquirejs.org</a></p></blockquote><h4 id="require-toUrl"><a href="#require-toUrl" class="headerlink" title="require.toUrl"></a>require.toUrl</h4><blockquote><p>获取模块的路径。</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 官方demo</span></span><br><span class="line">define([<span class="string">"require"</span>], <span class="function"><span class="keyword">function</span>(<span class="params">require</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> cssUrl = <span class="built_in">require</span>.toUrl(<span class="string">"./style.css"</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;requirejs的快速入门&quot;&gt;&lt;a href=&quot;#requirejs的快速入门&quot; class=&quot;headerlink&quot; title=&quot;requirejs的快速入门&quot;&gt;&lt;/a&gt;requirejs的快速入门&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;阮一峰老师的入门系
      
    
    </summary>
    
      <category term="requirejs" scheme="https://betgar.github.io/categories/requirejs/"/>
    
      <category term="AMD" scheme="https://betgar.github.io/categories/requirejs/AMD/"/>
    
    
      <category term="AMD" scheme="https://betgar.github.io/tags/AMD/"/>
    
      <category term="requirejs" scheme="https://betgar.github.io/tags/requirejs/"/>
    
  </entry>
  
  <entry>
    <title>adminlte-theme-zh-cn-docs</title>
    <link href="https://betgar.github.io/2018/09/09/adminlte-theme-zh-cn-docs/"/>
    <id>https://betgar.github.io/2018/09/09/adminlte-theme-zh-cn-docs/</id>
    <published>2018-09-09T08:52:00.000Z</published>
    <updated>2018-09-26T14:47:11.226Z</updated>
    
    <content type="html"><![CDATA[<h1 id="adminlte主题中文文档"><a href="#adminlte主题中文文档" class="headerlink" title="adminlte主题中文文档"></a>adminlte主题中文文档</h1><blockquote><p>文件结构</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">File Hierarchy of the Source Code Package</span><br><span class="line"></span><br><span class="line">      AdminLTE/</span><br><span class="line">      ├── dist/</span><br><span class="line">      │   ├── CSS/</span><br><span class="line">      │   ├── JS</span><br><span class="line">      │   ├── img</span><br><span class="line">      ├── build/</span><br><span class="line">      │   ├── less/</span><br><span class="line">      │   │   ├── AdminLTE&apos;s Less files</span><br><span class="line">      │   └── Bootstrap-less/ (Only for reference. No modifications have been made)</span><br><span class="line">      │       ├── mixins/</span><br><span class="line">      │       ├── variables.less</span><br><span class="line">      │       ├── mixins.less</span><br><span class="line">      └── plugins/</span><br><span class="line">          ├── All the customized plugins CSS and JS files</span><br></pre></td></tr></table></figure><h2 id="布局"><a href="#布局" class="headerlink" title="布局"></a>布局</h2><ul><li><code>.wrapper</code>.一个div包裹着整个网站。</li><li><code>.main-header</code>. 包含导航和logo。</li><li><code>.sidebar-wrapper</code>. 包含用户面板和侧边栏。</li><li><code>.content-wrapper</code>. 包含页面的头部和内容。</li></ul><h3 id="布局options"><a href="#布局options" class="headerlink" title="布局options"></a>布局<code>options</code></h3><ul><li>AdminLTE 2.0提供了一组应用于主布局的选项。可以将这些类中的每一个添加到body标记中以获得所需的目标。<ul><li><strong>修复：</strong>使用该类<code>.fixed</code>获取固定标题和侧边栏。</li><li><strong>折叠边栏：</strong>使用该类<code>.sidebar-collapse</code>在加载时折叠侧边栏。</li><li><strong>盒装布局：</strong>使用该类<code>.layout-boxed</code>获得仅延伸至1250像素的盒装布局。</li><li><strong>顶部导航</strong>使用该类<code>.layout-top-nav</code>删除侧边栏并在顶部导航栏中显示您的链接。</li></ul></li></ul><h2 id="皮肤"><a href="#皮肤" class="headerlink" title="皮肤"></a>皮肤</h2><p>皮肤可以在dist / css / skins文件夹中找到。选择所需的外观文件，然后将相应的类添加到body标签以更改模板的外观。以下是可用皮肤的列表： </p><table><thead><tr><th>皮肤</th></tr></thead><tbody><tr><td><code>skin-blue</code></td></tr><tr><td><code>skin-blue-light</code></td></tr><tr><td><code>skin-yellow</code></td></tr><tr><td><code>skin-yellow-light</code></td></tr><tr><td><code>skin-green</code></td></tr><tr><td><code>skin-green-light</code></td></tr><tr><td><code>skin-purple</code></td></tr><tr><td><code>skin-purple-light</code></td></tr><tr><td><code>skin-red</code></td></tr><tr><td><code>skin-red-light</code></td></tr><tr><td><code>skin-black</code></td></tr><tr><td><code>skin-black-light</code></td></tr></tbody></table><h2 id="adminlte-JavaScirpt选项"><a href="#adminlte-JavaScirpt选项" class="headerlink" title="adminlte JavaScirpt选项"></a>adminlte JavaScirpt选项</h2><p>可以使用以下方法之一修改AdminLTE app.js的选项。 </p><h4 id="编辑app-js"><a href="#编辑app-js" class="headerlink" title="编辑app.js"></a>编辑app.js</h4><p>在主Javascript文件中，修改<code>$.AdminLTE.options</code>对象以适合您的用例。 </p><h4 id="定义AdminlteOptions"><a href="#定义AdminlteOptions" class="headerlink" title="定义AdminlteOptions"></a>定义AdminlteOptions</h4><p>在初始化app.js之前初始化，例如</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="keyword">var</span> AdminLTEOptions = &#123;</span><br><span class="line">        <span class="comment">//Enable sidebar expand on hover effect for sidebar mini</span></span><br><span class="line">        <span class="comment">//This option is forced to true if both the fixed layout and sidebar mini</span></span><br><span class="line">        <span class="comment">//are used together</span></span><br><span class="line">        sidebarExpandOnHover: <span class="literal">true</span>,</span><br><span class="line">        <span class="comment">//BoxRefresh Plugin</span></span><br><span class="line">        enableBoxRefresh: <span class="literal">true</span>,</span><br><span class="line">        <span class="comment">//Bootstrap.js tooltip</span></span><br><span class="line">        enableBSToppltip: <span class="literal">true</span></span><br><span class="line">    &#125;;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp">&lt;script src="dist/</span>js/app.js<span class="string">" type="</span>text/javascript<span class="string">"&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 添加slimscroll.js到导航菜单，在每个页面的app.js加载之前</span></span><br><span class="line">    navbarMenuSlimscroll: <span class="literal">true</span>,</span><br><span class="line">    <span class="comment">// scroll bar的width</span></span><br><span class="line">    navbarMenuSlimscrollWidth: <span class="string">"3px"</span>,</span><br><span class="line">    <span class="comment">// inner menu的height</span></span><br><span class="line">    navbarMenuHeight: <span class="string">"200px"</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 通用的动画速度，例如box的collapse/expend和sidebar treeview的slid up/down</span></span><br><span class="line">    <span class="comment">// 这个选项接受毫秒整数或者 fast, normal, slow</span></span><br><span class="line">    animationSpeed: <span class="number">500</span>,</span><br><span class="line">    <span class="comment">// sidebar中的push menu 触发器的选择器</span></span><br><span class="line">    sidebarToggleSelector: <span class="string">"[data-toggle='offcanvas']"</span>,</span><br><span class="line">    <span class="comment">// 激活状态的sidebar的push menu</span></span><br><span class="line">    sidebarPushMenu: <span class="literal">true</span>,</span><br><span class="line">    <span class="comment">// 如果设置fixed layout，激活sidebar的slimscroll</span></span><br><span class="line">    sidebarSlimScroll: <span class="literal">true</span>,</span><br><span class="line">    <span class="comment">// 开启 sidebar mini的expand悬浮特效</span></span><br><span class="line">    <span class="comment">// 这个选项在fixed layout和sidebar mini同时使用的时候强制设置为true</span></span><br><span class="line">    sidebarExpandOnHover: <span class="literal">false</span>,</span><br><span class="line">    <span class="comment">// 开启 BoxRefresh 插件</span></span><br><span class="line">    enableBoxRefresh: <span class="literal">true</span>,</span><br><span class="line">    <span class="comment">// 开启bootstrap.js的tooltip插件</span></span><br><span class="line">    enableBSToppltip: <span class="literal">true</span>,</span><br><span class="line">    <span class="comment">// bootstrap tooltip的选择器</span></span><br><span class="line">    BSTooltipSelector: <span class="string">"[data-toggle='tooltip']"</span>,</span><br><span class="line">    <span class="comment">// 开启fast click, fastclick.js 在触控设备上创建了一个更原生的触控体验</span></span><br><span class="line">    <span class="comment">// 如果你开启了，确保在app.js加载之前加载fastclick.js</span></span><br><span class="line">    enableFastclick: <span class="literal">true</span>,</span><br><span class="line">    <span class="comment">//Control Sidebar Tree Views</span></span><br><span class="line">    <span class="comment">// 开启控制 sidebar tree views</span></span><br><span class="line">    enableControlTreeView: <span class="literal">true</span>,</span><br><span class="line">    <span class="comment">// 开启 控制sidebar</span></span><br><span class="line">    enableControlSidebar: <span class="literal">true</span>,</span><br><span class="line">    <span class="comment">// control sidebar options</span></span><br><span class="line">    controlSidebarOptions: &#123;</span><br><span class="line">      <span class="comment">// 触发sidebar open/close事件的button选择器</span></span><br><span class="line">      toggleBtnSelector: <span class="string">"[data-toggle='control-sidebar']"</span>,</span><br><span class="line">      <span class="comment">// sidebar 选择器</span></span><br><span class="line">      selector: <span class="string">".control-sidebar"</span>,</span><br><span class="line">      <span class="comment">// 开启slide over content</span></span><br><span class="line">      slide: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 开启这个选项允许box的collapsed 和 removed效果</span></span><br><span class="line">    enableBoxWidget: <span class="literal">true</span>,</span><br><span class="line">    <span class="comment">//Box Widget plugin options</span></span><br><span class="line">    boxWidgetOptions: &#123;</span><br><span class="line">      boxWidgetIcons: &#123;</span><br><span class="line">        <span class="comment">// 折叠的图标</span></span><br><span class="line">        collapse: <span class="string">'fa-minus'</span>,</span><br><span class="line">        <span class="comment">// 展开图标</span></span><br><span class="line">        open: <span class="string">'fa-plus'</span>,</span><br><span class="line">        <span class="comment">// 移除图标</span></span><br><span class="line">        remove: <span class="string">'fa-times'</span></span><br><span class="line">      &#125;,</span><br><span class="line">      boxWidgetSelectors: &#123;</span><br><span class="line">        <span class="comment">// 移除按钮的选择器</span></span><br><span class="line">        remove: <span class="string">'[data-widget="remove"]'</span>,</span><br><span class="line">        <span class="comment">// 折叠按钮的选择器</span></span><br><span class="line">        collapse: <span class="string">'[data-widget="collapse"]'</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// Direct Chat plugin options</span></span><br><span class="line">    directChat: &#123;</span><br><span class="line">      <span class="comment">// 开启direct chat插件</span></span><br><span class="line">      enable: <span class="literal">true</span>,</span><br><span class="line">      <span class="comment">// 开启或关闭聊天联系人窗口的button选择器</span></span><br><span class="line">      contactToggleSelector: <span class="string">'[data-widget="chat-pane-toggle"]'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//Define the set of colors to use globally around the website</span></span><br><span class="line">    <span class="comment">// 定一个站点的全局一个颜色集合</span></span><br><span class="line">    colors: &#123;</span><br><span class="line">      lightBlue: <span class="string">"#3c8dbc"</span>,</span><br><span class="line">      red: <span class="string">"#f56954"</span>,</span><br><span class="line">      green: <span class="string">"#00a65a"</span>,</span><br><span class="line">      aqua: <span class="string">"#00c0ef"</span>,</span><br><span class="line">      yellow: <span class="string">"#f39c12"</span>,</span><br><span class="line">      blue: <span class="string">"#0073b7"</span>,</span><br><span class="line">      navy: <span class="string">"#001F3F"</span>,</span><br><span class="line">      teal: <span class="string">"#39CCCC"</span>,</span><br><span class="line">      olive: <span class="string">"#3D9970"</span>,</span><br><span class="line">      lime: <span class="string">"#01FF70"</span>,</span><br><span class="line">      orange: <span class="string">"#FF851B"</span>,</span><br><span class="line">      fuchsia: <span class="string">"#F012BE"</span>,</span><br><span class="line">      purple: <span class="string">"#8E24AA"</span>,</span><br><span class="line">      maroon: <span class="string">"#D81B60"</span>,</span><br><span class="line">      black: <span class="string">"#222222"</span>,</span><br><span class="line">      gray: <span class="string">"#d2d6de"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//The standard screen sizes that bootstrap uses.</span></span><br><span class="line">    <span class="comment">//If you change these in the variables.less file, change</span></span><br><span class="line">    <span class="comment">//them here too.</span></span><br><span class="line">    screenSizes: &#123;</span><br><span class="line">      xs: <span class="number">480</span>,</span><br><span class="line">      sm: <span class="number">768</span>,</span><br><span class="line">      md: <span class="number">992</span>,</span><br><span class="line">      lg: <span class="number">1200</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h3 id="主标题"><a href="#主标题" class="headerlink" title="主标题"></a>主标题</h3><p>主标题包含徽标和导航栏。导航栏的构造与Bootstrap略有不同，因为它具有Bootstrap不提供的组件。导航栏可以通过两种方式构建。这是普通导航栏的示例，接下来我们将提供顶部导航布局的示例。</p><h4 id="侧边航栏"><a href="#侧边航栏" class="headerlink" title="侧边航栏"></a>侧边航栏</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">header</span> <span class="attr">class</span>=<span class="string">"main-header"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"../../index2.html"</span> <span class="attr">class</span>=<span class="string">"logo"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- LOGO --&gt;</span></span><br><span class="line">        AdminLTE</span><br><span class="line">    <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Header Navbar: style can be found in header.less --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">nav</span> <span class="attr">class</span>=<span class="string">"navbar navbar-static-top"</span> <span class="attr">role</span>=<span class="string">"navigation"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Navbar Right Menu --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"navbar-custom-menu"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"nav navbar-nav"</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!-- Messages: style can be found in dropdown.less--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"dropdown messages-menu"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">class</span>=<span class="string">"dropdown-toggle"</span> <span class="attr">data-toggle</span>=<span class="string">"dropdown"</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"fa fa-envelope-o"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"label label-success"</span>&gt;</span>4<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"dropdown-menu"</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"header"</span>&gt;</span>You have 4 messages<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                            <span class="comment">&lt;!-- inner menu: contains the actual data --&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"menu"</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="comment">&lt;!-- start message --&gt;</span></span><br><span class="line">                                    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span></span><br><span class="line">                                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"pull-left"</span>&gt;</span></span><br><span class="line">                                            <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"dist/img/user2-160x160.jpg"</span> </span></span><br><span class="line"><span class="tag">                                                 <span class="attr">class</span>=<span class="string">"img-circle"</span> <span class="attr">alt</span>=<span class="string">"User Image"</span>&gt;</span></span><br><span class="line">                                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                                        <span class="tag">&lt;<span class="name">h4</span>&gt;</span></span><br><span class="line">                                            Sender Name</span><br><span class="line">                                            <span class="tag">&lt;<span class="name">small</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"fa fa-clock-o"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> 5 mins<span class="tag">&lt;/<span class="name">small</span>&gt;</span></span><br><span class="line">                                        <span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line">                                        <span class="tag">&lt;<span class="name">p</span>&gt;</span>Message Excerpt<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                                    <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="comment">&lt;!-- end message --&gt;</span></span><br><span class="line">                                ...</span><br><span class="line">                            <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"footer"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>See All Messages<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!-- Notifications: style can be found in dropdown.less --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"dropdown notifications-menu"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">class</span>=<span class="string">"dropdown-toggle"</span> <span class="attr">data-toggle</span>=<span class="string">"dropdown"</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"fa fa-bell-o"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"label label-warning"</span>&gt;</span>10<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"dropdown-menu"</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"header"</span>&gt;</span>You have 10 notifications<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                            <span class="comment">&lt;!-- inner menu: contains the actual data --&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"menu"</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                                    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span></span><br><span class="line">                                        <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"ion ion-ios-people info"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">                                        Notification title</span><br><span class="line">                                    <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                                ...</span><br><span class="line">                            <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"footer"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>View all<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!-- Tasks: style can be found in dropdown.less --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"dropdown tasks-menu"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">class</span>=<span class="string">"dropdown-toggle"</span> <span class="attr">data-toggle</span>=<span class="string">"dropdown"</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"fa fa-flag-o"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"label label-danger"</span>&gt;</span>9<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"dropdown-menu"</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"header"</span>&gt;</span>You have 9 tasks<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                            <span class="comment">&lt;!-- inner menu: contains the actual data --&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"menu"</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="comment">&lt;!-- Task item --&gt;</span></span><br><span class="line">                                    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span></span><br><span class="line">                                        <span class="tag">&lt;<span class="name">h3</span>&gt;</span></span><br><span class="line">                                            Design some buttons</span><br><span class="line">                                            <span class="tag">&lt;<span class="name">small</span> <span class="attr">class</span>=<span class="string">"pull-right"</span>&gt;</span>20%<span class="tag">&lt;/<span class="name">small</span>&gt;</span></span><br><span class="line">                                        <span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">                                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"progress xs"</span>&gt;</span></span><br><span class="line">                                            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"progress-bar progress-bar-aqua"</span> <span class="attr">style</span>=<span class="string">"width: 20%"</span> <span class="attr">role</span>=<span class="string">"progressbar"</span></span></span><br><span class="line"><span class="tag">                                                 <span class="attr">aria-valuenow</span>=<span class="string">"20"</span> <span class="attr">aria-valuemin</span>=<span class="string">"0"</span> <span class="attr">aria-</span><span class="attr">valuemax</span>=<span class="string">"100"</span>&gt;</span></span><br><span class="line">                                                <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"sr-only"</span>&gt;</span>20% Complete<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                                            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                                    <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;/<span class="name">li</span>&gt;</span><span class="comment">&lt;!-- end task item --&gt;</span></span><br><span class="line">                                ...</span><br><span class="line">                            <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"footer"</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>View all tasks<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!-- User Account: style can be found in dropdown.less --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"dropdown user user-menu"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">class</span>=<span class="string">"dropdown-toggle"</span> <span class="attr">data-toggle</span>=<span class="string">"dropdown"</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"dist/img/user2-160x160.jpg"</span> </span></span><br><span class="line"><span class="tag">                             <span class="attr">class</span>=<span class="string">"user-image"</span> <span class="attr">alt</span>=<span class="string">"User Image"</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"hidden-xs"</span>&gt;</span>Alexander Pierce<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"dropdown-menu"</span>&gt;</span></span><br><span class="line">                        <span class="comment">&lt;!-- User image --&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"user-header"</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"dist/img/user2-160x160.jpg"</span> </span></span><br><span class="line"><span class="tag">                                 <span class="attr">class</span>=<span class="string">"img-circle"</span> <span class="attr">alt</span>=<span class="string">"User Image"</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">                                Alexander Pierce - Web Developer</span><br><span class="line">                                <span class="tag">&lt;<span class="name">small</span>&gt;</span>Member since Nov. 2012<span class="tag">&lt;/<span class="name">small</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                        <span class="comment">&lt;!-- Menu Body --&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"user-body"</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-xs-4 text-center"</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>Followers<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-xs-4 text-center"</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>Sales<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-xs-4 text-center"</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>Friends<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                        <span class="comment">&lt;!-- Menu Footer--&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"user-footer"</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"pull-left"</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">class</span>=<span class="string">"btn btn-default btn-flat"</span>&gt;</span>Profile<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"pull-right"</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">class</span>=<span class="string">"btn btn-default btn-flat"</span>&gt;</span>Sign out<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">nav</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">header</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="顶部导航布局"><a href="#顶部导航布局" class="headerlink" title="顶部导航布局"></a>顶部导航布局</h4><blockquote><p>要使用此主标题而不是常规标题，必须将该<code>layout-top-nav</code>类添加到body标记中。 </p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">header</span> <span class="attr">class</span>=<span class="string">"main-header"</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">nav</span> <span class="attr">class</span>=<span class="string">"navbar navbar-static-top"</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container-fluid"</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"navbar-header"</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"../../index2.html"</span> <span class="attr">class</span>=<span class="string">"navbar-brand"</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>Admin<span class="tag">&lt;/<span class="name">b</span>&gt;</span>LTE<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"navbar-toggle collapsed"</span></span></span><br><span class="line"><span class="tag">                   <span class="attr">data-toggle</span>=<span class="string">"collapse"</span> <span class="attr">data-target</span>=<span class="string">"#navbar-collapse"</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"fa fa-bars"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">         <span class="comment">&lt;!-- Collect the nav links, forms, and other content for toggling --&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"collapse navbar-collapse"</span> <span class="attr">id</span>=<span class="string">"navbar-collapse"</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"nav navbar-nav"</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"active"</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>Link <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"sr-only"</span>&gt;</span>(current)<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>Link<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"dropdown"</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">class</span>=<span class="string">"dropdown-toggle"</span> </span></span><br><span class="line"><span class="tag">                  <span class="attr">data-toggle</span>=<span class="string">"dropdown"</span>&gt;</span>Dropdown <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"caret"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"dropdown-menu"</span> <span class="attr">role</span>=<span class="string">"menu"</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>Action<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>Another action<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>Something else here<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"divider"</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>Separated link<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"divider"</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>One more separated link<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">form</span> <span class="attr">class</span>=<span class="string">"navbar-form navbar-left"</span> <span class="attr">role</span>=<span class="string">"search"</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> </span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"navbar-search-input"</span> <span class="attr">placeholder</span>=<span class="string">"Search"</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"nav navbar-nav navbar-right"</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>Link<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"dropdown"</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">class</span>=<span class="string">"dropdown-toggle"</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">data-toggle</span>=<span class="string">"dropdown"</span>&gt;</span>Dropdown <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"caret"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"dropdown-menu"</span> <span class="attr">role</span>=<span class="string">"menu"</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>Action<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>Another action<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>Something else here<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"divider"</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>Separated link<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!-- /.navbar-collapse --&gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!-- /.container-fluid --&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">nav</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">header</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="sidebar"><a href="#sidebar" class="headerlink" title="sidebar"></a>sidebar</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"main-sidebar"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Inner sidebar --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"sidebar"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- user panel (Optional) --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"user-panel"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"pull-left image"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"dist/img/user2-160x160.jpg"</span> <span class="attr">class</span>=<span class="string">"img-circle"</span> <span class="attr">alt</span>=<span class="string">"User Image"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"pull-left info"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">p</span>&gt;</span>User Name<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"fa fa-circle text-success"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> Online<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!-- /.user-panel --&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- Search Form (Optional) --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"#"</span> <span class="attr">method</span>=<span class="string">"get"</span> <span class="attr">class</span>=<span class="string">"sidebar-form"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"input-group"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"q"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">placeholder</span>=<span class="string">"Search..."</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"input-group-btn"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">name</span>=<span class="string">"search"</span> <span class="attr">id</span>=<span class="string">"search-btn"</span></span></span><br><span class="line"><span class="tag">                            <span class="attr">class</span>=<span class="string">"btn btn-flat"</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"fa fa-search"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span><span class="comment">&lt;!-- /.sidebar-form --&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- Sidebar Menu --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"sidebar-menu"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"header"</span>&gt;</span>HEADER<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- Optionally, you can add icons to the links --&gt;</span></span><br><span class="line">            &lt;li class="active"&gt;&lt;a href="#"&gt;&lt;span&gt;Link&lt;/span&gt;&lt;/a&gt;&lt;&lt;/li&gt;</span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>Another Link<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"treeview"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>Multilevel<span class="tag">&lt;/<span class="name">span</span>&gt;</span> </span><br><span class="line">                    <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"fa fa-angle-left pull-right"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"treeview-menu"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>Link in level 2<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>Link in level 2<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span><span class="comment">&lt;!-- /.sidebar-menu --&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!-- /.sidebar --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!-- /.main-sidebar --&gt;</span></span><br></pre></td></tr></table></figure><h3 id="控制边栏"><a href="#控制边栏" class="headerlink" title="控制边栏"></a>控制边栏</h3><p>控制侧栏是右侧栏。它可以用于多种用途，并且非常容易创建。侧边栏有两种不同的显示/隐藏样式。第一个允许侧边栏在内容上滑动。第二个推送内容为侧边栏腾出空间。可以通过<a href="http://192.168.56.1:53210/documentation/#adminlte-options" target="_blank" rel="noopener">Javascript选项</a>设置这些方法中的任何一个。</p><p>以下代码应放在<code>.wrapper</code>div中。我更喜欢把它放在页脚之后。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- The Right Sidebar --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aside</span> <span class="attr">class</span>=<span class="string">"control-sidebar control-sidebar-dark"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- Content of the sidebar goes here --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aside</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- The sidebar's background --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- This div must placed right after the sidebar for it to work--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"control-sidebar-bg"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- The Right Sidebar --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aside</span> <span class="attr">class</span>=<span class="string">"control-sidebar control-sidebar-light"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- Content of the sidebar goes here --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aside</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- The sidebar's background --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- This div must placed right after the sidebar for it to work--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"control-sidebar-bg"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>创建侧边栏后，您需要一个切换按钮来打开/关闭它。通过将属性添加<code>data-toggle=&quot;control-sidebar&quot;</code>到任何按钮，它将自动充当切换按钮。</p><p>切换按钮示例</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-default"</span> <span class="attr">data-toggle</span>=<span class="string">"control-sidebar"</span>&gt;</span>Toggle Right Sidebar<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="信息框"><a href="#信息框" class="headerlink" title="信息框"></a>信息框</h3><p>信息框用于显示统计代码段。有两种类型的信息框。</p><h4 id="第一类信息框"><a href="#第一类信息框" class="headerlink" title="第一类信息框"></a>第一类信息框</h4><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/img/2018-09-09-adminlte-theme-zh-cn-docs/infobox-1.png" alt="infobox" title="">                </div>                <div class="image-caption">infobox</div>            </figure><p>标记 </p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"info-box"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Apply any bg-* class to to the icon to color it --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"info-box-icon bg-red"</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"fa fa-star-o"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"info-box-content"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"info-box-text"</span>&gt;</span>Likes<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"info-box-number"</span>&gt;</span>93,139<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!-- /.info-box-content --&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!-- /.info-box --&gt;</span></span><br></pre></td></tr></table></figure><h4 id="第二类信息框"><a href="#第二类信息框" class="headerlink" title="第二类信息框"></a>第二类信息框</h4><p><img src="/img/2018-09-09-adminlte-theme-zh-cn-docs/infobox-2.png" alt="infobox"></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Apply any bg-* class to to the info-box to color it --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"info-box bg-red"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"info-box-icon"</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"fa fa-comments-o"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"info-box-content"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"info-box-text"</span>&gt;</span>Likes<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"info-box-number"</span>&gt;</span>41,410<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">          <span class="comment">&lt;!-- The progress section is optional --&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"progress"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"progress-bar"</span> <span class="attr">style</span>=<span class="string">"width: 70%"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"progress-description"</span>&gt;</span></span><br><span class="line">            70% Increase in 30 Days</span><br><span class="line">          <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!-- /.info-box-content --&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!-- /.info-box --&gt;</span></span><br></pre></td></tr></table></figure><p>您需要更改为在这些样式之间切换的唯一方法是更改bg- <em>类的位置。对于第一个样式，将任何bg- </em>类应用于图标本身。对于其他样式，将bg- *类应用于info-box div。 </p><h3 id="框"><a href="#框" class="headerlink" title="框"></a>框</h3><p>框组件是整个模板中使用最广泛的组件。您可以将它用于从显示图表到文本块的任何内容。它有许多不同的风格，我们将在下面探讨。</p><h4 id="默认Box标记"><a href="#默认Box标记" class="headerlink" title="默认Box标记"></a>默认Box标记</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span> =<span class="string">“box”</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span> =<span class="string">“box-header</span> <span class="attr">with-border</span>”&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">h3</span> <span class="attr">class</span> =<span class="string">“box-title”</span>&gt;</span>默认框示例<span class="tag">&lt;/ <span class="attr">h3</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span> =<span class="string">“box-tools</span> <span class="attr">pull-right</span>”&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">！</span> <span class="attr">-</span> 按钮，标签和许多其他东西都可以放在这里！ <span class="attr">-</span> &gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">！</span> <span class="attr">-</span> 这是一个标签，例如 <span class="attr">-</span> &gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span> =<span class="string">“label</span> <span class="attr">label-primary</span>”&gt;</span>标签<span class="tag">&lt;/ <span class="attr">span</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/ <span class="attr">div</span>&gt;</span> <span class="tag">&lt;<span class="name">！</span> <span class="attr">-</span>  /<span class="attr">.box-tools</span>  <span class="attr">-</span> &gt;</span></span><br><span class="line">        <span class="tag">&lt;/ <span class="attr">div</span>&gt;</span> <span class="tag">&lt;<span class="name">！</span> <span class="attr">-</span>  /<span class="attr">.box-header</span>  <span class="attr">-</span> &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span> =<span class="string">“box-body”</span>&gt;</span></span><br><span class="line">          盒子的主体</span><br><span class="line">        <span class="tag">&lt;/ <span class="attr">div</span>&gt;</span> <span class="tag">&lt;<span class="name">！</span> <span class="attr">-</span>  /<span class="attr">.box-body</span>  <span class="attr">-</span> &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span> =<span class="string">“box-footer”</span>&gt;</span></span><br><span class="line">          盒子的页脚</span><br><span class="line">        <span class="tag">&lt;/ <span class="attr">div</span>&gt;</span> <span class="tag">&lt;<span class="name">！</span> <span class="attr">-</span>  <span class="attr">box-footer</span>  <span class="attr">-</span> &gt;</span></span><br><span class="line">      <span class="tag">&lt;/ <span class="attr">div</span>&gt;</span> <span class="tag">&lt;<span class="name">！</span> <span class="attr">-</span>  / <span class="attr">.box</span>  <span class="attr">-</span> &gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span> =<span class="string">“box</span> <span class="attr">box-default</span>”&gt;</span> ... <span class="tag">&lt;/ <span class="attr">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span> =<span class="string">“box</span> <span class="attr">box-primary</span>”&gt;</span> ... <span class="tag">&lt;/ <span class="attr">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span> =<span class="string">“box</span> <span class="attr">box-info</span>”&gt;</span> ... <span class="tag">&lt;/ <span class="attr">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span> =<span class="string">“box</span> <span class="attr">box-warning</span>”&gt;</span> ... <span class="tag">&lt;/ <span class="attr">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span> =<span class="string">“box</span> <span class="attr">box-success</span>”&gt;</span> ... <span class="tag">&lt;/ <span class="attr">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span> =<span class="string">“box</span> <span class="attr">box-danger</span>”&gt;</span> ... <span class="tag">&lt;/ <span class="attr">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="实心盒子"><a href="#实心盒子" class="headerlink" title="实心盒子"></a>实心盒子</h4><p>Solid Boxes是展示盒子的另一种方式。只需将box-solid类添加到box组件即可创建它们。您也可以将固定框与上下文类一起使用。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span> =<span class="string">“box</span> <span class="attr">box-solid</span> <span class="attr">box-default</span>”&gt;</span> ... <span class="tag">&lt;/ <span class="attr">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span> =<span class="string">“box</span> <span class="attr">box-solid</span> <span class="attr">box-primary</span>”&gt;</span> ... <span class="tag">&lt;/ <span class="attr">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span> =<span class="string">“box</span> <span class="attr">box-solid</span> <span class="attr">box-info</span>”&gt;</span> ... <span class="tag">&lt;/ <span class="attr">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span> =<span class="string">“box</span> <span class="attr">box-solid</span> <span class="attr">box-warning</span>”&gt;</span> ... <span class="tag">&lt;/ <span class="attr">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span> =<span class="string">“box</span> <span class="attr">box-solid</span> <span class="attr">box-success</span>”&gt;</span> ... <span class="tag">&lt;/ <span class="attr">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span> =<span class="string">“box</span> <span class="attr">box-solid</span> <span class="attr">box-danger</span>”&gt;</span> ... <span class="tag">&lt;/ <span class="attr">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="盒子工具"><a href="#盒子工具" class="headerlink" title="盒子工具"></a>盒子工具</h4><p>框可以包含用于部署特定事件或提供简单信息的工具。以下示例在框的标题中使用了多个AdminLTE组件。</p><p>AdminLTE data-widget属性提供了可以折叠或删除的框。按钮放置在盒子工具中，盒子工具放置在盒子标题中。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">！</span> <span class="attr">-</span> 这将导致单击时删除框 <span class="attr">-</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span> =<span class="string">“btn</span> <span class="attr">btn-box-tool</span>”<span class="attr">data-widget</span> =<span class="string">“remove”data-toggle</span> =<span class="string">“tooltip”title</span> =<span class="string">“Remove”</span>&gt;</span> <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span> =<span class="string">“fa</span> <span class="attr">fa-times</span>”&gt;</span> <span class="tag">&lt;/ <span class="attr">i</span>&gt;</span> <span class="tag">&lt;/ <span class="attr">button</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">！</span> <span class="attr">-</span> 这将导致单击框时折叠 <span class="attr">-</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span> =<span class="string">“btn</span> <span class="attr">btn-box-tool</span>”<span class="attr">data-widget</span> =<span class="string">“collapse”data-toggle</span> =<span class="string">“tooltip”title</span> =<span class="string">“Collapse”</span>&gt;</span> <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span> =<span class="string">“fa</span> <span class="attr">fa-minus</span>”&gt;</span> <span class="tag">&lt;/ <span class="attr">i</span>&gt;</span> <span class="tag">&lt;/ <span class="attr">button</span> &gt;</span></span><br></pre></td></tr></table></figure><p>如果在<code>app.js</code>加载后在文档中插入了一个框，则必须通过调用<code>.activateBox()</code>以下方法显式激活折叠/删除按钮：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    $(<span class="string">"#box-widget"</span>).activateBox();</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure><h4 id="Loading-States"><a href="#Loading-States" class="headerlink" title="Loading States"></a>Loading States</h4><p>要模拟加载状态，只需将此代码放在<code>.box</code>结束标记之前。 </p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"overlay"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"fa fa-refresh fa-spin"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;adminlte主题中文文档&quot;&gt;&lt;a href=&quot;#adminlte主题中文文档&quot; class=&quot;headerlink&quot; title=&quot;adminlte主题中文文档&quot;&gt;&lt;/a&gt;adminlte主题中文文档&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;文件结构&lt;/p&gt;

      
    
    </summary>
    
      <category term="adminlte" scheme="https://betgar.github.io/categories/adminlte/"/>
    
    
      <category term="adminlte" scheme="https://betgar.github.io/tags/adminlte/"/>
    
  </entry>
  
  <entry>
    <title>AMD最佳实践(requirejs)</title>
    <link href="https://betgar.github.io/2018/08/03/AMD-best-practice/"/>
    <id>https://betgar.github.io/2018/08/03/AMD-best-practice/</id>
    <published>2018-08-03T09:00:00.000Z</published>
    <updated>2018-09-26T14:47:11.226Z</updated>
    
    <content type="html"><![CDATA[<h1 id="AMD最佳实践-requirejs"><a href="#AMD最佳实践-requirejs" class="headerlink" title="AMD最佳实践(requirejs)"></a>AMD最佳实践(requirejs)</h1><blockquote><p>一下内容全部来自网络。</p></blockquote><h2 id="AMD部分"><a href="#AMD部分" class="headerlink" title="AMD部分"></a>AMD部分</h2><blockquote><p>阅读这部分文章的前提是你已经使用过AMD（requirejs）等异步加载库。</p></blockquote><ul><li>玩转AMD系列<ul><li><a href="http://efe.baidu.com/blog/dissecting-amd-preface/" target="_blank" rel="noopener"> 写在前面</a></li><li><a href="http://efe.baidu.com/blog/dissecting-amd-what/" target="_blank" rel="noopener">设计思路</a></li><li><a href="http://efe.baidu.com/blog/dissecting-amd-how/" target="_blank" rel="noopener">应用实践</a></li><li><a href="http://efe.baidu.com/blog/dissecting-amd-loader/" target="_blank" rel="noopener">AMD - Loader</a></li></ul></li></ul><h2 id="模块规划"><a href="#模块规划" class="headerlink" title="模块规划"></a>模块规划</h2><ul><li><p>模块化目录规范</p><ul><li><p><a href="https://github.com/ecomfe/spec/blob/master/package.md" target="_blank" rel="noopener">包结构规范</a></p></li><li><p><a href="https://github.com/ecomfe/spec/blob/master/module.md" target="_blank" rel="noopener">模块和加载器规范</a></p></li><li><a href="https://github.com/ecomfe/spec/blob/master/directory.md" target="_blank" rel="noopener">项目目录结构规范</a></li></ul></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;AMD最佳实践-requirejs&quot;&gt;&lt;a href=&quot;#AMD最佳实践-requirejs&quot; class=&quot;headerlink&quot; title=&quot;AMD最佳实践(requirejs)&quot;&gt;&lt;/a&gt;AMD最佳实践(requirejs)&lt;/h1&gt;&lt;blockquote
      
    
    </summary>
    
      <category term="AMD" scheme="https://betgar.github.io/categories/AMD/"/>
    
      <category term="requirejs" scheme="https://betgar.github.io/categories/AMD/requirejs/"/>
    
    
      <category term="AMD" scheme="https://betgar.github.io/tags/AMD/"/>
    
      <category term="requirejs" scheme="https://betgar.github.io/tags/requirejs/"/>
    
  </entry>
  
  <entry>
    <title>egg.js和nestjs使用场景对比</title>
    <link href="https://betgar.github.io/2018/08/02/eggjs-nestjs-usage-scenario-compare/"/>
    <id>https://betgar.github.io/2018/08/02/eggjs-nestjs-usage-scenario-compare/</id>
    <published>2018-08-02T10:00:00.000Z</published>
    <updated>2019-08-04T09:18:34.144Z</updated>
    
    <content type="html"><![CDATA[<h1 id="egg-js和nestjs使用场景对比"><a href="#egg-js和nestjs使用场景对比" class="headerlink" title="egg.js和nestjs使用场景对比"></a>egg.js和nestjs使用场景对比</h1><p><strong>提醒大家：注意文章的时效性，毕竟不同的事件节点，框架成熟度不同。分享这篇文章主要是希望能够让大家认清框架的定位和应对的业务场景，框架没有好坏之分，只有是否适合自己。</strong></p><blockquote><p>原标题：关于nodejs-web框架的调研</p><p>作者：xingyuzhe</p><p>日期： Feb 25, 2018</p><p>原文： <a href="https://github.com/xingyuzhe/blog/issues/1" target="_blank" rel="noopener">https://github.com/xingyuzhe/blog/issues/1</a></p></blockquote><p>以下内容其实是补漏, 算是对1月份一点工作的总结。</p><p>加入了新团队, 初次接触, 粗略的查看了一些项目(nodejs server端), 发现存在<a href="https://github.com/xingyuzhe/blog/issues/5" target="_blank" rel="noopener">几个</a>问题:</p><p>对于新成立的团队，存在以上问题可以理解， 本次是讨论和解决第一个问题。</p><p>对于集团范围内而言，同种技术存在多种不同规范和框架很正常, 但是对于一个几十人的团队而言, 资源有限，还是集中力量统一一下效率高些, 有鉴于此， 觉得做一个种子项目比较合适: 一个企业定制框架, 共同维护, 同步更新, 信息共享和沉淀最佳实践。</p><p>跟领导聊了一下， 总结了一下当前状态团队对于这块内容的一些主观诉求:</p><ol><li>框架实现够简单, 团队能全面掌控, 低风险。</li><li>给新手从基础开始学习的机会, 就是希望除了满足业务需求之外, 团队也能得到成长。</li><li>一个企业基础框架应满足的基本要求: 约束规范、扩展机制、安全、高效业务开发</li><li>最终还是希望能沉淀出一套自己的轮子</li></ol><p>根据上面的要求, 筛选出了<a href="https://eggjs.org/" target="_blank" rel="noopener">eggjs</a>和<a href="https://nestjs.com/" target="_blank" rel="noopener">nestjs</a>2个web框架, 其中nestjs是团队一部分同学比较喜欢和尝试使用了的。</p><p>首先从外层信息做些调查。</p><p>我通读了eggjs和nestjs的文档，查阅了一些资料, 简单对比如下:</p><table><thead><tr><th>–</th><th>eggjs</th><th>nestjs</th></tr></thead><tbody><tr><td>github stars</td><td>7014</td><td>4291</td></tr><tr><td>github forks</td><td>720</td><td>250</td></tr><tr><td>gitHub dependents</td><td>1591/305</td><td>0/0</td></tr><tr><td>npm search results</td><td>565</td><td>53+</td></tr><tr><td>github contributors</td><td>101</td><td>31</td></tr><tr><td>github core contributors</td><td>4(10+)</td><td>1(2+)</td></tr><tr><td>github releases</td><td>49</td><td>19</td></tr><tr><td>github issues</td><td>86/1416</td><td>20/347</td></tr><tr><td>基础框架依赖</td><td>koa2</td><td>express</td></tr><tr><td>文档</td><td>业界良心</td><td>一般</td></tr><tr><td>核心原理</td><td>载入-挂载</td><td>模块容器-依赖注入(通过装饰器和元数据实现)</td></tr><tr><td>核心理念</td><td>微内核-插件机制</td><td>组件树-装饰器-流程控制</td></tr></tbody></table><blockquote><p>eggjs的特点和解决的主要问题:</p></blockquote><ol><li>通过载入代码-自动挂载代码到对象的方式解决了到处写import/require的问题, 不再需要手动维护模块之间的依赖关系, 核心就是一个loader, 虽然官方没有提及, 但是本人开下脑洞猜测, 这个模块的实现灵感有可能来自于坟头草已经一人高了的seajs, -_-, 这种挂载模式实现起来简单粗暴直接高效, 但是一个小问题就是在使用TS编写代码的时候, 会影响书写体验的流畅度, 毕竟不很OOP。</li><li>微核心 + 插件机制(这个理念其实一直以来都是代码组织的核心手段, 本人在以前开发播放器和IM客户端这块时感同身受), 大部分功能通过插件实现, 从而剥离非核心生命周期功能代码, 达到解耦/降低思维负担的目的; 另外一点就是跨模块API调用比较自由没有限制, 这个地方带来便捷的同时也有可能需要一定约束。</li><li>统一约束和规范, 对开发人员强约束, 保证不会出现千人千面的代码风格和设计。</li><li>种子项目 + 渐进式开发, 可以沉淀出自己的插件和业务框架、最佳实践</li><li>针对业务中遇到的常见问题基本都给出了解决方案, 插件丰富, 配套齐全</li><li>内部实现了进程间管理和通信功能</li><li>文档可是说是比较细致了, 基本把web这块涉及到的点都涵盖了, 仅仅通读文档对新手而言都会有不少收获</li><li>核心开发者较多, 属于团队项目, 整体看来比较严谨</li><li>沉淀时间较长, 正式发版2年, 实际发展了4年</li><li>明确定义了agent和app模式, 也实现了schedule功能</li></ol><blockquote><p> nestjs的特点和解决的主要问题:</p></blockquote><ol><li>通过模块容器-依赖注入维护组件树的模式解决了到处写import/require的问题, 不再需要手动维护模块之间的依赖关系, 另外编码方式与java十分相似。</li><li>组件树容器模式也达到了解耦效果, 实现方式上很大程度上受angular-module影响, 但是需要指定节点component的依赖关系, 跨模块调用严格依赖于声明. 其实这块功能github有独立的项目专做这个东西, 例如:<a href="http://inversify.io/" target="_blank" rel="noopener"> InversifyJS</a> | <a href="https://github.com/young-steveo/bottlejs" target="_blank" rel="noopener">bottlejs</a>, nestjs 自己实现了这个模块。</li><li>统一约束和规范, 对开发人员强约束</li><li>大量使用装饰器, 这个未支持的特性需要编译, 对代码阅读上可能会提高一些难度</li><li>流程控制上比较细致, 提出了filter、pipe、guard、interceptor这些明确的概念, 虽然这些工作在正常开发时也会做, 但是明确提出来并制定规范还是很有必要的</li><li>明确了Exception Layer的概念</li><li>默认使用/推荐TS开发</li><li>自带微服务实现</li><li>自带swagger接口文档生成功能</li><li>核心开发基本就作者一人, 属于个人项目, 提交记录比较难看, 前期的提交非常随便, 到后期才慢慢改善</li><li>2017年1月立项, 2017年5月发布第一个正式版本, 尚需时日印证</li></ol><p>从上述情况来看, 2个框架都在123这几项做了工作, 完成了一个框架所应具备的基本诉求; 总体上看eggjs更加成熟和全面, 配套/生态相对完善的多, 低风险; nestjs则比较青涩和单一, 但是在组件树、流程控制、错误层级处理上有自己的特色, 理念上更加OOP,学习并吸收这些理念是很可取的, 但暂时不建议在核心产品线上投入使用。</p><h3 id="eggjs"><a href="#eggjs" class="headerlink" title="eggjs"></a>eggjs</h3><p>详细阅读了核心相关代码, 粗略阅读了cluster等一些模块和插件的代码, 代码读起来总体比较流畅, 发现框架的核心实现非常简单明了:</p><ul><li><p>框架基础依赖一个非常独立的loader模块, 功能就是加载代码文件和挂载函数到指定对象。</p></li><li><p>框架本身核心类只有6个: koa本身的application, context, response, request, egg自身新增的controller, service 这2个类, 后续所有的挂载动作都在这几个类上面进行</p></li><li><p>框架明确了app, framework, plugin3个概念, 依赖方式大概是这样:</p><p><img src="https://user-images.githubusercontent.com/3498363/36649060-26c36ab8-1ad5-11e8-8c35-d1bb6f1c104e.png" alt=""></p></li><li><p>框架启动的核心流程主要是这样:</p><p><img src="https://user-images.githubusercontent.com/3498363/36660001-6e88cda2-1b11-11e8-9279-506031289ef1.png" alt=""></p></li></ul><p>  由于eggjs自己实现了cluster, 自带进程管理和进程间通信功能, 所以egg自身部署时并不需要pm2这个工具, 官方文档上也对此做了<a href="https://eggjs.org/zh-cn/faq.html#进程管理为什么没有选型-pm2" target="_blank" rel="noopener">解释</a>。不过由于这块内容的引入(cluster还涉及到schedule、socket等功能)，给框架本身带来了大量额外的代码和逻辑, 总体提升了框架的复杂度。</p><p>  但是有些时候由于某些原因并不希望直接使用框架提供的cluster解决方案, 另外我查看了下pm2的API, 也是有进程间通信的API的, 当然用起来可能没有自定义实现时那样自由, 也尚未听说该API有被广泛使用过, 不过, cluster相关的内容能否作为一个扩展包, 而不是强耦合进框架核心流程中? 这样框架本身更加简单纯洁, 或者更容易被接受一些?</p><p>  为此尝试抽离了eggjs的核心代码, 目标是仅保留最最核心的代码(移除cluster等周边代码), 具备egg的扩展机制和能正常直接使用eggjs的周边插件, 结果最后只需要几百行代码, 很少几个文件即可完成。后续在此基础上整理了一个上层框架, 预想作为业务项目的基础框架使用，主要涉及以下一些方面:</p><ol><li>抽离eggjs的核心代码, 仅保留其插件机制和对应的约束规范</li><li>集成常用扩展函数、中间件、插件</li><li>集成多节点/进程下消息推送解决方案示例</li><li><p>集成schedule定时任务模块</p><p>之后花了点时间用这个上层框架开发了一个抽奖小项目, 开发体验还算流畅, 虽说是草量级项目, 不过也是五脏俱全, 作为example还挺适合。</p></li></ol><h3 id="nestjs"><a href="#nestjs" class="headerlink" title="nestjs"></a>nestjs</h3><p>  粗略查看了下nestjs的源码, nestjs的核心其实就是一个IoC模块管理容器的实现, 这块内容的逻辑实现作者处理的还是相对复杂的多, 这里吐槽下作者的代码组织方式和略显随意的注释大量的接口引用和糟糕的历史提交记录…，真是额外提高了阅读的难度. TypeScript的加持和作者本人的光环也不能阻挡这一点。言归正传, 这里说下它的核心原理和流程。</p><p>  要想理解nestjs的源码先要理解和掌握以下知识:</p><ol><li>ES6的proxy，reflect</li><li>TypeScript的decorator</li><li>inversion of control (IoC)的基本概念</li><li>一定TypeScript基础.</li><li>如何通过decorator和元数据实现依赖注入</li></ol><ul><li>container类: 用于存储所有模块</li><li>scanner类: 递归提取出所有模块并存储到容器中; 提取出模块间的关联关系和模块自身的各种类以及内部联系，并存储到模块中;</li><li>module类: 存储自身的关联模块、组件、可注入类、控制器类</li><li>injector类: 依赖注入的核心环节, 在所有模块的内容和关系都被扫描出后, 来创建实例,</li><li><p>instanceLoader类: 使用Injector来加载模块的各种实例, 这个过程很复杂, 伴随递归和各种判断</p><p>这个IoC容器实现的核心流程是这样:<br>scanner扫描所有module并提取关系存入module-&gt;module存入 container-&gt; injector创建实例(依赖注入)-&gt; instanceLoader加载实例</p><p>我们再拿nestjs实现上面eggjs版本lottery的例子, 大概是这样:</p><p>结合源码和实际开发体验来说:</p></li><li><p>eggjs框架本身的模块管理(扩展机制)非常简单, 复杂度主要在于cluster这块内容和为此配套的周边设施(命令行工具、调试工具)，但是这个复杂度是脱离于核心之外的东西。</p></li><li><p>nestjs的复杂度主要在于IoC模块管理器这块的实现上, 实际上这个东西理论上可以独立出来, 以此降低框架本身逻辑的复杂度。</p><p>从总体上讲, eggjs相对成熟, 更贴合实际开发需求。 nestjs的优势就是在一些细节上的约束和控制以及理念上的新颖(仅相对node-web框架而言), 但是这些并不是核心诉求。</p><p>另外eggjs团队做的工作内容相对于nestjs而言相当的多, 这些与人力、时间资源的投入是分不开的。</p></li></ul><blockquote><p>最后, 对于想要的新框架的处理结论已经有了:</p></blockquote><p>1 社区模式(节省资源)</p><ul><li>直接在eggjs基础上做一个上层框架, 吸收nestjs的一些优点, 作为插件/扩展内容去完善框架本身.</li></ul><p>2 造轮子模式</p><ul><li>eggjs插件机制 + nestjs流程控制 + component模式(可选) =&gt; 新轮子</li></ul><p>3 所应具备的特性</p><ul><li>约束规范</li><li>沉淀/扩展模式</li><li>模块依赖管理</li><li>集成typescript开发环境</li><li>集成API文档输出方案</li><li>环境配置</li><li>多节点/cluster解决方案<ul><li>socket.io</li><li>schedule</li></ul></li><li>集成常用插件功能<ul><li>logger</li><li>cookie</li><li>session</li><li>security</li><li>i18n</li><li>redis</li><li>sequelize</li><li>multipart</li><li>oauth</li><li>onerror</li><li>passport</li><li>view</li><li>role</li><li>crypto</li></ul></li><li>定义控制流/数据流约束规范<ul><li>schema</li><li>pipe</li><li>interceptor</li><li>guard</li></ul></li><li>migration</li><li>微服务</li><li>错误分级</li><li>监控</li><li>测试用例/代码覆盖率</li><li>调试</li><li>压力测试</li></ul><p>补充:<br>随着各种工具的发展, 加上eggjs使用也有一段时日，最初一些模糊的预感变得清晰：<br>1 egg内置cluster模式带来的额外麻烦太多, 现在各种配套工具逐渐完善， 这个功能并没有什么用</p><p>2 egg模块隔离度不够但矛盾的是有时候又有限制, 简单的说就是代码组织模式上作为框架不够好, 需要自行定制上层规范; egg的是plugin模式, 相对于nest的component模式还是不够用；</p><p>3 egg的ts开发的流畅度差那么一点</p><p>4 实际的项目, 需要各种配套设施、工具、系统的协作联合，框架只是一个组成部分, 就应该只做它应该做的事就可以了</p><p>各有优劣, 诉求不一样, 选择就不一样:<br>1 eggjs: 短平快稳，上手极快, 文档完善，配套齐全, 能极大缩短工期。<br>2 nestjs: 有点追求, 复杂度高的协作项目, 核心诉求是代码组织模式的</p><p>之前egg很好的满足了我们的诉求, 但是下一个项目, 会考虑使用nestjs或者自行开发框架(足够闲的话)。</p><blockquote><p>egg官方维护者atian25的评论：<a href="https://github.com/xingyuzhe/blog/issues/1#issuecomment-416619079" target="_blank" rel="noopener">点击详见</a></p></blockquote><p>补充下几点：</p><ul><li><p>Cluster 里面并没有 schedule</p></li><li><p>Socket 那个是为了实现高级的 IPC</p></li><li><p>Cluster 还是很建议使用的，如果有什么特殊的定制需求，何不如提下 RFC/ISSUE 大家讨论下</p></li><li><p>egg-core + egg-cluster 才成为 egg，你要是想定制，可以类似 egg-core + my-cluster(虽然不建议)</p></li><li><p>框架复杂度其实反而是降低了，因为 PM2 的代码比 egg-cluster 复杂多了</p></li><li><p>Egg 的定位是框架的框架，跟 thinkjs/sails/nest 这些是没法直接对比的，因为不是一个层面的概念。就像你只能对比 Express 和 Koa，而不能对比 nest 和 Koa，因为 nest 是在 Express 之上的封装。</p><p>基于 Egg 封装的针对某个领域的上层框架，才能对比。譬如完全可以用官方的 TS 方案，再封装集成几个装饰器，成为一个上层框架。就可以拿来对比了。</p></li></ul><h2 id="相关资料"><a href="#相关资料" class="headerlink" title="相关资料"></a>相关资料</h2><p><a href="https://github.com/atian25/blog/issues/20" target="_blank" rel="noopener">Egg &amp; Node.js 从小工坊走向企业级开发</a></p><p><a href="https://mp.weixin.qq.com/s/QI52VbaQfFOTZyNSfkHk0w" target="_blank" rel="noopener">选择JavaScript开源库时，你需要考虑这些问题</a></p><p><a href="https://12factor.net/zh_cn/" target="_blank" rel="noopener">12个因素</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;egg-js和nestjs使用场景对比&quot;&gt;&lt;a href=&quot;#egg-js和nestjs使用场景对比&quot; class=&quot;headerlink&quot; title=&quot;egg.js和nestjs使用场景对比&quot;&gt;&lt;/a&gt;egg.js和nestjs使用场景对比&lt;/h1&gt;&lt;p&gt;&lt;s
      
    
    </summary>
    
      <category term="fe" scheme="https://betgar.github.io/categories/fe/"/>
    
    
      <category term="fe" scheme="https://betgar.github.io/tags/fe/"/>
    
  </entry>
  
  <entry>
    <title>自适应全背景图片布局</title>
    <link href="https://betgar.github.io/2018/07/26/perfect-full-page-background-image/"/>
    <id>https://betgar.github.io/2018/07/26/perfect-full-page-background-image/</id>
    <published>2018-07-26T13:30:00.000Z</published>
    <updated>2018-09-26T14:47:11.226Z</updated>
    
    <content type="html"><![CDATA[<h1 id="自适应全背景图片布局"><a href="#自适应全背景图片布局" class="headerlink" title="自适应全背景图片布局"></a>自适应全背景图片布局</h1><blockquote><p><a href="https://css-tricks.com/perfect-full-page-background-image/" target="_blank" rel="noopener">原文在这里</a></p></blockquote><h2 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">html</span> &#123; </span><br><span class="line">  <span class="attribute">height</span>: auto;</span><br><span class="line">  <span class="attribute">min-height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">url</span>(http://desk.fd.zol-img.com.cn/t_s1366x768c5/g5/M00/01/03/ChMkJ1or0MGIGULYABCo5rcHl4AAAi_rgHdSLYAEKj-970.jpg?downfile=1532612079420.jpg) no-repeat center center fixed; </span><br><span class="line">  <span class="attribute">-webkit-background-size</span>: cover;</span><br><span class="line">  <span class="attribute">-moz-background-size</span>: cover;</span><br><span class="line">  <span class="attribute">-o-background-size</span>: cover;</span><br><span class="line">   <span class="attribute">background-size</span>: cover;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="http://desk.fd.zol-img.com.cn/t_s1366x768c5/g5/M00/01/03/ChMkJ1or0MGIGULYABCo5rcHl4AAAi_rgHdSLYAEKj-970.jpg?downfile=1532612079420.jpg" alt="123" title="">                </div>                <div class="image-caption">123</div>            </figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;自适应全背景图片布局&quot;&gt;&lt;a href=&quot;#自适应全背景图片布局&quot; class=&quot;headerlink&quot; title=&quot;自适应全背景图片布局&quot;&gt;&lt;/a&gt;自适应全背景图片布局&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://css-tric
      
    
    </summary>
    
      <category term="layout" scheme="https://betgar.github.io/categories/layout/"/>
    
    
      <category term="layout" scheme="https://betgar.github.io/tags/layout/"/>
    
  </entry>
  
  <entry>
    <title>Bootstrap-validator的使用</title>
    <link href="https://betgar.github.io/2018/07/25/the-docs-of-bootstrap-validator/"/>
    <id>https://betgar.github.io/2018/07/25/the-docs-of-bootstrap-validator/</id>
    <published>2018-07-25T12:00:00.000Z</published>
    <updated>2018-09-26T14:47:11.226Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Bootstrap-validator的使用"><a href="#Bootstrap-validator的使用" class="headerlink" title="Bootstrap-validator的使用"></a>Bootstrap-validator的使用</h1><blockquote><p>翻译官方的<a href="http://1000hz.github.io/bootstrap-validator/" target="_blank" rel="noopener">文档</a>。</p><p>这个插件遵循Bootstrap核心jQuery插件提出的<a href="http://getbootstrap.com/javascript/#js-overview" target="_blank" rel="noopener">约定</a>，所以一定要检查这些插件，以便更好地理解这个插件的目标和设计。 </p></blockquote><h2 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h2><blockquote><p>使用这个简单的插件为表单添加验证。 </p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">data-toggle</span>=<span class="string">"validator"</span> <span class="attr">role</span>=<span class="string">"form"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"inputName"</span> <span class="attr">class</span>=<span class="string">"control-label"</span>&gt;</span>Name<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"inputName"</span> <span class="attr">placeholder</span>=<span class="string">"Cina Saffary"</span> <span class="attr">required</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group has-feedback"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"inputTwitter"</span> <span class="attr">class</span>=<span class="string">"control-label"</span>&gt;</span>Twitter<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"input-group"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"input-group-addon"</span>&gt;</span>@<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">pattern</span>=<span class="string">"^[_A-z0-9]&#123;1,&#125;$"</span> <span class="attr">maxlength</span>=<span class="string">"15"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"inputTwitter"</span> <span class="attr">placeholder</span>=<span class="string">"1000hz"</span> <span class="attr">required</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon form-control-feedback"</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"help-block with-errors"</span>&gt;</span>Hey look, this one has feedback icons!<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"inputEmail"</span> <span class="attr">class</span>=<span class="string">"control-label"</span>&gt;</span>Email<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"email"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"inputEmail"</span> <span class="attr">placeholder</span>=<span class="string">"Email"</span> <span class="attr">data-error</span>=<span class="string">"Bruh, that email address is invalid"</span> <span class="attr">required</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"help-block with-errors"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"inputPassword"</span> <span class="attr">class</span>=<span class="string">"control-label"</span>&gt;</span>Password<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-inline row"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group col-sm-6"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">data-minlength</span>=<span class="string">"6"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"inputPassword"</span> <span class="attr">placeholder</span>=<span class="string">"Password"</span> <span class="attr">required</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"help-block"</span>&gt;</span>Minimum of 6 characters<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group col-sm-6"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"inputPasswordConfirm"</span> <span class="attr">data-match</span>=<span class="string">"#inputPassword"</span> <span class="attr">data-match-error</span>=<span class="string">"Whoops, these don't match"</span> <span class="attr">placeholder</span>=<span class="string">"Confirm"</span> <span class="attr">required</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"help-block with-errors"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"radio"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"underwear"</span> <span class="attr">required</span>&gt;</span></span><br><span class="line">        Boxers</span><br><span class="line">      <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"radio"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"underwear"</span> <span class="attr">required</span>&gt;</span></span><br><span class="line">        Briefs</span><br><span class="line">      <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"checkbox"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">id</span>=<span class="string">"terms"</span> <span class="attr">data-error</span>=<span class="string">"Before you wreck yourself"</span> <span class="attr">required</span>&gt;</span></span><br><span class="line">        Check yourself</span><br><span class="line">      <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"help-block with-errors"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span>&gt;</span>Submit<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="用法"><a href="#用法" class="headerlink" title="用法"></a>用法</h2><blockquote><p>可以通过data-api或JavaScript在标记中启用表单验证。通过添加<code>data-toggle=&quot;validator&quot;</code>到表单元素自动启用表单验证。 </p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">role</span>=<span class="string">"form"</span> <span class="attr">data-toggle</span>=<span class="string">"validator"</span>&gt;</span></span><br><span class="line">  ...</span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>或者通过JavaScript激活验证： </p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">'#myForm'</span>).validator()</span><br></pre></td></tr></table></figure><h2 id="标记"><a href="#标记" class="headerlink" title="标记"></a>标记</h2><p>按照Bootstrap的<a href="http://getbootstrap.com/css/#forms" target="_blank" rel="noopener">示例</a>进行适当的表单标记。重要的是每个输入字段都在其自己的单独<code>.form-group</code>容器中，以便正确显示错误消息。</p><p>验证规则通过以下标准HTML5属性在表单输入上指定：</p><ul><li><code>type=&quot;email&quot;</code></li><li><code>type=&quot;url&quot;</code></li><li><code>type=&quot;number&quot;</code>，通过附加约束<code>max</code>，<code>min</code>和<code>step</code>属性</li><li><code>pattern=&quot;Reg(ular )?Exp(ression)?&quot;</code>（用于输入类型的<code>text</code>，<code>search</code>，<code>tel</code>，<code>url</code>或<code>email</code>）</li><li><code>required</code></li></ul><p>以及以下非标准属性：</p><ul><li><code>data-match=&quot;#inputToMatch&quot;</code> 确保两个字段匹配，例如密码确认</li><li><code>data-minlength=&quot;5&quot;</code> 强制执行最少量的字符</li><li><code>data-remote=&quot;/path/to/remote/validator&quot;</code>发出AJAX请求以确定该字段是否有效。请务必为输入提供<code>name</code>属性，因为请求将被发送到<code>/path/to/remote/validator?&lt;name&gt;=&lt;value&gt;</code>。<code>200 OK</code>如果字段有效，则远程端点应返回a ，<code>4xx</code>否则返回。这是使用Express 的<a href="https://github.com/1000hz/validator-remote-example" target="_blank" rel="noopener">参考服务器实现</a>。</li></ul><blockquote><h4 id="标准属性验证器"><a href="#标准属性验证器" class="headerlink" title="标准属性验证器"></a>标准属性验证器</h4><p>标准HTML5属性的验证规则由浏览器使用<a href="https://developer.mozilla.org/en-US/docs/Web/Guide/HTML/HTML5/Constraint_validation" target="_blank" rel="noopener">HTML5约束验证API</a>完全处理。因此，此插件无法控制有资格作为有效电子邮件地址或URL的内容。如果您发现需要对这些字段进行更严格的验证，则可以使用该<code>pattern</code>属性进一步限制可接受的范围。</p><p>但请注意，您不要过于严格，这可能会导致漏报和糟糕的用户体验。例如，根据标准，您会对哪种<a href="https://en.wikipedia.org/wiki/Email_address#Valid_email_addresses" target="_blank" rel="noopener">电子邮件地址</a>被视为有效感到惊讶。</p></blockquote><blockquote><h4 id="跨浏览器兼容性"><a href="#跨浏览器兼容性" class="headerlink" title="跨浏览器兼容性"></a>跨浏览器兼容性</h4><p>由于此插件依赖于HTML5约束验证API，因此不支持Internet Explorer 9及更早版本。如果您需要支持这些浏览器，则必须添加像Ryan Seddon的<a href="https://github.com/ryanseddon/H5F" target="_blank" rel="noopener">H5F</a>这样的<a href="https://github.com/ryanseddon/H5F" target="_blank" rel="noopener">polyfill</a>。</p></blockquote><p>要显示错误消息，请在输入字段后面包含容器<code>help-block</code>和<code>with-errors</code>类。 </p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">role</span>=<span class="string">"form"</span> <span class="attr">data-toggle</span>=<span class="string">"validator"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"inputEmail"</span>&gt;</span>Email<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"email"</span> <span class="attr">id</span>=<span class="string">"inputEmail"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"help-block with-errors"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="验证字段"><a href="#验证字段" class="headerlink" title="验证字段"></a>验证字段</h2><p>默认情况下，验证程序仅验证插件初始化时存在的字段。如果表单具有动态字段集，则需要调用<code>$(...).validator(&#39;update&#39;)</code>以通知插件要验证的字段集已更改。</p><p>用于确定验证哪些字段的默认选择器是：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$.fn.validator.Constructor.INPUT_SELECTOR = <span class="string">':input:not([type="hidden"], [type="submit"], [type="reset"], button)'</span></span><br></pre></td></tr></table></figure><p>如果需要更改此默认行为，可以在代码中覆盖此值。或者，您可以添加<code>data-validate=&quot;true&quot;</code>/ <code>data-validate=&quot;false&quot;</code>到特定输入以强制将其包含/排除在已验证字段集中。</p><h3 id="选项"><a href="#选项" class="headerlink" title="选项"></a>选项</h3><p>选项可以通过数据属性或JavaScript传递。对于数据属性，请将选项名称附加到<code>data-</code>，如<code>data-delay=&quot;&quot;</code>。</p><table><thead><tr><th>名称</th><th>类型</th><th>默认</th><th>描述</th></tr></thead><tbody><tr><td>delay</td><td>number</td><td>500</td><td>在表单字段上显示错误之前要等待的毫秒数。</td></tr><tr><td>html</td><td>boolean</td><td>false</td><td>将HTML插入错误消息中。如果为false，则使用jQuery的文本方法将内容插入DOM。如果您担心XSS攻击，请使用文本。</td></tr><tr><td>disable</td><td>boolean</td><td>true</td><td>禁用提交按钮，直到表单有效并且所有必填字段都已完成。</td></tr><tr><td>focus</td><td>boolean</td><td>true</td><td>在验证表单时，滚动并聚焦第一个字段并显示错误。例如，如果页面顶部有一个固定的导航栏，并且需要调整窗口顶部和焦点字段之间的填充量，则可以覆盖以下变量：<code>$.fn.validator.Constructor.FOCUS_OFFSET</code>默认为20（px）。</td></tr><tr><td>feedback</td><td>object</td><td>glyphicon classes</td><td>覆盖用于表单反馈图标的类。默认为Bootstrap的glyphicons：<code>feedback: {   success: &#39;glyphicon-ok&#39;,   error: &#39;glyphicon-remove&#39; }</code></td></tr><tr><td>custom</td><td>object</td><td>{}</td><td>添加要运行的自定义验证程序。验证器应该是接收jQuery元素作为参数的函数，如果字段无效则返回错误消息。这是一个自定义验证器的示例，它检查输入是否等于某个指定值：<code>custom: {   equals: function($el) {     var matchValue = $el.data(&quot;equals&quot;) // foo     if ($el.val() !== matchValue) {       return &quot;Hey, that&#39;s not valid! It&#39;s gotta be &quot; + matchValue     }   } }</code>通过将其名称作为数据属性引用，将验证器添加到输入中就像完成其他操作一样：<code>&lt;input data-equals=&quot;foo&quot;&gt;</code>。在这种情况下，如果用户输入除以外的任何内容，该字段将显示错误<code>foo</code>。</td></tr></tbody></table><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// feedback</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    feedback: &#123;   </span><br><span class="line">        success: <span class="string">'glyphicon-ok'</span>,   </span><br><span class="line">        error: <span class="string">'glyphicon-remove'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// custom</span></span><br><span class="line">&#123;</span><br><span class="line">    custom: &#123;   </span><br><span class="line">        equals: <span class="function"><span class="keyword">function</span>(<span class="params">$el</span>) </span>&#123;     </span><br><span class="line">            <span class="keyword">var</span> matchValue = $el.data(<span class="string">"equals"</span>) <span class="comment">// foo     </span></span><br><span class="line">            <span class="keyword">if</span> ($el.val() !== matchValue) &#123;       </span><br><span class="line">                <span class="keyword">return</span> <span class="string">"Hey, that's not valid! It's gotta be "</span> + matchValue     </span><br><span class="line">            &#125;   </span><br><span class="line">        &#125; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><h4 id="各个表单字段的错误消息"><a href="#各个表单字段的错误消息" class="headerlink" title="各个表单字段的错误消息"></a>各个表单字段的错误消息</h4><p>可以通过使用数据属性来指定单个表单字段的错误消息。您可以在字段中的每个类型的验证，即指定一个错误信息<code>data-pattern-error=&quot;&quot;</code>，<code>data-required-error=&quot;&quot;</code>，<code>data-match-error=&quot;&quot;</code>，等…或者使用<code>data-error=&quot;&quot;</code>用于衬垫的错误消息，以显示该字段的任何错误。</p></blockquote><h3 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h3><h4 id="validator-options"><a href="#validator-options" class="headerlink" title=".validator(options)"></a><code>.validator(options)</code></h4><p>将验证器附加到表单集合。</p><h4 id="validator-39-update-39"><a href="#validator-39-update-39" class="headerlink" title=".validator(&#39;update&#39;)"></a><code>.validator(&#39;update&#39;)</code></h4><p>更新将验证的输入集合。如果需要验证的字段集已更改，请调用此方法。</p><h4 id="validator-39-validate-39"><a href="#validator-39-validate-39" class="headerlink" title=".validator(&#39;validate&#39;)"></a><code>.validator(&#39;validate&#39;)</code></h4><p>立即验证整个表格。</p><h4 id="validator-39-destroy-39"><a href="#validator-39-destroy-39" class="headerlink" title=".validator(&#39;destroy&#39;)"></a><code>.validator(&#39;destroy&#39;)</code></h4><p>销毁形式验证器并清理留下的数据。</p><h3 id="事件"><a href="#事件" class="headerlink" title="事件"></a>事件</h3><p>所有事件都在表单元素上触发，并提供对事件所属的表单字段的引用<code>event.relatedTarget</code>。</p><table><thead><tr><th>事件类型</th><th>描述</th></tr></thead><tbody><tr><td>validate.bs.validator</td><td>验证表单字段时，此事件立即触发。</td></tr><tr><td>invalid.bs.validator</td><td>当表单字段变为无效时会触发此事件。通过提供字段错误<code>event.detail</code>。</td></tr><tr><td>valid.bs.validator</td><td>当表单字段变为有效时，将触发此事件。之前的字段错误通过提供<code>event.detail</code>。</td></tr><tr><td>validated.bs.validator</td><td>在验证表单字段后触发此事件。</td></tr></tbody></table><blockquote><h4 id="有条件地处理提交事件"><a href="#有条件地处理提交事件" class="headerlink" title="有条件地处理提交事件"></a>有条件地处理提交事件</h4><p>当表单无效时，<code>.preventDefault()</code>将在提交事件上调用。因此，如果您想要挂钩提交事件并根据表单是否有效而有条件地执行某些操作，则可以检查事件是否有效<code>.isDefaultPrevented()</code>。在表单上初始化插件后，请确保您的提交处理程序已绑定。</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">'#form'</span>).validator().on(<span class="string">'submit'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (e.isDefaultPrevented()) &#123;</span><br><span class="line">    <span class="comment">// handle the invalid form...</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// everything looks good!</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Bootstrap-validator的使用&quot;&gt;&lt;a href=&quot;#Bootstrap-validator的使用&quot; class=&quot;headerlink&quot; title=&quot;Bootstrap-validator的使用&quot;&gt;&lt;/a&gt;Bootstrap-validator的
      
    
    </summary>
    
      <category term="Bootstrap" scheme="https://betgar.github.io/categories/Bootstrap/"/>
    
      <category term="Validation" scheme="https://betgar.github.io/categories/Bootstrap/Validation/"/>
    
    
      <category term="Bootstrap" scheme="https://betgar.github.io/tags/Bootstrap/"/>
    
      <category term="Validation" scheme="https://betgar.github.io/tags/Validation/"/>
    
  </entry>
  
  <entry>
    <title>Bootstrap 表单布局</title>
    <link href="https://betgar.github.io/2018/07/23/bootstrap-form-layout/"/>
    <id>https://betgar.github.io/2018/07/23/bootstrap-form-layout/</id>
    <published>2018-07-23T11:00:00.000Z</published>
    <updated>2018-09-26T14:47:11.226Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Bootstrap-表单布局"><a href="#Bootstrap-表单布局" class="headerlink" title="Bootstrap 表单布局"></a>Bootstrap 表单布局</h1><blockquote><p>bootstrap已经使用很久了，但是对于表单布局，尤其是<code>HTML</code>结构嵌套层次还有很多疑问。</p><p>所以又翻了一遍官网和资料，总结一下。</p><p>本文部分内容翻译自<a href="http://stacktips.com/tutorials/bootstrap/vertical-horizontal-and-inline-form-example-in-bootstrap" target="_blank" rel="noopener">这里</a>.</p></blockquote><h3 id="基本原则"><a href="#基本原则" class="headerlink" title="基本原则"></a>基本原则</h3><p>Bootstrap表单控件自动获得一些全局样式，如所有textual <code>&lt;input&gt;</code>，<code>&lt;textarea&gt;</code>以及<code>&lt;select&gt;</code>带类的元素<code>.form-control</code>的宽度为100％。表单布局的基本规则如下;</p><ul><li>始终使用<code>&lt;form role=&quot;form&quot;&gt;</code>，有助于改善使用屏幕阅读器的人的可访问性</li><li>用于最佳间距包装标签和表格控件 <code>&lt;div class=&quot;form-group&quot;&gt;</code></li><li>将类<code>.form-control</code>添加到所有文本<code>&lt;input&gt;,&lt;textarea&gt;</code>和<code>&lt;select&gt;</code>元素</li></ul><h2 id="表单垂直布局-vertical-form"><a href="#表单垂直布局-vertical-form" class="headerlink" title="表单垂直布局(vertical form)"></a>表单垂直布局(vertical form)</h2><blockquote><p>垂直布局也是<code>Bootstrap</code>的默认布局，因为我们的浏览器默认的<strong>普通流</strong>就是从左到右(LTR)，从上到下。</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span>    </span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>My first Bootstrap page <span class="tag">&lt;/<span class="name">title</span>&gt;</span>    </span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initialscale=1"</span>&gt;</span>    </span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"CSS/bootstrap.min.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span>&gt;</span>   </span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"CSS/bootstrap-theme.min.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span>&gt;</span>    </span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"JS/bootstrap.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span> </span><br><span class="line"> <span class="tag">&lt;/<span class="name">head</span>&gt;</span> </span><br><span class="line"> <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span> <span class="attr">style</span>=<span class="string">"max-width:600px;margin:60px auto;"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">role</span>=<span class="string">"form"</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"name"</span>&gt;</span>First name<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"name"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"fname"</span> <span class="attr">placeholder</span>=<span class="string">"Enter name"</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="表单水平布局-horizontal-form"><a href="#表单水平布局-horizontal-form" class="headerlink" title="表单水平布局(horizontal form)"></a>表单水平布局(horizontal form)</h2><blockquote><p>水平形式与垂直形式布局的不同之处在于标记量和表单的表示形式。在此表单中，布局标签浮动到输入字段的左侧。标签和输入字段都出现在同一行上。除默认规则外，水平表单的规则，</p><p>所有你需要做的就是添加<code>.form-horizontal</code>类的<code>&lt;form&gt;</code> 元素，<code>.control-label</code>类的所有<code>&lt;label&gt;</code>元素。使用Bootstrap的预定义网格类来对齐标签和表单控件。</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span> <span class="attr">style</span>=<span class="string">"max-width:600px;padding:40px 20px;background:#ebeff2"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>Signup<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">class</span>=<span class="string">"form-horizontal"</span> <span class="attr">role</span>=<span class="string">"form"</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"name"</span> <span class="attr">class</span> =<span class="string">"control-label col-sm-3"</span>&gt;</span>First name<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-8"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"name"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"name"</span> <span class="attr">placeholder</span>=<span class="string">"Enter name"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"address"</span> <span class="attr">class</span> =<span class="string">"control-label col-sm-3"</span>&gt;</span>Second name<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-8"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"address"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"address"</span> <span class="attr">placeholder</span>=<span class="string">"Enter address"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"email"</span> <span class="attr">class</span> =<span class="string">"control-label col-sm-3"</span>&gt;</span>Email<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-8"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"email"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"email"</span> <span class="attr">placeholder</span>=<span class="string">"Enter email"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"pwd"</span> <span class="attr">class</span> =<span class="string">"control-label col-sm-3"</span>&gt;</span>Password<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-8"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"pwd"</span> <span class="attr">placeholder</span>=<span class="string">"Enter password"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-offset-2 col-sm-8"</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">class</span>=<span class="string">"btn btn-default"</span>&gt;</span>Register<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>注意：<code>label</code>元素在<strong>水平布局</strong>中必须添加<code>.control-label</code>样式。</li></ul><h2 id="内联表单-inline-form"><a href="#内联表单-inline-form" class="headerlink" title="内联表单(inline form )"></a>内联表单(inline form )</h2><blockquote><p>Bootstrap的内联表单布局可用于将表单控件并排放置在紧凑的布局中。在内联形式中，所有元素都是直线，左对齐，标签位于旁边。为此，您需要将<code>.form-inline</code>类添加到<code>&lt;form&gt;</code>元素。 </p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">class</span>=<span class="string">"form-inline"</span> <span class="attr">role</span>=<span class="string">"form"</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"name"</span>&gt;</span>Name<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"name"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"name"</span> <span class="attr">placeholder</span>=<span class="string">"Enter name"</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"email"</span>&gt;</span>Email<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"email"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"email"</span> <span class="attr">placeholder</span>=<span class="string">"Enter email"</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"pwd"</span>&gt;</span>Password<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"pwd"</span> <span class="attr">placeholder</span>=<span class="string">"Enter password"</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">class</span>=<span class="string">"btn btn-default"</span>&gt;</span>Register<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h3><ul><li><code>.form-group</code>类用于封装组中的多个控件 - 就像我们对标签和相应的文本框所做的那样。</li><li><code>.control-label</code>和<code>.form-control</code>类分别用于设置标签和表单元素的样式。</li><li>使用<code>.input-group</code>类可以相邻地关联多个控件。</li><li>禁用或只读状态可用于控件 - Bootstrap将自动关联必要的样式，但是，所有控件都必须添加.form-control类。</li><li>为了控制大小，可以使用<code>.input-lg</code>，<code>.input-sm</code>类。要控制组的大小，可以使用<code>.form-group-lg</code>或<code>.form-group-sm</code>类。</li><li>要显示任何帮助文本，可以在单独的标签中使用<code>.help-block</code>类。这将以新的一行显示文本。</li></ul><hr><h2 id="静态表单"><a href="#静态表单" class="headerlink" title="静态表单"></a>静态表单</h2><blockquote><p>经常需要静态展示表单信息，所以顺便总结一下静态表单的展示。</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">class</span>=<span class="string">"form-horizontal"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-2 control-label"</span>&gt;</span>Email<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-10"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"form-control-static"</span>&gt;</span>email@example.com<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"inputPassword"</span> <span class="attr">class</span>=<span class="string">"col-sm-2 control-label"</span>&gt;</span>Password<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-10"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"inputPassword"</span> <span class="attr">placeholder</span>=<span class="string">"Password"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p><a href="https://v3.bootcss.com/css/#forms-controls-static" target="_blank" rel="noopener">参考这里</a></p></blockquote><h2 id="表单元素校验状态"><a href="#表单元素校验状态" class="headerlink" title="表单元素校验状态"></a>表单元素校验状态</h2><blockquote><p>涉及<code>.input-group-addon</code>  <code>.has-feedback</code> <code>.form-control-feedback</code>  <code>.has-success</code>  <code>.help-block</code>等。</p><p>这里有一个<code>bootstrap-validation</code><a href="http://1000hz.github.io/bootstrap-validator/" target="_blank" rel="noopener">校验库</a>就是使用这些<code>class</code>样式实现的.</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">class</span>=<span class="string">"form-horizontal"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group has-success has-feedback"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"control-label col-sm-3"</span> <span class="attr">for</span>=<span class="string">"inputSuccess3"</span>&gt;</span>Input with success<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-9"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"inputSuccess3"</span> <span class="attr">aria-describedby</span>=<span class="string">"inputSuccess3Status"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-ok form-control-feedback"</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"inputSuccess3Status"</span> <span class="attr">class</span>=<span class="string">"sr-only"</span>&gt;</span>(success)<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group has-success has-feedback"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"control-label col-sm-3"</span> <span class="attr">for</span>=<span class="string">"inputGroupSuccess2"</span>&gt;</span>Input group with success<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-9"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"input-group"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"input-group-addon"</span>&gt;</span>@<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"inputGroupSuccess2"</span> <span class="attr">aria-describedby</span>=<span class="string">"inputGroupSuccess2Status"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-ok form-control-feedback"</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"inputGroupSuccess2Status"</span> <span class="attr">class</span>=<span class="string">"sr-only"</span>&gt;</span>(success)<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p><a href="https://v3.bootcss.com/css/#forms-control-validation" target="_blank" rel="noopener">例子参考这里</a></p></blockquote><h2 id="bootstrap表格样式class"><a href="#bootstrap表格样式class" class="headerlink" title="bootstrap表格样式class"></a>bootstrap表格样式class</h2><blockquote><p>总结一下bootstrap表格样式class的id，以下内容来自bootstrap的<code>forms.less</code>文件。</p></blockquote><h3 id="表单元素标签样式"><a href="#表单元素标签样式" class="headerlink" title="表单元素标签样式"></a>表单元素标签样式</h3><blockquote><p><code>Bootstrap</code>内部对如下的标签进行过样式的修饰。</p></blockquote><p>fieldset  </p><p>legend </p><p>label </p><p>input[type=”search”] </p><p>input[type=”radio”]</p><p>input[type=”checkbox”]</p><p>input[type=”file”]  </p><p>input[type=”range”] </p><p>select[multiple]</p><p>select[size]</p><p>output </p><p>select</p><p>textarea</p><p>input[type=”text”]</p><p>input[type=”password”]</p><p>input[type=”datetime”]</p><p>input[type=”datetime-local”]</p><p>input[type=”date”]</p><p>input[type=”month”]</p><p>input[type=”time”]</p><p>input[type=”week”]</p><p>input[type=”number”]</p><p>input[type=”email”]</p><p>input[type=”url”]</p><p>input[type=”search”]</p><p>input[type=”tel”]</p><p>input[type=”color”]</p><h3 id="表单样式class"><a href="#表单样式class" class="headerlink" title="表单样式class"></a>表单样式class</h3><h4 id="form-inline"><a href="#form-inline" class="headerlink" title=".form-inline"></a><code>.form-inline</code></h4><h4 id="form-horizontal"><a href="#form-horizontal" class="headerlink" title=".form-horizontal"></a><code>.form-horizontal</code></h4><h4 id="control-label"><a href="#control-label" class="headerlink" title=".control-label"></a><code>.control-label</code></h4><h4 id="form-control"><a href="#form-control" class="headerlink" title=".form-control"></a><code>.form-control</code></h4><ul><li>focus </li><li>disabled </li><li>readonly </li></ul><h4 id="form-control-static"><a href="#form-control-static" class="headerlink" title=".form-control-static"></a><code>.form-control-static</code></h4><blockquote><p>静态表单展示使用</p></blockquote><h4 id="form-group"><a href="#form-group" class="headerlink" title=".form-group"></a><code>.form-group</code></h4><ul><li><code>.form-group-sm</code></li><li><code>.form-group-lg</code></li></ul><h4 id="input-group-input-groups-less"><a href="#input-group-input-groups-less" class="headerlink" title=".input-group (input-groups.less)"></a><code>.input-group</code> (input-groups.less)</h4><ul><li><code>.input-group-addon</code></li><li><p><code>.input-group-btn</code></p></li><li><p><code>.input-sm</code></p></li><li><p><code>.input-lg</code></p></li><li><code>.input-group-lg</code></li><li><code>.input-group-sm</code></li></ul><blockquote><p><a href="https://v3.bootcss.com/css/#forms-control-sizes" target="_blank" rel="noopener">参考这里</a></p></blockquote><h4 id="radio和-checkbox"><a href="#radio和-checkbox" class="headerlink" title=".radio和.checkbox"></a><code>.radio</code>和<code>.checkbox</code></h4><ul><li><code>.radio</code></li><li><code>.radio-inline</code></li><li><code>.checkbox</code></li><li><code>.checkbox-inline</code></li></ul><blockquote><p><a href="https://v3.bootcss.com/css/#%E5%A4%9A%E9%80%89%E5%92%8C%E5%8D%95%E9%80%89%E6%A1%86" target="_blank" rel="noopener">参考这里</a></p></blockquote><h4 id="form-control的add-on系列"><a href="#form-control的add-on系列" class="headerlink" title="form-control的add-on系列"></a>form-control的add-on系列</h4><ul><li><code>.has-feedback</code></li><li><code>.form-control-feedback</code></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group has-success has-feedback"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"control-label"</span> <span class="attr">for</span>=<span class="string">"inputGroupSuccess1"</span>&gt;</span>Input group with success<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"input-group"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"input-group-addon"</span>&gt;</span>@<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"inputGroupSuccess1"</span> <span class="attr">aria-describedby</span>=<span class="string">"inputGroupSuccess1Status"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-ok form-control-feedback"</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"inputGroupSuccess1Status"</span> <span class="attr">class</span>=<span class="string">"sr-only"</span>&gt;</span>(success)<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p><a href="https://v3.bootcss.com/css/#forms-control-validation" target="_blank" rel="noopener">参考这里</a></p></blockquote><h4 id="help-block"><a href="#help-block" class="headerlink" title=".help-block"></a><code>.help-block</code></h4><blockquote><p><code>.help-block</code>主要给表单做一些说明性的文字</p></blockquote><h3 id="lt-legend-gt-和-lt-fieldset-gt-的使用"><a href="#lt-legend-gt-和-lt-fieldset-gt-的使用" class="headerlink" title="&lt;legend&gt;和&lt;fieldset&gt;的使用"></a><code>&lt;legend&gt;</code>和<code>&lt;fieldset&gt;</code>的使用</h3><h4 id="lt-legend-gt-的使用"><a href="#lt-legend-gt-的使用" class="headerlink" title="&lt;legend&gt;的使用"></a><code>&lt;legend&gt;</code>的使用</h4><blockquote><p><code>&lt;legend&gt;</code>：主要用来添加表单<strong>标题说明</strong>的.</p></blockquote><h4 id="lt-fieldset-gt-使用"><a href="#lt-fieldset-gt-使用" class="headerlink" title="&lt;fieldset&gt;使用"></a><code>&lt;fieldset&gt;</code>使用</h4><blockquote><p><code>&lt;fieldset&gt;</code>标签平时使用比较少，主要用在，当表单元素比较多，不同的表单元素需要进行<strong>分组</strong>，这时比较方便，而且对于<strong>分组表单元素</strong>进行统一的<strong>禁用</strong>时。</p><p>注意：<a href="https://v3.bootcss.com/css/#forms-control-disabled" target="_blank" rel="noopener">浏览器兼容性问题</a></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="tag">&lt;<span class="name">fieldset</span> <span class="attr">disabled</span>=<span class="string">"disabled"</span>&gt;</span>内部的表单元素都被禁用<span class="tag">&lt;/<span class="name">fieldset</span>&gt;</span></span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><blockquote><p> <a href="https://www.tutorialrepublic.com/codelab.php?topic=bootstrap&amp;file=disabled-fieldsets" target="_blank" rel="noopener">例子参考这里</a>：</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"IE=edge"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Example of Bootstrap 3 Disabled Fieldsets<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.bs-example</span>&#123;</span></span><br><span class="line"><span class="undefined">    margin: 20px;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"bs-example"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">class</span>=<span class="string">"form-horizontal"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">legend</span>&gt;</span>登录信息<span class="tag">&lt;/<span class="name">legend</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">fieldset</span> <span class="attr">disabled</span>=<span class="string">"disabled"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"inputEmail"</span> <span class="attr">class</span>=<span class="string">"control-label col-xs-2"</span>&gt;</span>Email<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-xs-10"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"email"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"inputEmail"</span> <span class="attr">placeholder</span>=<span class="string">"Email"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"inputPassword"</span> <span class="attr">class</span>=<span class="string">"control-label col-xs-2"</span>&gt;</span>Password<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-xs-10"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"inputPassword"</span> <span class="attr">placeholder</span>=<span class="string">"Password"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-xs-offset-2 col-xs-10"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"checkbox"</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span>&gt;</span> Remember me<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-xs-offset-2 col-xs-10"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span>&gt;</span>Login<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">fieldset</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="http://stacktips.com/tutorials/bootstrap/vertical-horizontal-and-inline-form-example-in-bootstrap" target="_blank" rel="noopener">http://stacktips.com/tutorials/bootstrap/vertical-horizontal-and-inline-form-example-in-bootstrap</a></p><p><a href="https://v3.bootcss.com/css/#forms" target="_blank" rel="noopener">https://v3.bootcss.com/css/#forms</a></p><p><a href="https://www.tutorialrepublic.com/twitter-bootstrap-tutorial/" target="_blank" rel="noopener">https://www.tutorialrepublic.com/twitter-bootstrap-tutorial/</a></p><p><a href="https://www.tutorialrepublic.com/twitter-bootstrap-tutorial/bootstrap-forms.php" target="_blank" rel="noopener">https://www.tutorialrepublic.com/twitter-bootstrap-tutorial/bootstrap-forms.php</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Bootstrap-表单布局&quot;&gt;&lt;a href=&quot;#Bootstrap-表单布局&quot; class=&quot;headerlink&quot; title=&quot;Bootstrap 表单布局&quot;&gt;&lt;/a&gt;Bootstrap 表单布局&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;bootstrap
      
    
    </summary>
    
      <category term="Bootstrap" scheme="https://betgar.github.io/categories/Bootstrap/"/>
    
    
      <category term="Bootstrap" scheme="https://betgar.github.io/tags/Bootstrap/"/>
    
  </entry>
  
  <entry>
    <title>创建基于ES6的项目</title>
    <link href="https://betgar.github.io/2018/07/17/create-project-based-on-es6-with-babel/"/>
    <id>https://betgar.github.io/2018/07/17/create-project-based-on-es6-with-babel/</id>
    <published>2018-07-17T13:00:00.000Z</published>
    <updated>2018-09-26T14:47:11.226Z</updated>
    
    <content type="html"><![CDATA[<h1 id="创建基于ES6的项目-babel"><a href="#创建基于ES6的项目-babel" class="headerlink" title="创建基于ES6的项目(babel)"></a>创建基于ES6的项目(babel)</h1><blockquote><p>首先感谢业界的很多大神，创造了很多的模版项目，成功的把我用成了傻逼。今天有个小的功能，使用<code>CRC</code>进行<code>checksum</code>校验，选择使用<code>node-crc</code>包，本来想写个小demo测试一下，结果发现<code>crc</code>全部使用es6语法进行构建，长期使用别人模版的我瞬间傻逼了。所以才有了这篇文章。</p><p><a href="https://github.com/jamiebuilds/babel-handbook/blob/master/translations/zh-Hans/user-handbook.md" target="_blank" rel="noopener">babel handbook 中文版</a></p></blockquote><h2 id="初始化项目"><a href="#初始化项目" class="headerlink" title="初始化项目"></a>初始化项目</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd crc-demo # crc-demo自己的项目目录</span><br><span class="line">npm init</span><br></pre></td></tr></table></figure><h2 id="安装依赖"><a href="#安装依赖" class="headerlink" title="安装依赖"></a>安装依赖</h2><ul><li><p><code>babel</code>和目标运行环境依赖（es5）</p><blockquote><p>目标环境根据自己实际的环境定义，具体参考<a href="https://www.babeljs.cn/docs/plugins/preset-env/" target="_blank" rel="noopener">preset-env</a></p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> rimraf 用来删除文件的</span></span><br><span class="line">npm install babel-cli babel-preset-es2015 rimraf --save-dev</span><br></pre></td></tr></table></figure></li><li><p>创建 <code>.babelrc</code> 配置文件</p><blockquote><p>在crc-demo下添加<code>.babelrc</code>文件，参考<a href="https://www.babeljs.cn/docs/setup/#installation" target="_blank" rel="noopener">这里</a></p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"presets"</span>: [</span><br><span class="line">        <span class="string">"es2015"</span> <span class="comment">// 环境和安装依赖的环境相关(babel-preset-es2015)</span></span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h2 id="package-json的scripts中添加babel"><a href="#package-json的scripts中添加babel" class="headerlink" title="package.json的scripts中添加babel"></a><code>package.json</code>的<code>scripts</code>中添加babel</h2><blockquote><p><code>src</code>目录的<code>js</code>文件会编译到<code>dist</code>中，每次编译之前都会先删除<code>dist</code>文件。</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"scripts"</span>: &#123;</span><br><span class="line">        <span class="string">"build"</span>: <span class="string">"rimraf dist/ &amp;&amp; babel src --out-dir dist/ --copy-files"</span>,</span><br><span class="line">        <span class="string">"start"</span>: <span class="string">"npm run build &amp;&amp; node dist/index.js"</span></span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="执行index-js内容"><a href="#执行index-js内容" class="headerlink" title="执行index.js内容"></a>执行<code>index.js</code>内容</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run start</span><br></pre></td></tr></table></figure><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://www.cnblogs.com/weschen/p/7154284.html" target="_blank" rel="noopener">https://www.cnblogs.com/weschen/p/7154284.html</a></p><p><a href="https://www.babeljs.cn/docs/plugins/preset-env/" target="_blank" rel="noopener">https://www.babeljs.cn/docs/plugins/preset-env/</a></p><p><a href="https://www.babeljs.cn/docs/usage/cli/" target="_blank" rel="noopener">https://www.babeljs.cn/docs/usage/cli/</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;创建基于ES6的项目-babel&quot;&gt;&lt;a href=&quot;#创建基于ES6的项目-babel&quot; class=&quot;headerlink&quot; title=&quot;创建基于ES6的项目(babel)&quot;&gt;&lt;/a&gt;创建基于ES6的项目(babel)&lt;/h1&gt;&lt;blockquote&gt;
&lt;p
      
    
    </summary>
    
      <category term="babel" scheme="https://betgar.github.io/categories/babel/"/>
    
    
      <category term="babel" scheme="https://betgar.github.io/tags/babel/"/>
    
  </entry>
  
  <entry>
    <title>Bootstrap响应式的HTML标签嵌套规则</title>
    <link href="https://betgar.github.io/2018/07/12/the-bootstrap-responsive-nested-rule-of-html/"/>
    <id>https://betgar.github.io/2018/07/12/the-bootstrap-responsive-nested-rule-of-html/</id>
    <published>2018-07-12T13:00:00.000Z</published>
    <updated>2018-09-26T14:47:11.226Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Bootstrap响应式的HTML嵌套规则"><a href="#Bootstrap响应式的HTML嵌套规则" class="headerlink" title="Bootstrap响应式的HTML嵌套规则"></a>Bootstrap响应式的HTML嵌套规则</h1><blockquote><p>使用Bootstrap已经很长时间了，总结一些HTML嵌套规则和Bootstrap的<code>class</code>使用。本来要自己总结的，重新看Bootstrap官网时发现了bootlint，所以直接把内容搬了过来，进行了分类汇总。</p></blockquote><h2 id="Bootlint使用"><a href="#Bootlint使用" class="headerlink" title="Bootlint使用"></a>Bootlint使用</h2><blockquote><p><code>Bootlint</code>是Bootstrap官方推出的一个工具，用来检测HTML结构是否符合Bootstrap响应式的规则。因为不正确的HTML嵌套，Bootstrap响应式效果不会生效。</p><p><code>bootlint</code>：问题代码参考地址<a href="https://github.com/twbs/bootlint/wiki" target="_blank" rel="noopener">https://github.com/twbs/bootlint/wiki</a></p></blockquote><h3 id="手动引入bootlint-js"><a href="#手动引入bootlint-js" class="headerlink" title="手动引入bootlint.js"></a>手动引入<code>bootlint.js</code></h3><blockquote><p>在<code>&lt;/body&gt;</code>之前引入<a href="https://github.com/twbs/bootlint/blob/master/dist/browser/bootlint.js" target="_blank" rel="noopener">bootlint.js</a></p></blockquote><h3 id="使用bookmarklet动态引入"><a href="#使用bookmarklet动态引入" class="headerlink" title="使用bookmarklet动态引入"></a>使用bookmarklet动态引入</h3><blockquote><p>添加一个书签，url配置为:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; javascript:(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> s=<span class="built_in">document</span>.createElement(<span class="string">"script"</span>);s.onload=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;bootlint.showLintReportForCurrentDocument([]);&#125;;s.src=<span class="string">"https://maxcdn.bootstrapcdn.com/bootlint/latest/bootlint.min.js"</span>;<span class="built_in">document</span>.body.appendChild(s)&#125;)();</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><blockquote><p>当你点击书签时，自动在当前页面引入。</p></blockquote><h2 id="Bootstrap的HTML嵌套规则"><a href="#Bootstrap的HTML嵌套规则" class="headerlink" title="Bootstrap的HTML嵌套规则"></a>Bootstrap的HTML嵌套规则</h2><blockquote><p>为什么要了解<code>Bootstrap</code>框架规定的HTML嵌套规则呢？因为只有了解了嵌套规则才能把<strong>响应式布局</strong>用好。</p></blockquote><h3 id="container"><a href="#container" class="headerlink" title=".container"></a>.container</h3><h4 id="container和-container-fluid不能嵌套"><a href="#container和-container-fluid不能嵌套" class="headerlink" title=".container和.container-fluid不能嵌套"></a><code>.container</code>和<code>.container-fluid</code>不能嵌套</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- wrong --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container-fluid"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container-fluid"</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"foobar"</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">          ...</span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container-fluid"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="row"><a href="#row" class="headerlink" title=".row"></a>.row</h3><h4 id="row的子节点应该只有-col"><a href="#row的子节点应该只有-col" class="headerlink" title=".row的子节点应该只有.col-*-*"></a><code>.row</code>的子节点应该只有<code>.col-*-*</code></h4><p>Bootlint found non-grid-column children of grid rows. Bootstrap’s grid system requires that all children of grid rows must be grid columns.</p><p>Wrong:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"my-awesome-thing"</span>&gt;</span>...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"other-thing"</span>&gt;</span>...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span>...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Right:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-6"</span>&gt;</span>...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-lg-12"</span>&gt;</span>...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-xs-12"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span>...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="row必须是-container或者-container-fluid的后代节点"><a href="#row必须是-container或者-container-fluid的后代节点" class="headerlink" title=".row必须是.container或者.container-fluid的后代节点"></a><code>.row</code>必须是<code>.container</code>或者<code>.container-fluid</code>的后代节点</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="row-and-col-不能同时用在同一个元素上"><a href="#row-and-col-不能同时用在同一个元素上" class="headerlink" title=".row and .col-*-* 不能同时用在同一个元素上"></a><code>.row</code> and <code>.col-*-*</code> 不能同时用在同一个元素上</h4><p>Wrong:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row col-xs-6"</span>&gt;</span>...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Right (Note that the two options have different meanings):</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-xs-6"</span>&gt;</span>...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- Or, depending on the semantics you need: --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-xs-6"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span>...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="column-col"><a href="#column-col" class="headerlink" title="column(.col-*-*)"></a>column(<code>.col-*-*</code>)</h3><h4 id="col-不能应用float属性"><a href="#col-不能应用float属性" class="headerlink" title=".col-*-*不能应用float属性"></a><code>.col-*-*</code>不能应用<code>float</code>属性</h4><p>wrong</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-7 pull-right"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-7"</span> <span class="attr">style</span>=<span class="string">"float: left;"</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="多余的col"><a href="#多余的col" class="headerlink" title="多余的col-*-*"></a>多余的<code>col-*-*</code></h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-xs-6 col-sm-6 col-md-6 col-lg-6"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p><code>col-xs-6</code>适用于等于和大于它的尺寸，所以其它<code>col-sm-6 col-md-6 col-lg-6</code>都是多余的。</p><p><strong>但是不同的尺寸下，宽度不一样时，不能这样使用</strong>。</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-xs-6"</span>&gt;</span>这样就行了<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="col-只应该是-row和-form-groups的子节点"><a href="#col-只应该是-row和-form-groups的子节点" class="headerlink" title=".col-*-*只应该是.row和.form-groups的子节点"></a><code>.col-*-*</code>只应该是<code>.row</code>和<code>.form-groups</code>的子节点</h4><p>Wrong:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"my-random-thing"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-6"</span>&gt;</span>...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-6"</span>&gt;</span>...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-12"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-12"</span>&gt;</span>...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- You can't nest columns directly like this. This is missing a level of .row --&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Right:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-6"</span>&gt;</span>...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-6"</span>&gt;</span>...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-horizontal"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-6"</span>&gt;</span>...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-6"</span>&gt;</span>...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-12"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-12"</span>&gt;</span>...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="input-group"><a href="#input-group" class="headerlink" title=".input-group"></a>.input-group</h3><h4 id="input-group-不能包含-lt-select-gt"><a href="#input-group-不能包含-lt-select-gt" class="headerlink" title=".input-group 不能包含 &lt;select&gt;"></a><code>.input-group</code> 不能包含 <code>&lt;select&gt;</code></h4><p>Wrong:<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- select 不能自适应宽度 在webkit浏览器中 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"input-group"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"input-group-addon"</span>&gt;</span>$<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">select</span> <span class="attr">class</span>=<span class="string">"form-control"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"5.00"</span>&gt;</span><span class="tag">&lt;<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"50.00"</span>&gt;</span><span class="tag">&lt;<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"500.00"</span>&gt;</span><span class="tag">&lt;<span class="name">option</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h4 id="input-group-不能包含-lt-textarea-gt"><a href="#input-group-不能包含-lt-textarea-gt" class="headerlink" title=".input-group 不能包含 &lt;textarea&gt;"></a><code>.input-group</code> 不能包含 <code>&lt;textarea&gt;</code></h4><p>Wrong:<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- input-group只能包含那些基于input的元素 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"input-group"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"input-group-addon"</span>&gt;</span>✉<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">textarea</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">placeholder</span>=<span class="string">"To Whom It May Concern:"</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h4 id="input-group不能包含多个-form-control元素"><a href="#input-group不能包含多个-form-control元素" class="headerlink" title=".input-group不能包含多个.form-control元素"></a><code>.input-group</code>不能包含<strong>多个</strong><code>.form-control</code>元素</h4><p>Wrong (unsupported):</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"input-group"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"input-group-addon"</span>&gt;</span>$<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">placeholder</span>=<span class="string">"Dollars"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">placeholder</span>=<span class="string">"Cents"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Right (supported):</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"input-group"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"input-group-addon"</span>&gt;</span>$<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">placeholder</span>=<span class="string">"Amount"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><hr><p>Wrong (unsupported):</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"input-group"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">placeholder</span>=<span class="string">"Username"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"input-group-addon"</span>&gt;</span>@<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">placeholder</span>=<span class="string">"Domain"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Right (supported):</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"input-group"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">placeholder</span>=<span class="string">"Username"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"input-group-addon"</span>&gt;</span>@example.com<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="input-group和-form-group不能同时应用同一元素"><a href="#input-group和-form-group不能同时应用同一元素" class="headerlink" title=".input-group和.form-group不能同时应用同一元素"></a><code>.input-group</code>和<code>.form-group</code>不能同时应用同一元素</h4><blockquote><p>应该在<code>.from-group</code>中嵌套<code>.input-group</code></p></blockquote><p>Wrong:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group input-group"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"input-group-addon"</span>&gt;</span>@<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">type</span>=<span class="string">"email"</span> <span class="attr">placeholder</span>=<span class="string">"Enter nickname"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Right:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"input-group"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"input-group-addon"</span>&gt;</span>@<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">type</span>=<span class="string">"email"</span> <span class="attr">placeholder</span>=<span class="string">"Enter nickname"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="input-group-and-col-不能同时直接应用在同一元素上"><a href="#input-group-and-col-不能同时直接应用在同一元素上" class="headerlink" title=".input-group and .col-*-* 不能同时直接应用在同一元素上"></a><code>.input-group</code> and <code>.col-*-*</code> 不能同时直接应用在同一元素上</h4><blockquote><p> <code>.col-*-*</code>不能用在 <code>.input-group</code>元素上.  应该在 <code>.col-*-*</code>中嵌套<code>.input-group</code> </p></blockquote><p>Wrong:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"input-group col-sm-5"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"input-group-addon"</span>&gt;</span>@<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">placeholder</span>=<span class="string">"Username"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Right:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-5"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"input-group"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"input-group-addon"</span>&gt;</span>@<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">placeholder</span>=<span class="string">"Username"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="input-group不支持在input单边-左边或者右边-包含多个-input-group-addon"><a href="#input-group不支持在input单边-左边或者右边-包含多个-input-group-addon" class="headerlink" title=".input-group不支持在input单边(左边或者右边)包含多个.input-group-addon"></a><code>.input-group</code>不支持在input单边(左边或者右边)包含多个<code>.input-group-addon</code></h4><p>Right (two add-ons are fine so long as they’re on <em>different</em> sides):</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"input-group"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"input-group-addon"</span>&gt;</span>$<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"input-group-addon"</span>&gt;</span>.00<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Wrong:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"input-group"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"input-group-addon"</span>&gt;</span>USD<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"input-group-addon"</span>&gt;</span>$<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Wrong:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"input-group"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"input-group-addon"</span>&gt;</span>.00<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"input-group-addon"</span>&gt;</span>USD<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="button"><a href="#button" class="headerlink" title="button"></a>button</h3><h4 id="btn-只能用在-lt-a-gt-button-lt-label-gt-lt-input-gt-元素上"><a href="#btn-只能用在-lt-a-gt-button-lt-label-gt-lt-input-gt-元素上" class="headerlink" title=".btn 只能用在&lt;a&gt; button &lt;label&gt;  &lt;input&gt;元素上"></a><code>.btn</code> 只能用在<code>&lt;a&gt;</code> <code>button</code> <code>&lt;label&gt;</code>  <code>&lt;input&gt;</code>元素上</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span>&gt;</span>Button<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span>&gt;</span>Button<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span> <span class="attr">value</span>=<span class="string">"Button"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span>&gt;</span>Button<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="button和input大小-在input-group中"><a href="#button和input大小-在input-group中" class="headerlink" title="button和input大小(在input-group中)"></a>button和input大小(在input-group中)</h4><blockquote><p>应该使用<code>input-group-lg</code>代替<code>btn-lg</code></p></blockquote><p>Wrong:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"input-group"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"input-group-btn"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-default btn-lg"</span> <span class="attr">type</span>=<span class="string">"button"</span>&gt;</span>Go!<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control input-lg"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Right:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"input-group input-group-lg"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"input-group-btn"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-default"</span> <span class="attr">type</span>=<span class="string">"button"</span>&gt;</span>Go!<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="btn-dropdown-toggle-只能是button-group最后一个元素"><a href="#btn-dropdown-toggle-只能是button-group最后一个元素" class="headerlink" title=".btn.dropdown-toggle 只能是button group最后一个元素."></a><code>.btn.dropdown-toggle</code> 只能是button group最后一个元素.</h4><p>Due to current limitations, for proper rendering, the dropdown toggle button in a split button dropdown must be the last button in the <code>.btn-group</code>.</p><p>Wrong:<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"btn-group"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-danger dropdown-toggle"</span> <span class="attr">data-toggle</span>=<span class="string">"dropdown"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"caret"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"sr-only"</span>&gt;</span>Toggle Dropdown<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"dropdown-menu"</span> <span class="attr">role</span>=<span class="string">"menu"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>Action<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>Another action<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>Something else here<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"divider"</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>Separated link<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-danger"</span>&gt;</span>Action<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>Right:<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"btn-group"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-danger"</span>&gt;</span>Action<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-danger dropdown-toggle"</span> <span class="attr">data-toggle</span>=<span class="string">"dropdown"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"caret"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"sr-only"</span>&gt;</span>Toggle Dropdown<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"dropdown-menu"</span> <span class="attr">role</span>=<span class="string">"menu"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>Action<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>Another action<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>Something else here<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"divider"</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>Separated link<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h3 id="checkbox"><a href="#checkbox" class="headerlink" title="checkbox"></a>checkbox</h3><h4 id="checkboxclass要求结构固定"><a href="#checkboxclass要求结构固定" class="headerlink" title=".checkboxclass要求结构固定"></a><code>.checkbox</code>class要求结构固定</h4><blockquote><p> <code>.checkbox&gt;label&gt;input[type=&quot;checkbox&quot;]</code></p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"checkbox"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> /&gt;</span> Label text goes here</span><br><span class="line">  <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="checkbox-inline-只能用在-lt-label-gt-元素"><a href="#checkbox-inline-只能用在-lt-label-gt-元素" class="headerlink" title=".checkbox-inline 只能用在 &lt;label&gt;元素"></a><code>.checkbox-inline</code> 只能用在 <code>&lt;label&gt;</code>元素</h4><p>Wrong:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"checkbox-inline"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">id</span>=<span class="string">"inlineCheckbox1"</span> <span class="attr">value</span>=<span class="string">"option1"</span> /&gt;</span> Option number one</span><br><span class="line"><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Right:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"checkbox-inline"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">id</span>=<span class="string">"inlineCheckbox1"</span> <span class="attr">value</span>=<span class="string">"option1"</span> /&gt;</span> Option number one</span><br><span class="line"><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="checkbox-inline-class正确的标签结构"><a href="#checkbox-inline-class正确的标签结构" class="headerlink" title=".checkbox-inline class正确的标签结构"></a><code>.checkbox-inline</code> class正确的标签结构</h4><blockquote><p>正确的结构是<code>label.checkbox-inline&gt;input[type=&quot;checkbox&quot;]</code></p></blockquote><p><code>.checkbox-inline</code> requires a specific DOM structure. There cannot be any intervening layers of elements.</p><p>Wrong:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"checkbox-inline"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"my-awesome-wrapper"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">id</span>=<span class="string">"inlineCheckbox1"</span> <span class="attr">value</span>=<span class="string">"option1"</span> /&gt;</span> Option number one</span><br><span class="line">  <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Right:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"checkbox-inline"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">id</span>=<span class="string">"inlineCheckbox1"</span> <span class="attr">value</span>=<span class="string">"option1"</span> /&gt;</span> Option number one</span><br><span class="line"><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="radioclass要求固定结构"><a href="#radioclass要求固定结构" class="headerlink" title=".radioclass要求固定结构"></a><code>.radio</code>class要求固定结构</h3><blockquote><p><code>.radio&gt;label&gt;input[type=&quot;radio&quot;]</code></p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"radio"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"someChoiceGroup"</span> <span class="attr">value</span>=<span class="string">"option1"</span> /&gt;</span></span><br><span class="line">    This is option number one</span><br><span class="line">  <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="radio-inline-只应该用在-lt-label-gt-元素"><a href="#radio-inline-只应该用在-lt-label-gt-元素" class="headerlink" title=".radio-inline 只应该用在 &lt;label&gt;元素"></a><code>.radio-inline</code> 只应该用在 <code>&lt;label&gt;</code>元素</h4><p>Wrong:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"radio-inline"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"someInlineRadioOptions"</span> <span class="attr">id</span>=<span class="string">"inlineRadio1"</span> <span class="attr">value</span>=<span class="string">"option1"</span> /&gt;</span> Option one</span><br><span class="line"><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"radio-inline"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"someInlineRadioOptions"</span> <span class="attr">id</span>=<span class="string">"inlineRadio2"</span> <span class="attr">value</span>=<span class="string">"option2"</span> /&gt;</span> Option two</span><br><span class="line"><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Right:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"radio-inline"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"someInlineRadioOptions"</span> <span class="attr">id</span>=<span class="string">"inlineRadio1"</span> <span class="attr">value</span>=<span class="string">"option1"</span> /&gt;</span> Option one</span><br><span class="line"><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"radio-inline"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"someInlineRadioOptions"</span> <span class="attr">id</span>=<span class="string">"inlineRadio2"</span> <span class="attr">value</span>=<span class="string">"option2"</span> /&gt;</span> Option two</span><br><span class="line"><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="radio-inline-class正确使用方式"><a href="#radio-inline-class正确使用方式" class="headerlink" title=".radio-inline class正确使用方式"></a><code>.radio-inline</code> class正确使用方式</h4><blockquote><p>正确标签结构：<code>label.radio-inline&gt;input[type=&quot;radio&quot;]</code></p></blockquote><p><code>.radio-inline</code> requires a specific DOM structure. There cannot be any intervening layers of elements.</p><p>Wrong:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"radio-inline"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"my-awesome-wrapper"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"someInlineRadioOptions"</span> <span class="attr">id</span>=<span class="string">"inlineRadio1"</span> <span class="attr">value</span>=<span class="string">"option1"</span> /&gt;</span> Option one</span><br><span class="line">  <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"radio-inline"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"my-awesome-wrapper"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"someInlineRadioOptions"</span> <span class="attr">id</span>=<span class="string">"inlineRadio2"</span> <span class="attr">value</span>=<span class="string">"option2"</span> /&gt;</span> Option two</span><br><span class="line">  <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Right:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"radio-inline"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"someInlineRadioOptions"</span> <span class="attr">id</span>=<span class="string">"inlineRadio1"</span> <span class="attr">value</span>=<span class="string">"option1"</span> /&gt;</span> Option one</span><br><span class="line"><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"radio-inline"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"someInlineRadioOptions"</span> <span class="attr">id</span>=<span class="string">"inlineRadio2"</span> <span class="attr">value</span>=<span class="string">"option2"</span> /&gt;</span> Option two</span><br><span class="line"><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="active-amp-checked"><a href="#active-amp-checked" class="headerlink" title=".active &amp; checked"></a><code>.active</code> &amp; <code>checked</code></h3><h4 id="checkbox和-radio的-active状态"><a href="#checkbox和-radio的-active状态" class="headerlink" title=".checkbox和.radio的.active状态"></a><code>.checkbox</code>和<code>.radio</code>的<code>.active</code>状态</h4><blockquote><p><code>.bt-group</code>中使用<code>.checkbox</code>和<code>.radio</code>，当<code>input[type=&quot;checkbox&quot;]</code>和<code>input[type=&quot;radio&quot;]</code>元素是checked状态，它们的<code>&lt;label&gt;</code>标签必须添加<code>.active</code>样式。</p></blockquote><p>Wrong:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"btn-group"</span> <span class="attr">data-toggle</span>=<span class="string">"buttons"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">checked</span> /&gt;</span> Option 1 (pre-checked)</span><br><span class="line">  <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"btn btn-primary active"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> /&gt;</span> Option 2 (not pre-checked)</span><br><span class="line">  <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Right:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"btn-group"</span> <span class="attr">data-toggle</span>=<span class="string">"buttons"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"btn btn-primary active"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">checked</span> /&gt;</span> Option 1 (pre-checked)</span><br><span class="line">  <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> /&gt;</span> Option 2 (not pre-checked)</span><br><span class="line">  <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><hr><p>Wrong:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"btn-group"</span> <span class="attr">data-toggle</span>=<span class="string">"buttons"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"options"</span> <span class="attr">id</span>=<span class="string">"option1"</span> <span class="attr">checked</span> /&gt;</span> Option 1 (preselected)</span><br><span class="line">  <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"btn btn-primary active"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"options"</span> <span class="attr">id</span>=<span class="string">"option2"</span> /&gt;</span> Option 2 (not preselected)</span><br><span class="line">  <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Right:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"btn-group"</span> <span class="attr">data-toggle</span>=<span class="string">"buttons"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"btn btn-primary active"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"options"</span> <span class="attr">id</span>=<span class="string">"option1"</span> <span class="attr">checked</span> /&gt;</span> Option 1 (preselected)</span><br><span class="line">  <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"options"</span> <span class="attr">id</span>=<span class="string">"option2"</span> /&gt;</span> Option 2 (not preselected)</span><br><span class="line">  <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="panel"><a href="#panel" class="headerlink" title="panel"></a>panel</h3><h4 id="panel-footer和-panel-heading-父元素必须是-panel"><a href="#panel-footer和-panel-heading-父元素必须是-panel" class="headerlink" title=".panel-footer和.panel-heading 父元素必须是 .panel"></a><code>.panel-footer</code>和<code>.panel-heading</code> 父元素必须是 <code>.panel</code></h4><p><code>.panel-footer</code>、 <code>.panel-heading</code>必须是<code>.panel</code>的直接子节点。<code>.panel-footer</code>、<code>.panel-heading</code> 和 <code>.panel</code>之间不能有任何的其它节点干扰。</p><p>Wrong:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel panel-default"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"my-super-special-wrapper"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-heading"</span>&gt;</span>Panel heading without title<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-body"</span>&gt;</span></span><br><span class="line">    Panel content</span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"my-super-special-wrapper"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-footer"</span>&gt;</span>Panel footer<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Right:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel panel-default"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-heading"</span>&gt;</span>Panel heading without title<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-body"</span>&gt;</span></span><br><span class="line">    Panel content</span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-footer"</span>&gt;</span>Panel footer<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="panel-title父元素必须是-panel-heading"><a href="#panel-title父元素必须是-panel-heading" class="headerlink" title=".panel-title父元素必须是.panel-heading"></a><code>.panel-title</code>父元素必须是<code>.panel-heading</code></h4><h3 id="table"><a href="#table" class="headerlink" title="table"></a>table</h3><h4 id="table-responsice应用在table的父元素上，而不是table元素"><a href="#table-responsice应用在table的父元素上，而不是table元素" class="headerlink" title=".table-responsice应用在table的父元素上，而不是table元素"></a><code>.table-responsice</code>应用在<code>table</code>的父元素上，而不是<code>table</code>元素</h4><p>Wrong:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">"table table-responsive"</span>&gt;</span></span><br><span class="line">  ...</span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Right:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"table-responsive"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">"table"</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line">  <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="form"><a href="#form" class="headerlink" title="form"></a>form</h3><h4 id="form-group元素不能嵌套"><a href="#form-group元素不能嵌套" class="headerlink" title=".form-group元素不能嵌套"></a><code>.form-group</code>元素不能嵌套</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="form-inline-或者-form-horizontal直接使用在-form-group-元素上"><a href="#form-inline-或者-form-horizontal直接使用在-form-group-元素上" class="headerlink" title=".form-inline 或者.form-horizontal直接使用在 .form-group. 元素上"></a><code>.form-inline</code> 或者<code>.form-horizontal</code>直接使用在 <code>.form-group</code>. 元素上</h4><blockquote><p> 或者 <code>.form-group</code> 嵌套在 <code>.form-inline</code> or <code>.form-horizontal</code>内部</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-inline"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-horizontal"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="form-control-feedback"><a href="#form-control-feedback" class="headerlink" title=".form-control-feedback"></a><code>.form-control-feedback</code></h4><blockquote><p><code>.form-control-feedback</code>元素的<strong>祖先元素</strong>必须有 <code>.form-group.has-feedback</code> 样式</p></blockquote><p>Wrong:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group has-error"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"control-label"</span> <span class="attr">for</span>=<span class="string">"inputError2"</span>&gt;</span>Input with error<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"inputError2"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-remove form-control-feedback"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Right:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group has-feedback has-error"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"control-label"</span> <span class="attr">for</span>=<span class="string">"inputError2"</span>&gt;</span>Input with error<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">id</span>=<span class="string">"inputError2"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-remove form-control-feedback"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="form-control不能用在没有交互输入的文本属性的input上"><a href="#form-control不能用在没有交互输入的文本属性的input上" class="headerlink" title=".form-control不能用在没有交互输入的文本属性的input上"></a><code>.form-control</code>不能用在没有<strong>交互输入</strong>的文本属性的<code>input</code>上</h4><p>Right</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">value</span>=<span class="string">"Text input"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">textarea</span> <span class="attr">class</span>=<span class="string">"form-control"</span>&gt;</span>Text area<span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">class</span>=<span class="string">"form-control"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">option</span>&gt;</span>Option 1<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">option</span>&gt;</span>Option 2<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">  ...</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="glyphicon"><a href="#glyphicon" class="headerlink" title="glyphicon"></a>glyphicon</h3><h4 id="glyphicon-必须和-glyphicon结合使用"><a href="#glyphicon-必须和-glyphicon结合使用" class="headerlink" title=".glyphicon-*必须和.glyphicon结合使用"></a><code>.glyphicon-*</code>必须和<code>.glyphicon</code>结合使用</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-heart"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="glyphicon-的元素，不能有子节点和文本节点"><a href="#glyphicon-的元素，不能有子节点和文本节点" class="headerlink" title=".glyphicon-*的元素，不能有子节点和文本节点"></a><code>.glyphicon-*</code>的元素，不能有子节点和文本节点</h4><p>Wrong:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-heart"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#love"</span>&gt;</span>I love this<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Right:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-heart"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#love"</span>&gt;</span>I love this<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="modal"><a href="#modal" class="headerlink" title="modal"></a>modal</h3><h4 id="modal正确的嵌套结构"><a href="#modal正确的嵌套结构" class="headerlink" title="modal正确的嵌套结构"></a>modal正确的嵌套结构</h4><blockquote><p><code>.modal .modal-dialog .modal-content .modal-header .modal-title .modal-body .modal-footer</code>嵌套结构不能改变。</p><p><code>.modal-header .modal-footer</code>是可选的。</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal fade"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-dialog"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-content"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-header"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"close"</span> <span class="attr">data-dismiss</span>=<span class="string">"modal"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span>&amp;times;<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"sr-only"</span>&gt;</span>Close<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h4</span> <span class="attr">class</span>=<span class="string">"modal-title"</span>&gt;</span>Modal title<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-body"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>One fine body<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-footer"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-default"</span> <span class="attr">data-dismiss</span>=<span class="string">"modal"</span>&gt;</span>Close<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span>&gt;</span>Save changes<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="hide-should-not-be-used-on-modal-in-Bootstrap-v3"><a href="#hide-should-not-be-used-on-modal-in-Bootstrap-v3" class="headerlink" title=".hide should not be used on .modal in Bootstrap v3."></a><code>.hide</code> should not be used on <code>.modal</code> in Bootstrap v3.</h4><blockquote><p><code>.hide</code>在Bootstrap3中不能应用在<code>.modal</code>身上。</p></blockquote><h4 id="modal必须含有tabindex和role属性"><a href="#modal必须含有tabindex和role属性" class="headerlink" title=".modal必须含有tabindex和role属性"></a><code>.modal</code>必须含有<code>tabindex</code>和<code>role</code>属性</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal"</span> <span class="attr">tabindex</span>=<span class="string">"-1"</span> <span class="attr">role</span>=<span class="string">"dialog"</span>&gt;</span></span><br><span class="line">  ...</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="modal-dialog元素必须含有role-quot-document-quot"><a href="#modal-dialog元素必须含有role-quot-document-quot" class="headerlink" title=".modal-dialog元素必须含有role=&quot;document&quot;"></a><code>.modal-dialog</code>元素必须含有<code>role=&quot;document&quot;</code></h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-dialog"</span> <span class="attr">role</span>=<span class="string">"document"</span>&gt;</span></span><br><span class="line">  ...</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="alert"><a href="#alert" class="headerlink" title=".alert"></a><code>.alert</code></h3><h4 id="alert-包含dismiss-button时-必须包含-alert-dismissible样式"><a href="#alert-包含dismiss-button时-必须包含-alert-dismissible样式" class="headerlink" title=".alert 包含dismiss button时 必须包含 .alert-dismissible样式"></a><code>.alert</code> 包含<code>dismiss button</code>时 必须包含 <code>.alert-dismissible</code>样式</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"alert alert-warning alert-dismissible"</span> <span class="attr">role</span>=<span class="string">"alert"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">data-dismiss</span>=<span class="string">"alert"</span>&gt;</span>Dismiss<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  Better check yourself, you're not looking too good.</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="alert的-closebutton必须是第一个子节点"><a href="#alert的-closebutton必须是第一个子节点" class="headerlink" title=".alert的.closebutton必须是第一个子节点"></a><code>.alert</code>的<code>.close</code>button必须是第一个子节点</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"alert alert-warning alert-dismissible"</span> <span class="attr">role</span>=<span class="string">"alert"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"close"</span> <span class="attr">data-dismiss</span>=<span class="string">"alert"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span>&amp;times;<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"sr-only"</span>&gt;</span>Close<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  Better check yourself, you're not looking too good.</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="media"><a href="#media" class="headerlink" title="media"></a>media</h3><h4 id="media-left-and-media-right-在-media-内部使用"><a href="#media-left-and-media-right-在-media-内部使用" class="headerlink" title=".media-left and .media-right 在.media 内部使用."></a><code>.media-left</code> and <code>.media-right</code> 在<code>.media</code> 内部使用.</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"media"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"media-left"</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"media-body"</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="nav"><a href="#nav" class="headerlink" title="nav"></a>nav</h3><h4 id="navbar-left-and-navbar-right-should-not-be-used-outside-of-navbars"><a href="#navbar-left-and-navbar-right-should-not-be-used-outside-of-navbars" class="headerlink" title=".navbar-left and .navbar-right should not be used outside of navbars."></a><code>.navbar-left</code> and <code>.navbar-right</code> should not be used outside of navbars.</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">nav</span> <span class="attr">class</span>=<span class="string">"navbar navbar-default"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container-fluid"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"navbar-header"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"navbar-toggle collapsed"</span> <span class="attr">data-toggle</span>=<span class="string">"collapse"</span> <span class="attr">data-target</span>=<span class="string">"#bs-example-navbar-42"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"sr-only"</span>&gt;</span>Toggle navigation<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"icon-bar"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"icon-bar"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"icon-bar"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"navbar-brand"</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>Brand<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"collapse navbar-collapse"</span> <span class="attr">id</span>=<span class="string">"bs-example-navbar-42"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"navbar-text navbar-right"</span>&gt;</span>Signed in as Mark Otto<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">nav</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="carousel"><a href="#carousel" class="headerlink" title=".carousel"></a><code>.carousel</code></h3><h4 id="carousel-inner-必须有一个活动状态的子节点-item-active"><a href="#carousel-inner-必须有一个活动状态的子节点-item-active" class="headerlink" title=".carousel-inner 必须有一个活动状态的子节点 .item.active"></a><code>.carousel-inner</code> 必须有一个活动状态的子节点 <code>.item.active</code></h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"carousel-inner"</span> <span class="attr">role</span>=<span class="string">"listbox"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"item active"</span>&gt;</span>...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span>...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  ...</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="carousel-必须有且只有一个-carousel-inner-子节点"><a href="#carousel-必须有且只有一个-carousel-inner-子节点" class="headerlink" title=".carousel 必须有且只有一个 .carousel-inner 子节点"></a><code>.carousel</code> 必须有且只有一个 <code>.carousel-inner</code> 子节点</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"carousel-example-generic"</span> <span class="attr">class</span>=<span class="string">"carousel slide"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ol</span> <span class="attr">class</span>=<span class="string">"carousel-indicators"</span>&gt;</span>...<span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"carousel-inner"</span> <span class="attr">role</span>=<span class="string">"listbox"</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"left carousel-control"</span> <span class="attr">href</span>=<span class="string">"#carousel-example-generic"</span> <span class="attr">role</span>=<span class="string">"button"</span> <span class="attr">data-slide</span>=<span class="string">"prev"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-chevron-left"</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"sr-only"</span>&gt;</span>Previous<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"right carousel-control"</span> <span class="attr">href</span>=<span class="string">"#carousel-example-generic"</span> <span class="attr">role</span>=<span class="string">"button"</span> <span class="attr">data-slide</span>=<span class="string">"next"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-chevron-right"</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"sr-only"</span>&gt;</span>Next<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>等等规则，详情见<a href="https://github.com/twbs/bootlint/wiki" target="_blank" rel="noopener">bootlint wiki</a></p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://www.tutorialrepublic.com/twitter-bootstrap-tutorial/" target="_blank" rel="noopener">https://www.tutorialrepublic.com/twitter-bootstrap-tutorial/</a></p><p><a href="https://github.com/twbs/bootlint/" target="_blank" rel="noopener">https://github.com/twbs/bootlint/</a></p><p><a href="https://github.com/twbs/bootlint/blob/master/dist/browser/bootlint.js" target="_blank" rel="noopener">https://github.com/twbs/bootlint/blob/master/dist/browser/bootlint.js</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Bootstrap响应式的HTML嵌套规则&quot;&gt;&lt;a href=&quot;#Bootstrap响应式的HTML嵌套规则&quot; class=&quot;headerlink&quot; title=&quot;Bootstrap响应式的HTML嵌套规则&quot;&gt;&lt;/a&gt;Bootstrap响应式的HTML嵌套规则&lt;/
      
    
    </summary>
    
      <category term="Bootstrap" scheme="https://betgar.github.io/categories/Bootstrap/"/>
    
    
      <category term="Bootstrap" scheme="https://betgar.github.io/tags/Bootstrap/"/>
    
  </entry>
  
  <entry>
    <title>iCheck使用总结</title>
    <link href="https://betgar.github.io/2018/07/11/use-the-icheck/"/>
    <id>https://betgar.github.io/2018/07/11/use-the-icheck/</id>
    <published>2018-07-11T12:00:00.000Z</published>
    <updated>2018-09-26T14:47:11.226Z</updated>
    
    <content type="html"><![CDATA[<h1 id="iCheck使用"><a href="#iCheck使用" class="headerlink" title="iCheck使用"></a>iCheck使用</h1><blockquote><p>注意：使用<code>iCheck</code>时需要自己引用相关的皮肤，官方提供了几套皮肤，每一套还有不同的颜色，使用之前一定要引入相关<code>css</code>，不然会出现<code>checkbox</code><strong>无法显示</strong>的窘境。</p></blockquote><h2 id="初始化iCheck"><a href="#初始化iCheck" class="headerlink" title="初始化iCheck"></a>初始化iCheck</h2><blockquote><p>具体的请参考官方文档。</p></blockquote><ul><li><p>引入样式<code>CSS</code>和<code>JavaScript</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"your-path/jquery.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"your-path/minimal/red.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"your-path/icheck.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>添加HTML</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">checked</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"iCheck"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"iCheck"</span> <span class="attr">checked</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>初始化<code>iCheck</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 例子1： 指定皮肤样式 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    $(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">      $(<span class="string">'input'</span>).iCheck(&#123;</span></span><br><span class="line"><span class="javascript">        checkboxClass: <span class="string">'icheckbox_minimal'</span>, <span class="comment">// 指定的皮肤样式</span></span></span><br><span class="line"><span class="javascript">        radioClass: <span class="string">'iradio_minimal'</span>,</span></span><br><span class="line"><span class="javascript">        increaseArea: <span class="string">'20%'</span> <span class="comment">// optional</span></span></span><br><span class="line"><span class="undefined">      &#125;);</span></span><br><span class="line"><span class="undefined">    &#125;);</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 例子2： 指定皮肤样式和颜色 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    $(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">      $(<span class="string">'input'</span>).iCheck(&#123;</span></span><br><span class="line"><span class="javascript">        checkboxClass: <span class="string">'icheckbox_minimal-red'</span>,</span></span><br><span class="line"><span class="javascript">        radioClass: <span class="string">'iradio_minimal-red'</span>,</span></span><br><span class="line"><span class="javascript">        increaseArea: <span class="string">'20%'</span> <span class="comment">// optional</span></span></span><br><span class="line"><span class="undefined">      &#125;);</span></span><br><span class="line"><span class="undefined">    &#125;);</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 例子3： html上指定皮肤 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">checked</span> <span class="attr">class</span>=<span class="string">"minimal"</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ul><h2 id="全选功能实现"><a href="#全选功能实现" class="headerlink" title="全选功能实现"></a>全选功能实现</h2><blockquote><p>实现一个全选功能。</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-xs-6 col-sm-6 col-md-6 col-lg-6"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">class</span>=<span class="string">"js-all"</span>&gt;</span>checkbox2</span><br><span class="line">        <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span> </span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span> <span class="attr">data-role</span>=<span class="string">"checkbox"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-xs-6 col-sm-6 col-md-6 col-lg-6"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span>&gt;</span>checkbox1</span><br><span class="line">        <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-xs-6 col-sm-6 col-md-6 col-lg-6"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span>&gt;</span>checkbox2</span><br><span class="line">        <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> checkAll = $(<span class="string">'input.js-all'</span>);</span><br><span class="line">    <span class="keyword">var</span> checkboxes = $(<span class="string">'input[type="checkbox"]'</span>, <span class="string">'[data-role="checkbox"]'</span>);</span><br><span class="line"></span><br><span class="line">    $(<span class="string">'input'</span>).iCheck();</span><br><span class="line"><span class="comment">// 全部选中或者不选.</span></span><br><span class="line">    checkAll.on(<span class="string">'ifChecked ifUnchecked'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;        </span><br><span class="line">        <span class="keyword">if</span> (event.type == <span class="string">'ifChecked'</span>) &#123;</span><br><span class="line">            checkboxes.iCheck(<span class="string">'check'</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            checkboxes.iCheck(<span class="string">'uncheck'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="comment">// 改变全选checkbox状态.</span></span><br><span class="line">    checkboxes.on(<span class="string">'ifChanged'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(checkboxes.filter(<span class="string">':checked'</span>).length == checkboxes.length) &#123;</span><br><span class="line">            checkAll.prop(<span class="string">'checked'</span>, <span class="literal">true</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            checkAll.prop(<span class="string">'checked'</span>, <span class="literal">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        checkAll.iCheck(<span class="string">'update'</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="动态添加checkbox事件代理"><a href="#动态添加checkbox事件代理" class="headerlink" title="动态添加checkbox事件代理"></a>动态添加checkbox事件代理</h2><blockquote><p>动态添加checkbox事件不生效问题，应该使用<strong>事件代理</strong>。</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span> <span class="attr">data-role</span>=<span class="string">"checkbox"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-xs-6 col-sm-6 col-md-6 col-lg-6"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span>&gt;</span>checkbox1</span><br><span class="line">        <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-xs-6 col-sm-6 col-md-6 col-lg-6"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span>&gt;</span>checkbox2</span><br><span class="line">        <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 这里动态添加checkbox 时, js需要修改为事件代理模式 --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 如果所有&lt;div class="row" data-role="checkbox"&gt;</span></span><br><span class="line"><span class="comment">// 内所有的checkbox都选中，或者不全选需要动态的改变“全选”checkbox状态</span></span><br><span class="line"><span class="comment">// 因为有动态加入的checkbox，所以这里需要修改成代理事件</span></span><br><span class="line"><span class="keyword">var</span> $checkboxContainer = $(<span class="string">'.row[data-role="checkbox"]'</span>);</span><br><span class="line">$checkboxContainer.on(<span class="string">'ifChanged'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span>&#123;</span><br><span class="line">    <span class="comment">// checkboxes需要动态获取</span></span><br><span class="line">    <span class="keyword">var</span> checkboxes = $(<span class="string">'input[type="checkbox"]'</span>, $checkboxContainer);</span><br><span class="line">    <span class="keyword">if</span>(checkboxes.filter(<span class="string">':checked'</span>).length == checkboxes.length) &#123;</span><br><span class="line">        checkAll.prop(<span class="string">'checked'</span>, <span class="literal">true</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        checkAll.prop(<span class="string">'checked'</span>, <span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    checkAll.iCheck(<span class="string">'update'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="获取checked状态的checkbox"><a href="#获取checked状态的checkbox" class="headerlink" title="获取checked状态的checkbox"></a>获取checked状态的checkbox</h2><blockquote><p><code>iCheckbox</code>是没有提供获取<code>checked</code>状态的<strong>方法</strong>，所以你要使用<code>jQuery</code>提供的<code>prop</code>方法。</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> checkboxes = $(<span class="string">'input[type="checkbox"]'</span>, $checkboxContainer);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取选中的checkbox</span></span><br><span class="line"><span class="keyword">var</span> allChecked = checkboxes.filter(<span class="string">':checked'</span>);</span><br><span class="line"><span class="comment">// 获取checked状态</span></span><br><span class="line">$.each(checkboxes, <span class="function"><span class="keyword">function</span> (<span class="params">checkbox, i</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log($(<span class="keyword">this</span>).prop(<span class="string">'checked'</span>)); <span class="comment">// true | false</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="http://icheck.fronteed.com/" target="_blank" rel="noopener">http://icheck.fronteed.com/</a></p><p><a href="http://github.com/fronteed/iCheck/" target="_blank" rel="noopener">http://github.com/fronteed/iCheck/</a></p><p><a href="https://stackoverflow.com/questions/17820080/function-select-all-and-icheck" target="_blank" rel="noopener">https://stackoverflow.com/questions/17820080/function-select-all-and-icheck</a></p><p><a href="https://github.com/fronteed/iCheck/issues/44" target="_blank" rel="noopener">https://github.com/fronteed/iCheck/issues/44</a></p><p><a href="https://www.cnblogs.com/xcsn/p/6307610.html" target="_blank" rel="noopener">https://www.cnblogs.com/xcsn/p/6307610.html</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;iCheck使用&quot;&gt;&lt;a href=&quot;#iCheck使用&quot; class=&quot;headerlink&quot; title=&quot;iCheck使用&quot;&gt;&lt;/a&gt;iCheck使用&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;注意：使用&lt;code&gt;iCheck&lt;/code&gt;时需要自己引用相关
      
    
    </summary>
    
      <category term="jQuery" scheme="https://betgar.github.io/categories/jQuery/"/>
    
    
      <category term="jQuery" scheme="https://betgar.github.io/tags/jQuery/"/>
    
      <category term="iCheck" scheme="https://betgar.github.io/tags/iCheck/"/>
    
  </entry>
  
  <entry>
    <title>个人装机软件</title>
    <link href="https://betgar.github.io/2018/07/03/software-for-daily/"/>
    <id>https://betgar.github.io/2018/07/03/software-for-daily/</id>
    <published>2018-07-03T14:46:12.000Z</published>
    <updated>2018-09-26T14:47:11.226Z</updated>
    
    <content type="html"><![CDATA[<h1 id="个人装机软件"><a href="#个人装机软件" class="headerlink" title="个人装机软件"></a>个人装机软件</h1><blockquote><p>总结一下个人windows装机软件，比较适合coder.</p></blockquote><h2 id="压缩软件"><a href="#压缩软件" class="headerlink" title="压缩软件"></a>压缩软件</h2><ul><li>7-zip</li><li><a href="https://cn.bandisoft.com/bandizip/" target="_blank" rel="noopener">bindizip</a></li></ul><h2 id="下载软件"><a href="#下载软件" class="headerlink" title="下载软件"></a>下载软件</h2><ul><li>迅雷极速版</li><li>you-get</li><li>proxyee-down</li></ul><h2 id="安全软件"><a href="#安全软件" class="headerlink" title="安全软件"></a>安全软件</h2><ul><li>火绒</li></ul><h2 id="辅助软件"><a href="#辅助软件" class="headerlink" title="辅助软件"></a>辅助软件</h2><ul><li>ccleaner</li><li>xmeters</li><li>rainmeter(很漂亮也很复杂)</li><li>everything</li><li>freecommander</li></ul><h2 id="文档工具"><a href="#文档工具" class="headerlink" title="文档工具"></a>文档工具</h2><ul><li>ms office</li><li>typora(markdown)</li><li>notepad++</li><li>SumatraPDF</li><li><a href="https://otp.landian.la/index.html" target="_blank" rel="noopener">office tool plus</a></li></ul><h2 id="浏览器"><a href="#浏览器" class="headerlink" title="浏览器"></a>浏览器</h2><ul><li>firefox(自动同步书签和多个终端的tabs)</li><li>chrome</li></ul><h2 id="邮件"><a href="#邮件" class="headerlink" title="邮件"></a>邮件</h2><ul><li>foxmail</li></ul><h2 id="通讯软件"><a href="#通讯软件" class="headerlink" title="通讯软件"></a>通讯软件</h2><ul><li>QQ(TIM没广告)</li><li>weixin</li></ul><h2 id="代理软件"><a href="#代理软件" class="headerlink" title="代理软件"></a>代理软件</h2><ul><li>shadowsocks</li></ul><h2 id="输入法"><a href="#输入法" class="headerlink" title="输入法"></a>输入法</h2><ul><li>QQ拼音</li><li>搜狗输入法</li></ul><h2 id="cmd"><a href="#cmd" class="headerlink" title="cmd"></a>cmd</h2><ul><li>git for windows</li><li>cmder</li><li>cygwin</li></ul><h2 id="ftp"><a href="#ftp" class="headerlink" title="ftp"></a>ftp</h2><ul><li>filezilla</li></ul><h2 id="ssh"><a href="#ssh" class="headerlink" title="ssh"></a>ssh</h2><ul><li>putty</li><li>xmanager</li></ul><h2 id="编辑器-amp-IDE"><a href="#编辑器-amp-IDE" class="headerlink" title="编辑器&amp;IDE"></a>编辑器&amp;IDE</h2><ul><li>webStorm</li><li>vscode</li><li>eclipse</li><li>spring tool suite</li><li>plsql developer</li><li>notepad++</li></ul><h2 id="资料"><a href="#资料" class="headerlink" title="资料"></a>资料</h2><blockquote><p>可以看看amazing系列。</p></blockquote><p><a href="https://legacy.gitbook.com/@amazing-apps" target="_blank" rel="noopener">https://legacy.gitbook.com/@amazing-apps</a></p><p><a href="https://amazing-apps.gitbooks.io/windows-apps-that-amaze-us/zh-CN/" target="_blank" rel="noopener">https://amazing-apps.gitbooks.io/windows-apps-that-amaze-us/zh-CN/</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;个人装机软件&quot;&gt;&lt;a href=&quot;#个人装机软件&quot; class=&quot;headerlink&quot; title=&quot;个人装机软件&quot;&gt;&lt;/a&gt;个人装机软件&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;总结一下个人windows装机软件，比较适合coder.&lt;/p&gt;
&lt;/blockq
      
    
    </summary>
    
      <category term="software" scheme="https://betgar.github.io/categories/software/"/>
    
    
      <category term="software" scheme="https://betgar.github.io/tags/software/"/>
    
  </entry>
  
  <entry>
    <title>test-hexo-synax-again</title>
    <link href="https://betgar.github.io/2018/06/26/test-hexo-synax-again/"/>
    <id>https://betgar.github.io/2018/06/26/test-hexo-synax-again/</id>
    <published>2018-06-26T15:30:00.000Z</published>
    <updated>2018-09-26T14:47:11.226Z</updated>
    
    <content type="html"><![CDATA[<h1 id="hexo语法测试"><a href="#hexo语法测试" class="headerlink" title="hexo语法测试"></a>hexo语法测试</h1><blockquote><p>预定义参数测试</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;hexo语法测试&quot;&gt;&lt;a href=&quot;#hexo语法测试&quot; class=&quot;headerlink&quot; title=&quot;hexo语法测试&quot;&gt;&lt;/a&gt;hexo语法测试&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;预定义参数测试&lt;/p&gt;
&lt;/blockquote&gt;

      
    
    </summary>
    
      <category term="hexo" scheme="https://betgar.github.io/categories/hexo/"/>
    
    
      <category term="hexo" scheme="https://betgar.github.io/tags/hexo/"/>
    
  </entry>
  
  <entry>
    <title>Android 开发环境部署</title>
    <link href="https://betgar.github.io/2018/06/25/android-dev-env/"/>
    <id>https://betgar.github.io/2018/06/25/android-dev-env/</id>
    <published>2018-06-25T02:00:00.000Z</published>
    <updated>2018-09-26T14:47:11.226Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Android-开发环境部署"><a href="#Android-开发环境部署" class="headerlink" title="Android 开发环境部署"></a>Android 开发环境部署</h1><blockquote><p>android studio 3.0</p><p>android SDK</p></blockquote><h2 id="Java环境配置"><a href="#Java环境配置" class="headerlink" title="Java环境配置"></a>Java环境配置</h2><blockquote><p>Java SDK安装：JDK8.X</p></blockquote><h3 id="Java环境变量配置"><a href="#Java环境变量配置" class="headerlink" title="Java环境变量配置"></a>Java环境变量配置</h3><blockquote><p>我的电脑配置环境变量：</p></blockquote><ol><li><p>JAVA_HOME</p><blockquote><p>D:\Android\jdk1.6.0_03</p></blockquote></li><li><p>CLASSPATH</p><blockquote><p>%JAVA_HOME%\lib\dt.jar;%JAVA_HOME%\lib\tools.jar;</p></blockquote></li></ol><ul><li><p>3-PATH</p><blockquote><p>%JAVA_HOME%\bin;</p></blockquote></li></ul><h2 id="Android-Studio安装"><a href="#Android-Studio安装" class="headerlink" title="Android Studio安装"></a>Android Studio安装</h2><blockquote><p>android studio 解压就可以用.</p></blockquote><h2 id="Android-SDK-manager-更新SDK"><a href="#Android-SDK-manager-更新SDK" class="headerlink" title="Android SDK manager 更新SDK"></a>Android SDK manager 更新SDK</h2><blockquote><p>第一次启动android studio，有让你选择的android SDK的路径，然后勾选一些选项然后进行更新。</p><p>也可以跳过，然后启动android studio之后，进入configure搜索sdk进行更新（目前好像不存在科学上网的问题了）。</p></blockquote><h2 id="Android-studio-常用插件"><a href="#Android-studio-常用插件" class="headerlink" title="Android studio 常用插件"></a>Android studio 常用插件</h2><blockquote><ul><li>Butterknife Zelezny</li><li>Parcelable Code Generator</li><li>Prettify</li><li>ADB Idea</li><li>GsonFormat</li><li>Android Drawable Importer</li><li>Android Code Generator</li><li>Android Material Design Icon Generator</li></ul><p>参考：<a href="https://www.cnblogs.com/zhayh/p/6555850.html" target="_blank" rel="noopener">https://www.cnblogs.com/zhayh/p/6555850.html</a></p></blockquote><h2 id="ADB环境变量"><a href="#ADB环境变量" class="headerlink" title="ADB环境变量"></a>ADB环境变量</h2><blockquote><p>ADB环境变量配置，方便调试使用<code>adb</code>命令。</p><p>环境变量里面配置：</p><p>ANDROID_HOME=你的anroid sdk路径</p><p>path=%ANDROID_HOME%\platform-tools;%ANDROID_HOME%\tools;</p><p>参考： <a href="https://www.cnblogs.com/yxysuanfa/p/7251253.html" target="_blank" rel="noopener">https://www.cnblogs.com/yxysuanfa/p/7251253.html</a></p></blockquote><h2 id="ADB-usb-driver安装"><a href="#ADB-usb-driver安装" class="headerlink" title="ADB usb driver安装"></a>ADB usb driver安装</h2><blockquote><p>推荐使用adbinstaller</p><p><a href="http://adbdriver.com/" target="_blank" rel="noopener">http://adbdriver.com/</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Android-开发环境部署&quot;&gt;&lt;a href=&quot;#Android-开发环境部署&quot; class=&quot;headerlink&quot; title=&quot;Android 开发环境部署&quot;&gt;&lt;/a&gt;Android 开发环境部署&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;android s
      
    
    </summary>
    
      <category term="android" scheme="https://betgar.github.io/categories/android/"/>
    
    
      <category term="android" scheme="https://betgar.github.io/tags/android/"/>
    
  </entry>
  
  <entry>
    <title>apt-cyg安装</title>
    <link href="https://betgar.github.io/2018/06/04/apt-cyg/"/>
    <id>https://betgar.github.io/2018/06/04/apt-cyg/</id>
    <published>2018-06-04T00:29:00.000Z</published>
    <updated>2019-04-05T14:07:31.746Z</updated>
    
    <content type="html"><![CDATA[<h1 id="apt-cyg"><a href="#apt-cyg" class="headerlink" title="apt-cyg"></a>apt-cyg</h1><blockquote><p>因为使用在windows下使用<code>cygwin</code>，为了方便安装其它包，所以需要安装<code>apt-cyg</code>包管理器。</p></blockquote><h2 id="使用setup-x86-64-exe安装（apt-cyg）"><a href="#使用setup-x86-64-exe安装（apt-cyg）" class="headerlink" title="使用setup-x86_64.exe安装（apt-cyg）"></a>使用setup-x86_64.exe安装（apt-cyg）</h2><blockquote><p><code>setup-x86_64.exe</code>已经是<code>cygwin</code>的包管理器，所以其它包都可以通过它来安装。</p></blockquote><p> <del>别名是为了方便使用，设置只在当前的shell生效</del><br> <del>alias cyg-get=”/cygdrive/d/path/to/cygwin/setup-x86_64.exe -q -P”</del><br> <del>建议使用<a href="ftp://sourceware.org/pub/cygwin镜像比较快" target="_blank" rel="noopener">ftp://sourceware.org/pub/cygwin镜像比较快</a></del><br> <del><a href="http://mirrors.163.com/cygwin/" target="_blank" rel="noopener">http://mirrors.163.com/cygwin/</a></del><br><del>cyg-get wget</del></p><h2 id="安装wget"><a href="#安装wget" class="headerlink" title="安装wget"></a>安装wget</h2><blockquote><p>使用<code>apt-cyg</code>需要先安装<code>wget</code></p></blockquote><h2 id="下载apt-cyg"><a href="#下载apt-cyg" class="headerlink" title="下载apt-cyg"></a>下载<code>apt-cyg</code></h2><blockquote><p>下载<code>apt-cyg</code>保存到<code>$root\cygwin64\bin</code></p><p>地址：<a href="https://raw.githubusercontent.com/transcode-open/apt-cyg/master/apt-cyg" target="_blank" rel="noopener">https://raw.githubusercontent.com/transcode-open/apt-cyg/master/apt-cyg</a></p></blockquote><h2 id="设置镜像源"><a href="#设置镜像源" class="headerlink" title="设置镜像源"></a>设置镜像源</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 添加权限</span></span><br><span class="line">chmod +x  /bin/apt-cyg</span><br><span class="line"><span class="comment"># 设置官方镜像</span></span><br><span class="line">apt-cyg mirror ftp://sourceware.org/pub/cygwin</span><br></pre></td></tr></table></figure><h2 id="安装chere的package"><a href="#安装chere的package" class="headerlink" title="安装chere的package"></a>安装<code>chere</code>的package</h2><blockquote><p><code>chere</code>可以把<code>cygwin</code>添加到<strong>资源管理器的右键菜单</strong>(windows explorer context menu)</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 安装chere</span></span><br><span class="line">apy-cyg install chere</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 注册到context menu</span></span><br><span class="line">chere -i -t mintty -s bash</span><br><span class="line"><span class="meta">#</span><span class="bash"> windows context menu 有Bash Prompt here</span></span><br></pre></td></tr></table></figure><h2 id="apt-cyg源码"><a href="#apt-cyg源码" class="headerlink" title="apt-cyg源码"></a>apt-cyg源码</h2><blockquote><p>如果apt-cyg安装不成功，直接copy下文源码保存apt-cyg文件，放到cygwin的安装目录的bin下，添加一下执行权限（如果需要）。</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># apt-cyg: install tool for Cygwin similar to debian apt-get</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># The MIT License (MIT)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Copyright (c) 2013 Trans-code Design</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Permission is hereby granted, free of charge, to any person obtaining a copy</span></span><br><span class="line"><span class="comment"># of this software and associated documentation files (the "Software"), to deal</span></span><br><span class="line"><span class="comment"># in the Software without restriction, including without limitation the rights</span></span><br><span class="line"><span class="comment"># to use, copy, modify, merge, publish, distribute, sublicense, and/or sell</span></span><br><span class="line"><span class="comment"># copies of the Software, and to permit persons to whom the Software is</span></span><br><span class="line"><span class="comment"># furnished to do so, subject to the following conditions:</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># The above copyright notice and this permission notice shall be included in</span></span><br><span class="line"><span class="comment"># all copies or substantial portions of the Software.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span></span><br><span class="line"><span class="comment"># IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span></span><br><span class="line"><span class="comment"># FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span></span><br><span class="line"><span class="comment"># AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span></span><br><span class="line"><span class="comment"># LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,</span></span><br><span class="line"><span class="comment"># OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN</span></span><br><span class="line"><span class="comment"># THE SOFTWARE.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$&#123;BASH_VERSINFO&#125;</span><span class="variable">$&#123;BASH_VERSINFO[1]&#125;</span> -lt 42 ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">'Bash version 4.2+ required'</span></span><br><span class="line">  <span class="built_in">exit</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">usage=<span class="string">"\</span></span><br><span class="line"><span class="string">NAME</span></span><br><span class="line"><span class="string">  apt-cyg - package manager utility</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">SYNOPSIS</span></span><br><span class="line"><span class="string">  apt-cyg [operation] [options] [targets]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">DESCRIPTION</span></span><br><span class="line"><span class="string">  apt-cyg is a package management utility that tracks installed packages on a</span></span><br><span class="line"><span class="string">  Cygwin system. Invoking apt-cyg involves specifying an operation with any</span></span><br><span class="line"><span class="string">  potential options and targets to operate on. A target is usually a package</span></span><br><span class="line"><span class="string">  name, file name, URL, or a search string. Targets can be provided as command</span></span><br><span class="line"><span class="string">  line arguments.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">OPERATIONS</span></span><br><span class="line"><span class="string">  install</span></span><br><span class="line"><span class="string">    Install package(s).</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  remove</span></span><br><span class="line"><span class="string">    Remove package(s) from the system.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  update</span></span><br><span class="line"><span class="string">    Download a fresh copy of the master package list (setup.ini) from the</span></span><br><span class="line"><span class="string">    server defined in setup.rc.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  download</span></span><br><span class="line"><span class="string">    Retrieve package(s) from the server, but do not install/upgrade anything.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  show</span></span><br><span class="line"><span class="string">    Display information on given package(s).</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  depends</span></span><br><span class="line"><span class="string">    Produce a dependency tree for a package.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  rdepends</span></span><br><span class="line"><span class="string">    Produce a tree of packages that depend on the named package.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  list</span></span><br><span class="line"><span class="string">    Search each locally-installed package for names that match regexp. If no</span></span><br><span class="line"><span class="string">    package names are provided in the command line, all installed packages will</span></span><br><span class="line"><span class="string">    be queried.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  listall</span></span><br><span class="line"><span class="string">    This will search each package in the master package list (setup.ini) for</span></span><br><span class="line"><span class="string">    names that match regexp.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  category</span></span><br><span class="line"><span class="string">    Display all packages that are members of a named category.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  listfiles</span></span><br><span class="line"><span class="string">    List all files owned by a given package. Multiple packages can be specified</span></span><br><span class="line"><span class="string">    on the command line.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  search</span></span><br><span class="line"><span class="string">    Search for downloaded packages that own the specified file(s). The path can</span></span><br><span class="line"><span class="string">    be relative or absolute, and one or more files can be specified.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  searchall</span></span><br><span class="line"><span class="string">    Search cygwin.com to retrieve file information about packages. The provided</span></span><br><span class="line"><span class="string">    target is considered to be a filename and searchall will return the</span></span><br><span class="line"><span class="string">    package(s) which contain this file.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  mirror</span></span><br><span class="line"><span class="string">    Set the mirror; a full URL to a location where the database, packages, and</span></span><br><span class="line"><span class="string">    signatures for this repository can be found. If no URL is provided, display</span></span><br><span class="line"><span class="string">    current mirror.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  cache</span></span><br><span class="line"><span class="string">    Set the package cache directory. If a file is not found in cache directory,</span></span><br><span class="line"><span class="string">    it will be downloaded. Unix and Windows forms are accepted, as well as</span></span><br><span class="line"><span class="string">    absolute or regular paths. If no directory is provided, display current</span></span><br><span class="line"><span class="string">    cache.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">OPTIONS</span></span><br><span class="line"><span class="string">  --nodeps</span></span><br><span class="line"><span class="string">    Specify this option to skip all dependency checks.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  --version</span></span><br><span class="line"><span class="string">    Display version and exit.</span></span><br><span class="line"><span class="string">"</span></span><br><span class="line"></span><br><span class="line">version=<span class="string">"\</span></span><br><span class="line"><span class="string">apt-cyg version 1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">The MIT License (MIT)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Copyright (c) 2005-9 Stephen Jungels</span></span><br><span class="line"><span class="string">"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> wget &#123;</span><br><span class="line">  <span class="keyword">if</span> <span class="built_in">command</span> wget -h &amp;&gt;/dev/null</span><br><span class="line">  <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">command</span> wget <span class="string">"<span class="variable">$@</span>"</span></span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    warn wget is not installed, using lynx as fallback</span><br><span class="line">    <span class="built_in">set</span> <span class="string">"<span class="variable">$&#123;*: -1&#125;</span>"</span></span><br><span class="line">    lynx -<span class="built_in">source</span> <span class="string">"<span class="variable">$1</span>"</span> &gt; <span class="string">"<span class="variable">$&#123;1##*/&#125;</span>"</span></span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> find-workspace &#123;</span><br><span class="line">  <span class="comment"># default working directory and mirror</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment"># work wherever setup worked last, if possible</span></span><br><span class="line">  cache=$(awk <span class="string">'</span></span><br><span class="line"><span class="string">  BEGIN &#123;</span></span><br><span class="line"><span class="string">    RS = "\n\\&lt;"</span></span><br><span class="line"><span class="string">    FS = "\n\t"</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">  $1 == "last-cache" &#123;</span></span><br><span class="line"><span class="string">    print $2</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">  '</span> /etc/setup/setup.rc)</span><br><span class="line"></span><br><span class="line">  mirror=$(awk <span class="string">'</span></span><br><span class="line"><span class="string">  /last-mirror/ &#123;</span></span><br><span class="line"><span class="string">    getline</span></span><br><span class="line"><span class="string">    print $1</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">  '</span> /etc/setup/setup.rc)</span><br><span class="line">  mirrordir=$(sed <span class="string">'</span></span><br><span class="line"><span class="string">  s / %2f g</span></span><br><span class="line"><span class="string">  s : %3a g</span></span><br><span class="line"><span class="string">  '</span> &lt;&lt;&lt; <span class="string">"<span class="variable">$mirror</span>"</span>)</span><br><span class="line"></span><br><span class="line">  mkdir -p <span class="string">"<span class="variable">$cache</span>/<span class="variable">$mirrordir</span>/<span class="variable">$arch</span>"</span></span><br><span class="line">  <span class="built_in">cd</span> <span class="string">"<span class="variable">$cache</span>/<span class="variable">$mirrordir</span>/<span class="variable">$arch</span>"</span></span><br><span class="line">  <span class="keyword">if</span> [ -e setup.ini ]</span><br><span class="line">  <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">return</span> 0</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    get-setup</span><br><span class="line">    <span class="built_in">return</span> 1</span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> get-setup &#123;</span><br><span class="line">  touch setup.ini</span><br><span class="line">  mv setup.ini setup.ini-save</span><br><span class="line">  wget -N <span class="variable">$mirror</span>/<span class="variable">$arch</span>/setup.bz2</span><br><span class="line">  <span class="keyword">if</span> [ -e setup.bz2 ]</span><br><span class="line">  <span class="keyword">then</span></span><br><span class="line">    bunzip2 setup.bz2</span><br><span class="line">    mv setup setup.ini</span><br><span class="line">    <span class="built_in">echo</span> Updated setup.ini</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> Error updating setup.ini, reverting</span><br><span class="line">    mv setup.ini-save setup.ini</span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> check-packages &#123;</span><br><span class="line">  <span class="keyword">if</span> [[ <span class="variable">$pks</span> ]]</span><br><span class="line">  <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">return</span> 0</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> No packages found.</span><br><span class="line">    <span class="built_in">return</span> 1</span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> warn &#123;</span><br><span class="line">  <span class="built_in">printf</span> <span class="string">'\e[1;31m%s\e[m\n'</span> <span class="string">"$*"</span> &gt;&amp;2</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> apt-update &#123;</span><br><span class="line">  <span class="keyword">if</span> find-workspace</span><br><span class="line">  <span class="keyword">then</span></span><br><span class="line">    get-setup</span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> apt-category &#123;</span><br><span class="line">  check-packages</span><br><span class="line">  find-workspace</span><br><span class="line">  <span class="keyword">for</span> pkg <span class="keyword">in</span> <span class="string">"<span class="variable">$&#123;pks[@]&#125;</span>"</span></span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">    awk <span class="string">'</span></span><br><span class="line"><span class="string">    $1 == "@" &#123;</span></span><br><span class="line"><span class="string">      pck = $2</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    $1 == "category:" &amp;&amp; $0 ~ query &#123;</span></span><br><span class="line"><span class="string">      print pck</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    '</span> query=<span class="string">"<span class="variable">$pks</span>"</span> setup.ini</span><br><span class="line">  <span class="keyword">done</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> apt-list &#123;</span><br><span class="line">  <span class="built_in">local</span> sbq</span><br><span class="line">  <span class="keyword">for</span> pkg <span class="keyword">in</span> <span class="string">"<span class="variable">$&#123;pks[@]&#125;</span>"</span></span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">let</span> sbq++ &amp;&amp; <span class="built_in">echo</span></span><br><span class="line">    awk <span class="string">'NR&gt;1 &amp;&amp; $1~pkg &amp;&amp; $0=$1'</span> pkg=<span class="string">"<span class="variable">$pkg</span>"</span> /etc/setup/installed.db</span><br><span class="line">  <span class="keyword">done</span></span><br><span class="line">  <span class="built_in">let</span> sbq &amp;&amp; <span class="built_in">return</span></span><br><span class="line">  awk <span class="string">'NR&gt;1 &amp;&amp; $0=$1'</span> /etc/setup/installed.db</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> apt-listall &#123;</span><br><span class="line">  check-packages</span><br><span class="line">  find-workspace</span><br><span class="line">  <span class="built_in">local</span> sbq</span><br><span class="line">  <span class="keyword">for</span> pkg <span class="keyword">in</span> <span class="string">"<span class="variable">$&#123;pks[@]&#125;</span>"</span></span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">let</span> sbq++ &amp;&amp; <span class="built_in">echo</span></span><br><span class="line">    awk <span class="string">'$1~pkg &amp;&amp; $0=$1'</span> RS=<span class="string">'\n\n@ '</span> FS=<span class="string">'\n'</span> pkg=<span class="string">"<span class="variable">$pkg</span>"</span> setup.ini</span><br><span class="line">  <span class="keyword">done</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> apt-listfiles &#123;</span><br><span class="line">  check-packages</span><br><span class="line">  find-workspace</span><br><span class="line">  <span class="built_in">local</span> pkg sbq</span><br><span class="line">  <span class="keyword">for</span> pkg <span class="keyword">in</span> <span class="string">"<span class="variable">$&#123;pks[@]&#125;</span>"</span></span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">    (( sbq++ )) &amp;&amp; <span class="built_in">echo</span></span><br><span class="line">    <span class="keyword">if</span> [ ! -e /etc/setup/<span class="string">"<span class="variable">$pkg</span>"</span>.lst.gz ]</span><br><span class="line">    <span class="keyword">then</span></span><br><span class="line">      download <span class="string">"<span class="variable">$pkg</span>"</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">    gzip -<span class="built_in">cd</span> /etc/setup/<span class="string">"<span class="variable">$pkg</span>"</span>.lst.gz</span><br><span class="line">  <span class="keyword">done</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> apt-show &#123;</span><br><span class="line">  find-workspace</span><br><span class="line">  check-packages</span><br><span class="line">  <span class="keyword">for</span> pkg <span class="keyword">in</span> <span class="string">"<span class="variable">$&#123;pks[@]&#125;</span>"</span></span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">    (( notfirst++ )) &amp;&amp; <span class="built_in">echo</span></span><br><span class="line">    awk <span class="string">'</span></span><br><span class="line"><span class="string">    $1 == query &#123;</span></span><br><span class="line"><span class="string">      print</span></span><br><span class="line"><span class="string">      fd++</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    END &#123;</span></span><br><span class="line"><span class="string">      if (! fd)</span></span><br><span class="line"><span class="string">        print "Unable to locate package " query</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    '</span> RS=<span class="string">'\n\n@ '</span> FS=<span class="string">'\n'</span> query=<span class="string">"<span class="variable">$pkg</span>"</span> setup.ini</span><br><span class="line">  <span class="keyword">done</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> apt-depends &#123;</span><br><span class="line">  find-workspace</span><br><span class="line">  check-packages</span><br><span class="line">  <span class="keyword">for</span> pkg <span class="keyword">in</span> <span class="string">"<span class="variable">$&#123;pks[@]&#125;</span>"</span></span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">    awk <span class="string">'</span></span><br><span class="line"><span class="string">    @include "join"</span></span><br><span class="line"><span class="string">    $1 == "@" &#123;</span></span><br><span class="line"><span class="string">      apg = $2</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    $1 == "requires:" &#123;</span></span><br><span class="line"><span class="string">      for (z=2; z&lt;=NF; z++)</span></span><br><span class="line"><span class="string">        reqs[apg][z-1] = $z</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    END &#123;</span></span><br><span class="line"><span class="string">      prpg(ENVIRON["pkg"])</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    function smartmatch(small, large,    values) &#123;</span></span><br><span class="line"><span class="string">      for (each in large)</span></span><br><span class="line"><span class="string">        values[large[each]]</span></span><br><span class="line"><span class="string">      return small in values</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    function prpg(fpg) &#123;</span></span><br><span class="line"><span class="string">      if (smartmatch(fpg, spath)) return</span></span><br><span class="line"><span class="string">      spath[length(spath)+1] = fpg</span></span><br><span class="line"><span class="string">      print join(spath, 1, length(spath), " &gt; ")</span></span><br><span class="line"><span class="string">      if (isarray(reqs[fpg]))</span></span><br><span class="line"><span class="string">        for (each in reqs[fpg])</span></span><br><span class="line"><span class="string">          prpg(reqs[fpg][each])</span></span><br><span class="line"><span class="string">      delete spath[length(spath)]</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    '</span> setup.ini</span><br><span class="line">  <span class="keyword">done</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> apt-rdepends &#123;</span><br><span class="line">  find-workspace</span><br><span class="line">  <span class="keyword">for</span> pkg <span class="keyword">in</span> <span class="string">"<span class="variable">$&#123;pks[@]&#125;</span>"</span></span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">    awk <span class="string">'</span></span><br><span class="line"><span class="string">    @include "join"</span></span><br><span class="line"><span class="string">    $1 == "@" &#123;</span></span><br><span class="line"><span class="string">      apg = $2</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    $1 == "requires:" &#123;</span></span><br><span class="line"><span class="string">      for (z=2; z&lt;=NF; z++)</span></span><br><span class="line"><span class="string">        reqs[$z][length(reqs[$z])+1] = apg</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    END &#123;</span></span><br><span class="line"><span class="string">      prpg(ENVIRON["pkg"])</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    function smartmatch(small, large,    values) &#123;</span></span><br><span class="line"><span class="string">      for (each in large)</span></span><br><span class="line"><span class="string">        values[large[each]]</span></span><br><span class="line"><span class="string">      return small in values</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    function prpg(fpg) &#123;</span></span><br><span class="line"><span class="string">      if (smartmatch(fpg, spath)) return</span></span><br><span class="line"><span class="string">      spath[length(spath)+1] = fpg</span></span><br><span class="line"><span class="string">      print join(spath, 1, length(spath), " &lt; ")</span></span><br><span class="line"><span class="string">      if (isarray(reqs[fpg]))</span></span><br><span class="line"><span class="string">        for (each in reqs[fpg])</span></span><br><span class="line"><span class="string">          prpg(reqs[fpg][each])</span></span><br><span class="line"><span class="string">      delete spath[length(spath)]</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    '</span> setup.ini</span><br><span class="line">  <span class="keyword">done</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> apt-download &#123;</span><br><span class="line">  check-packages</span><br><span class="line">  find-workspace</span><br><span class="line">  <span class="built_in">local</span> pkg sbq</span><br><span class="line">  <span class="keyword">for</span> pkg <span class="keyword">in</span> <span class="string">"<span class="variable">$&#123;pks[@]&#125;</span>"</span></span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">    (( sbq++ )) &amp;&amp; <span class="built_in">echo</span></span><br><span class="line">    download <span class="string">"<span class="variable">$pkg</span>"</span></span><br><span class="line">  <span class="keyword">done</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> download &#123;</span><br><span class="line">  <span class="built_in">local</span> pkg digest digactual</span><br><span class="line">  pkg=<span class="variable">$1</span></span><br><span class="line">  <span class="comment"># look for package and save desc file</span></span><br><span class="line"></span><br><span class="line">  awk <span class="string">'$1 == pc'</span> RS=<span class="string">'\n\n@ '</span> FS=<span class="string">'\n'</span> pc=<span class="variable">$pkg</span> setup.ini &gt; desc</span><br><span class="line">  <span class="keyword">if</span> [ ! -s desc ]</span><br><span class="line">  <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> Unable to locate package <span class="variable">$pkg</span></span><br><span class="line">    <span class="built_in">exit</span> 1</span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># download and unpack the bz2 or xz file</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># pick the latest version, which comes first</span></span><br><span class="line">  <span class="built_in">set</span> -- $(awk <span class="string">'$1 == "install:"'</span> desc)</span><br><span class="line">  <span class="keyword">if</span> (( ! <span class="variable">$#</span> ))</span><br><span class="line">  <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">'Could not find "install" in package description: obsolete package?'</span></span><br><span class="line">    <span class="built_in">exit</span> 1</span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">  dn=$(dirname <span class="variable">$2</span>)</span><br><span class="line">  bn=$(basename <span class="variable">$2</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment"># check the md5</span></span><br><span class="line">  digest=<span class="variable">$4</span></span><br><span class="line">  <span class="keyword">case</span> <span class="variable">$&#123;#digest&#125;</span> <span class="keyword">in</span></span><br><span class="line">   32) <span class="built_in">hash</span>=md5sum    ;;</span><br><span class="line">  128) <span class="built_in">hash</span>=sha512sum ;;</span><br><span class="line">  <span class="keyword">esac</span></span><br><span class="line">  mkdir -p <span class="string">"<span class="variable">$cache</span>/<span class="variable">$mirrordir</span>/<span class="variable">$dn</span>"</span></span><br><span class="line">  <span class="built_in">cd</span> <span class="string">"<span class="variable">$cache</span>/<span class="variable">$mirrordir</span>/<span class="variable">$dn</span>"</span></span><br><span class="line">  <span class="keyword">if</span> ! <span class="built_in">test</span> -e <span class="variable">$bn</span> || ! <span class="variable">$hash</span> -c &lt;&lt;&lt; <span class="string">"<span class="variable">$digest</span> <span class="variable">$bn</span>"</span></span><br><span class="line">  <span class="keyword">then</span></span><br><span class="line">    wget -O <span class="variable">$bn</span> <span class="variable">$mirror</span>/<span class="variable">$dn</span>/<span class="variable">$bn</span></span><br><span class="line">    <span class="variable">$hash</span> -c &lt;&lt;&lt; <span class="string">"<span class="variable">$digest</span> <span class="variable">$bn</span>"</span> || <span class="built_in">exit</span></span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">  tar tf <span class="variable">$bn</span> | gzip &gt; /etc/setup/<span class="string">"<span class="variable">$pkg</span>"</span>.lst.gz</span><br><span class="line">  <span class="built_in">cd</span> ~-</span><br><span class="line">  mv desc <span class="string">"<span class="variable">$cache</span>/<span class="variable">$mirrordir</span>/<span class="variable">$dn</span>"</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="variable">$dn</span> <span class="variable">$bn</span> &gt; /tmp/dwn</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> apt-search &#123;</span><br><span class="line">  check-packages</span><br><span class="line">  <span class="built_in">echo</span> Searching downloaded packages...</span><br><span class="line">  <span class="keyword">for</span> pkg <span class="keyword">in</span> <span class="string">"<span class="variable">$&#123;pks[@]&#125;</span>"</span></span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">    key=$(<span class="built_in">type</span> -P <span class="string">"<span class="variable">$pkg</span>"</span> | sed s./..)</span><br><span class="line">    [[ <span class="variable">$key</span> ]] || key=<span class="variable">$pkg</span></span><br><span class="line">    <span class="keyword">for</span> manifest <span class="keyword">in</span> /etc/setup/*.lst.gz</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">      <span class="keyword">if</span> gzip -<span class="built_in">cd</span> <span class="variable">$manifest</span> | grep -q <span class="string">"<span class="variable">$key</span>"</span></span><br><span class="line">      <span class="keyword">then</span></span><br><span class="line">        package=$(sed <span class="string">'</span></span><br><span class="line"><span class="string">        s,/etc/setup/,,</span></span><br><span class="line"><span class="string">        s,.lst.gz,,</span></span><br><span class="line"><span class="string">        '</span> &lt;&lt;&lt; <span class="variable">$manifest</span>)</span><br><span class="line">        <span class="built_in">echo</span> <span class="variable">$package</span></span><br><span class="line">      <span class="keyword">fi</span></span><br><span class="line">    <span class="keyword">done</span></span><br><span class="line">  <span class="keyword">done</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> apt-searchall &#123;</span><br><span class="line">  <span class="built_in">cd</span> /tmp</span><br><span class="line">  <span class="keyword">for</span> pkg <span class="keyword">in</span> <span class="string">"<span class="variable">$&#123;pks[@]&#125;</span>"</span></span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">printf</span> -v qs <span class="string">'text=1&amp;arch=%s&amp;grep=%s'</span> <span class="variable">$arch</span> <span class="string">"<span class="variable">$pkg</span>"</span></span><br><span class="line">    wget -O matches cygwin.com/cgi-bin2/package-grep.cgi?<span class="string">"<span class="variable">$qs</span>"</span></span><br><span class="line">    awk <span class="string">'</span></span><br><span class="line"><span class="string">    NR == 1 &#123;next&#125;</span></span><br><span class="line"><span class="string">    mc[$1]++ &#123;next&#125;</span></span><br><span class="line"><span class="string">    /-debuginfo-/ &#123;next&#125;</span></span><br><span class="line"><span class="string">    /^cygwin32-/ &#123;next&#125;</span></span><br><span class="line"><span class="string">    &#123;print $1&#125;</span></span><br><span class="line"><span class="string">    '</span> FS=-[[:digit:]] matches</span><br><span class="line">  <span class="keyword">done</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> apt-install &#123;</span><br><span class="line">  check-packages</span><br><span class="line">  find-workspace</span><br><span class="line">  <span class="built_in">local</span> pkg dn bn requires wr package sbq script</span><br><span class="line">  <span class="keyword">for</span> pkg <span class="keyword">in</span> <span class="string">"<span class="variable">$&#123;pks[@]&#125;</span>"</span></span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> grep -q <span class="string">"^<span class="variable">$pkg</span> "</span> /etc/setup/installed.db</span><br><span class="line">  <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> Package <span class="variable">$pkg</span> is already installed, skipping</span><br><span class="line">    <span class="built_in">continue</span></span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line">  (( sbq++ )) &amp;&amp; <span class="built_in">echo</span></span><br><span class="line">  <span class="built_in">echo</span> Installing <span class="variable">$pkg</span></span><br><span class="line"></span><br><span class="line">  download <span class="variable">$pkg</span></span><br><span class="line">  <span class="built_in">read</span> dn bn &lt;/tmp/dwn</span><br><span class="line">  <span class="built_in">echo</span> Unpacking...</span><br><span class="line"></span><br><span class="line">  <span class="built_in">cd</span> <span class="string">"<span class="variable">$cache</span>/<span class="variable">$mirrordir</span>/<span class="variable">$dn</span>"</span></span><br><span class="line">  tar -x -C / -f <span class="variable">$bn</span></span><br><span class="line">  <span class="comment"># update the package database</span></span><br><span class="line"></span><br><span class="line">  awk <span class="string">'</span></span><br><span class="line"><span class="string">  ins != 1 &amp;&amp; pkg &lt; $1 &#123;</span></span><br><span class="line"><span class="string">    print pkg, bz, 0</span></span><br><span class="line"><span class="string">    ins = 1</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">  1</span></span><br><span class="line"><span class="string">  END &#123;</span></span><br><span class="line"><span class="string">    if (ins != 1) print pkg, bz, 0</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">  '</span> pkg=<span class="string">"<span class="variable">$pkg</span>"</span> bz=<span class="variable">$bn</span> /etc/setup/installed.db &gt; /tmp/awk.$$</span><br><span class="line">  mv /etc/setup/installed.db /etc/setup/installed.db-save</span><br><span class="line">  mv /tmp/awk.$$ /etc/setup/installed.db</span><br><span class="line"></span><br><span class="line">  [ -v nodeps ] &amp;&amp; <span class="built_in">continue</span></span><br><span class="line">  <span class="comment"># recursively install required packages</span></span><br><span class="line"></span><br><span class="line">  requires=$(awk <span class="string">'$1=="requires", $0=$2'</span> FS=<span class="string">': '</span> desc)</span><br><span class="line">  <span class="built_in">cd</span> ~-</span><br><span class="line">  wr=0</span><br><span class="line">  <span class="keyword">if</span> [[ <span class="variable">$requires</span> ]]</span><br><span class="line">  <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> Package <span class="variable">$pkg</span> requires the following packages, installing:</span><br><span class="line">    <span class="built_in">echo</span> <span class="variable">$requires</span></span><br><span class="line">    <span class="keyword">for</span> package <span class="keyword">in</span> <span class="variable">$requires</span></span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">      <span class="keyword">if</span> grep -q <span class="string">"^<span class="variable">$package</span> "</span> /etc/setup/installed.db</span><br><span class="line">      <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> Package <span class="variable">$package</span> is already installed, skipping</span><br><span class="line">        <span class="built_in">continue</span></span><br><span class="line">      <span class="keyword">fi</span></span><br><span class="line">      apt-cyg install --noscripts <span class="variable">$package</span> || (( wr++ ))</span><br><span class="line">    <span class="keyword">done</span></span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line">  <span class="keyword">if</span> (( wr ))</span><br><span class="line">  <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> some required packages did not install, continuing</span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># run all postinstall scripts</span></span><br><span class="line"></span><br><span class="line">  [ -v noscripts ] &amp;&amp; <span class="built_in">continue</span></span><br><span class="line">  find /etc/postinstall -name <span class="string">'*.sh'</span> | <span class="keyword">while</span> <span class="built_in">read</span> script</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> Running <span class="variable">$script</span></span><br><span class="line">    <span class="variable">$script</span></span><br><span class="line">    mv <span class="variable">$script</span> <span class="variable">$script</span>.<span class="keyword">done</span></span><br><span class="line">  <span class="keyword">done</span></span><br><span class="line">  <span class="built_in">echo</span> Package <span class="variable">$pkg</span> installed</span><br><span class="line"></span><br><span class="line">  <span class="keyword">done</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> apt-remove &#123;</span><br><span class="line">  check-packages</span><br><span class="line">  <span class="built_in">cd</span> /etc</span><br><span class="line">  cygcheck awk bash bunzip2 grep gzip mv sed tar xz &gt; setup/essential.lst</span><br><span class="line">  <span class="keyword">for</span> pkg <span class="keyword">in</span> <span class="string">"<span class="variable">$&#123;pks[@]&#125;</span>"</span></span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ! grep -q <span class="string">"^<span class="variable">$pkg</span> "</span> setup/installed.db</span><br><span class="line">  <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> Package <span class="variable">$pkg</span> is not installed, skipping</span><br><span class="line">    <span class="built_in">continue</span></span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> [ ! -e setup/<span class="string">"<span class="variable">$pkg</span>"</span>.lst.gz ]</span><br><span class="line">  <span class="keyword">then</span></span><br><span class="line">    warn Package manifest missing, cannot remove <span class="variable">$pkg</span>. Exiting</span><br><span class="line">    <span class="built_in">exit</span> 1</span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line">  gzip -dk setup/<span class="string">"<span class="variable">$pkg</span>"</span>.lst.gz</span><br><span class="line">  awk <span class="string">'</span></span><br><span class="line"><span class="string">  NR == FNR &#123;</span></span><br><span class="line"><span class="string">    if ($NF) ess[$NF]</span></span><br><span class="line"><span class="string">    next</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">  $NF in ess &#123;</span></span><br><span class="line"><span class="string">    exit 1</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">  '</span> FS=<span class="string">'[/\\\\]'</span> setup/&#123;essential,<span class="variable">$pkg</span>&#125;.lst</span><br><span class="line">  esn=$?</span><br><span class="line">  <span class="keyword">if</span> [ <span class="variable">$esn</span> = 0 ]</span><br><span class="line">  <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> Removing <span class="variable">$pkg</span></span><br><span class="line">    <span class="keyword">if</span> [ -e preremove/<span class="string">"<span class="variable">$pkg</span>"</span>.sh ]</span><br><span class="line">    <span class="keyword">then</span></span><br><span class="line">      preremove/<span class="string">"<span class="variable">$pkg</span>"</span>.sh</span><br><span class="line">      rm preremove/<span class="string">"<span class="variable">$pkg</span>"</span>.sh</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">    <span class="built_in">mapfile</span> dt &lt; setup/<span class="string">"<span class="variable">$pkg</span>"</span>.lst</span><br><span class="line">    <span class="keyword">for</span> each <span class="keyword">in</span> <span class="variable">$&#123;dt[*]&#125;</span></span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">      [ -f /<span class="variable">$each</span> ] &amp;&amp; rm /<span class="variable">$each</span></span><br><span class="line">    <span class="keyword">done</span></span><br><span class="line">    <span class="keyword">for</span> each <span class="keyword">in</span> <span class="variable">$&#123;dt[*]&#125;</span></span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">      [ -d /<span class="variable">$each</span> ] &amp;&amp; rmdir --i /<span class="variable">$each</span></span><br><span class="line">    <span class="keyword">done</span></span><br><span class="line">    rm -f setup/<span class="string">"<span class="variable">$pkg</span>"</span>.lst.gz postinstall/<span class="string">"<span class="variable">$pkg</span>"</span>.sh.done</span><br><span class="line">    awk -i inplace <span class="string">'$1 != ENVIRON["pkg"]'</span> setup/installed.db</span><br><span class="line">    <span class="built_in">echo</span> Package <span class="variable">$pkg</span> removed</span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line">  rm setup/<span class="string">"<span class="variable">$pkg</span>"</span>.lst</span><br><span class="line">  <span class="keyword">if</span> [ <span class="variable">$esn</span> = 1 ]</span><br><span class="line">  <span class="keyword">then</span></span><br><span class="line">    warn apt-cyg cannot remove package <span class="variable">$pkg</span>, exiting</span><br><span class="line">    <span class="built_in">exit</span> 1</span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">done</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> apt-mirror &#123;</span><br><span class="line">  <span class="keyword">if</span> [ <span class="string">"<span class="variable">$pks</span>"</span> ]</span><br><span class="line">  <span class="keyword">then</span></span><br><span class="line">    awk -i inplace <span class="string">'</span></span><br><span class="line"><span class="string">    1</span></span><br><span class="line"><span class="string">    /last-mirror/ &#123;</span></span><br><span class="line"><span class="string">      getline</span></span><br><span class="line"><span class="string">      print "\t" pks</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    '</span> pks=<span class="string">"<span class="variable">$pks</span>"</span> /etc/setup/setup.rc</span><br><span class="line">    <span class="built_in">echo</span> Mirror <span class="built_in">set</span> to <span class="string">"<span class="variable">$pks</span>"</span>.</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    awk <span class="string">'</span></span><br><span class="line"><span class="string">    /last-mirror/ &#123;</span></span><br><span class="line"><span class="string">      getline</span></span><br><span class="line"><span class="string">      print $1</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    '</span> /etc/setup/setup.rc</span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> apt-cache &#123;</span><br><span class="line">  <span class="keyword">if</span> [ <span class="string">"<span class="variable">$pks</span>"</span> ]</span><br><span class="line">  <span class="keyword">then</span></span><br><span class="line">    vas=$(cygpath -aw <span class="string">"<span class="variable">$pks</span>"</span>)</span><br><span class="line">    awk -i inplace <span class="string">'</span></span><br><span class="line"><span class="string">    1</span></span><br><span class="line"><span class="string">    /last-cache/ &#123;</span></span><br><span class="line"><span class="string">      getline</span></span><br><span class="line"><span class="string">      print "\t" vas</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    '</span> vas=<span class="string">"<span class="variable">$&#123;vas//\\/\\\\&#125;</span>"</span> /etc/setup/setup.rc</span><br><span class="line">    <span class="built_in">echo</span> Cache <span class="built_in">set</span> to <span class="string">"<span class="variable">$vas</span>"</span>.</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    awk <span class="string">'</span></span><br><span class="line"><span class="string">    /last-cache/ &#123;</span></span><br><span class="line"><span class="string">      getline</span></span><br><span class="line"><span class="string">      print $1</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    '</span> /etc/setup/setup.rc</span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ -p /dev/stdin ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">  <span class="built_in">mapfile</span> -t pks</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># process options</span></span><br><span class="line">until [ <span class="variable">$#</span> = 0 ]</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  <span class="keyword">case</span> <span class="string">"<span class="variable">$1</span>"</span> <span class="keyword">in</span></span><br><span class="line"></span><br><span class="line">    --nodeps)</span><br><span class="line">      nodeps=1</span><br><span class="line">      <span class="built_in">shift</span></span><br><span class="line">    ;;</span><br><span class="line"></span><br><span class="line">    --noscripts)</span><br><span class="line">      noscripts=1</span><br><span class="line">      <span class="built_in">shift</span></span><br><span class="line">    ;;</span><br><span class="line"></span><br><span class="line">    --version)</span><br><span class="line">      <span class="built_in">printf</span> <span class="string">"<span class="variable">$version</span>"</span></span><br><span class="line">      <span class="built_in">exit</span></span><br><span class="line">    ;;</span><br><span class="line"></span><br><span class="line">    update)</span><br><span class="line">      <span class="built_in">command</span>=<span class="variable">$1</span></span><br><span class="line">      <span class="built_in">shift</span></span><br><span class="line">    ;;</span><br><span class="line"></span><br><span class="line">    list | cache  | remove | depends | listall  | download | listfiles |\</span><br><span class="line">    show | mirror | search | install | category | rdepends | searchall )</span><br><span class="line">      <span class="keyword">if</span> [[ <span class="variable">$command</span> ]]</span><br><span class="line">      <span class="keyword">then</span></span><br><span class="line">        pks+=(<span class="string">"<span class="variable">$1</span>"</span>)</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">command</span>=<span class="variable">$1</span></span><br><span class="line">      <span class="keyword">fi</span></span><br><span class="line">      <span class="built_in">shift</span></span><br><span class="line">    ;;</span><br><span class="line"></span><br><span class="line">    *)</span><br><span class="line">      pks+=(<span class="string">"<span class="variable">$1</span>"</span>)</span><br><span class="line">      <span class="built_in">shift</span></span><br><span class="line">    ;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">esac</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span> -a</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">type</span> -t apt-<span class="variable">$command</span> | grep -q <span class="keyword">function</span></span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">  <span class="built_in">readonly</span> arch=<span class="variable">$&#123;HOSTTYPE/i6/x&#125;</span></span><br><span class="line">  apt-<span class="variable">$command</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  <span class="built_in">printf</span> <span class="string">"<span class="variable">$usage</span>"</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;apt-cyg&quot;&gt;&lt;a href=&quot;#apt-cyg&quot; class=&quot;headerlink&quot; title=&quot;apt-cyg&quot;&gt;&lt;/a&gt;apt-cyg&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;因为使用在windows下使用&lt;code&gt;cygwin&lt;/code&gt;，为了
      
    
    </summary>
    
      <category term="cygwin" scheme="https://betgar.github.io/categories/cygwin/"/>
    
    
      <category term="cygwin" scheme="https://betgar.github.io/tags/cygwin/"/>
    
  </entry>
  
  <entry>
    <title>npm常用命令</title>
    <link href="https://betgar.github.io/2018/06/04/npm-common-commands/"/>
    <id>https://betgar.github.io/2018/06/04/npm-common-commands/</id>
    <published>2018-06-04T00:00:00.000Z</published>
    <updated>2018-09-26T14:47:11.226Z</updated>
    
    <content type="html"><![CDATA[<h1 id="npm常用命令"><a href="#npm常用命令" class="headerlink" title="npm常用命令"></a>npm常用命令</h1><blockquote><p>总结一下npm常用的命令。</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">npm -v</span><br><span class="line">npm install -g npm@latest</span><br><span class="line">npm install -g npm@next</span><br><span class="line">npm install -g npm@version</span><br><span class="line">npm update</span><br><span class="line">npm outdated</span><br><span class="line"></span><br><span class="line">npm uninstall lodash</span><br><span class="line"></span><br><span class="line"><span class="comment"># 如需从 package.json 文件中删除依赖，需要在命令后添加参数 --save</span></span><br><span class="line">npm uninstall --save lodash  </span><br><span class="line"></span><br><span class="line"><span class="comment"># package.json 文件中依赖devDependency，就是--save-dev 参数保存的</span></span><br><span class="line"><span class="comment"># 必须通过 --save-dev 参数可以将其卸载。</span></span><br><span class="line">npm uninstall --save-dev lodash</span><br></pre></td></tr></table></figure><h2 id="npm生命周期的命令"><a href="#npm生命周期的命令" class="headerlink" title="npm生命周期的命令"></a>npm生命周期的命令</h2><blockquote><p>install: 安装依赖。</p></blockquote><p><code>npm run install</code>的默认值是<code>node-gyp rebuild</code>，前提是项目根目录下有<code>binding.gyp</code>文件。 </p><blockquote><p>build：构建项目。</p></blockquote><p>npm 脚本有<code>pre</code>和<code>post</code>两个钩子。举例来说，<code>build</code>脚本命令的钩子就是<code>prebuild</code>和<code>postbuild</code> 。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// package.json</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">"scripts"</span>: &#123;</span><br><span class="line">      <span class="string">"prebuild"</span>: <span class="string">"echo I run before the build script"</span>,</span><br><span class="line">      <span class="string">"build"</span>: <span class="string">"cross-env NODE_ENV=production webpack"</span>,</span><br><span class="line">      <span class="string">"postbuild"</span>: <span class="string">"echo I run after the build script"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>rebuild：重新构建。</p><p>test：测试。</p></blockquote><blockquote><p>start：开发阶段启动服务。</p></blockquote><p>  上面代码中，<code>npm run start</code>的默认值是<code>node server.js</code>，前提是项目根目录下有<code>server.js</code>这个脚本。</p><blockquote><p>restart：重新启动。</p></blockquote><p><code>npm restart</code> 是一个复合命令，实际上会执行三个脚本命令：<code>stop</code>、<code>restart</code>、<code>start</code>。具体的执行顺序如下。 </p><blockquote><ol><li>prerestart</li><li>prestop</li><li>stop</li><li>poststop</li><li>restart</li><li>prestart</li><li>start</li><li>poststart</li><li>postrestart </li></ol></blockquote><blockquote><p>stop：停止服务。</p></blockquote><blockquote><p>publish：对外发布package。</p></blockquote><blockquote><p>republish</p></blockquote><h2 id="npm-default-hook"><a href="#npm-default-hook" class="headerlink" title="npm default hook"></a>npm default hook</h2><blockquote><p>npm命令的默认钩子命令。</p></blockquote><blockquote><ul><li>prepublish，postpublish</li><li>preinstall，postinstall</li><li>preuninstall，postuninstall</li><li>preversion，postversion</li><li>pretest，posttest</li><li>prestop，poststop</li><li>prestart，poststart</li><li>prerestart，postrestart</li></ul></blockquote><p><strong>注意</strong>：</p><blockquote><p><code>prepublish</code>这个钩子不仅会在<code>npm publish</code>命令之前运行，还会在<code>npm install</code>（不带任何参数）命令之前运行。这种行为很容易让用户感到困惑，所以 npm 4 引入了一个新的钩子<code>prepare</code>，行为等同于<code>prepublish</code>，而从 npm 5 开始，<code>prepublish</code>将只在<code>npm publish</code>命令之前运行。 </p></blockquote><h2 id="npm-shortcut-commands"><a href="#npm-shortcut-commands" class="headerlink" title="npm shortcut commands"></a>npm shortcut commands</h2><p>四个常用的 npm 脚本有简写形式。</p><blockquote><ul><li><code>npm start</code>是<code>npm run start</code></li><li><code>npm stop</code>是<code>npm run stop</code>的简写</li><li><code>npm test</code>是<code>npm run test</code>的简写</li><li><code>npm restart</code>是<code>npm run stop &amp;&amp; npm run restart &amp;&amp; npm run start</code>的简写</li><li><code>npm run</code>是<code>npm run-script</code>的简写。</li></ul></blockquote><h2 id="npm-config"><a href="#npm-config" class="headerlink" title="npm config"></a>npm config</h2><blockquote><p>好多内容以后在补充。</p></blockquote><h2 id="npm-scripts"><a href="#npm-scripts" class="headerlink" title="npm scripts"></a>npm scripts</h2><h3 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h3><blockquote><p><code>node</code>环境中可以引用<code>package.json</code>和<code>bash</code>等变量。</p></blockquote><h4 id="变量前缀：npm-package"><a href="#变量前缀：npm-package" class="headerlink" title="变量前缀：npm_package_"></a>变量前缀：npm_package_</h4><p>npm 脚本有一个非常强大的功能，就是可以使用 npm 的内部变量。</p><p>首先，通过<code>npm_package_</code>前缀，npm 脚本可以拿到<code>package.json</code>里面的字段。比如，下面是一个<code>package.json</code>。</p><blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt; &#123;</span><br><span class="line">&gt;   &quot;name&quot;: &quot;foo&quot;, </span><br><span class="line">&gt;   &quot;version&quot;: &quot;1.2.5&quot;,</span><br><span class="line">&gt;   &quot;scripts&quot;: &#123;</span><br><span class="line">&gt;     &quot;view&quot;: &quot;node view.js&quot;</span><br><span class="line">&gt;   &#125;</span><br><span class="line">&gt; &#125;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><p>那么，变量<code>npm_package_name</code>返回<code>foo</code>，变量<code>npm_package_version</code>返回<code>1.2.5</code>。</p><blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; // view.js</span><br><span class="line">&gt; console.log(process.env.npm_package_name); // foo</span><br><span class="line">&gt; console.log(process.env.npm_package_version); // 1.2.5</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><p>上面代码中，我们通过环境变量<code>process.env</code>对象，拿到<code>package.json</code>的字段值。</p><h4 id="变量前缀：-npm-package-（bash变量）"><a href="#变量前缀：-npm-package-（bash变量）" class="headerlink" title="变量前缀：$npm_package （bash变量）"></a>变量前缀：$npm_package （bash变量）</h4><p>如果是 Bash 脚本，可以用<code>$npm_package_name</code>和<code>$npm_package_version</code>取到这两个值。 </p><h4 id="变量：npm-config"><a href="#变量：npm-config" class="headerlink" title="变量：npm_config_"></a>变量：npm_config_</h4><p>npm 脚本还可以通过<code>npm_config_</code>前缀，拿到 npm 的配置变量，即<code>npm config get xxx</code>命令返回的值。比如，当前模块的发行标签，可以通过<code>npm_config_tag</code>取到。 </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// config</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">"view"</span>: <span class="string">"echo $npm_config_tag"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="环境变量覆盖package-json的config对象"><a href="#环境变量覆盖package-json的config对象" class="headerlink" title="环境变量覆盖package.json的config对象"></a>环境变量覆盖package.json的config对象</h4><p><code>package.json</code>里面的<code>config</code>对象，可以被环境变量覆盖。 </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123; </span><br><span class="line">  &quot;name&quot; : &quot;foo&quot;,</span><br><span class="line">  &quot;config&quot; : &#123; &quot;port&quot; : &quot;8080&quot; &#125;,</span><br><span class="line">  &quot;scripts&quot; : &#123; &quot;start&quot; : &quot;node server.js&quot; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>上面代码中，<code>npm_package_config_port</code>变量返回的是<code>8080</code>。这个值可以用下面的方法覆盖。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm config <span class="built_in">set</span> foo:port 80</span><br></pre></td></tr></table></figure><h2 id="package-json"><a href="#package-json" class="headerlink" title="package.json"></a>package.json</h2><blockquote><p>详情见：<a href="http://javascript.ruanyifeng.com/nodejs/packagejson.html" target="_blank" rel="noopener">http://javascript.ruanyifeng.com/nodejs/packagejson.html</a></p></blockquote><h2 id="package-lock-json"><a href="#package-lock-json" class="headerlink" title="package.lock.json"></a>package.lock.json</h2><blockquote><p><code>npm5</code>以后，每次<code>npm install</code>会自动创建<code>package.lock.json</code>，但是有一些潜规则。</p></blockquote><ul><li>如果<code>package.json</code>和<code>package.lock.json</code>一致，则使用<code>package.lock.json</code>中的配置。</li><li>如果<code>package.json</code>和<code>package.lock.json</code><strong>不一致</strong>，则使用<code>package.json</code>中的配置。</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;npm常用命令&quot;&gt;&lt;a href=&quot;#npm常用命令&quot; class=&quot;headerlink&quot; title=&quot;npm常用命令&quot;&gt;&lt;/a&gt;npm常用命令&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;总结一下npm常用的命令。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figu
      
    
    </summary>
    
      <category term="npm" scheme="https://betgar.github.io/categories/npm/"/>
    
    
      <category term="npm" scheme="https://betgar.github.io/tags/npm/"/>
    
  </entry>
  
  <entry>
    <title>Node环境配置</title>
    <link href="https://betgar.github.io/2018/06/01/node-env-config/"/>
    <id>https://betgar.github.io/2018/06/01/node-env-config/</id>
    <published>2018-05-31T16:00:00.000Z</published>
    <updated>2018-09-28T01:06:06.245Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Node环境配置"><a href="#Node环境配置" class="headerlink" title="Node环境配置"></a>Node环境配置</h2><blockquote><p>Node环境及配置参考</p></blockquote><h2 id="nvm-for-windows"><a href="#nvm-for-windows" class="headerlink" title="nvm for windows"></a>nvm for windows</h2><blockquote><p><code>nvm</code>是一个Node的版本管理模块，使用它可以随时切换Node环境。</p><p>注意: 安装 node 前保证自己电脑中的<code>node</code>，<code>npm</code>已<strong>卸载干净</strong></p></blockquote><h3 id="nvm安装"><a href="#nvm安装" class="headerlink" title="nvm安装"></a>nvm安装</h3><blockquote><p> <a href="https://github.com/coreybutler/nvm-windows/releases" target="_blank" rel="noopener">nvm-windows</a></p></blockquote><ul><li><p>查看当前版本</p>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvm  --version</span><br></pre></td></tr></table></figure></li><li><p>查看当前已安装 node 的版本</p>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvm ls</span><br></pre></td></tr></table></figure></li><li><p>安装某版本 node， 根据 <a href="https://github.com/nodejs/LTS" target="_blank" rel="noopener">LTS</a> 查看此处安装 8.11.1</p>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvm install 8.11.1</span><br></pre></td></tr></table></figure></li><li><p>使用某版本 node </p>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvm use 8.11.1</span><br></pre></td></tr></table></figure></li><li><p>检查本地是否存在 node </p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node -v</span><br></pre></td></tr></table></figure></li></ul><h2 id="nrm管理下载源"><a href="#nrm管理下载源" class="headerlink" title="nrm管理下载源"></a>nrm管理下载源</h2><blockquote><p><code>nrm</code> 是为了解决切换 <code>npm</code> 源的问题，因为如果直接通过 <code>npm</code> 手动设置 registry 非常麻烦，并且不容易记忆，因此，才有了 <code>nrm</code> 的出现。<code>npm</code>的官方源对广大中国开发者来说较卡，因此推荐 <code>cnpm</code> 或者 <code>taobao</code>。 </p></blockquote><p><code>nrm</code> 是为了解决切换<code>npm</code> 源的问题，因为如果直接通过 npm 手动设置 registry 非常麻烦，并且不容易记忆，因此，才有了<code>nrm</code>的出现。 <code>npm</code>的官方源对广大中国开发者来说较卡，因此推荐 <code>cnpm</code> 或者 <code>taobao</code>。</p><h3 id="nrm的安装"><a href="#nrm的安装" class="headerlink" title="nrm的安装"></a>nrm的安装</h3><p>有了<code>npm</code>后，一切都变得非常简单，全局安装 <code>nrm</code>, 使用<code>taobao</code>源下载</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g nrm</span><br></pre></td></tr></table></figure><ul><li><p>查询当前有哪些可用源</p>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nrm ls</span><br></pre></td></tr></table></figure></li><li><p>切换淘宝源</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nrm use taobao</span><br></pre></td></tr></table></figure></li><li><p>测试源延迟毫秒数 (也与当前网络环境有关)</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nrm <span class="built_in">test</span></span><br></pre></td></tr></table></figure></li></ul><h2 id="python-安装"><a href="#python-安装" class="headerlink" title="python 安装"></a>python 安装</h2><blockquote><p><code>node-gyp</code>模块需要安装python(<code>python</code> (<code>v2.7</code> recommended, <code>v3.x.x</code> is <strong>not</strong> supported)</p></blockquote><h3 id="python依赖-net-framework-4-5"><a href="#python依赖-net-framework-4-5" class="headerlink" title="python依赖.net framework 4.5"></a>python依赖.net framework 4.5</h3><blockquote><p>解决方式1：</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># run as Administrator</span></span><br><span class="line">npm install --global --production windows-build-tools</span><br></pre></td></tr></table></figure><blockquote><p>解决方式2：自己到微软的官网下载最新的.net framework安装。</p></blockquote><h3 id="node-gyp配置python"><a href="#node-gyp配置python" class="headerlink" title="node-gyp配置python"></a>node-gyp配置python</h3><blockquote><p><strong>注意：</strong></p><p><a href="https://github.com/nodejs/node-gyp#readme" target="_blank" rel="noopener">node-gyp官网</a></p><p>因为python有v2和v3版本，并且两个版本不兼容，如果电脑上有应用软件使用python的版本不同，</p><p>最好<strong>不要</strong>把python路径配置到系统<code>path</code>中。</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 如果你使用node-gyp单独编译一些模块，则这样配置（多数情况下是通过npm调用的）</span></span><br><span class="line">node-gyp --python /path/to/python2.7</span><br></pre></td></tr></table></figure><h3 id="npm配置python"><a href="#npm配置python" class="headerlink" title="npm配置python"></a>npm配置python</h3><blockquote><p>如果使用npm 调用的<code>node-gyp</code>，则使用<code>npm</code>配置<code>python</code>就可以</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm config <span class="built_in">set</span> python /path/to/executable/python2.7</span><br></pre></td></tr></table></figure><h2 id="verdaccio安装"><a href="#verdaccio安装" class="headerlink" title="verdaccio安装"></a>verdaccio安装</h2><blockquote><p>如果搭建npm私服可以参考。<a href="https://verdaccio.org/zh-CN/" target="_blank" rel="noopener">verdaccio官网</a></p><p>verdaccio是用来搭建npm私服，已经安装过的模块会缓存起来，以后安装依赖是会优先查看缓存。</p></blockquote><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i -g verdaccio</span><br></pre></td></tr></table></figure><h3 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">verdaccio</span><br></pre></td></tr></table></figure><h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><blockquote><p>配置主要修改使用<code>taobao</code>源和<code>端口</code>修改</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 配置文件地址：我的window 10是.config非官网说的.local</span><br><span class="line"># C:\Users\你的用户名称\.config\verdaccio</span><br></pre></td></tr></table></figure><blockquote><ol><li>修改默认端口（如果有需要）</li><li>添加uplinks</li><li>修改使用的proxy</li></ol></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 修改默认的端口</span></span><br><span class="line"><span class="attr">listen:</span></span><br><span class="line">  <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span><span class="string">:10086</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># a list of other known repositories we can talk to</span></span><br><span class="line"><span class="attr">uplinks:</span></span><br><span class="line"><span class="attr">  npmjs:</span></span><br><span class="line"><span class="attr">    url:</span> <span class="attr">https://registry.npmjs.org/</span></span><br><span class="line">  <span class="comment"># 添加taobao</span></span><br><span class="line"><span class="attr">  taobao:</span></span><br><span class="line"><span class="attr">    url:</span> <span class="attr">https://registry.npm.taobao.org</span></span><br><span class="line"></span><br><span class="line"><span class="attr">packages:</span></span><br><span class="line">  <span class="string">'@*/*'</span><span class="string">:</span></span><br><span class="line">    <span class="comment"># scoped packages</span></span><br><span class="line"><span class="attr">    access:</span> <span class="string">$all</span></span><br><span class="line"><span class="attr">    publish:</span> <span class="string">$authenticated</span></span><br><span class="line">    <span class="comment"># 使用taobao</span></span><br><span class="line"><span class="attr">    proxy:</span> <span class="string">taobao</span> </span><br><span class="line"></span><br><span class="line">  <span class="string">'**'</span><span class="string">:</span></span><br><span class="line">    <span class="comment"># allow all users (including non-authenticated users) to read and</span></span><br><span class="line">    <span class="comment"># publish all packages</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># you can specify usernames/groupnames (depending on your auth plugin)</span></span><br><span class="line">    <span class="comment"># and three keywords: "$all", "$anonymous", "$authenticated"</span></span><br><span class="line"><span class="attr">    access:</span> <span class="string">$all</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># allow all known users to publish packages</span></span><br><span class="line">    <span class="comment"># (anyone can register by default, remember?)</span></span><br><span class="line"><span class="attr">    publish:</span> <span class="string">$authenticated</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># if package is not available locally, proxy requests to 'npmjs' registry</span></span><br><span class="line"><span class="attr">    proxy:</span> <span class="string">taobao</span> <span class="comment"># 使用taobao</span></span><br></pre></td></tr></table></figure><h2 id="chrome-driver安装"><a href="#chrome-driver安装" class="headerlink" title="chrome driver安装"></a>chrome driver安装</h2><blockquote><p>使用淘宝源</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install chromedriver --chromedriver_cdnurl=http://cdn.npm.taobao.org/dist/chromedriver</span><br></pre></td></tr></table></figure><h2 id="vue项目使用sass"><a href="#vue项目使用sass" class="headerlink" title="vue项目使用sass"></a>vue项目使用sass</h2><blockquote><p>如果使用<code>vue-cli</code>创建项目，并且使用<code>.vue</code>单文件，使用<code>scss</code>来写<code>CSS</code>需要安装两个依赖。</p><p><code>vue-cli</code>默认没有安装<code>node-sass</code>和<code>sass-loader</code>。</p></blockquote><h3 id="安装依赖"><a href="#安装依赖" class="headerlink" title="安装依赖"></a>安装依赖</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install node-sass --save-dev</span><br><span class="line">npm install sass-loader --save-dev</span><br></pre></td></tr></table></figure><h3 id="配置webpack"><a href="#配置webpack" class="headerlink" title="配置webpack"></a>配置webpack</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.base.config.js 中添加</span></span><br><span class="line"> &#123;</span><br><span class="line">     test: <span class="regexp">/\.scss$/</span>,</span><br><span class="line">         loaders: [<span class="string">"style"</span>, <span class="string">"css"</span>, <span class="string">"sass"</span>]</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><p><a href="https://github.com/QC-L/learning-node.js/blob/master/docs/01.Node.js%E7%AE%80%E4%BB%8B%E4%BB%A5%E5%8F%8A%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE.md" target="_blank" rel="noopener">Node.js简介以及环境配置</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;Node环境配置&quot;&gt;&lt;a href=&quot;#Node环境配置&quot; class=&quot;headerlink&quot; title=&quot;Node环境配置&quot;&gt;&lt;/a&gt;Node环境配置&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;Node环境及配置参考&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2
      
    
    </summary>
    
    
      <category term="node" scheme="https://betgar.github.io/tags/node/"/>
    
  </entry>
  
  <entry>
    <title>jQuery最佳实践</title>
    <link href="https://betgar.github.io/2018/04/19/jquery-best-practice/"/>
    <id>https://betgar.github.io/2018/04/19/jquery-best-practice/</id>
    <published>2018-04-19T12:00:00.000Z</published>
    <updated>2018-06-28T11:24:48.112Z</updated>
    
    <content type="html"><![CDATA[<h1 id="jQuery最佳实践"><a href="#jQuery最佳实践" class="headerlink" title="jQuery最佳实践"></a>jQuery最佳实践</h1><blockquote><p>本文介绍一些使用jQuery的通用标准和最佳实践，这些标准不涵盖Javascript的标准和最佳实践，英文原文地址是 <a href="http://lab.abhinayrathore.com/jquery-standards/" target="_blank" rel="noopener">http://lab.abhinayrathore.com/jquery-standards/</a>。</p><p>中文地址: <a href="http://keenwon.com/955.html" target="_blank" rel="noopener">http://keenwon.com/955.html</a></p></blockquote><h2 id="加载jQuery"><a href="#加载jQuery" class="headerlink" title="加载jQuery"></a>加载jQuery</h2><p>1、尽量使用CDN加载：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="xml">window.jQuery || document.write('<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"js/jquery-1.11.0.min.js"</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="xml"><span class="tag">&lt;<span class="name">\</span>/<span class="attr">script</span>&gt;</span>')</span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>2、就像上面的代码一样，在CDN加载失败时，要回源到本地服务器的同版本jQuery。</p><p>3、使用<a href="http://keenwon.com/577.html" target="_blank" rel="noopener">依赖协议的URL</a>（不加<code>http:</code>和<code>https:</code>，直接使用<code>//</code>），参看上面的例子。</p><p>4、尽可能在页面底部加载jQuery和javascript。</p><p>5、如何选择jQuery版本？</p><ul><li>如果要兼容IE6/7/8，不要使用2.x版本的</li><li>对于新的应用，如果不考虑一些插件的兼容性问题，尽可能的使用最新版</li><li>从CDN加载jQuery的时候，使用完整的版本号（例如，使用1.11.0，不用1.11和1）</li><li>不要加载多个版本的jQuery</li></ul><p>6、如果你使用了Prototype, MooTools, Zepto等，尝试使用<code>jQuery</code>代替<code>$</code>。可以使用<code>$.noConflict()</code>让出<code>$</code>的控制权。</p><h2 id="jQuery变量"><a href="#jQuery变量" class="headerlink" title="jQuery变量"></a>jQuery变量</h2><p>1、所有被缓存的jQuery对象，变量名以<code>$</code>开头。</p><p>2、总是缓存jQuery选择器返回的对象，方便复用：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> $myDiv = $(<span class="string">"#myDiv"</span>);</span><br><span class="line">$myDiv.click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;...&#125;);</span><br></pre></td></tr></table></figure><p>3、使用驼峰命名。</p><h2 id="选择器"><a href="#选择器" class="headerlink" title="选择器"></a>选择器</h2><p>1、尽可能的使用ID选择器。ID选择器使用<code>document.getElementById()</code>，所以更快。</p><p>2、当使用类选择器的时候，不要加DOM元素类型：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> $products = $(<span class="string">"div.products"</span>); <span class="comment">// 慢</span></span><br><span class="line"><span class="keyword">var</span> $products = $(<span class="string">".products"</span>); <span class="comment">// 快</span></span><br></pre></td></tr></table></figure><p>3、使用find查找ID-&gt;Child的嵌套查询，<code>.find()</code>方法更快，因为第一次选择没有使用jQuery的选择器引擎：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 差, 全部使用jQuery的选择器引擎</span></span><br><span class="line"><span class="keyword">var</span> $productIds = $(<span class="string">"#products div.id"</span>);</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 好, #products使用document.getElementById(), 只有div.id需要使用jQuery的选择器引擎</span></span><br><span class="line"><span class="keyword">var</span> $productIds = $(<span class="string">"#products"</span>).find(<span class="string">"div.id"</span>);</span><br></pre></td></tr></table></figure><p>4、越靠右侧越具体：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 差</span></span><br><span class="line">$(<span class="string">"div.data .gonzalez"</span>);</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 最佳</span></span><br><span class="line">$(<span class="string">".data td.gonzalez"</span>);</span><br></pre></td></tr></table></figure><p>5、选择器不要太“具体”：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">".data table.attendees td.gonzalez"</span>);</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 更好，尽可能省去中间部分</span></span><br><span class="line">$(<span class="string">".data td.gonzalez"</span>);</span><br></pre></td></tr></table></figure><p>6、给选择器指定上下文（限定范围）：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 慢，因为它在整个DOM结构中查找</span></span><br><span class="line">$(<span class="string">'.class'</span>);</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 快，因为它只查找 class-container 下的.</span></span><br><span class="line">$(<span class="string">'.class'</span>, <span class="string">'#class-container'</span>);</span><br></pre></td></tr></table></figure><p>7、避免使用“*”：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">'div.container &gt; *'</span>); <span class="comment">// 差</span></span><br><span class="line">$(<span class="string">'div.container'</span>).children(); <span class="comment">// 好</span></span><br></pre></td></tr></table></figure><p>8、避免隐式使用“*”</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">'div.someclass :radio'</span>); <span class="comment">// 差，还是用了“*”</span></span><br><span class="line">$(<span class="string">'div.someclass input:radio'</span>); <span class="comment">// 好</span></span><br></pre></td></tr></table></figure><p>9、不要使用多个ID选择器，或者嵌套使用ID选择器，单独的ID选择器使用<code>document.getElementById()</code>，速度很快：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">'#outer #inner'</span>); <span class="comment">// 差</span></span><br><span class="line">$(<span class="string">'div#inner'</span>); <span class="comment">// 差</span></span><br><span class="line">$(<span class="string">'.outer-container #inner'</span>); <span class="comment">// 差</span></span><br><span class="line">$(<span class="string">'#inner'</span>); <span class="comment">// 好, 调用 document.getElementById()</span></span><br></pre></td></tr></table></figure><h2 id="DOM操作"><a href="#DOM操作" class="headerlink" title="DOM操作"></a>DOM操作</h2><p>1、先把元素分离出DOM结构，再进行复杂的操作，之后再附加回DOM中。不明白原因的话，可以了解下<code>.detach()</code>这个方法</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> $myList = $(<span class="string">"#list-container &gt; ul"</span>).detach();</span><br><span class="line"><span class="comment">// 对 $myList 执行大量复杂操作</span></span><br><span class="line">$myList.appendTo(<span class="string">"#list-container"</span>);</span><br></pre></td></tr></table></figure><p>2、使用字符串连接或者array.join()，少用.append()，<a href="http://jsperf.com/jquery-append-vs-string-concat" target="_blank" rel="noopener">点击这里</a>查看性能比较。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 慢</span></span><br><span class="line"><span class="keyword">var</span> $myList = $(<span class="string">"#list"</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">10000</span>; i++)&#123;</span><br><span class="line">    $myList.append(<span class="string">"&lt;li&gt;"</span>+i+<span class="string">"&lt;/li&gt;"</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 快</span></span><br><span class="line"><span class="keyword">var</span> $myList = $(<span class="string">"#list"</span>);</span><br><span class="line"><span class="keyword">var</span> list = <span class="string">""</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">10000</span>; i++)&#123;</span><br><span class="line">    list += <span class="string">"&lt;li&gt;"</span>+i+<span class="string">"&lt;/li&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line">$myList.html(list);</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 更快</span></span><br><span class="line"><span class="keyword">var</span> array = []; </span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">10000</span>; i++)&#123;</span><br><span class="line">    array[i] = <span class="string">"&lt;li&gt;"</span>+i+<span class="string">"&lt;/li&gt;"</span>; </span><br><span class="line">&#125;</span><br><span class="line">$myList.html(array.join(<span class="string">''</span>));</span><br></pre></td></tr></table></figure><p>3、不要对不存在的元素做操作：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 差: 在发现该ID不存在之前，已经执行了3个函数</span></span><br><span class="line">$(<span class="string">"#nosuchthing"</span>).slideUp();</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 好</span></span><br><span class="line"><span class="keyword">var</span> $mySelection = $(<span class="string">"#nosuchthing"</span>);</span><br><span class="line"><span class="keyword">if</span> ($mySelection.length) &#123;</span><br><span class="line">    $mySelection.slideUp();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="事件"><a href="#事件" class="headerlink" title="事件"></a>事件</h2><p>1、一个页面只使用一个Document ready，便于调试和跟踪。</p><p>2、不要使用匿名函数绑定事件，匿名函数不利于调试，复用，测试，debug：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">"#myLink"</span>).on(<span class="string">"click"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;...&#125;); <span class="comment">// 差 </span></span><br><span class="line"><span class="comment">// 好</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myLinkClickHandler</span>(<span class="params"></span>)</span>&#123;...&#125;$(<span class="string">"#myLink"</span>).on(<span class="string">"click"</span>, myLinkClickHandler);</span><br></pre></td></tr></table></figure><p>3、Document ready 不要用匿名函数，原因同上：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; ... &#125;); <span class="comment">// 差: 你没办法写单元测试和复用</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">// 好</span></span><br><span class="line">$(initPage); <span class="comment">// or $(document).ready(initPage);</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">initPage</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>4、Document ready 的处理函数应该写在外部文件，内联的javascript可以在一些初始化设置之后调用 ready 函数，例如：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"my-document-ready.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="comment">// 做一些初始化设置.</span></span></span><br><span class="line"><span class="javascript">$(<span class="built_in">document</span>).ready(initPage); <span class="comment">// or $(initPage); initPage函数在外部文件中</span></span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>5、不要把事件直接写在HTML元素上，这样不方便调试：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">id</span>=<span class="string">"myLink"</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">onclick</span>=<span class="string">"myEventHandler();"</span>&gt;</span>my link<span class="tag">&lt;/<span class="name">a</span>&gt;</span> <span class="comment">&lt;!-- 差--&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">"#myLink"</span>).on(<span class="string">"click"</span>, myEventHandler); <span class="comment">// 好</span></span><br></pre></td></tr></table></figure><p>6、尽可能的给事件加上命名空间。这样方便解除绑定，而不影响该DOM元素的其他事件：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">"#myLink"</span>).on(<span class="string">"click.mySpecialClick"</span>, myEventHandler); <span class="comment">// 好</span></span><br><span class="line"><span class="comment">// 之后，很容易的解除绑定</span></span><br><span class="line">$(<span class="string">"#myLink"</span>).unbind(<span class="string">"click.mySpecialClick"</span>);</span><br></pre></td></tr></table></figure><h2 id="AJAX"><a href="#AJAX" class="headerlink" title="AJAX"></a>AJAX</h2><p>1、使用<code>.ajax()</code>，避免<code>.getJson()</code>或者<code>.get()</code>，它们在内部也是调用<code>.ajax()</code>的。</p><p>2、不要在<code>https</code>的站点上请求<code>http</code>，使用<a href="http://keenwon.com/577.html" target="_blank" rel="noopener">依赖协议的URL</a></p><p>3、不要把数据加在url上，使用data属性。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 可读性差</span></span><br><span class="line">$.ajax(&#123;</span><br><span class="line">    url: <span class="string">"something.php?param1=test1&amp;param2=test2"</span>,</span><br><span class="line">    ....</span><br><span class="line">&#125;);</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 可读性好</span></span><br><span class="line">$.ajax(&#123;</span><br><span class="line">    url: <span class="string">"something.php"</span>,</span><br><span class="line">    data: &#123; <span class="attr">param1</span>: test1, <span class="attr">param2</span>: test2 &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>4、指定dataType属性，更容易知道数据类型。</p><p>5、对于ajax加载的内容，使用委托绑定事件，这样可以在元素不存在的时候执行绑定。（之后ajax加载进DOM结构中）</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">"#parent-container"</span>).on(<span class="string">"click"</span>, <span class="string">"a"</span>, delegatedClickHandlerForAjax);</span><br></pre></td></tr></table></figure><p>6、使用Promise</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$.ajax(&#123; ... &#125;).then(successHandler, failureHandler);</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 或者</span></span><br><span class="line"><span class="keyword">var</span> jqxhr = $.ajax(&#123; ... &#125;);</span><br><span class="line">jqxhr.done(successHandler);</span><br><span class="line">jqxhr.fail(failureHandler);</span><br></pre></td></tr></table></figure><p>7、抽象出ajax模板，方便复用：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> jqxhr = $.ajax(&#123;</span><br><span class="line">    url: url,</span><br><span class="line">    type: <span class="string">"GET"</span>, <span class="comment">// default is GET but you can use other verbs based on your needs.</span></span><br><span class="line">    cache: <span class="literal">true</span>, <span class="comment">// default is true, but false for dataType 'script' and 'jsonp', so set it on need basis.</span></span><br><span class="line">    data: &#123;&#125;, <span class="comment">// add your request parameters in the data object.</span></span><br><span class="line">    dataType: <span class="string">"json"</span>, <span class="comment">// specify the dataType for future reference</span></span><br><span class="line">    jsonp: <span class="string">"callback"</span>, <span class="comment">// only specify this to match the name of callback parameter your API is expecting for JSONP requests.</span></span><br><span class="line">    statusCode: &#123; <span class="comment">// if you want to handle specific error codes, use the status code mapping settings.</span></span><br><span class="line">        <span class="number">404</span>: handler404,</span><br><span class="line">        <span class="number">500</span>: handler500</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line">jqxhr.done(successHandler);</span><br><span class="line">jqxhr.fail(failureHandler);</span><br></pre></td></tr></table></figure><h2 id="动画效果"><a href="#动画效果" class="headerlink" title="动画效果"></a>动画效果</h2><p>1、Adopt a restrained and consistent approach to implementing animation functionality（大意：采取受限制的和统一的方法来实现动画功能。）</p><p>2、满足用户体验即可，不要做过多的动画：</p><ul><li>尽量使用简单的show/hide，slideUp/slideDown来切换元素</li><li>尽量使用jQuery预定义的时间间隔（durations），“slow”，“fast”或者400（中等）</li></ul><h2 id="插件"><a href="#插件" class="headerlink" title="插件"></a>插件</h2><p>1、选择兼容性好，文档，测试齐全何社区支持好的插件。</p><p>2、检查插件在不同版本jQuery下的兼容性。</p><p>3、任何参加的可复用的组件，都应该以插件的形式实现。</p><h2 id="链式调用"><a href="#链式调用" class="headerlink" title="链式调用"></a>链式调用</h2><p>1、使用链式调用代替变量缓存和多次调用选择器：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">"#myDiv"</span>).addClass(<span class="string">"error"</span>).show();</span><br></pre></td></tr></table></figure><p>2、当链式调用超过3级的时候，适当的换行增加可读性：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">"#myLink"</span>)</span><br><span class="line">    .addClass(<span class="string">"bold"</span>)</span><br><span class="line">    .on(<span class="string">"click"</span>, myClickHandler)</span><br><span class="line">    .on(<span class="string">"mouseover"</span>, myMouseOverHandler)</span><br><span class="line">    .show();</span><br></pre></td></tr></table></figure><p>3、链太长的时候，缓存中间对象是可以接受的。</p><h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><p>1、参数尽量使用对象形式：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$myLink.attr(<span class="string">"href"</span>, <span class="string">"#"</span>).attr(<span class="string">"title"</span>, <span class="string">"my link"</span>).attr(<span class="string">"rel"</span>, <span class="string">"external"</span>); <span class="comment">// 差, 调用三次attr()</span></span><br><span class="line"><span class="comment">// 好, 调用一次</span></span><br><span class="line">$myLink.attr(&#123;</span><br><span class="line">    href: <span class="string">"#"</span>,</span><br><span class="line">    title: <span class="string">"my link"</span>,</span><br><span class="line">    rel: <span class="string">"external"</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>2、尽量不要把css混在js中：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.error</span> &#123; <span class="attribute">color</span>: red; <span class="attribute">font-weight</span>: bold; &#125; <span class="comment">/* 好*/</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">"#mydiv"</span>).css(&#123;<span class="string">'color'</span>:red, <span class="string">'font-weight'</span>:<span class="string">'bold'</span>&#125;); <span class="comment">// 差</span></span><br><span class="line">$(<span class="string">"#mydiv"</span>).addClass(<span class="string">"error"</span>); <span class="comment">// 好</span></span><br></pre></td></tr></table></figure><p>3、不要使用过时的方法，注意新版更新时弃用的方法，不要使用它们。</p><p>4、必要的时候使用原生js，这里看查看性能对比 <a href="http://jsperf.com/document-getelementbyid-vs-jquery/3" target="_blank" rel="noopener">http://jsperf.com/document-getelementbyid-vs-jquery/3</a></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">"#myId"</span>); <span class="comment">// 还是有一点点点点慢...</span></span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">"myId"</span>);</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;jQuery最佳实践&quot;&gt;&lt;a href=&quot;#jQuery最佳实践&quot; class=&quot;headerlink&quot; title=&quot;jQuery最佳实践&quot;&gt;&lt;/a&gt;jQuery最佳实践&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;本文介绍一些使用jQuery的通用标准和最佳实践，
      
    
    </summary>
    
      <category term="jQuery" scheme="https://betgar.github.io/categories/jQuery/"/>
    
    
      <category term="jQuery" scheme="https://betgar.github.io/tags/jQuery/"/>
    
  </entry>
  
  <entry>
    <title>qem-manual(使用手册)</title>
    <link href="https://betgar.github.io/2018/04/17/qem-manual/"/>
    <id>https://betgar.github.io/2018/04/17/qem-manual/</id>
    <published>2018-04-17T12:00:00.000Z</published>
    <updated>2018-06-28T11:24:48.112Z</updated>
    
    <content type="html"><![CDATA[<h1 id="qem-manual-使用手册"><a href="#qem-manual-使用手册" class="headerlink" title="qem-manual(使用手册)"></a>qem-manual(使用手册)</h1><blockquote><p>q$error_manager使用手册</p><p>(DBMS_UTILITY.format_error_backtrace()也挺好用)</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> q$<span class="keyword">log</span>;</span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> q$<span class="keyword">error</span>;</span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> q$error_context;</span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> q$error_instance;</span><br><span class="line"></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> q$error_instance;</span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> q$<span class="keyword">error</span>;</span><br><span class="line"><span class="comment">--------------------------</span></span><br><span class="line"><span class="comment">-- q$error_manager install</span></span><br><span class="line"><span class="comment">-- 执行qem$install.sql</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-------------------------</span></span><br><span class="line"><span class="comment">-- q$error_manager.pks</span></span><br><span class="line"><span class="comment">-- q$error_manager.pkb</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 清空q$log</span></span><br><span class="line"><span class="keyword">CALL</span> q$error_manager.clear_trace();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询trace</span></span><br><span class="line"><span class="keyword">CALL</span> q$error_manager.show_trace(from_id_in =&gt; <span class="literal">NULL</span>, context_like_in =&gt; <span class="string">'km_sum_with_obj'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- A查询</span></span><br><span class="line"><span class="keyword">CALL</span> q$error_manager.show_trace(from_id_in =&gt; <span class="literal">NULL</span>, context_like_in =&gt; <span class="string">'km_sum_with_obj'</span>, text_like_in =&gt; <span class="string">'XTCACMERGEDATA'</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 等价A查询</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> q$<span class="keyword">log</span> l <span class="keyword">WHERE</span> l.context <span class="keyword">LIKE</span> <span class="string">'%km_sum_with_obj'</span> <span class="keyword">AND</span> l.text <span class="keyword">LIKE</span> <span class="string">'%XTCACMERGEDATA%'</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> l.ID;</span><br><span class="line"></span><br><span class="line">execsql;</span><br><span class="line"><span class="comment">------------</span></span><br><span class="line"><span class="comment">-- 跟踪代码</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">IF NOT q$error_manager.trace_enabled(context_in =&gt; 'km_sum_with_obj') THEN</span></span><br><span class="line"><span class="comment">q$error_manager.trace_on(context_like_in =&gt; 'km_sum_with_obj');</span></span><br><span class="line"><span class="comment">END IF;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">---------</span></span><br><span class="line"><span class="comment">-- 记录</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">IF q$error_manager.trace_enabled('km_sum_with_obj') THEN</span></span><br><span class="line"><span class="comment">q$error_manager.trace(context_in =&gt; 'km_sum_with_obj',text_in =&gt; V_SQLSTRING);</span></span><br><span class="line"><span class="comment">END IF;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-----------</span></span><br><span class="line"><span class="comment">-- 记录错误</span></span><br><span class="line">q$error_manager.error_trace_on();</span><br><span class="line">q$error_manager.register_error(error_code_in =&gt; SQLCODE, </span><br><span class="line">error_instance_id_out =&gt; error_instance_id, </span><br><span class="line">text_in =&gt; dbms_utility.format_error_backtrace);</span><br><span class="line">q$error_manager.error_trace_off();</span><br></pre></td></tr></table></figure><h2 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h2><h3 id="register-error"><a href="#register-error" class="headerlink" title="register_error"></a>register_error</h3><blockquote><p><code>qem_demo_register_error.sql</code></p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">   <span class="keyword">DELETE</span> <span class="keyword">FROM</span> q$error_instance;</span><br><span class="line"></span><br><span class="line">   FOR rec IN (<span class="keyword">SELECT</span> *</span><br><span class="line">                 <span class="keyword">FROM</span> employees)</span><br><span class="line">   <span class="keyword">LOOP</span></span><br><span class="line">      DBMS_OUTPUT.put_line (rec.last_name);</span><br><span class="line">      q$error_manager.register_error (error_name_in      =&gt; 'UNANTICIPATED-ERROR'</span><br><span class="line">                                    , text_in            =&gt;    'My message here: '</span><br><span class="line">                                                            || rec.last_name</span><br><span class="line">                                    , name1_in           =&gt; 'FIRSTNAME'</span><br><span class="line">                                    , value1_in          =&gt; rec.first_name</span><br><span class="line">                                     );</span><br><span class="line">      q$error_manager.mark_q$error_handled;</span><br><span class="line">   <span class="keyword">END</span> <span class="keyword">LOOP</span>;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">COMMIT</span>;</span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure><h3 id="trace-logging-with-multiple-contexts"><a href="#trace-logging-with-multiple-contexts" class="headerlink" title="trace logging with multiple contexts"></a>trace logging with multiple contexts</h3><blockquote><p><code>qem_demo_mult_contexts.sql</code></p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Test the trace logging with multiple contexts</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> <span class="keyword">REPLACE</span> <span class="keyword">PROCEDURE</span> dept_sal (department_id_in <span class="keyword">IN</span> PLS_INTEGER)</span><br><span class="line"><span class="keyword">IS</span></span><br><span class="line">   l_max_salary   <span class="built_in">NUMBER</span>;</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">   <span class="keyword">IF</span> q$error_manager.trace_enabled(<span class="string">'context1'</span>)</span><br><span class="line">   <span class="keyword">THEN</span></span><br><span class="line">      q$error_manager.trace (<span class="string">'context1'</span>, department_id_in);</span><br><span class="line">   <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line"></span><br><span class="line">   l_max_salary := CASE WHEN department_id_in &gt; 100 THEN 10000 ELSE 20000 END;</span><br><span class="line"></span><br><span class="line">   IF q$error_manager.trace_enabled('context2')</span><br><span class="line">   THEN</span><br><span class="line">      q$error_manager.trace ('context2', l_max_salary);</span><br><span class="line">   <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line"><span class="keyword">END</span> dept_sal;</span><br><span class="line">/</span><br><span class="line"></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">   q$error_manager.trace_on (<span class="string">'context2,context1'</span>);</span><br><span class="line">   q$error_manager.toscreen;</span><br><span class="line"><span class="comment">-- or use q$error_manager.totable so the output is writed to the q$log table</span></span><br><span class="line">   </span><br><span class="line">   dept_sal (50);</span><br><span class="line">   dept_sal (200);</span><br><span class="line"></span><br><span class="line">   IF q$error_manager.trace_enabled('context3')</span><br><span class="line">   THEN</span><br><span class="line">      q$error_manager.trace ('context3', 'All done!');</span><br><span class="line">   <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line">/</span><br></pre></td></tr></table></figure><h3 id="discard-error-state"><a href="#discard-error-state" class="headerlink" title="discard_error_state"></a>discard_error_state</h3><blockquote><p><code>qem_demo_discard_error_state.sql</code></p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment">Raise and propagate an Oracle error, then</span></span><br><span class="line"><span class="comment">trap that error and extract information about the error.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> <span class="keyword">REPLACE</span> <span class="keyword">PROCEDURE</span> dept_sal (department_id_in <span class="keyword">IN</span> PLS_INTEGER)</span><br><span class="line"><span class="keyword">IS</span></span><br><span class="line">   l_max_salary   <span class="built_in">NUMBER</span>;</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">   l_max_salary := <span class="keyword">CASE</span> <span class="keyword">WHEN</span> department_id_in &gt; <span class="number">100</span> <span class="keyword">THEN</span> <span class="number">10000</span> <span class="keyword">ELSE</span> <span class="number">20000</span> <span class="keyword">END</span>;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">BEGIN</span></span><br><span class="line">      <span class="keyword">IF</span> l_max_salary = <span class="number">10000</span></span><br><span class="line">      <span class="keyword">THEN</span></span><br><span class="line">         DBMS_OUTPUT.put_line (<span class="string">'Raising DUP_VAL_ON_INDEX'</span>);</span><br><span class="line">         RAISE DUP_VAL_ON_INDEX;</span><br><span class="line">      ELSE</span><br><span class="line">         DBMS_OUTPUT.put_line ('Raising NO_DATA_FOUND');</span><br><span class="line">         RAISE NO_DATA_FOUND;</span><br><span class="line">      <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line">   EXCEPTION</span><br><span class="line">      WHEN OTHERS</span><br><span class="line">      THEN</span><br><span class="line">         <span class="comment">/* Trap the error, add some context, pass it along. */</span></span><br><span class="line">         q$error_manager.raise_unanticipated (name1_in    =&gt; 'DEPARTMENT ID'</span><br><span class="line">                                            , value1_in   =&gt; department_id_in</span><br><span class="line">                                            , name2_in    =&gt; 'MAX SALARY'</span><br><span class="line">                                            , value2_in   =&gt; l_max_salary</span><br><span class="line">                                            , name3_in    =&gt; 'TABLE_NAME'</span><br><span class="line">                                            , value3_in   =&gt; 'DEPARTMENTS'</span><br><span class="line">                                            , name4_in    =&gt; 'OWNER'</span><br><span class="line">                                            , value4_in   =&gt; USER</span><br><span class="line">                                             );</span><br><span class="line">   <span class="keyword">END</span>;</span><br><span class="line">EXCEPTION</span><br><span class="line">   WHEN OTHERS</span><br><span class="line">   THEN</span><br><span class="line">      DBMS_OUTPUT.put_line (DBMS_UTILITY.format_error_stack);</span><br><span class="line"><span class="keyword">END</span> dept_sal;</span><br><span class="line">/</span><br><span class="line"></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">   DBMS_OUTPUT.put_line (<span class="string">'Keep Error State:'</span>);</span><br><span class="line">   q$error_manager.keep_error_state;</span><br><span class="line"></span><br><span class="line">   dept_sal (50);</span><br><span class="line">   dept_sal (200);</span><br><span class="line">   DBMS_OUTPUT.put_line ('Discard Error State:');</span><br><span class="line"></span><br><span class="line">   q$error_manager.discard_error_state;</span><br><span class="line">   dept_sal (50);</span><br><span class="line">   dept_sal (200);</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line">/</span><br></pre></td></tr></table></figure><h2 id="q-error-manager安装"><a href="#q-error-manager安装" class="headerlink" title="q$error_manager安装"></a>q$error_manager安装</h2><blockquote><p><code>qem$install.sql</code>文件</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">| This program is a part of the Quest Error Manager for Oracle.</span></span><br><span class="line"><span class="comment">| This product is freeware and is not supported by Quest.</span></span><br><span class="line"><span class="comment">| </span></span><br><span class="line"><span class="comment">| www.quest.com</span></span><br><span class="line"><span class="comment">| </span></span><br><span class="line"><span class="comment">| Copyright, Quest Software, Inc, 2007</span></span><br><span class="line"><span class="comment">| All rights reserved</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">?2008 Quest Software, Inc.</span></span><br><span class="line"><span class="comment">ALL RIGHTS RESERVED.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Redistribution and use of the Quest Error Manager for Oracle software in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">1.    Redistributions of source code must retain (i) the following copyright notice: "?008 Quest Software, Inc. All rights reserved," (ii) this list of conditions, and (iii) the disclaimer below. </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">2.    Redistributions in binary form must reproduce (i) the following copyright notice: "?008 Quest Software, Inc. All rights reserved," (ii) this list of conditions, and (iii) the disclaimer below, in the documentation and/or other materials provided with the distribution. </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">3.    All advertising materials mentioning features or use of the Quest Error Manager for Oracle software must display the following acknowledgement: </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">This product includes software developed by Quest Software, Inc. and its contributors.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">4.    Neither the name of Quest Software, Inc. nor the name its affiliates, subsidiaries or contributors may be used to endorse or promote products derived from the Quest Error Manager for Oracle software without specific prior written permission from Quest Software, Inc. </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Disclaimer:</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">THIS SOFTWARE IS PROVIDED BY QUEST SOFTWARE, INC. AND ITS CONTRIBUTORS ``AS IS'' </span></span><br><span class="line"><span class="comment">AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, </span></span><br><span class="line"><span class="comment">THE IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, </span></span><br><span class="line"><span class="comment">AND NON-INFRINGEMENT ARE DISCLAIMED. IN NO EVENT SHALL QUEST SOFTWARE OR ITS </span></span><br><span class="line"><span class="comment">CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, </span></span><br><span class="line"><span class="comment">OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE </span></span><br><span class="line"><span class="comment">GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) </span></span><br><span class="line"><span class="comment">HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, </span></span><br><span class="line"><span class="comment">OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THE </span></span><br><span class="line"><span class="comment">QUEST ERROR MANAGER SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">SPOOL qem$install.log</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">SEQUENCE</span> q$error_seq</span><br><span class="line">/</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">SEQUENCE</span> q$log_seq</span><br><span class="line">/</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">SEQUENCE</span> q$error_context_seq</span><br><span class="line">/</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">SEQUENCE</span> q$error_instance_seq</span><br><span class="line">/</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> q$error_context</span><br><span class="line">(</span><br><span class="line">   <span class="keyword">id</span>                  <span class="built_in">INTEGER</span></span><br><span class="line"> , error_instance_id   <span class="built_in">INTEGER</span></span><br><span class="line"> , <span class="keyword">name</span>                VARCHAR2 (<span class="number">500</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line"> , <span class="keyword">VALUE</span>               VARCHAR2 (<span class="number">4000</span>)</span><br><span class="line"> , created_on          <span class="keyword">TIMESTAMP</span></span><br><span class="line"> , created_by          VARCHAR2 (<span class="number">100</span>)</span><br><span class="line"> , changed_on          <span class="keyword">TIMESTAMP</span></span><br><span class="line"> , changed_by          VARCHAR2 (<span class="number">100</span>)</span><br><span class="line">)</span><br><span class="line">/</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 1.3.3 If QEM is already installed, use the alter statements to </span></span><br><span class="line"><span class="comment">         change the datatypes */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> q$error_context <span class="keyword">MODIFY</span> (created_on <span class="keyword">TIMESTAMP</span>, changed_on <span class="keyword">TIMESTAMP</span>)</span><br><span class="line">/</span><br><span class="line"></span><br><span class="line"><span class="keyword">COMMENT</span> <span class="keyword">ON</span> <span class="keyword">TABLE</span> q$error_context <span class="keyword">IS</span></span><br><span class="line"><span class="string">'Actual value for the named context for a given error instance.'</span></span><br><span class="line">/</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> q$<span class="keyword">error</span></span><br><span class="line">(</span><br><span class="line">   <span class="keyword">id</span>                    <span class="built_in">INTEGER</span></span><br><span class="line"> , error_category_name   VARCHAR2 (<span class="number">500</span>)</span><br><span class="line"> , code                  <span class="built_in">INTEGER</span></span><br><span class="line"> , <span class="keyword">name</span>                  VARCHAR2 (<span class="number">500</span>)</span><br><span class="line"> , description           VARCHAR2 (<span class="number">4000</span>)</span><br><span class="line"> , substitute_string     VARCHAR2 (<span class="number">4000</span>)</span><br><span class="line"> , recommendation        VARCHAR2 (<span class="number">4000</span>)</span><br><span class="line"> , created_on            <span class="keyword">TIMESTAMP</span></span><br><span class="line"> , created_by            VARCHAR2 (<span class="number">100</span>)</span><br><span class="line"> , changed_on            <span class="keyword">TIMESTAMP</span></span><br><span class="line"> , changed_by            VARCHAR2 (<span class="number">100</span>)</span><br><span class="line">)</span><br><span class="line">/</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 1.3.3 If QEM is already installed, use the alter statements to </span></span><br><span class="line"><span class="comment">         change the datatypes */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> q$<span class="keyword">error</span> <span class="keyword">MODIFY</span> (created_on <span class="keyword">TIMESTAMP</span>, changed_on <span class="keyword">TIMESTAMP</span>)</span><br><span class="line">/</span><br><span class="line"></span><br><span class="line"><span class="keyword">COMMENT</span> <span class="keyword">ON</span> <span class="keyword">TABLE</span> q$<span class="keyword">error</span> <span class="keyword">IS</span></span><br><span class="line"><span class="string">'The set of pre-defined errors copied from sa_error when app was deployed'</span></span><br><span class="line">/</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> q$error_instance</span><br><span class="line">(</span><br><span class="line">   <span class="keyword">id</span>                     <span class="built_in">INTEGER</span></span><br><span class="line"> , error_id               <span class="built_in">INTEGER</span></span><br><span class="line"> , error_stack            VARCHAR2 (<span class="number">4000</span>)</span><br><span class="line"> , call_stack             VARCHAR2 (<span class="number">4000</span>)</span><br><span class="line"> , MESSAGE                VARCHAR2 (<span class="number">4000</span>)</span><br><span class="line"> , system_error_code      <span class="built_in">INTEGER</span></span><br><span class="line"> , system_error_message   VARCHAR2 (<span class="number">4000</span>)</span><br><span class="line"> , environment_info       VARCHAR2 (<span class="number">4000</span>)</span><br><span class="line"> , created_on             <span class="keyword">TIMESTAMP</span></span><br><span class="line"> , created_by             VARCHAR2 (<span class="number">100</span>)</span><br><span class="line"> , changed_on             <span class="keyword">TIMESTAMP</span></span><br><span class="line"> , changed_by             VARCHAR2 (<span class="number">100</span>)</span><br><span class="line">)</span><br><span class="line">/</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 1.3.3 If QEM is already installed, use the alter statements to </span></span><br><span class="line"><span class="comment">         change the datatypes */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> q$error_instance <span class="keyword">MODIFY</span> (created_on <span class="keyword">TIMESTAMP</span>, changed_on <span class="keyword">TIMESTAMP</span>)</span><br><span class="line">/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">COMMENT</span> <span class="keyword">ON</span> <span class="keyword">TABLE</span> q$error_instance <span class="keyword">IS</span></span><br><span class="line"><span class="string">'A particular instance of an error that occurs in the application'</span></span><br><span class="line">/</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> q$<span class="keyword">log</span></span><br><span class="line">(</span><br><span class="line">   <span class="keyword">id</span>           <span class="built_in">INTEGER</span></span><br><span class="line"> , <span class="keyword">context</span>      VARCHAR2 (<span class="number">500</span>)</span><br><span class="line"> , <span class="built_in">text</span>         VARCHAR2 (<span class="number">4000</span>)</span><br><span class="line"> , call_stack   VARCHAR2 (<span class="number">4000</span>)</span><br><span class="line"> , created_on   <span class="keyword">TIMESTAMP</span></span><br><span class="line"> , created_by   VARCHAR2 (<span class="number">100</span>)</span><br><span class="line"> , changed_on   <span class="keyword">TIMESTAMP</span></span><br><span class="line"> , changed_by   VARCHAR2 (<span class="number">100</span>)</span><br><span class="line">)</span><br><span class="line">/</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 1.3.3 If QEM is already installed, use the alter statements to </span></span><br><span class="line"><span class="comment">         change the datatypes */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> q$<span class="keyword">log</span> <span class="keyword">MODIFY</span> (created_on <span class="keyword">TIMESTAMP</span>, changed_on <span class="keyword">TIMESTAMP</span>)</span><br><span class="line">/</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">UNIQUE</span> <span class="keyword">INDEX</span> q$error_context_un</span><br><span class="line">   <span class="keyword">ON</span> q$error_context (error_instance_id, <span class="keyword">name</span>)</span><br><span class="line">/</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">UNIQUE</span> <span class="keyword">INDEX</span> q$error_context_pk</span><br><span class="line">   <span class="keyword">ON</span> q$error_context (<span class="keyword">id</span>)</span><br><span class="line">/</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">UNIQUE</span> <span class="keyword">INDEX</span> q$error_pk</span><br><span class="line">   <span class="keyword">ON</span> q$<span class="keyword">error</span> (<span class="keyword">id</span>)</span><br><span class="line">/</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">UNIQUE</span> <span class="keyword">INDEX</span> q$error_code_pk</span><br><span class="line">   <span class="keyword">ON</span> q$<span class="keyword">error</span> (code)</span><br><span class="line">/</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">UNIQUE</span> <span class="keyword">INDEX</span> q$error_instance_pk</span><br><span class="line">   <span class="keyword">ON</span> q$error_instance (<span class="keyword">id</span>)</span><br><span class="line">/</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">UNIQUE</span> <span class="keyword">INDEX</span> q$log_pk</span><br><span class="line">   <span class="keyword">ON</span> q$<span class="keyword">log</span> (<span class="keyword">id</span>)</span><br><span class="line">/</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> q$error_context <span class="keyword">ADD</span> (</span><br><span class="line">  <span class="keyword">CONSTRAINT</span> q$error_context_pk PRIMARY <span class="keyword">KEY</span> (<span class="keyword">id</span>))</span><br><span class="line">/</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> q$<span class="keyword">error</span> <span class="keyword">ADD</span> (</span><br><span class="line">  <span class="keyword">CONSTRAINT</span> q$error_pk PRIMARY <span class="keyword">KEY</span> (<span class="keyword">id</span>))</span><br><span class="line">/</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> q$error_instance <span class="keyword">ADD</span> (</span><br><span class="line">  <span class="keyword">CONSTRAINT</span> q$error_instance_pk PRIMARY <span class="keyword">KEY</span> (<span class="keyword">id</span>))</span><br><span class="line">/</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> q$<span class="keyword">log</span> <span class="keyword">ADD</span> (</span><br><span class="line">  <span class="keyword">CONSTRAINT</span> q$log_pk PRIMARY <span class="keyword">KEY</span> (<span class="keyword">id</span>))</span><br><span class="line">/</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> q$error_context <span class="keyword">ADD</span> (</span><br><span class="line">  <span class="keyword">CONSTRAINT</span> q$error_context_errinst_fk FOREIGN <span class="keyword">KEY</span> (error_instance_id)</span><br><span class="line">    <span class="keyword">REFERENCES</span> q$error_instance (<span class="keyword">id</span>)</span><br><span class="line">    <span class="keyword">ON</span> <span class="keyword">DELETE</span> <span class="keyword">CASCADE</span>)</span><br><span class="line">/</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> q$error_instance <span class="keyword">ADD</span> (</span><br><span class="line">  <span class="keyword">CONSTRAINT</span> q$error_instance_err_fk FOREIGN <span class="keyword">KEY</span> (error_id)</span><br><span class="line">    <span class="keyword">REFERENCES</span> q$<span class="keyword">error</span> (<span class="keyword">id</span>)</span><br><span class="line">    <span class="keyword">ON</span> <span class="keyword">DELETE</span> <span class="keyword">CASCADE</span>)</span><br><span class="line">/</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 1.2.17 Provided by Filipe de Silva; add env info. */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> <span class="keyword">REPLACE</span> <span class="keyword">TRIGGER</span> q$error_instance_ir</span><br><span class="line">   <span class="keyword">BEFORE</span> <span class="keyword">INSERT</span></span><br><span class="line">   <span class="keyword">ON</span> q$error_instance</span><br><span class="line">   <span class="keyword">REFERENCING</span> <span class="keyword">OLD</span> <span class="keyword">AS</span> <span class="keyword">old</span> <span class="keyword">NEW</span> <span class="keyword">AS</span> <span class="keyword">new</span></span><br><span class="line">   <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="keyword">ROW</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">   :new.created_on := <span class="keyword">SYSDATE</span>;</span><br><span class="line">   :new.created_by := SYS_CONTEXT ('USERENV', 'SESSION_USER');</span><br><span class="line"></span><br><span class="line">   :new.environment_info :=</span><br><span class="line">         'instance: '</span><br><span class="line">      || SYS_CONTEXT ('USERENV', 'INSTANCE')</span><br><span class="line">      || '/'</span><br><span class="line">      || SYS_CONTEXT ('USERENV', 'INSTANCE_NAME')</span><br><span class="line">      || CHR (10)</span><br><span class="line">      || 'db_name: '</span><br><span class="line">      || SYS_CONTEXT ('USERENV', 'DB_NAME')</span><br><span class="line">      || CHR (10)</span><br><span class="line">      || 'db_domain: '</span><br><span class="line">      || SYS_CONTEXT ('USERENV', 'DB_DOMAIN')</span><br><span class="line">      || CHR (10)</span><br><span class="line">      || 'host: '</span><br><span class="line">      || SYS_CONTEXT ('USERENV', 'SERVER_HOST')</span><br><span class="line">      || CHR (10)</span><br><span class="line">      || 'service_name: '</span><br><span class="line">      || SYS_CONTEXT ('USERENV', 'SERVICE_NAME')</span><br><span class="line">      || CHR (10)</span><br><span class="line">      || '<span class="comment">--'</span></span><br><span class="line">      || CHR (10)</span><br><span class="line">      || 'session_user: '</span><br><span class="line">      || SYS_CONTEXT ('USERENV', 'SESSION_USER')</span><br><span class="line">      || CHR (10)</span><br><span class="line">      || 'session_id: '</span><br><span class="line">      || SYS_CONTEXT ('USERENV', 'SESSIONID')</span><br><span class="line">      || CHR (10)</span><br><span class="line">      || '<span class="comment">--'</span></span><br><span class="line">      || CHR (10)</span><br><span class="line">      || 'host: '</span><br><span class="line">      || SYS_CONTEXT ('USERENV', 'HOST')</span><br><span class="line">      || CHR (10)</span><br><span class="line">      || 'ip_address: '</span><br><span class="line">      || SYS_CONTEXT ('USERENV', 'IP_ADDRESS')</span><br><span class="line">      || CHR (10)</span><br><span class="line">      || 'os_user: '</span><br><span class="line">      || SYS_CONTEXT ('USERENV', 'OS_USER')</span><br><span class="line">      || CHR (10)</span><br><span class="line">      || '<span class="comment">--'</span></span><br><span class="line">      || CHR (10)</span><br><span class="line">      || 'module: '</span><br><span class="line">      || SYS_CONTEXT ('USERENV', 'MODULE')</span><br><span class="line">      || CHR (10)</span><br><span class="line">      || 'action: '</span><br><span class="line">      || SYS_CONTEXT ('USERENV', 'ACTION')</span><br><span class="line">      || CHR (10)</span><br><span class="line">      || 'client_identifier: '</span><br><span class="line">      || SYS_CONTEXT ('USERENV', 'CLIENT_IDENTIFIER')</span><br><span class="line">      || CHR (10)</span><br><span class="line">      || 'client_info: '</span><br><span class="line">      || SYS_CONTEXT ('USERENV', 'CLIENT_INFO')</span><br><span class="line">      || CHR (10)</span><br><span class="line">      || '<span class="comment">--'</span></span><br><span class="line">      || CHR (10)</span><br><span class="line">      || 'bg_job_id: '</span><br><span class="line">      || SYS_CONTEXT ('USERENV', 'BG_JOB_ID')</span><br><span class="line">      || CHR (10)</span><br><span class="line">      || 'fg_job_id: '</span><br><span class="line">      || SYS_CONTEXT ('USERENV', 'FG_JOB_ID')</span><br><span class="line">      || CHR (10);</span><br><span class="line">      </span><br><span class="line">  <span class="comment">/* 1.3.7 Provided by Filipe Silva */</span></span><br><span class="line">  &lt;&lt;debug_web_variables&gt;&gt;</span><br><span class="line">   <span class="keyword">BEGIN</span></span><br><span class="line">      <span class="keyword">FOR</span> i <span class="keyword">IN</span> <span class="number">1</span> .. OWA.num_cgi_vars</span><br><span class="line">      <span class="keyword">LOOP</span></span><br><span class="line">         :new.environment_info   :=</span><br><span class="line">               :new.environment_info</span><br><span class="line">            || OWA.cgi_var_name (i)</span><br><span class="line">            || <span class="string">': '</span></span><br><span class="line">            || OWA.cgi_var_val (i)</span><br><span class="line">            || <span class="keyword">CHR</span> (<span class="number">10</span>);</span><br><span class="line">      <span class="keyword">END</span> <span class="keyword">LOOP</span>;</span><br><span class="line">   EXCEPTION</span><br><span class="line">      WHEN VALUE_ERROR</span><br><span class="line">      THEN</span><br><span class="line">         NULL;</span><br><span class="line">   <span class="keyword">END</span> debug_web_variables;</span><br><span class="line">      </span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line">/</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 1.3.7 Trigger needed to allow DBA partition of table.</span></span><br><span class="line"><span class="comment">         Provided by Filipe Silva. */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> <span class="keyword">REPLACE</span> <span class="keyword">TRIGGER</span> <span class="string">"Q$ERROR_CONTEXT_IR"</span> </span><br><span class="line"><span class="keyword">BEFORE</span> <span class="keyword">INSERT</span> <span class="keyword">ON</span> <span class="string">"Q$ERROR_CONTEXT"</span> <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="keyword">ROW</span> </span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    :new.created_on := SYSTIMESTAMP;</span><br><span class="line">    :new.created_by := SYS_CONTEXT ('USERENV', 'SESSION_USER');</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line">/</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 1.3.7 Populate the changed* columns */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> <span class="keyword">REPLACE</span> <span class="keyword">TRIGGER</span> <span class="string">"Q$ERROR_CONTEXT_UR"</span> </span><br><span class="line"><span class="keyword">BEFORE</span> <span class="keyword">UPDATE</span> <span class="keyword">ON</span> <span class="string">"Q$ERROR_CONTEXT"</span> <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="keyword">ROW</span> </span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    :new.changed_on := SYSTIMESTAMP;</span><br><span class="line">    :new.changed_by := SYS_CONTEXT ('USERENV', 'SESSION_USER');</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line">/</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> <span class="keyword">REPLACE</span> <span class="keyword">TRIGGER</span> <span class="string">"Q$ERROR_INSTANCE_UR"</span> </span><br><span class="line"><span class="keyword">BEFORE</span> <span class="keyword">UPDATE</span> <span class="keyword">ON</span> <span class="string">"Q$ERROR_INSTANCE"</span> <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="keyword">ROW</span> </span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    :new.changed_on := SYSTIMESTAMP;</span><br><span class="line">    :new.changed_by := SYS_CONTEXT ('USERENV', 'SESSION_USER');</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line">/</span><br><span class="line"></span><br><span class="line">@@q$error_manager.pks</span><br><span class="line"></span><br><span class="line">@@q$error_manager.pkb</span><br><span class="line"></span><br><span class="line">SPOOL OFF</span><br></pre></td></tr></table></figure><h2 id="q-error-manager包声明"><a href="#q-error-manager包声明" class="headerlink" title="q$error_manager包声明"></a>q$error_manager包声明</h2><blockquote><p><code>q$error_manager.pks</code></p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> <span class="keyword">replace</span> <span class="keyword">PACKAGE</span> q$error_manager</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">| This program is a part of the Quest Error Manager for Oracle.</span></span><br><span class="line"><span class="comment">| This product is freeware and is not supported by Quest.</span></span><br><span class="line"><span class="comment">|</span></span><br><span class="line"><span class="comment">| www.quest.com</span></span><br><span class="line"><span class="comment">|</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">?2009 Quest Software, Inc.</span></span><br><span class="line"><span class="comment">ALL RIGHTS RESERVED.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Redistribution and use of the Quest Error Manager for Oracle software in source and binary forms,</span></span><br><span class="line"><span class="comment">with or without modification, are permitted provided that the following conditions are met:</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">1.  Redistributions of source code must retain (i) the following copyright notice: "?008 Quest Software, Inc.</span></span><br><span class="line"><span class="comment">All rights reserved," (ii) this list of conditions, and (iii) the disclaimer below.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">2.  Redistributions in binary form must reproduce (i) the following copyright notice:</span></span><br><span class="line"><span class="comment">"?008 Quest Software, Inc. All rights reserved," (ii) this list of conditions, and (iii)</span></span><br><span class="line"><span class="comment">the disclaimer below, in the documentation and/or other materials provided with the distribution.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">3.  All advertising materials mentioning features or use of the Quest Error Manager</span></span><br><span class="line"><span class="comment">for Oracle software must display the following acknowledgement:</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">This product includes software developed by Quest Software, Inc. and its contributors.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">4.  Neither the name of Quest Software, Inc. nor the name its affiliates, subsidiaries</span></span><br><span class="line"><span class="comment">or contributors may be used to endorse or promote products derived from the Quest Error</span></span><br><span class="line"><span class="comment">Manager for Oracle software without specific prior written permission from Quest Software, Inc.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Disclaimer:</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">THIS SOFTWARE IS PROVIDED BY QUEST SOFTWARE, INC. AND ITS CONTRIBUTORS ``AS IS''</span></span><br><span class="line"><span class="comment">AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,</span></span><br><span class="line"><span class="comment">THE IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE,</span></span><br><span class="line"><span class="comment">AND NON-INFRINGEMENT ARE DISCLAIMED. IN NO EVENT SHALL QUEST SOFTWARE OR ITS</span></span><br><span class="line"><span class="comment">CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY,</span></span><br><span class="line"><span class="comment">OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE</span></span><br><span class="line"><span class="comment">GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)</span></span><br><span class="line"><span class="comment">HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,</span></span><br><span class="line"><span class="comment">OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THE</span></span><br><span class="line"><span class="comment">QUEST ERROR MANAGER SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">IS</span></span><br><span class="line">    c_version                  <span class="keyword">CONSTANT</span> PLS_INTEGER := <span class="number">1</span>;</span><br><span class="line">    c_release                  CONSTANT PLS_INTEGER := 4;</span><br><span class="line">    c_subrelease               CONSTANT PLS_INTEGER := 1;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    Modification History</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    Date  Who Vrsn  What</span></span><br><span class="line"><span class="comment">    ----------- ----- ------ -------------------------------------------------------</span></span><br><span class="line"><span class="comment">    Oct 15 2010 FS  1.4.1    * removed declaration of unreference variables</span></span><br><span class="line"><span class="comment">                             * labeled end tags</span></span><br><span class="line"><span class="comment">                             * discard_error_state: clear state already stored</span></span><br><span class="line"><span class="comment">    Jul 27 2010 FS  1.4.0    * add error_category_name field to error_info_rt</span></span><br><span class="line"><span class="comment">                             * minor refactoring</span></span><br><span class="line"><span class="comment">                             * add more last_* functions and last_error_info function to return the record</span></span><br><span class="line"><span class="comment">                             * add option to disregard the remaining_context in the message</span></span><br><span class="line"><span class="comment">    Jul 23 2010 FS  1.3.8    * make register_error truncate text_in to 4000 to make the insert possible</span></span><br><span class="line"><span class="comment">                               (thanks to Bill Pribyl for reporting)</span></span><br><span class="line"><span class="comment">                             * add truncante to 4000 to DBMS_UTILITY.format* output when storing to table</span></span><br><span class="line"><span class="comment">    Mar 22 2010 FS  1.3.7    * add trigger to populate environmental info to q$error_context</span></span><br><span class="line"><span class="comment">                             * q$error_instance_ir trigger: add web environment variables log (if available)</span></span><br><span class="line"><span class="comment">                             * corrected commentaries in example scripts and cleaned unused variables</span></span><br><span class="line"><span class="comment">                             * add missing example file from the last versions: QEM in APEX</span></span><br><span class="line"><span class="comment">    Mar 04 2010 SF  1.3.6    * Change all argument names in raise/register/add from err_</span></span><br><span class="line"><span class="comment">                               to error_ for consistency. Synch up with QCGU scripts.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    Feb 19 2010 SF  1.3.5    * Add last* functions so that you can easily get values</span></span><br><span class="line"><span class="comment">                               for last-raised error and among other things test more</span></span><br><span class="line"><span class="comment">                               easily (request from Aci Polajnar).</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    Dec 01 2009 SF  1.3.4    * Add clean_up_errors to help users remove error information.</span></span><br><span class="line"><span class="comment">                             * Add grab_settings to register_error (error_name_in, text_in)</span></span><br><span class="line"><span class="comment">                             overload. It was missing.</span></span><br><span class="line"><span class="comment">                             * Remove redundant overloading of register_error (Why did Oracle</span></span><br><span class="line"><span class="comment">                             let me COMPILE it the way it was, I wonder...)</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    Oct 05 2009 SF  1.3.3    Change audit dates to TIMESTAMP from DATE</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    Sep 12 2009 SF  1.3.2    If error stack is empty assign call stack to it.</span></span><br><span class="line"><span class="comment">                             Add "simple assert" routines that simply call RAE.</span></span><br><span class="line"><span class="comment">                             Add PROCEDURE clean_up_errors to remove rows from</span></span><br><span class="line"><span class="comment">                              q$error_instance and q$error_context.</span></span><br><span class="line"><span class="comment">                              Idea from Dennis Anderson.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    Aug 18 2009  SF  1.3.1   Add fields to the error_info_rt and overloadings to also</span></span><br><span class="line"><span class="comment">                              return that information through parameters. Also make sure</span></span><br><span class="line"><span class="comment">                              that environment info is passed back through get_error_info</span></span><br><span class="line"><span class="comment">                              (kudos to Neal Ala for both providing specs and testing the release).</span></span><br><span class="line"><span class="comment">                             Fix bug in exc section of pl (Thanks, Volker Bartuseck)</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    Dec 12 2008  SF  1.2.19  Change trigger intro'd in 1.2.17 so that you do NOT need</span></span><br><span class="line"><span class="comment">                             access to v$session to run QEM. It will just ignore the</span></span><br><span class="line"><span class="comment">                             environment info when running the trigger.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    Dec 9  2008  SF  1.2.18 Avoid context strings &gt; 500 characters. Thanks, Mike Pinker!</span></span><br><span class="line"><span class="comment">      Add ability to specify multiple distinct contexts.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    Nov 10 2008  SF/FS 1.2.17 Minor fixes from feedback by Filipe Silva, add trigger to</span></span><br><span class="line"><span class="comment">      populate environmental info. Also, offer toggle to avoid</span></span><br><span class="line"><span class="comment">      the need to mark an error as unhandled.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    Jul 12 2008  SF  1.2.16 Avoid VALUE_ERROR exception for sqlcode_name.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    July 2008 SF  1.2.15 register_oracle_error RAISES an error. Should not do that.</span></span><br><span class="line"><span class="comment">      Thanks to Filipe de Silva for pointing this out.</span></span><br><span class="line"><span class="comment">      Also add overloading to return error instance ID.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    Mar 12 2008  SF  1.2.14 Minor refactorings from feedback by Volker Bartusek.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    Nov 27 2007  SF  1.2.13 REMOVE DBMS_ERRLOG - only available in 10gR2.</span></span><br><span class="line"><span class="comment">      Will put in separate utility that will come with QEM.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    Nov 11 2007  SF  1.2.12 Allow user to show error info in message.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    Oct 1  2007  SF  1.2.11 * Start tracking version.</span></span><br><span class="line"><span class="comment">      * Change q$error error code for DUPVAL to -1.</span></span><br><span class="line"><span class="comment">      * Add raise/register_oracle_error alternative.</span></span><br><span class="line"><span class="comment">      * Obtain most recent instance ID from package global</span></span><br><span class="line"><span class="comment">      g_error_instance_raised instead of parsing the</span></span><br><span class="line"><span class="comment">      Oracle error message. This is set in the session</span></span><br><span class="line"><span class="comment">      each time an error is registered.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    Sep 27 2007  SF  SF Add dbms_Errlog functionality</span></span><br><span class="line"><span class="comment">    Sep 26 2007  SF  SF Add raise_unaticipated</span></span><br><span class="line"><span class="comment">    Sep 21 2007  SF  SF Add overloadings with different column names</span></span><br><span class="line"><span class="comment">      err_instance instead of error_instance to support</span></span><br><span class="line"><span class="comment">      backward compatibility with QCGU generated code.</span></span><br><span class="line"><span class="comment">    Sep 5 2007 SF SF Add "not yet implemented" program</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    c_newline                  CONSTANT CHAR (1) := CHR (10);</span><br><span class="line"></span><br><span class="line">    TYPE weak_refcursor IS REF CURSOR;</span><br><span class="line"></span><br><span class="line">    SUBTYPE maxvarchar2_t IS VARCHAR2 (32767);</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- public global constants</span></span><br><span class="line">    c_varchar2_max_length      CONSTANT PLS_INTEGER := 32767;</span><br><span class="line">    <span class="comment">/* 1.4.0 */</span></span><br><span class="line">    c_varchar2_max_length_db   CONSTANT PLS_INTEGER := 4000;</span><br><span class="line"></span><br><span class="line">    c_subst_char               CONSTANT VARCHAR2 (1) := '$';</span><br><span class="line">    c_error_prefix             CONSTANT VARCHAR2 (4) := 'QEM';</span><br><span class="line">    c_error_prefix_len         CONSTANT PLS_INTEGER := 3;</span><br><span class="line">    c_error_code_len           CONSTANT PLS_INTEGER := 20;</span><br><span class="line">    c_oracle_separator         CONSTANT VARCHAR2 (5) := '-ORA-';</span><br><span class="line">    c_oracle_code_len          CONSTANT PLS_INTEGER := 5;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- public global user-defined types</span></span><br><span class="line">    <span class="comment">-- used to return error info back to a calling context</span></span><br><span class="line">    TYPE error_info_rt IS RECORD</span><br><span class="line">    (</span><br><span class="line">        code                   q$error.code%TYPE</span><br><span class="line">       ,name                   q$error.name%TYPE</span><br><span class="line">       ,system_error_code      q$error_instance.system_error_code%TYPE</span><br><span class="line">       ,system_error_message   q$error_instance.system_error_message%TYPE</span><br><span class="line">       ,text                   q$error_instance.MESSAGE%TYPE</span><br><span class="line">       ,recommendation         q$error.recommendation%TYPE</span><br><span class="line">       ,error_stack            q$error_instance.error_stack%TYPE</span><br><span class="line">       ,call_stack             q$error_instance.call_stack%TYPE</span><br><span class="line">       ,environment_info       q$error_instance.environment_info%TYPE</span><br><span class="line">       <span class="comment">/* Added in 1.3 */</span></span><br><span class="line">       ,id                     q$error_instance.id%TYPE</span><br><span class="line">       ,MESSAGE                q$error_instance.MESSAGE%TYPE</span><br><span class="line">       ,error_id               q$error_instance.error_id%TYPE</span><br><span class="line">       ,contexts               maxvarchar2_t</span><br><span class="line">       ,created_on             q$error_instance.created_on%TYPE</span><br><span class="line">       ,created_by             q$error_instance.created_by%TYPE</span><br><span class="line">       ,changed_on             q$error_instance.changed_on%TYPE</span><br><span class="line">       ,changed_by             q$error_instance.changed_by%TYPE</span><br><span class="line">       <span class="comment">/* Added in 1.4.0 */</span></span><br><span class="line">       ,error_category_name    q$error.error_category_name%TYPE</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    TYPE q$log_tc IS TABLE OF q$log%ROWTYPE</span><br><span class="line">                         INDEX BY PLS_INTEGER;</span><br><span class="line"></span><br><span class="line">    TYPE q$error_context_tc IS TABLE OF q$error_context%ROWTYPE</span><br><span class="line">                                   INDEX BY PLS_INTEGER;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- Error/warning management</span></span><br><span class="line">    c_error                    CONSTANT CHAR (5) := 'ERROR';</span><br><span class="line">    c_info_msg                 CONSTANT CHAR (4) := 'INFO';</span><br><span class="line">    c_warning                  CONSTANT CHAR (7) := 'WARNING';</span><br><span class="line">    c_status_delimiter         CONSTANT CHAR (1) := ':';</span><br><span class="line">    <span class="comment">/* Special NYI exception */</span></span><br><span class="line">    e_not_yet_implemented               EXCEPTION;</span><br><span class="line">    c_not_yet_implemented               PLS_INTEGER := -20999;</span><br><span class="line">    <span class="keyword">PRAGMA</span> EXCEPTION_INIT (e_not_yet_implemented, <span class="number">-20999</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- public global routines</span></span><br><span class="line">    <span class="comment">-- -------------------------------------</span></span><br><span class="line">    <span class="comment">-- Tracing and DBMS_OUTPUT encapsulation</span></span><br><span class="line">    <span class="comment">-- -------------------------------------</span></span><br><span class="line">    <span class="comment">-- switches output to the console</span></span><br><span class="line">    <span class="comment">-- <span class="doctag">NOTE:</span> default is to Table</span></span><br><span class="line">    PROCEDURE toscreen;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- switches output to the q$log. table</span></span><br><span class="line">    <span class="comment">-- <span class="doctag">NOTE:</span> this is the default destination</span></span><br><span class="line">    PROCEDURE totable;</span><br><span class="line"></span><br><span class="line">    PROCEDURE totable (purge_in IN BOOLEAN);</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- Send output to file. tofile opens the file; trace off closes the file.</span></span><br><span class="line">    PROCEDURE tofile (dir_in         IN VARCHAR2</span><br><span class="line">                     ,file_in        IN VARCHAR2</span><br><span class="line">                     ,overwrite_in   IN BOOLEAN DEFAULT TRUE);</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- simple DBMS_OUTPUT handling of 255 char limit</span></span><br><span class="line">    <span class="comment">-- looks for a newline, or chops to fit given length</span></span><br><span class="line">    PROCEDURE pl (string_in IN VARCHAR2, length_in IN PLS_INTEGER := 80);</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- converts the given boolean value to string,</span></span><br><span class="line">    <span class="comment">-- then writes it out as above</span></span><br><span class="line">    PROCEDURE pl (val IN BOOLEAN);</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- as above but concatenates str with the string value of bool</span></span><br><span class="line">    <span class="comment">-- e.g., 'cursor%found TRUE'</span></span><br><span class="line">    PROCEDURE pl (str IN VARCHAR2, bool IN BOOLEAN, len IN PLS_INTEGER := 80);</span><br><span class="line"></span><br><span class="line">    PROCEDURE pl (clob_in IN CLOB, length_in IN PLS_INTEGER := 80);</span><br><span class="line"></span><br><span class="line">    PROCEDURE set_error_trace (onoff_in IN BOOLEAN);</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- When error trace is turned on, all errors are also written</span></span><br><span class="line">    <span class="comment">-- to the log table automatically.</span></span><br><span class="line">    PROCEDURE error_trace_on;</span><br><span class="line"></span><br><span class="line">    PROCEDURE error_trace_off;</span><br><span class="line"></span><br><span class="line">    FUNCTION error_trace_enabled</span><br><span class="line">        RETURN BOOLEAN;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 1.4.0 control the adding or not of the remaining_context to the text message</span></span><br><span class="line"><span class="comment">       by default it's on*/</span></span><br><span class="line">    PROCEDURE add_remaining_context_msg_on;</span><br><span class="line"></span><br><span class="line">    PROCEDURE add_remaining_context_msg_off;</span><br><span class="line"></span><br><span class="line">    PROCEDURE set_add_remaining_context_msg (onoff_in IN BOOLEAN);</span><br><span class="line"></span><br><span class="line">    FUNCTION add_remaining_context_enabled</span><br><span class="line">        RETURN BOOLEAN;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- Controls the trace mechanism via a private global variable</span></span><br><span class="line">    <span class="comment">-- and sets the trace context filter (defaults to all traces)</span></span><br><span class="line">    <span class="comment">-- <span class="doctag">NOTE:</span> tracing defaults to FALSE on package initialization</span></span><br><span class="line">    <span class="comment">--   only one context can be in force at a time</span></span><br><span class="line">    <span class="comment">--   and is case-insensitive</span></span><br><span class="line">    PROCEDURE set_trace (onoff_in               IN BOOLEAN</span><br><span class="line">                        ,context_like_in        IN q$log.context%TYPE := NULL</span><br><span class="line">                        ,include_timestamp_in   IN BOOLEAN DEFAULT FALSE</span><br><span class="line">                        ,delimiter_in           IN VARCHAR2 DEFAULT ',');</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- Clears out the trace contents. Currently just deletes from q$log.</span></span><br><span class="line">    PROCEDURE clear_trace;</span><br><span class="line"></span><br><span class="line">    PROCEDURE trace_on (context_like_in        IN q$log.context%TYPE := NULL</span><br><span class="line">                       ,include_timestamp_in   IN BOOLEAN DEFAULT FALSE</span><br><span class="line">                       ,delimiter_in           IN VARCHAR2 DEFAULT ',');</span><br><span class="line"></span><br><span class="line">    PROCEDURE trace_off (context_like_in        IN q$log.context%TYPE := NULL</span><br><span class="line">                        ,include_timestamp_in   IN BOOLEAN DEFAULT FALSE);</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- Has tracing been turned on globally?</span></span><br><span class="line">    FUNCTION trace_enabled</span><br><span class="line">        RETURN BOOLEAN;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- Has tracing been turned on globally or for a specific context?</span></span><br><span class="line">    <span class="comment">-- Context values are compared using UPPER case.</span></span><br><span class="line">    FUNCTION trace_enabled (context_in IN q$log.context%TYPE)</span><br><span class="line">        RETURN BOOLEAN;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- Writes output to the screen or q$log. table</span></span><br><span class="line">    <span class="comment">-- (see toscreen and totable above)</span></span><br><span class="line">    <span class="comment">-- If you pass TRUE for force parameter, this program will write to the log</span></span><br><span class="line">    <span class="comment">-- even if overall tracing is disabled.</span></span><br><span class="line">    <span class="comment">-- Level results in indentation to help you understand the log output.</span></span><br><span class="line">    PROCEDURE trace (context_in       IN q$log.context%TYPE</span><br><span class="line">                    ,text_in          IN q$log.text%TYPE</span><br><span class="line">                    ,force_trace_in   IN BOOLEAN DEFAULT FALSE</span><br><span class="line">                    ,level_in         IN PLS_INTEGER DEFAULT NULL);</span><br><span class="line"></span><br><span class="line">    PROCEDURE trace (context_in       IN q$log.context%TYPE</span><br><span class="line">                    ,number_in        IN NUMBER</span><br><span class="line">                    ,force_trace_in   IN BOOLEAN DEFAULT FALSE</span><br><span class="line">                    ,level_in         IN PLS_INTEGER DEFAULT NULL);</span><br><span class="line"></span><br><span class="line">    PROCEDURE trace (context_in       IN q$log.context%TYPE</span><br><span class="line">                    ,date_in          IN DATE</span><br><span class="line">                    ,force_trace_in   IN BOOLEAN DEFAULT FALSE</span><br><span class="line">                    ,level_in         IN PLS_INTEGER DEFAULT NULL);</span><br><span class="line"></span><br><span class="line">    PROCEDURE trace (context_in       IN q$log.context%TYPE</span><br><span class="line">                    ,boolean_in       IN BOOLEAN</span><br><span class="line">                    ,force_trace_in   IN BOOLEAN DEFAULT FALSE</span><br><span class="line">                    ,level_in         IN PLS_INTEGER DEFAULT NULL);</span><br><span class="line"></span><br><span class="line">    PROCEDURE trace (context_in       IN q$log.context%TYPE</span><br><span class="line">                    ,clob_in          IN CLOB</span><br><span class="line">                    ,force_trace_in   IN BOOLEAN DEFAULT FALSE</span><br><span class="line">                    ,level_in         IN PLS_INTEGER DEFAULT NULL);</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- writes to the console the trace rows</span></span><br><span class="line">    <span class="comment">-- given (optionally filtered in any combination):</span></span><br><span class="line">    <span class="comment">--  trace id, context, text</span></span><br><span class="line">    <span class="comment">-- may be limited by limit_in</span></span><br><span class="line">    <span class="comment">-- call stack can also be displayed</span></span><br><span class="line">    PROCEDURE show_trace (from_id_in              IN q$log.id%TYPE := NULL</span><br><span class="line">                         ,context_like_in         IN VARCHAR2 := '%'</span><br><span class="line">                         ,text_like_in            IN VARCHAR2 := '%'</span><br><span class="line">                         ,limit_in                IN PLS_INTEGER := NULL</span><br><span class="line">                         ,include_call_stack_in   IN BOOLEAN := TRUE);</span><br><span class="line"></span><br><span class="line">    <span class="comment">-------------------------------------------</span></span><br><span class="line">    <span class="comment">-- Error handling and raising functionality</span></span><br><span class="line">    <span class="comment">-------------------------------------------</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">-- An error needs to be raised or logged.</span></span><br><span class="line">    <span class="comment">-- Get a message handle for this particular error instance.</span></span><br><span class="line">    <span class="comment">-- The "error message" id keeps track of both the error</span></span><br><span class="line">    <span class="comment">-- and message information. This program also serves as</span></span><br><span class="line">    <span class="comment">-- "record and go" and "go". In other words, we do not</span></span><br><span class="line">    <span class="comment">-- raise an error, but it is noted.</span></span><br><span class="line">    <span class="comment">--</span></span><br><span class="line">    PROCEDURE register_error (</span><br><span class="line">        error_code_in           IN     q$error.code%TYPE</span><br><span class="line">       ,error_instance_id_out   IN OUT q$error_instance.id%TYPE</span><br><span class="line">       ,text_in                 IN     q$error_instance.MESSAGE%TYPE := NULL</span><br><span class="line">       ,name1_in                IN     VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value1_in               IN     VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name2_in                IN     VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value2_in               IN     VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name3_in                IN     VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value3_in               IN     VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name4_in                IN     VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value4_in               IN     VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name5_in                IN     VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value5_in               IN     VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,grab_settings_in        IN     BOOLEAN DEFAULT TRUE);</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- Pass in error name instead of code.</span></span><br><span class="line">    PROCEDURE register_error (</span><br><span class="line">        error_name_in           IN     q$error.name%TYPE</span><br><span class="line">       ,error_instance_id_out   IN OUT q$error_instance.id%TYPE</span><br><span class="line">       ,text_in                 IN     q$error_instance.MESSAGE%TYPE := NULL</span><br><span class="line">       ,name1_in                IN     VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value1_in               IN     VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name2_in                IN     VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value2_in               IN     VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name3_in                IN     VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value3_in               IN     VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name4_in                IN     VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value4_in               IN     VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name5_in                IN     VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value5_in               IN     VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,grab_settings_in        IN     BOOLEAN DEFAULT TRUE);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 1.3.6 Standardize arg name - this OL no longer needed</span></span><br><span class="line"><span class="comment">    PROCEDURE register_error (</span></span><br><span class="line"><span class="comment">       error_code_in       IN     q$error.code%TYPE</span></span><br><span class="line"><span class="comment">     , error_instance_id_out IN OUT q$error_instance.id%TYPE</span></span><br><span class="line"><span class="comment">     , text_in             IN     q$error_instance.MESSAGE%TYPE:= NULL</span></span><br><span class="line"><span class="comment">     , name1_in            IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="comment">     , value1_in           IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="comment">     , name2_in            IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="comment">     , value2_in           IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="comment">     , name3_in            IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="comment">     , value3_in           IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="comment">     , name4_in            IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="comment">     , value4_in           IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="comment">     , name5_in            IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="comment">     , value5_in           IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="comment">     , grab_settings_in    IN     BOOLEAN DEFAULT TRUE</span></span><br><span class="line"><span class="comment">    );</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">-- Record error (using name or code), but ignore error instance.</span></span><br><span class="line">    <span class="comment">-- Essentially, this is "record but do not raise error."</span></span><br><span class="line">    PROCEDURE register_error (</span><br><span class="line">        error_code_in      IN q$error.code%TYPE</span><br><span class="line">       ,text_in            IN q$error_instance.MESSAGE%TYPE DEFAULT NULL</span><br><span class="line">       ,name1_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value1_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name2_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value2_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name3_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value3_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name4_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value4_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name5_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value5_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,grab_settings_in   IN BOOLEAN DEFAULT TRUE);</span><br><span class="line"></span><br><span class="line">    PROCEDURE register_error (</span><br><span class="line">        error_name_in      IN q$error.name%TYPE</span><br><span class="line">       ,text_in            IN q$error_instance.MESSAGE%TYPE := NULL</span><br><span class="line">       ,name1_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value1_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name2_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value2_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name3_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value3_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name4_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value4_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name5_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value5_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,grab_settings_in   IN BOOLEAN DEFAULT TRUE);</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- Set a single context value for an error_instance row.</span></span><br><span class="line">    <span class="comment">-- Should overload this for a variety of datatypes.</span></span><br><span class="line">    PROCEDURE add_context (</span><br><span class="line">        error_instance_id_in   IN q$error_instance.id%TYPE</span><br><span class="line">       ,NAME_IN                IN q$error_context.name%TYPE</span><br><span class="line">       ,value_in               IN q$error_context.VALUE%TYPE</span><br><span class="line">       ,validate_in            IN BOOLEAN DEFAULT TRUE);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 1.3.6 Do not maintain an overloading only with an arg name change.</span></span><br><span class="line"><span class="comment">    PROCEDURE add_context (err_instance_id_in IN q$error_instance.id%TYPE</span></span><br><span class="line"><span class="comment">                         , NAME_IN            IN q$error_context.name%TYPE</span></span><br><span class="line"><span class="comment">                         , value_in           IN q$error_context.VALUE%TYPE</span></span><br><span class="line"><span class="comment">                         , validate_in        IN BOOLEAN DEFAULT TRUE</span></span><br><span class="line"><span class="comment">                          );*/</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">-- Global contexts; not tied to any specific instance.</span></span><br><span class="line">    PROCEDURE add_gcontext (NAME_IN    IN q$error_context.name%TYPE</span><br><span class="line">                           ,value_in   IN q$error_context.VALUE%TYPE);</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- Remove all global contexts.</span></span><br><span class="line">    <span class="comment">-- This is called by mark_q$error_handled as well.</span></span><br><span class="line">    PROCEDURE clear_gcontexts;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    Raise specified error, providing minimal message</span></span><br><span class="line"><span class="comment">    information in a single procedure call.</span></span><br><span class="line"><span class="comment">    No context information is passed; if message text</span></span><br><span class="line"><span class="comment">    is not provided then the default with the error</span></span><br><span class="line"><span class="comment">    is used.</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    PROCEDURE raise_error (</span><br><span class="line">        error_code_in      IN q$error.code%TYPE</span><br><span class="line">       ,text_in            IN q$error_instance.MESSAGE%TYPE := NULL</span><br><span class="line">       ,name1_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value1_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name2_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value2_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name3_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value3_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name4_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value4_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name5_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value5_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,grab_settings_in   IN BOOLEAN DEFAULT TRUE);</span><br><span class="line"></span><br><span class="line">    PROCEDURE raise_error (</span><br><span class="line">        error_name_in      IN q$error.name%TYPE</span><br><span class="line">       ,text_in            IN q$error_instance.MESSAGE%TYPE := NULL</span><br><span class="line">       ,name1_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value1_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name2_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value2_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name3_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value3_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name4_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value4_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name5_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value5_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,grab_settings_in   IN BOOLEAN DEFAULT TRUE);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 1.3.6 Standardize arg name */</span></span><br><span class="line">    PROCEDURE raise_error_instance (</span><br><span class="line">        error_instance_id_in IN q$error_instance.id%TYPE);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Raise an unanticipated error. */</span></span><br><span class="line">    PROCEDURE raise_unanticipated (</span><br><span class="line">        text_in            IN q$error_instance.MESSAGE%TYPE := NULL</span><br><span class="line">       ,name1_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value1_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name2_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value2_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name3_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value3_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name4_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value4_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name5_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value5_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,grab_settings_in   IN BOOLEAN DEFAULT TRUE);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* V1.2.11 Allow user to specify that an Oracle error should be registered</span></span><br><span class="line"><span class="comment">     (but not re-raised) or raised (registered and re-raised).</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    PROCEDURE register_oracle_error (</span><br><span class="line">        text_in            IN q$error_instance.MESSAGE%TYPE := NULL</span><br><span class="line">       ,name1_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value1_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name2_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value2_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name3_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value3_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name4_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value4_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name5_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value5_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,grab_settings_in   IN BOOLEAN DEFAULT TRUE);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 1.2.15 Return error instance */</span></span><br><span class="line">    <span class="comment">/* 1.3.6 Standardize arg name */</span></span><br><span class="line">    PROCEDURE register_oracle_error (</span><br><span class="line">        text_in                 IN     q$error_instance.MESSAGE%TYPE := NULL</span><br><span class="line">       ,name1_in                IN     VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value1_in               IN     VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name2_in                IN     VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value2_in               IN     VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name3_in                IN     VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value3_in               IN     VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name4_in                IN     VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value4_in               IN     VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name5_in                IN     VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value5_in               IN     VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,grab_settings_in        IN     BOOLEAN DEFAULT TRUE</span><br><span class="line">       ,error_instance_id_out      OUT q$error_instance.id%TYPE);</span><br><span class="line"></span><br><span class="line">    PROCEDURE raise_oracle_error (</span><br><span class="line">        text_in            IN q$error_instance.MESSAGE%TYPE := NULL</span><br><span class="line">       ,name1_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value1_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name2_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value2_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name3_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value3_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name4_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value4_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name5_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value5_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,grab_settings_in   IN BOOLEAN DEFAULT TRUE);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Get error info for latest error. */</span></span><br><span class="line">    PROCEDURE get_error_info (</span><br><span class="line">        error_instance_id_in   IN     q$error_instance.id%TYPE</span><br><span class="line">       ,error_info_out            OUT error_info_rt</span><br><span class="line">       ,context_delimiter_in   IN     VARCHAR2 DEFAULT c_newline);</span><br><span class="line"></span><br><span class="line">    PROCEDURE get_error_info (error_info_out OUT error_info_rt);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 1.4.0 */</span></span><br><span class="line">    FUNCTION last_error_info</span><br><span class="line">        RETURN error_info_rt;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 1.4.0 */</span></span><br><span class="line">    FUNCTION q$error_raised</span><br><span class="line">        RETURN BOOLEAN;</span><br><span class="line"></span><br><span class="line">    <span class="comment">--Simplest format, no composite structures</span></span><br><span class="line">    PROCEDURE get_error_info (</span><br><span class="line">        code_out                   OUT q$error.code%TYPE</span><br><span class="line">       ,name_out                   OUT q$error.name%TYPE</span><br><span class="line">       ,text_out                   OUT q$error_instance.MESSAGE%TYPE</span><br><span class="line">       ,system_error_code_out      OUT q$error_instance.system_error_code%TYPE</span><br><span class="line">       ,system_error_message_out   OUT q$error_instance.system_error_message%TYPE</span><br><span class="line">       ,recommendation_out         OUT q$error.recommendation%TYPE</span><br><span class="line">       ,error_stack_out            OUT q$error_instance.error_stack%TYPE</span><br><span class="line">       ,call_stack_out             OUT q$error_instance.call_stack%TYPE</span><br><span class="line">       ,environment_info_out       OUT q$error_instance.environment_info%TYPE);</span><br><span class="line"></span><br><span class="line">    PROCEDURE get_error_info (</span><br><span class="line">        error_instance_id_in       IN     q$error_instance.id%TYPE</span><br><span class="line">       ,code_out                      OUT q$error.code%TYPE</span><br><span class="line">       ,name_out                      OUT q$error.name%TYPE</span><br><span class="line">       ,text_out                      OUT q$error_instance.MESSAGE%TYPE</span><br><span class="line">       ,system_error_code_out         OUT q$error_instance.system_error_code%TYPE</span><br><span class="line">       ,system_error_message_out      OUT q$error_instance.system_error_message%TYPE</span><br><span class="line">       ,recommendation_out            OUT q$error.recommendation%TYPE</span><br><span class="line">       ,error_stack_out               OUT q$error_instance.error_stack%TYPE</span><br><span class="line">       ,call_stack_out                OUT q$error_instance.call_stack%TYPE</span><br><span class="line">       ,environment_info_out          OUT q$error_instance.environment_info%TYPE);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 1.3.6 Standardize arg name */</span></span><br><span class="line">    PROCEDURE get_error_info (</span><br><span class="line">        error_message_in           IN     VARCHAR2</span><br><span class="line">       ,code_out                      OUT q$error.code%TYPE</span><br><span class="line">       ,name_out                      OUT q$error.name%TYPE</span><br><span class="line">       ,text_out                      OUT q$error_instance.MESSAGE%TYPE</span><br><span class="line">       ,system_error_code_out         OUT q$error_instance.system_error_code%TYPE</span><br><span class="line">       ,system_error_message_out      OUT q$error_instance.system_error_message%TYPE</span><br><span class="line">       ,recommendation_out            OUT q$error.recommendation%TYPE</span><br><span class="line">       ,error_stack_out               OUT q$error_instance.error_stack%TYPE</span><br><span class="line">       ,call_stack_out                OUT q$error_instance.call_stack%TYPE</span><br><span class="line">       ,environment_info_out          OUT q$error_instance.environment_info%TYPE);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 1.3 Add id and message as OUT arguments */</span></span><br><span class="line">    PROCEDURE get_error_info (</span><br><span class="line">        code_out                      OUT q$error.code%TYPE</span><br><span class="line">       ,name_out                      OUT q$error.name%TYPE</span><br><span class="line">       ,text_out                      OUT q$error_instance.MESSAGE%TYPE</span><br><span class="line">       ,system_error_code_out         OUT q$error_instance.system_error_code%TYPE</span><br><span class="line">       ,system_error_message_out      OUT q$error_instance.system_error_message%TYPE</span><br><span class="line">       ,recommendation_out            OUT q$error.recommendation%TYPE</span><br><span class="line">       ,error_stack_out               OUT q$error_instance.error_stack%TYPE</span><br><span class="line">       ,call_stack_out                OUT q$error_instance.call_stack%TYPE</span><br><span class="line">       ,environment_info_out          OUT q$error_instance.environment_info%TYPE</span><br><span class="line">       ,id_out                        OUT q$error_instance.id%TYPE</span><br><span class="line">       ,message_out                   OUT q$error_instance.MESSAGE%TYPE</span><br><span class="line">       ,contexts_out                  OUT VARCHAR2</span><br><span class="line">       ,context_delimiter_in       IN     VARCHAR2 DEFAULT c_newline);</span><br><span class="line"></span><br><span class="line">    PROCEDURE get_error_info (</span><br><span class="line">        error_instance_id_in       IN     q$error_instance.id%TYPE</span><br><span class="line">       ,code_out                      OUT q$error.code%TYPE</span><br><span class="line">       ,name_out                      OUT q$error.name%TYPE</span><br><span class="line">       ,text_out                      OUT q$error_instance.MESSAGE%TYPE</span><br><span class="line">       ,system_error_code_out         OUT q$error_instance.system_error_code%TYPE</span><br><span class="line">       ,system_error_message_out      OUT q$error_instance.system_error_message%TYPE</span><br><span class="line">       ,recommendation_out            OUT q$error.recommendation%TYPE</span><br><span class="line">       ,error_stack_out               OUT q$error_instance.error_stack%TYPE</span><br><span class="line">       ,call_stack_out                OUT q$error_instance.call_stack%TYPE</span><br><span class="line">       ,environment_info_out          OUT q$error_instance.environment_info%TYPE</span><br><span class="line">       ,id_out                        OUT q$error_instance.id%TYPE</span><br><span class="line">       ,message_out                   OUT q$error_instance.MESSAGE%TYPE</span><br><span class="line">       ,contexts_out                  OUT VARCHAR2</span><br><span class="line">       ,context_delimiter_in       IN     VARCHAR2 DEFAULT c_newline);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 1.3.6 Standardize arg name */</span></span><br><span class="line">    PROCEDURE get_error_info (</span><br><span class="line">        error_message_in           IN     VARCHAR2</span><br><span class="line">       ,code_out                      OUT q$error.code%TYPE</span><br><span class="line">       ,name_out                      OUT q$error.name%TYPE</span><br><span class="line">       ,text_out                      OUT q$error_instance.MESSAGE%TYPE</span><br><span class="line">       ,system_error_code_out         OUT q$error_instance.system_error_code%TYPE</span><br><span class="line">       ,system_error_message_out      OUT q$error_instance.system_error_message%TYPE</span><br><span class="line">       ,recommendation_out            OUT q$error.recommendation%TYPE</span><br><span class="line">       ,error_stack_out               OUT q$error_instance.error_stack%TYPE</span><br><span class="line">       ,call_stack_out                OUT q$error_instance.call_stack%TYPE</span><br><span class="line">       ,environment_info_out          OUT q$error_instance.environment_info%TYPE</span><br><span class="line">       ,id_out                        OUT q$error_instance.id%TYPE</span><br><span class="line">       ,message_out                   OUT q$error_instance.MESSAGE%TYPE</span><br><span class="line">       ,contexts_out                  OUT VARCHAR2</span><br><span class="line">       ,context_delimiter_in       IN     VARCHAR2 DEFAULT c_newline);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 1.4.0 */</span></span><br><span class="line">    FUNCTION last_error_id</span><br><span class="line">        RETURN q$error.id%TYPE;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 1.4.0 */</span></span><br><span class="line">    FUNCTION last_instance_id</span><br><span class="line">        RETURN q$error_instance.id%TYPE;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 1.4.0 */</span></span><br><span class="line">    FUNCTION last_error_category_name</span><br><span class="line">        RETURN q$error.error_category_name%TYPE;</span><br><span class="line"></span><br><span class="line">    FUNCTION last_code</span><br><span class="line">        RETURN q$error.code%TYPE;</span><br><span class="line"></span><br><span class="line">    FUNCTION last_name</span><br><span class="line">        RETURN q$error.name%TYPE;</span><br><span class="line"></span><br><span class="line">    FUNCTION last_text</span><br><span class="line">        RETURN q$error_instance.MESSAGE%TYPE;</span><br><span class="line"></span><br><span class="line">    FUNCTION last_system_error_code</span><br><span class="line">        RETURN q$error_instance.system_error_code%TYPE;</span><br><span class="line"></span><br><span class="line">    FUNCTION last_system_error_message</span><br><span class="line">        RETURN q$error_instance.system_error_message%TYPE;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    PROCEDURE show_error_info (</span><br><span class="line">        error_instance_id_in   IN q$error_instance.id%TYPE</span><br><span class="line">       ,copy_to_clipboard_in   IN BOOLEAN DEFAULT FALSE);</span><br><span class="line"></span><br><span class="line">    PROCEDURE show_errors_after (</span><br><span class="line">        date_in                IN DATE</span><br><span class="line">       ,copy_to_clipboard_in   IN BOOLEAN DEFAULT FALSE);</span><br><span class="line"></span><br><span class="line">    PROCEDURE show_errors_with_message (</span><br><span class="line">        text_in                IN VARCHAR2</span><br><span class="line">       ,copy_to_clipboard_in   IN BOOLEAN DEFAULT FALSE);</span><br><span class="line"></span><br><span class="line">    PROCEDURE show_errors_with_code (</span><br><span class="line">        error_code_in             IN PLS_INTEGER</span><br><span class="line">       ,is_system_error_code_in   IN BOOLEAN DEFAULT FALSE</span><br><span class="line">       ,copy_to_clipboard_in      IN BOOLEAN DEFAULT FALSE);</span><br><span class="line"></span><br><span class="line">    PROCEDURE show_errors_for (</span><br><span class="line">        where_clause_in        IN VARCHAR2</span><br><span class="line">       ,copy_to_clipboard_in   IN BOOLEAN DEFAULT FALSE);</span><br><span class="line"></span><br><span class="line">    FUNCTION error_clipboard (clear_clipboard_in IN BOOLEAN DEFAULT TRUE)</span><br><span class="line">        RETURN VARCHAR2;</span><br><span class="line"></span><br><span class="line">    FUNCTION error_clipboard_is_full</span><br><span class="line">        RETURN BOOLEAN;</span><br><span class="line"></span><br><span class="line">    PROCEDURE clear_error_clipboard;</span><br><span class="line"></span><br><span class="line">    PROCEDURE assert (condition_in    IN BOOLEAN</span><br><span class="line">                     ,text_in         IN q$error_instance.MESSAGE%TYPE</span><br><span class="line">                     ,error_code_in   IN q$error.code%TYPE</span><br><span class="line">                     ,name1_in        IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,value1_in       IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,name2_in        IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,value2_in       IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,name3_in        IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,value3_in       IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,name4_in        IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,value4_in       IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,name5_in        IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,value5_in       IN VARCHAR2 DEFAULT NULL);</span><br><span class="line"></span><br><span class="line">    PROCEDURE assert (condition_in    IN BOOLEAN</span><br><span class="line">                     ,text_in         IN q$error_instance.MESSAGE%TYPE</span><br><span class="line">                     ,error_name_in   IN q$error.name%TYPE</span><br><span class="line">                     ,name1_in        IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,value1_in       IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,name2_in        IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,value2_in       IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,name3_in        IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,value3_in       IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,name4_in        IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,value4_in       IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,name5_in        IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,value5_in       IN VARCHAR2 DEFAULT NULL);</span><br><span class="line"></span><br><span class="line">    PROCEDURE assert (condition_in   IN BOOLEAN</span><br><span class="line">                     ,text_in        IN q$error_instance.MESSAGE%TYPE</span><br><span class="line">                     ,name1_in       IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,value1_in      IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,name2_in       IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,value2_in      IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,name3_in       IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,value3_in      IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,name4_in       IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,value4_in      IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,name5_in       IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,value5_in      IN VARCHAR2 DEFAULT NULL);</span><br><span class="line"></span><br><span class="line">    PROCEDURE simple_assert (</span><br><span class="line">        condition_in         IN BOOLEAN</span><br><span class="line">       ,text_in              IN q$error_instance.MESSAGE%TYPE</span><br><span class="line">       ,name1_in             IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value1_in            IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name2_in             IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value2_in            IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name3_in             IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value3_in            IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name4_in             IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value4_in            IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name5_in             IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value5_in            IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,raise_with_code_in   IN PLS_INTEGER DEFAULT -20000);</span><br><span class="line"></span><br><span class="line">    PROCEDURE mark_q$error_handled;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- Added/exposed in 1.1.1</span></span><br><span class="line">    FUNCTION error_instance_from_string (string_in IN VARCHAR2)</span><br><span class="line">        RETURN PLS_INTEGER;</span><br><span class="line"></span><br><span class="line">    FUNCTION error_instance_from_sqlerrm</span><br><span class="line">        RETURN PLS_INTEGER;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- 1.2 Get message text only</span></span><br><span class="line">    FUNCTION error_message</span><br><span class="line">        RETURN VARCHAR2;</span><br><span class="line"></span><br><span class="line">    PROCEDURE start_execution (program_name_in   IN VARCHAR2 := NULL</span><br><span class="line">                              ,information_in    IN VARCHAR2 := NULL);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    Test builder validation:</span></span><br><span class="line"><span class="comment">      * return a status string composed of type:message</span></span><br><span class="line"><span class="comment">      * if no prefix, then it is an error</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    FUNCTION is_warning (status_in IN VARCHAR2)</span><br><span class="line">        RETURN BOOLEAN;</span><br><span class="line"></span><br><span class="line">    FUNCTION is_error (status_in IN VARCHAR2)</span><br><span class="line">        RETURN BOOLEAN;</span><br><span class="line"></span><br><span class="line">    FUNCTION is_info_msg (status_in IN VARCHAR2)</span><br><span class="line">        RETURN BOOLEAN;</span><br><span class="line"></span><br><span class="line">    PROCEDURE parse_status_string (status_in         IN     VARCHAR2</span><br><span class="line">                                  ,status_type_out      OUT VARCHAR2</span><br><span class="line">                                  ,message_out          OUT VARCHAR2);</span><br><span class="line"></span><br><span class="line">    PROCEDURE make_a_warning (status_inout IN OUT VARCHAR2);</span><br><span class="line"></span><br><span class="line">    PROCEDURE make_an_error (status_inout IN OUT VARCHAR2);</span><br><span class="line"></span><br><span class="line">    PROCEDURE make_an_info_msg (status_inout IN OUT VARCHAR2);</span><br><span class="line"></span><br><span class="line">    FUNCTION make_a_warning (status_in IN VARCHAR2)</span><br><span class="line">        RETURN VARCHAR2;</span><br><span class="line"></span><br><span class="line">    FUNCTION make_an_error (status_in IN VARCHAR2)</span><br><span class="line">        RETURN VARCHAR2;</span><br><span class="line"></span><br><span class="line">    FUNCTION make_an_info_msg (status_in IN VARCHAR2)</span><br><span class="line">        RETURN VARCHAR2;</span><br><span class="line"></span><br><span class="line">    FUNCTION full_log_string (context_in   IN VARCHAR2</span><br><span class="line">                             ,text_in      IN VARCHAR2</span><br><span class="line">                             ,level_in     IN PLS_INTEGER)</span><br><span class="line">        RETURN VARCHAR2;</span><br><span class="line"></span><br><span class="line">    FUNCTION log_entries_after (timestamp_in IN DATE)</span><br><span class="line">        RETURN SYS_REFCURSOR;</span><br><span class="line"></span><br><span class="line">    PROCEDURE not_yet_implemented (program_name_in IN VARCHAR2);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 1.2.12</span></span><br><span class="line"><span class="comment">      Provide switch to force display of "real" error in the error message,</span></span><br><span class="line"><span class="comment">      rather than simply showing the error handle. You should ask for</span></span><br><span class="line"><span class="comment">      "raise with message" when you are not going to use the get_error_info</span></span><br><span class="line"><span class="comment">      program to extract error information.</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    PROCEDURE raise_with_message;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Only show the error instance handle in the error message. This is the</span></span><br><span class="line"><span class="comment">     default and assumes that you will be calling get_error_info to</span></span><br><span class="line"><span class="comment">     extract all the info. */</span></span><br><span class="line">    PROCEDURE raise_with_handle;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 1.2.17 Specify that you do NOT want the error state cached. This means</span></span><br><span class="line"><span class="comment">      that you will not have to explicitly mark the error as handled,</span></span><br><span class="line"><span class="comment">      but this also means that if successive layers in your call stack</span></span><br><span class="line"><span class="comment">      handle and re-raise your exception with QEM, you will see</span></span><br><span class="line"><span class="comment">      multiple entries in your error instance table. */</span></span><br><span class="line">    PROCEDURE discard_error_state;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* The default */</span></span><br><span class="line">    PROCEDURE keep_error_state;</span><br><span class="line"></span><br><span class="line">    FUNCTION error_state_discarded</span><br><span class="line">        RETURN BOOLEAN;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Remove data from q$error_instance and q$error_context</span></span><br><span class="line"><span class="comment">       for all errors that were reported earlier than the</span></span><br><span class="line"><span class="comment">       specified date. Pass NULL (default) to remove all rows.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">       <span class="doctag">NOTE:</span> This is a pragma autonomous_transaction; procedure.</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    PROCEDURE clean_up_errors (older_than_in IN DATE DEFAULT NULL);</span><br><span class="line"><span class="keyword">END</span> q$error_manager;</span><br><span class="line">/</span><br></pre></td></tr></table></figure><h2 id="q-error-manager包体"><a href="#q-error-manager包体" class="headerlink" title="q$error_manager包体"></a>q$error_manager包体</h2><blockquote><p><code>q$error_manager.pkb</code></p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br><span class="line">1022</span><br><span class="line">1023</span><br><span class="line">1024</span><br><span class="line">1025</span><br><span class="line">1026</span><br><span class="line">1027</span><br><span class="line">1028</span><br><span class="line">1029</span><br><span class="line">1030</span><br><span class="line">1031</span><br><span class="line">1032</span><br><span class="line">1033</span><br><span class="line">1034</span><br><span class="line">1035</span><br><span class="line">1036</span><br><span class="line">1037</span><br><span class="line">1038</span><br><span class="line">1039</span><br><span class="line">1040</span><br><span class="line">1041</span><br><span class="line">1042</span><br><span class="line">1043</span><br><span class="line">1044</span><br><span class="line">1045</span><br><span class="line">1046</span><br><span class="line">1047</span><br><span class="line">1048</span><br><span class="line">1049</span><br><span class="line">1050</span><br><span class="line">1051</span><br><span class="line">1052</span><br><span class="line">1053</span><br><span class="line">1054</span><br><span class="line">1055</span><br><span class="line">1056</span><br><span class="line">1057</span><br><span class="line">1058</span><br><span class="line">1059</span><br><span class="line">1060</span><br><span class="line">1061</span><br><span class="line">1062</span><br><span class="line">1063</span><br><span class="line">1064</span><br><span class="line">1065</span><br><span class="line">1066</span><br><span class="line">1067</span><br><span class="line">1068</span><br><span class="line">1069</span><br><span class="line">1070</span><br><span class="line">1071</span><br><span class="line">1072</span><br><span class="line">1073</span><br><span class="line">1074</span><br><span class="line">1075</span><br><span class="line">1076</span><br><span class="line">1077</span><br><span class="line">1078</span><br><span class="line">1079</span><br><span class="line">1080</span><br><span class="line">1081</span><br><span class="line">1082</span><br><span class="line">1083</span><br><span class="line">1084</span><br><span class="line">1085</span><br><span class="line">1086</span><br><span class="line">1087</span><br><span class="line">1088</span><br><span class="line">1089</span><br><span class="line">1090</span><br><span class="line">1091</span><br><span class="line">1092</span><br><span class="line">1093</span><br><span class="line">1094</span><br><span class="line">1095</span><br><span class="line">1096</span><br><span class="line">1097</span><br><span class="line">1098</span><br><span class="line">1099</span><br><span class="line">1100</span><br><span class="line">1101</span><br><span class="line">1102</span><br><span class="line">1103</span><br><span class="line">1104</span><br><span class="line">1105</span><br><span class="line">1106</span><br><span class="line">1107</span><br><span class="line">1108</span><br><span class="line">1109</span><br><span class="line">1110</span><br><span class="line">1111</span><br><span class="line">1112</span><br><span class="line">1113</span><br><span class="line">1114</span><br><span class="line">1115</span><br><span class="line">1116</span><br><span class="line">1117</span><br><span class="line">1118</span><br><span class="line">1119</span><br><span class="line">1120</span><br><span class="line">1121</span><br><span class="line">1122</span><br><span class="line">1123</span><br><span class="line">1124</span><br><span class="line">1125</span><br><span class="line">1126</span><br><span class="line">1127</span><br><span class="line">1128</span><br><span class="line">1129</span><br><span class="line">1130</span><br><span class="line">1131</span><br><span class="line">1132</span><br><span class="line">1133</span><br><span class="line">1134</span><br><span class="line">1135</span><br><span class="line">1136</span><br><span class="line">1137</span><br><span class="line">1138</span><br><span class="line">1139</span><br><span class="line">1140</span><br><span class="line">1141</span><br><span class="line">1142</span><br><span class="line">1143</span><br><span class="line">1144</span><br><span class="line">1145</span><br><span class="line">1146</span><br><span class="line">1147</span><br><span class="line">1148</span><br><span class="line">1149</span><br><span class="line">1150</span><br><span class="line">1151</span><br><span class="line">1152</span><br><span class="line">1153</span><br><span class="line">1154</span><br><span class="line">1155</span><br><span class="line">1156</span><br><span class="line">1157</span><br><span class="line">1158</span><br><span class="line">1159</span><br><span class="line">1160</span><br><span class="line">1161</span><br><span class="line">1162</span><br><span class="line">1163</span><br><span class="line">1164</span><br><span class="line">1165</span><br><span class="line">1166</span><br><span class="line">1167</span><br><span class="line">1168</span><br><span class="line">1169</span><br><span class="line">1170</span><br><span class="line">1171</span><br><span class="line">1172</span><br><span class="line">1173</span><br><span class="line">1174</span><br><span class="line">1175</span><br><span class="line">1176</span><br><span class="line">1177</span><br><span class="line">1178</span><br><span class="line">1179</span><br><span class="line">1180</span><br><span class="line">1181</span><br><span class="line">1182</span><br><span class="line">1183</span><br><span class="line">1184</span><br><span class="line">1185</span><br><span class="line">1186</span><br><span class="line">1187</span><br><span class="line">1188</span><br><span class="line">1189</span><br><span class="line">1190</span><br><span class="line">1191</span><br><span class="line">1192</span><br><span class="line">1193</span><br><span class="line">1194</span><br><span class="line">1195</span><br><span class="line">1196</span><br><span class="line">1197</span><br><span class="line">1198</span><br><span class="line">1199</span><br><span class="line">1200</span><br><span class="line">1201</span><br><span class="line">1202</span><br><span class="line">1203</span><br><span class="line">1204</span><br><span class="line">1205</span><br><span class="line">1206</span><br><span class="line">1207</span><br><span class="line">1208</span><br><span class="line">1209</span><br><span class="line">1210</span><br><span class="line">1211</span><br><span class="line">1212</span><br><span class="line">1213</span><br><span class="line">1214</span><br><span class="line">1215</span><br><span class="line">1216</span><br><span class="line">1217</span><br><span class="line">1218</span><br><span class="line">1219</span><br><span class="line">1220</span><br><span class="line">1221</span><br><span class="line">1222</span><br><span class="line">1223</span><br><span class="line">1224</span><br><span class="line">1225</span><br><span class="line">1226</span><br><span class="line">1227</span><br><span class="line">1228</span><br><span class="line">1229</span><br><span class="line">1230</span><br><span class="line">1231</span><br><span class="line">1232</span><br><span class="line">1233</span><br><span class="line">1234</span><br><span class="line">1235</span><br><span class="line">1236</span><br><span class="line">1237</span><br><span class="line">1238</span><br><span class="line">1239</span><br><span class="line">1240</span><br><span class="line">1241</span><br><span class="line">1242</span><br><span class="line">1243</span><br><span class="line">1244</span><br><span class="line">1245</span><br><span class="line">1246</span><br><span class="line">1247</span><br><span class="line">1248</span><br><span class="line">1249</span><br><span class="line">1250</span><br><span class="line">1251</span><br><span class="line">1252</span><br><span class="line">1253</span><br><span class="line">1254</span><br><span class="line">1255</span><br><span class="line">1256</span><br><span class="line">1257</span><br><span class="line">1258</span><br><span class="line">1259</span><br><span class="line">1260</span><br><span class="line">1261</span><br><span class="line">1262</span><br><span class="line">1263</span><br><span class="line">1264</span><br><span class="line">1265</span><br><span class="line">1266</span><br><span class="line">1267</span><br><span class="line">1268</span><br><span class="line">1269</span><br><span class="line">1270</span><br><span class="line">1271</span><br><span class="line">1272</span><br><span class="line">1273</span><br><span class="line">1274</span><br><span class="line">1275</span><br><span class="line">1276</span><br><span class="line">1277</span><br><span class="line">1278</span><br><span class="line">1279</span><br><span class="line">1280</span><br><span class="line">1281</span><br><span class="line">1282</span><br><span class="line">1283</span><br><span class="line">1284</span><br><span class="line">1285</span><br><span class="line">1286</span><br><span class="line">1287</span><br><span class="line">1288</span><br><span class="line">1289</span><br><span class="line">1290</span><br><span class="line">1291</span><br><span class="line">1292</span><br><span class="line">1293</span><br><span class="line">1294</span><br><span class="line">1295</span><br><span class="line">1296</span><br><span class="line">1297</span><br><span class="line">1298</span><br><span class="line">1299</span><br><span class="line">1300</span><br><span class="line">1301</span><br><span class="line">1302</span><br><span class="line">1303</span><br><span class="line">1304</span><br><span class="line">1305</span><br><span class="line">1306</span><br><span class="line">1307</span><br><span class="line">1308</span><br><span class="line">1309</span><br><span class="line">1310</span><br><span class="line">1311</span><br><span class="line">1312</span><br><span class="line">1313</span><br><span class="line">1314</span><br><span class="line">1315</span><br><span class="line">1316</span><br><span class="line">1317</span><br><span class="line">1318</span><br><span class="line">1319</span><br><span class="line">1320</span><br><span class="line">1321</span><br><span class="line">1322</span><br><span class="line">1323</span><br><span class="line">1324</span><br><span class="line">1325</span><br><span class="line">1326</span><br><span class="line">1327</span><br><span class="line">1328</span><br><span class="line">1329</span><br><span class="line">1330</span><br><span class="line">1331</span><br><span class="line">1332</span><br><span class="line">1333</span><br><span class="line">1334</span><br><span class="line">1335</span><br><span class="line">1336</span><br><span class="line">1337</span><br><span class="line">1338</span><br><span class="line">1339</span><br><span class="line">1340</span><br><span class="line">1341</span><br><span class="line">1342</span><br><span class="line">1343</span><br><span class="line">1344</span><br><span class="line">1345</span><br><span class="line">1346</span><br><span class="line">1347</span><br><span class="line">1348</span><br><span class="line">1349</span><br><span class="line">1350</span><br><span class="line">1351</span><br><span class="line">1352</span><br><span class="line">1353</span><br><span class="line">1354</span><br><span class="line">1355</span><br><span class="line">1356</span><br><span class="line">1357</span><br><span class="line">1358</span><br><span class="line">1359</span><br><span class="line">1360</span><br><span class="line">1361</span><br><span class="line">1362</span><br><span class="line">1363</span><br><span class="line">1364</span><br><span class="line">1365</span><br><span class="line">1366</span><br><span class="line">1367</span><br><span class="line">1368</span><br><span class="line">1369</span><br><span class="line">1370</span><br><span class="line">1371</span><br><span class="line">1372</span><br><span class="line">1373</span><br><span class="line">1374</span><br><span class="line">1375</span><br><span class="line">1376</span><br><span class="line">1377</span><br><span class="line">1378</span><br><span class="line">1379</span><br><span class="line">1380</span><br><span class="line">1381</span><br><span class="line">1382</span><br><span class="line">1383</span><br><span class="line">1384</span><br><span class="line">1385</span><br><span class="line">1386</span><br><span class="line">1387</span><br><span class="line">1388</span><br><span class="line">1389</span><br><span class="line">1390</span><br><span class="line">1391</span><br><span class="line">1392</span><br><span class="line">1393</span><br><span class="line">1394</span><br><span class="line">1395</span><br><span class="line">1396</span><br><span class="line">1397</span><br><span class="line">1398</span><br><span class="line">1399</span><br><span class="line">1400</span><br><span class="line">1401</span><br><span class="line">1402</span><br><span class="line">1403</span><br><span class="line">1404</span><br><span class="line">1405</span><br><span class="line">1406</span><br><span class="line">1407</span><br><span class="line">1408</span><br><span class="line">1409</span><br><span class="line">1410</span><br><span class="line">1411</span><br><span class="line">1412</span><br><span class="line">1413</span><br><span class="line">1414</span><br><span class="line">1415</span><br><span class="line">1416</span><br><span class="line">1417</span><br><span class="line">1418</span><br><span class="line">1419</span><br><span class="line">1420</span><br><span class="line">1421</span><br><span class="line">1422</span><br><span class="line">1423</span><br><span class="line">1424</span><br><span class="line">1425</span><br><span class="line">1426</span><br><span class="line">1427</span><br><span class="line">1428</span><br><span class="line">1429</span><br><span class="line">1430</span><br><span class="line">1431</span><br><span class="line">1432</span><br><span class="line">1433</span><br><span class="line">1434</span><br><span class="line">1435</span><br><span class="line">1436</span><br><span class="line">1437</span><br><span class="line">1438</span><br><span class="line">1439</span><br><span class="line">1440</span><br><span class="line">1441</span><br><span class="line">1442</span><br><span class="line">1443</span><br><span class="line">1444</span><br><span class="line">1445</span><br><span class="line">1446</span><br><span class="line">1447</span><br><span class="line">1448</span><br><span class="line">1449</span><br><span class="line">1450</span><br><span class="line">1451</span><br><span class="line">1452</span><br><span class="line">1453</span><br><span class="line">1454</span><br><span class="line">1455</span><br><span class="line">1456</span><br><span class="line">1457</span><br><span class="line">1458</span><br><span class="line">1459</span><br><span class="line">1460</span><br><span class="line">1461</span><br><span class="line">1462</span><br><span class="line">1463</span><br><span class="line">1464</span><br><span class="line">1465</span><br><span class="line">1466</span><br><span class="line">1467</span><br><span class="line">1468</span><br><span class="line">1469</span><br><span class="line">1470</span><br><span class="line">1471</span><br><span class="line">1472</span><br><span class="line">1473</span><br><span class="line">1474</span><br><span class="line">1475</span><br><span class="line">1476</span><br><span class="line">1477</span><br><span class="line">1478</span><br><span class="line">1479</span><br><span class="line">1480</span><br><span class="line">1481</span><br><span class="line">1482</span><br><span class="line">1483</span><br><span class="line">1484</span><br><span class="line">1485</span><br><span class="line">1486</span><br><span class="line">1487</span><br><span class="line">1488</span><br><span class="line">1489</span><br><span class="line">1490</span><br><span class="line">1491</span><br><span class="line">1492</span><br><span class="line">1493</span><br><span class="line">1494</span><br><span class="line">1495</span><br><span class="line">1496</span><br><span class="line">1497</span><br><span class="line">1498</span><br><span class="line">1499</span><br><span class="line">1500</span><br><span class="line">1501</span><br><span class="line">1502</span><br><span class="line">1503</span><br><span class="line">1504</span><br><span class="line">1505</span><br><span class="line">1506</span><br><span class="line">1507</span><br><span class="line">1508</span><br><span class="line">1509</span><br><span class="line">1510</span><br><span class="line">1511</span><br><span class="line">1512</span><br><span class="line">1513</span><br><span class="line">1514</span><br><span class="line">1515</span><br><span class="line">1516</span><br><span class="line">1517</span><br><span class="line">1518</span><br><span class="line">1519</span><br><span class="line">1520</span><br><span class="line">1521</span><br><span class="line">1522</span><br><span class="line">1523</span><br><span class="line">1524</span><br><span class="line">1525</span><br><span class="line">1526</span><br><span class="line">1527</span><br><span class="line">1528</span><br><span class="line">1529</span><br><span class="line">1530</span><br><span class="line">1531</span><br><span class="line">1532</span><br><span class="line">1533</span><br><span class="line">1534</span><br><span class="line">1535</span><br><span class="line">1536</span><br><span class="line">1537</span><br><span class="line">1538</span><br><span class="line">1539</span><br><span class="line">1540</span><br><span class="line">1541</span><br><span class="line">1542</span><br><span class="line">1543</span><br><span class="line">1544</span><br><span class="line">1545</span><br><span class="line">1546</span><br><span class="line">1547</span><br><span class="line">1548</span><br><span class="line">1549</span><br><span class="line">1550</span><br><span class="line">1551</span><br><span class="line">1552</span><br><span class="line">1553</span><br><span class="line">1554</span><br><span class="line">1555</span><br><span class="line">1556</span><br><span class="line">1557</span><br><span class="line">1558</span><br><span class="line">1559</span><br><span class="line">1560</span><br><span class="line">1561</span><br><span class="line">1562</span><br><span class="line">1563</span><br><span class="line">1564</span><br><span class="line">1565</span><br><span class="line">1566</span><br><span class="line">1567</span><br><span class="line">1568</span><br><span class="line">1569</span><br><span class="line">1570</span><br><span class="line">1571</span><br><span class="line">1572</span><br><span class="line">1573</span><br><span class="line">1574</span><br><span class="line">1575</span><br><span class="line">1576</span><br><span class="line">1577</span><br><span class="line">1578</span><br><span class="line">1579</span><br><span class="line">1580</span><br><span class="line">1581</span><br><span class="line">1582</span><br><span class="line">1583</span><br><span class="line">1584</span><br><span class="line">1585</span><br><span class="line">1586</span><br><span class="line">1587</span><br><span class="line">1588</span><br><span class="line">1589</span><br><span class="line">1590</span><br><span class="line">1591</span><br><span class="line">1592</span><br><span class="line">1593</span><br><span class="line">1594</span><br><span class="line">1595</span><br><span class="line">1596</span><br><span class="line">1597</span><br><span class="line">1598</span><br><span class="line">1599</span><br><span class="line">1600</span><br><span class="line">1601</span><br><span class="line">1602</span><br><span class="line">1603</span><br><span class="line">1604</span><br><span class="line">1605</span><br><span class="line">1606</span><br><span class="line">1607</span><br><span class="line">1608</span><br><span class="line">1609</span><br><span class="line">1610</span><br><span class="line">1611</span><br><span class="line">1612</span><br><span class="line">1613</span><br><span class="line">1614</span><br><span class="line">1615</span><br><span class="line">1616</span><br><span class="line">1617</span><br><span class="line">1618</span><br><span class="line">1619</span><br><span class="line">1620</span><br><span class="line">1621</span><br><span class="line">1622</span><br><span class="line">1623</span><br><span class="line">1624</span><br><span class="line">1625</span><br><span class="line">1626</span><br><span class="line">1627</span><br><span class="line">1628</span><br><span class="line">1629</span><br><span class="line">1630</span><br><span class="line">1631</span><br><span class="line">1632</span><br><span class="line">1633</span><br><span class="line">1634</span><br><span class="line">1635</span><br><span class="line">1636</span><br><span class="line">1637</span><br><span class="line">1638</span><br><span class="line">1639</span><br><span class="line">1640</span><br><span class="line">1641</span><br><span class="line">1642</span><br><span class="line">1643</span><br><span class="line">1644</span><br><span class="line">1645</span><br><span class="line">1646</span><br><span class="line">1647</span><br><span class="line">1648</span><br><span class="line">1649</span><br><span class="line">1650</span><br><span class="line">1651</span><br><span class="line">1652</span><br><span class="line">1653</span><br><span class="line">1654</span><br><span class="line">1655</span><br><span class="line">1656</span><br><span class="line">1657</span><br><span class="line">1658</span><br><span class="line">1659</span><br><span class="line">1660</span><br><span class="line">1661</span><br><span class="line">1662</span><br><span class="line">1663</span><br><span class="line">1664</span><br><span class="line">1665</span><br><span class="line">1666</span><br><span class="line">1667</span><br><span class="line">1668</span><br><span class="line">1669</span><br><span class="line">1670</span><br><span class="line">1671</span><br><span class="line">1672</span><br><span class="line">1673</span><br><span class="line">1674</span><br><span class="line">1675</span><br><span class="line">1676</span><br><span class="line">1677</span><br><span class="line">1678</span><br><span class="line">1679</span><br><span class="line">1680</span><br><span class="line">1681</span><br><span class="line">1682</span><br><span class="line">1683</span><br><span class="line">1684</span><br><span class="line">1685</span><br><span class="line">1686</span><br><span class="line">1687</span><br><span class="line">1688</span><br><span class="line">1689</span><br><span class="line">1690</span><br><span class="line">1691</span><br><span class="line">1692</span><br><span class="line">1693</span><br><span class="line">1694</span><br><span class="line">1695</span><br><span class="line">1696</span><br><span class="line">1697</span><br><span class="line">1698</span><br><span class="line">1699</span><br><span class="line">1700</span><br><span class="line">1701</span><br><span class="line">1702</span><br><span class="line">1703</span><br><span class="line">1704</span><br><span class="line">1705</span><br><span class="line">1706</span><br><span class="line">1707</span><br><span class="line">1708</span><br><span class="line">1709</span><br><span class="line">1710</span><br><span class="line">1711</span><br><span class="line">1712</span><br><span class="line">1713</span><br><span class="line">1714</span><br><span class="line">1715</span><br><span class="line">1716</span><br><span class="line">1717</span><br><span class="line">1718</span><br><span class="line">1719</span><br><span class="line">1720</span><br><span class="line">1721</span><br><span class="line">1722</span><br><span class="line">1723</span><br><span class="line">1724</span><br><span class="line">1725</span><br><span class="line">1726</span><br><span class="line">1727</span><br><span class="line">1728</span><br><span class="line">1729</span><br><span class="line">1730</span><br><span class="line">1731</span><br><span class="line">1732</span><br><span class="line">1733</span><br><span class="line">1734</span><br><span class="line">1735</span><br><span class="line">1736</span><br><span class="line">1737</span><br><span class="line">1738</span><br><span class="line">1739</span><br><span class="line">1740</span><br><span class="line">1741</span><br><span class="line">1742</span><br><span class="line">1743</span><br><span class="line">1744</span><br><span class="line">1745</span><br><span class="line">1746</span><br><span class="line">1747</span><br><span class="line">1748</span><br><span class="line">1749</span><br><span class="line">1750</span><br><span class="line">1751</span><br><span class="line">1752</span><br><span class="line">1753</span><br><span class="line">1754</span><br><span class="line">1755</span><br><span class="line">1756</span><br><span class="line">1757</span><br><span class="line">1758</span><br><span class="line">1759</span><br><span class="line">1760</span><br><span class="line">1761</span><br><span class="line">1762</span><br><span class="line">1763</span><br><span class="line">1764</span><br><span class="line">1765</span><br><span class="line">1766</span><br><span class="line">1767</span><br><span class="line">1768</span><br><span class="line">1769</span><br><span class="line">1770</span><br><span class="line">1771</span><br><span class="line">1772</span><br><span class="line">1773</span><br><span class="line">1774</span><br><span class="line">1775</span><br><span class="line">1776</span><br><span class="line">1777</span><br><span class="line">1778</span><br><span class="line">1779</span><br><span class="line">1780</span><br><span class="line">1781</span><br><span class="line">1782</span><br><span class="line">1783</span><br><span class="line">1784</span><br><span class="line">1785</span><br><span class="line">1786</span><br><span class="line">1787</span><br><span class="line">1788</span><br><span class="line">1789</span><br><span class="line">1790</span><br><span class="line">1791</span><br><span class="line">1792</span><br><span class="line">1793</span><br><span class="line">1794</span><br><span class="line">1795</span><br><span class="line">1796</span><br><span class="line">1797</span><br><span class="line">1798</span><br><span class="line">1799</span><br><span class="line">1800</span><br><span class="line">1801</span><br><span class="line">1802</span><br><span class="line">1803</span><br><span class="line">1804</span><br><span class="line">1805</span><br><span class="line">1806</span><br><span class="line">1807</span><br><span class="line">1808</span><br><span class="line">1809</span><br><span class="line">1810</span><br><span class="line">1811</span><br><span class="line">1812</span><br><span class="line">1813</span><br><span class="line">1814</span><br><span class="line">1815</span><br><span class="line">1816</span><br><span class="line">1817</span><br><span class="line">1818</span><br><span class="line">1819</span><br><span class="line">1820</span><br><span class="line">1821</span><br><span class="line">1822</span><br><span class="line">1823</span><br><span class="line">1824</span><br><span class="line">1825</span><br><span class="line">1826</span><br><span class="line">1827</span><br><span class="line">1828</span><br><span class="line">1829</span><br><span class="line">1830</span><br><span class="line">1831</span><br><span class="line">1832</span><br><span class="line">1833</span><br><span class="line">1834</span><br><span class="line">1835</span><br><span class="line">1836</span><br><span class="line">1837</span><br><span class="line">1838</span><br><span class="line">1839</span><br><span class="line">1840</span><br><span class="line">1841</span><br><span class="line">1842</span><br><span class="line">1843</span><br><span class="line">1844</span><br><span class="line">1845</span><br><span class="line">1846</span><br><span class="line">1847</span><br><span class="line">1848</span><br><span class="line">1849</span><br><span class="line">1850</span><br><span class="line">1851</span><br><span class="line">1852</span><br><span class="line">1853</span><br><span class="line">1854</span><br><span class="line">1855</span><br><span class="line">1856</span><br><span class="line">1857</span><br><span class="line">1858</span><br><span class="line">1859</span><br><span class="line">1860</span><br><span class="line">1861</span><br><span class="line">1862</span><br><span class="line">1863</span><br><span class="line">1864</span><br><span class="line">1865</span><br><span class="line">1866</span><br><span class="line">1867</span><br><span class="line">1868</span><br><span class="line">1869</span><br><span class="line">1870</span><br><span class="line">1871</span><br><span class="line">1872</span><br><span class="line">1873</span><br><span class="line">1874</span><br><span class="line">1875</span><br><span class="line">1876</span><br><span class="line">1877</span><br><span class="line">1878</span><br><span class="line">1879</span><br><span class="line">1880</span><br><span class="line">1881</span><br><span class="line">1882</span><br><span class="line">1883</span><br><span class="line">1884</span><br><span class="line">1885</span><br><span class="line">1886</span><br><span class="line">1887</span><br><span class="line">1888</span><br><span class="line">1889</span><br><span class="line">1890</span><br><span class="line">1891</span><br><span class="line">1892</span><br><span class="line">1893</span><br><span class="line">1894</span><br><span class="line">1895</span><br><span class="line">1896</span><br><span class="line">1897</span><br><span class="line">1898</span><br><span class="line">1899</span><br><span class="line">1900</span><br><span class="line">1901</span><br><span class="line">1902</span><br><span class="line">1903</span><br><span class="line">1904</span><br><span class="line">1905</span><br><span class="line">1906</span><br><span class="line">1907</span><br><span class="line">1908</span><br><span class="line">1909</span><br><span class="line">1910</span><br><span class="line">1911</span><br><span class="line">1912</span><br><span class="line">1913</span><br><span class="line">1914</span><br><span class="line">1915</span><br><span class="line">1916</span><br><span class="line">1917</span><br><span class="line">1918</span><br><span class="line">1919</span><br><span class="line">1920</span><br><span class="line">1921</span><br><span class="line">1922</span><br><span class="line">1923</span><br><span class="line">1924</span><br><span class="line">1925</span><br><span class="line">1926</span><br><span class="line">1927</span><br><span class="line">1928</span><br><span class="line">1929</span><br><span class="line">1930</span><br><span class="line">1931</span><br><span class="line">1932</span><br><span class="line">1933</span><br><span class="line">1934</span><br><span class="line">1935</span><br><span class="line">1936</span><br><span class="line">1937</span><br><span class="line">1938</span><br><span class="line">1939</span><br><span class="line">1940</span><br><span class="line">1941</span><br><span class="line">1942</span><br><span class="line">1943</span><br><span class="line">1944</span><br><span class="line">1945</span><br><span class="line">1946</span><br><span class="line">1947</span><br><span class="line">1948</span><br><span class="line">1949</span><br><span class="line">1950</span><br><span class="line">1951</span><br><span class="line">1952</span><br><span class="line">1953</span><br><span class="line">1954</span><br><span class="line">1955</span><br><span class="line">1956</span><br><span class="line">1957</span><br><span class="line">1958</span><br><span class="line">1959</span><br><span class="line">1960</span><br><span class="line">1961</span><br><span class="line">1962</span><br><span class="line">1963</span><br><span class="line">1964</span><br><span class="line">1965</span><br><span class="line">1966</span><br><span class="line">1967</span><br><span class="line">1968</span><br><span class="line">1969</span><br><span class="line">1970</span><br><span class="line">1971</span><br><span class="line">1972</span><br><span class="line">1973</span><br><span class="line">1974</span><br><span class="line">1975</span><br><span class="line">1976</span><br><span class="line">1977</span><br><span class="line">1978</span><br><span class="line">1979</span><br><span class="line">1980</span><br><span class="line">1981</span><br><span class="line">1982</span><br><span class="line">1983</span><br><span class="line">1984</span><br><span class="line">1985</span><br><span class="line">1986</span><br><span class="line">1987</span><br><span class="line">1988</span><br><span class="line">1989</span><br><span class="line">1990</span><br><span class="line">1991</span><br><span class="line">1992</span><br><span class="line">1993</span><br><span class="line">1994</span><br><span class="line">1995</span><br><span class="line">1996</span><br><span class="line">1997</span><br><span class="line">1998</span><br><span class="line">1999</span><br><span class="line">2000</span><br><span class="line">2001</span><br><span class="line">2002</span><br><span class="line">2003</span><br><span class="line">2004</span><br><span class="line">2005</span><br><span class="line">2006</span><br><span class="line">2007</span><br><span class="line">2008</span><br><span class="line">2009</span><br><span class="line">2010</span><br><span class="line">2011</span><br><span class="line">2012</span><br><span class="line">2013</span><br><span class="line">2014</span><br><span class="line">2015</span><br><span class="line">2016</span><br><span class="line">2017</span><br><span class="line">2018</span><br><span class="line">2019</span><br><span class="line">2020</span><br><span class="line">2021</span><br><span class="line">2022</span><br><span class="line">2023</span><br><span class="line">2024</span><br><span class="line">2025</span><br><span class="line">2026</span><br><span class="line">2027</span><br><span class="line">2028</span><br><span class="line">2029</span><br><span class="line">2030</span><br><span class="line">2031</span><br><span class="line">2032</span><br><span class="line">2033</span><br><span class="line">2034</span><br><span class="line">2035</span><br><span class="line">2036</span><br><span class="line">2037</span><br><span class="line">2038</span><br><span class="line">2039</span><br><span class="line">2040</span><br><span class="line">2041</span><br><span class="line">2042</span><br><span class="line">2043</span><br><span class="line">2044</span><br><span class="line">2045</span><br><span class="line">2046</span><br><span class="line">2047</span><br><span class="line">2048</span><br><span class="line">2049</span><br><span class="line">2050</span><br><span class="line">2051</span><br><span class="line">2052</span><br><span class="line">2053</span><br><span class="line">2054</span><br><span class="line">2055</span><br><span class="line">2056</span><br><span class="line">2057</span><br><span class="line">2058</span><br><span class="line">2059</span><br><span class="line">2060</span><br><span class="line">2061</span><br><span class="line">2062</span><br><span class="line">2063</span><br><span class="line">2064</span><br><span class="line">2065</span><br><span class="line">2066</span><br><span class="line">2067</span><br><span class="line">2068</span><br><span class="line">2069</span><br><span class="line">2070</span><br><span class="line">2071</span><br><span class="line">2072</span><br><span class="line">2073</span><br><span class="line">2074</span><br><span class="line">2075</span><br><span class="line">2076</span><br><span class="line">2077</span><br><span class="line">2078</span><br><span class="line">2079</span><br><span class="line">2080</span><br><span class="line">2081</span><br><span class="line">2082</span><br><span class="line">2083</span><br><span class="line">2084</span><br><span class="line">2085</span><br><span class="line">2086</span><br><span class="line">2087</span><br><span class="line">2088</span><br><span class="line">2089</span><br><span class="line">2090</span><br><span class="line">2091</span><br><span class="line">2092</span><br><span class="line">2093</span><br><span class="line">2094</span><br><span class="line">2095</span><br><span class="line">2096</span><br><span class="line">2097</span><br><span class="line">2098</span><br><span class="line">2099</span><br><span class="line">2100</span><br><span class="line">2101</span><br><span class="line">2102</span><br><span class="line">2103</span><br><span class="line">2104</span><br><span class="line">2105</span><br><span class="line">2106</span><br><span class="line">2107</span><br><span class="line">2108</span><br><span class="line">2109</span><br><span class="line">2110</span><br><span class="line">2111</span><br><span class="line">2112</span><br><span class="line">2113</span><br><span class="line">2114</span><br><span class="line">2115</span><br><span class="line">2116</span><br><span class="line">2117</span><br><span class="line">2118</span><br><span class="line">2119</span><br><span class="line">2120</span><br><span class="line">2121</span><br><span class="line">2122</span><br><span class="line">2123</span><br><span class="line">2124</span><br><span class="line">2125</span><br><span class="line">2126</span><br><span class="line">2127</span><br><span class="line">2128</span><br><span class="line">2129</span><br><span class="line">2130</span><br><span class="line">2131</span><br><span class="line">2132</span><br><span class="line">2133</span><br><span class="line">2134</span><br><span class="line">2135</span><br><span class="line">2136</span><br><span class="line">2137</span><br><span class="line">2138</span><br><span class="line">2139</span><br><span class="line">2140</span><br><span class="line">2141</span><br><span class="line">2142</span><br><span class="line">2143</span><br><span class="line">2144</span><br><span class="line">2145</span><br><span class="line">2146</span><br><span class="line">2147</span><br><span class="line">2148</span><br><span class="line">2149</span><br><span class="line">2150</span><br><span class="line">2151</span><br><span class="line">2152</span><br><span class="line">2153</span><br><span class="line">2154</span><br><span class="line">2155</span><br><span class="line">2156</span><br><span class="line">2157</span><br><span class="line">2158</span><br><span class="line">2159</span><br><span class="line">2160</span><br><span class="line">2161</span><br><span class="line">2162</span><br><span class="line">2163</span><br><span class="line">2164</span><br><span class="line">2165</span><br><span class="line">2166</span><br><span class="line">2167</span><br><span class="line">2168</span><br><span class="line">2169</span><br><span class="line">2170</span><br><span class="line">2171</span><br><span class="line">2172</span><br><span class="line">2173</span><br><span class="line">2174</span><br><span class="line">2175</span><br><span class="line">2176</span><br><span class="line">2177</span><br><span class="line">2178</span><br><span class="line">2179</span><br><span class="line">2180</span><br><span class="line">2181</span><br><span class="line">2182</span><br><span class="line">2183</span><br><span class="line">2184</span><br><span class="line">2185</span><br><span class="line">2186</span><br><span class="line">2187</span><br><span class="line">2188</span><br><span class="line">2189</span><br><span class="line">2190</span><br><span class="line">2191</span><br><span class="line">2192</span><br><span class="line">2193</span><br><span class="line">2194</span><br><span class="line">2195</span><br><span class="line">2196</span><br><span class="line">2197</span><br><span class="line">2198</span><br><span class="line">2199</span><br><span class="line">2200</span><br><span class="line">2201</span><br><span class="line">2202</span><br><span class="line">2203</span><br><span class="line">2204</span><br><span class="line">2205</span><br><span class="line">2206</span><br><span class="line">2207</span><br><span class="line">2208</span><br><span class="line">2209</span><br><span class="line">2210</span><br><span class="line">2211</span><br><span class="line">2212</span><br><span class="line">2213</span><br><span class="line">2214</span><br><span class="line">2215</span><br><span class="line">2216</span><br><span class="line">2217</span><br><span class="line">2218</span><br><span class="line">2219</span><br><span class="line">2220</span><br><span class="line">2221</span><br><span class="line">2222</span><br><span class="line">2223</span><br><span class="line">2224</span><br><span class="line">2225</span><br><span class="line">2226</span><br><span class="line">2227</span><br><span class="line">2228</span><br><span class="line">2229</span><br><span class="line">2230</span><br><span class="line">2231</span><br><span class="line">2232</span><br><span class="line">2233</span><br><span class="line">2234</span><br><span class="line">2235</span><br><span class="line">2236</span><br><span class="line">2237</span><br><span class="line">2238</span><br><span class="line">2239</span><br><span class="line">2240</span><br><span class="line">2241</span><br><span class="line">2242</span><br><span class="line">2243</span><br><span class="line">2244</span><br><span class="line">2245</span><br><span class="line">2246</span><br><span class="line">2247</span><br><span class="line">2248</span><br><span class="line">2249</span><br><span class="line">2250</span><br><span class="line">2251</span><br><span class="line">2252</span><br><span class="line">2253</span><br><span class="line">2254</span><br><span class="line">2255</span><br><span class="line">2256</span><br><span class="line">2257</span><br><span class="line">2258</span><br><span class="line">2259</span><br><span class="line">2260</span><br><span class="line">2261</span><br><span class="line">2262</span><br><span class="line">2263</span><br><span class="line">2264</span><br><span class="line">2265</span><br><span class="line">2266</span><br><span class="line">2267</span><br><span class="line">2268</span><br><span class="line">2269</span><br><span class="line">2270</span><br><span class="line">2271</span><br><span class="line">2272</span><br><span class="line">2273</span><br><span class="line">2274</span><br><span class="line">2275</span><br><span class="line">2276</span><br><span class="line">2277</span><br><span class="line">2278</span><br><span class="line">2279</span><br><span class="line">2280</span><br><span class="line">2281</span><br><span class="line">2282</span><br><span class="line">2283</span><br><span class="line">2284</span><br><span class="line">2285</span><br><span class="line">2286</span><br><span class="line">2287</span><br><span class="line">2288</span><br><span class="line">2289</span><br><span class="line">2290</span><br><span class="line">2291</span><br><span class="line">2292</span><br><span class="line">2293</span><br><span class="line">2294</span><br><span class="line">2295</span><br><span class="line">2296</span><br><span class="line">2297</span><br><span class="line">2298</span><br><span class="line">2299</span><br><span class="line">2300</span><br><span class="line">2301</span><br><span class="line">2302</span><br><span class="line">2303</span><br><span class="line">2304</span><br><span class="line">2305</span><br><span class="line">2306</span><br><span class="line">2307</span><br><span class="line">2308</span><br><span class="line">2309</span><br><span class="line">2310</span><br><span class="line">2311</span><br><span class="line">2312</span><br><span class="line">2313</span><br><span class="line">2314</span><br><span class="line">2315</span><br><span class="line">2316</span><br><span class="line">2317</span><br><span class="line">2318</span><br><span class="line">2319</span><br><span class="line">2320</span><br><span class="line">2321</span><br><span class="line">2322</span><br><span class="line">2323</span><br><span class="line">2324</span><br><span class="line">2325</span><br><span class="line">2326</span><br><span class="line">2327</span><br><span class="line">2328</span><br><span class="line">2329</span><br><span class="line">2330</span><br><span class="line">2331</span><br><span class="line">2332</span><br><span class="line">2333</span><br><span class="line">2334</span><br><span class="line">2335</span><br><span class="line">2336</span><br><span class="line">2337</span><br><span class="line">2338</span><br><span class="line">2339</span><br><span class="line">2340</span><br><span class="line">2341</span><br><span class="line">2342</span><br><span class="line">2343</span><br><span class="line">2344</span><br><span class="line">2345</span><br><span class="line">2346</span><br><span class="line">2347</span><br><span class="line">2348</span><br><span class="line">2349</span><br><span class="line">2350</span><br><span class="line">2351</span><br><span class="line">2352</span><br><span class="line">2353</span><br><span class="line">2354</span><br><span class="line">2355</span><br><span class="line">2356</span><br><span class="line">2357</span><br><span class="line">2358</span><br><span class="line">2359</span><br><span class="line">2360</span><br><span class="line">2361</span><br><span class="line">2362</span><br><span class="line">2363</span><br><span class="line">2364</span><br><span class="line">2365</span><br><span class="line">2366</span><br><span class="line">2367</span><br><span class="line">2368</span><br><span class="line">2369</span><br><span class="line">2370</span><br><span class="line">2371</span><br><span class="line">2372</span><br><span class="line">2373</span><br><span class="line">2374</span><br><span class="line">2375</span><br><span class="line">2376</span><br><span class="line">2377</span><br><span class="line">2378</span><br><span class="line">2379</span><br><span class="line">2380</span><br><span class="line">2381</span><br><span class="line">2382</span><br><span class="line">2383</span><br><span class="line">2384</span><br><span class="line">2385</span><br><span class="line">2386</span><br><span class="line">2387</span><br><span class="line">2388</span><br><span class="line">2389</span><br><span class="line">2390</span><br><span class="line">2391</span><br><span class="line">2392</span><br><span class="line">2393</span><br><span class="line">2394</span><br><span class="line">2395</span><br><span class="line">2396</span><br><span class="line">2397</span><br><span class="line">2398</span><br><span class="line">2399</span><br><span class="line">2400</span><br><span class="line">2401</span><br><span class="line">2402</span><br><span class="line">2403</span><br><span class="line">2404</span><br><span class="line">2405</span><br><span class="line">2406</span><br><span class="line">2407</span><br><span class="line">2408</span><br><span class="line">2409</span><br><span class="line">2410</span><br><span class="line">2411</span><br><span class="line">2412</span><br><span class="line">2413</span><br><span class="line">2414</span><br><span class="line">2415</span><br><span class="line">2416</span><br><span class="line">2417</span><br><span class="line">2418</span><br><span class="line">2419</span><br><span class="line">2420</span><br><span class="line">2421</span><br><span class="line">2422</span><br><span class="line">2423</span><br><span class="line">2424</span><br><span class="line">2425</span><br><span class="line">2426</span><br><span class="line">2427</span><br><span class="line">2428</span><br><span class="line">2429</span><br><span class="line">2430</span><br><span class="line">2431</span><br><span class="line">2432</span><br><span class="line">2433</span><br><span class="line">2434</span><br><span class="line">2435</span><br><span class="line">2436</span><br><span class="line">2437</span><br><span class="line">2438</span><br><span class="line">2439</span><br><span class="line">2440</span><br><span class="line">2441</span><br><span class="line">2442</span><br><span class="line">2443</span><br><span class="line">2444</span><br><span class="line">2445</span><br><span class="line">2446</span><br><span class="line">2447</span><br><span class="line">2448</span><br><span class="line">2449</span><br><span class="line">2450</span><br><span class="line">2451</span><br><span class="line">2452</span><br><span class="line">2453</span><br><span class="line">2454</span><br><span class="line">2455</span><br><span class="line">2456</span><br><span class="line">2457</span><br><span class="line">2458</span><br><span class="line">2459</span><br><span class="line">2460</span><br><span class="line">2461</span><br><span class="line">2462</span><br><span class="line">2463</span><br><span class="line">2464</span><br><span class="line">2465</span><br><span class="line">2466</span><br><span class="line">2467</span><br><span class="line">2468</span><br><span class="line">2469</span><br><span class="line">2470</span><br><span class="line">2471</span><br><span class="line">2472</span><br><span class="line">2473</span><br><span class="line">2474</span><br><span class="line">2475</span><br><span class="line">2476</span><br><span class="line">2477</span><br><span class="line">2478</span><br><span class="line">2479</span><br><span class="line">2480</span><br><span class="line">2481</span><br><span class="line">2482</span><br><span class="line">2483</span><br><span class="line">2484</span><br><span class="line">2485</span><br><span class="line">2486</span><br><span class="line">2487</span><br><span class="line">2488</span><br><span class="line">2489</span><br><span class="line">2490</span><br><span class="line">2491</span><br><span class="line">2492</span><br><span class="line">2493</span><br><span class="line">2494</span><br><span class="line">2495</span><br><span class="line">2496</span><br><span class="line">2497</span><br><span class="line">2498</span><br><span class="line">2499</span><br><span class="line">2500</span><br><span class="line">2501</span><br><span class="line">2502</span><br><span class="line">2503</span><br><span class="line">2504</span><br><span class="line">2505</span><br><span class="line">2506</span><br><span class="line">2507</span><br><span class="line">2508</span><br><span class="line">2509</span><br><span class="line">2510</span><br><span class="line">2511</span><br><span class="line">2512</span><br><span class="line">2513</span><br><span class="line">2514</span><br><span class="line">2515</span><br><span class="line">2516</span><br><span class="line">2517</span><br><span class="line">2518</span><br><span class="line">2519</span><br><span class="line">2520</span><br><span class="line">2521</span><br><span class="line">2522</span><br><span class="line">2523</span><br><span class="line">2524</span><br><span class="line">2525</span><br><span class="line">2526</span><br><span class="line">2527</span><br><span class="line">2528</span><br><span class="line">2529</span><br><span class="line">2530</span><br><span class="line">2531</span><br><span class="line">2532</span><br><span class="line">2533</span><br><span class="line">2534</span><br><span class="line">2535</span><br><span class="line">2536</span><br><span class="line">2537</span><br><span class="line">2538</span><br><span class="line">2539</span><br><span class="line">2540</span><br><span class="line">2541</span><br><span class="line">2542</span><br><span class="line">2543</span><br><span class="line">2544</span><br><span class="line">2545</span><br><span class="line">2546</span><br><span class="line">2547</span><br><span class="line">2548</span><br><span class="line">2549</span><br><span class="line">2550</span><br><span class="line">2551</span><br><span class="line">2552</span><br><span class="line">2553</span><br><span class="line">2554</span><br><span class="line">2555</span><br><span class="line">2556</span><br><span class="line">2557</span><br><span class="line">2558</span><br><span class="line">2559</span><br><span class="line">2560</span><br><span class="line">2561</span><br><span class="line">2562</span><br><span class="line">2563</span><br><span class="line">2564</span><br><span class="line">2565</span><br><span class="line">2566</span><br><span class="line">2567</span><br><span class="line">2568</span><br><span class="line">2569</span><br><span class="line">2570</span><br><span class="line">2571</span><br><span class="line">2572</span><br><span class="line">2573</span><br><span class="line">2574</span><br><span class="line">2575</span><br><span class="line">2576</span><br><span class="line">2577</span><br><span class="line">2578</span><br><span class="line">2579</span><br><span class="line">2580</span><br><span class="line">2581</span><br><span class="line">2582</span><br><span class="line">2583</span><br><span class="line">2584</span><br><span class="line">2585</span><br><span class="line">2586</span><br><span class="line">2587</span><br><span class="line">2588</span><br><span class="line">2589</span><br><span class="line">2590</span><br><span class="line">2591</span><br><span class="line">2592</span><br><span class="line">2593</span><br><span class="line">2594</span><br><span class="line">2595</span><br><span class="line">2596</span><br><span class="line">2597</span><br><span class="line">2598</span><br><span class="line">2599</span><br><span class="line">2600</span><br><span class="line">2601</span><br><span class="line">2602</span><br><span class="line">2603</span><br><span class="line">2604</span><br><span class="line">2605</span><br><span class="line">2606</span><br><span class="line">2607</span><br><span class="line">2608</span><br><span class="line">2609</span><br><span class="line">2610</span><br><span class="line">2611</span><br><span class="line">2612</span><br><span class="line">2613</span><br><span class="line">2614</span><br><span class="line">2615</span><br><span class="line">2616</span><br><span class="line">2617</span><br><span class="line">2618</span><br><span class="line">2619</span><br><span class="line">2620</span><br><span class="line">2621</span><br><span class="line">2622</span><br><span class="line">2623</span><br><span class="line">2624</span><br><span class="line">2625</span><br><span class="line">2626</span><br><span class="line">2627</span><br><span class="line">2628</span><br><span class="line">2629</span><br><span class="line">2630</span><br><span class="line">2631</span><br><span class="line">2632</span><br><span class="line">2633</span><br><span class="line">2634</span><br><span class="line">2635</span><br><span class="line">2636</span><br><span class="line">2637</span><br><span class="line">2638</span><br><span class="line">2639</span><br><span class="line">2640</span><br><span class="line">2641</span><br><span class="line">2642</span><br><span class="line">2643</span><br><span class="line">2644</span><br><span class="line">2645</span><br><span class="line">2646</span><br><span class="line">2647</span><br><span class="line">2648</span><br><span class="line">2649</span><br><span class="line">2650</span><br><span class="line">2651</span><br><span class="line">2652</span><br><span class="line">2653</span><br><span class="line">2654</span><br><span class="line">2655</span><br><span class="line">2656</span><br><span class="line">2657</span><br><span class="line">2658</span><br><span class="line">2659</span><br><span class="line">2660</span><br><span class="line">2661</span><br><span class="line">2662</span><br><span class="line">2663</span><br><span class="line">2664</span><br><span class="line">2665</span><br><span class="line">2666</span><br><span class="line">2667</span><br><span class="line">2668</span><br><span class="line">2669</span><br><span class="line">2670</span><br><span class="line">2671</span><br><span class="line">2672</span><br><span class="line">2673</span><br><span class="line">2674</span><br><span class="line">2675</span><br><span class="line">2676</span><br><span class="line">2677</span><br><span class="line">2678</span><br><span class="line">2679</span><br><span class="line">2680</span><br><span class="line">2681</span><br><span class="line">2682</span><br><span class="line">2683</span><br><span class="line">2684</span><br><span class="line">2685</span><br><span class="line">2686</span><br><span class="line">2687</span><br><span class="line">2688</span><br><span class="line">2689</span><br><span class="line">2690</span><br><span class="line">2691</span><br><span class="line">2692</span><br><span class="line">2693</span><br><span class="line">2694</span><br><span class="line">2695</span><br><span class="line">2696</span><br><span class="line">2697</span><br><span class="line">2698</span><br><span class="line">2699</span><br><span class="line">2700</span><br><span class="line">2701</span><br><span class="line">2702</span><br><span class="line">2703</span><br><span class="line">2704</span><br><span class="line">2705</span><br><span class="line">2706</span><br><span class="line">2707</span><br><span class="line">2708</span><br><span class="line">2709</span><br><span class="line">2710</span><br><span class="line">2711</span><br><span class="line">2712</span><br><span class="line">2713</span><br><span class="line">2714</span><br><span class="line">2715</span><br><span class="line">2716</span><br><span class="line">2717</span><br><span class="line">2718</span><br><span class="line">2719</span><br><span class="line">2720</span><br><span class="line">2721</span><br><span class="line">2722</span><br><span class="line">2723</span><br><span class="line">2724</span><br><span class="line">2725</span><br><span class="line">2726</span><br><span class="line">2727</span><br><span class="line">2728</span><br><span class="line">2729</span><br><span class="line">2730</span><br><span class="line">2731</span><br><span class="line">2732</span><br><span class="line">2733</span><br><span class="line">2734</span><br><span class="line">2735</span><br><span class="line">2736</span><br><span class="line">2737</span><br><span class="line">2738</span><br><span class="line">2739</span><br><span class="line">2740</span><br><span class="line">2741</span><br><span class="line">2742</span><br><span class="line">2743</span><br><span class="line">2744</span><br><span class="line">2745</span><br><span class="line">2746</span><br><span class="line">2747</span><br><span class="line">2748</span><br><span class="line">2749</span><br><span class="line">2750</span><br><span class="line">2751</span><br><span class="line">2752</span><br><span class="line">2753</span><br><span class="line">2754</span><br><span class="line">2755</span><br><span class="line">2756</span><br><span class="line">2757</span><br><span class="line">2758</span><br><span class="line">2759</span><br><span class="line">2760</span><br><span class="line">2761</span><br><span class="line">2762</span><br><span class="line">2763</span><br><span class="line">2764</span><br><span class="line">2765</span><br><span class="line">2766</span><br><span class="line">2767</span><br><span class="line">2768</span><br><span class="line">2769</span><br><span class="line">2770</span><br><span class="line">2771</span><br><span class="line">2772</span><br><span class="line">2773</span><br><span class="line">2774</span><br><span class="line">2775</span><br><span class="line">2776</span><br><span class="line">2777</span><br><span class="line">2778</span><br><span class="line">2779</span><br><span class="line">2780</span><br><span class="line">2781</span><br><span class="line">2782</span><br><span class="line">2783</span><br><span class="line">2784</span><br><span class="line">2785</span><br><span class="line">2786</span><br><span class="line">2787</span><br><span class="line">2788</span><br><span class="line">2789</span><br><span class="line">2790</span><br><span class="line">2791</span><br><span class="line">2792</span><br><span class="line">2793</span><br><span class="line">2794</span><br><span class="line">2795</span><br><span class="line">2796</span><br><span class="line">2797</span><br><span class="line">2798</span><br><span class="line">2799</span><br><span class="line">2800</span><br><span class="line">2801</span><br><span class="line">2802</span><br><span class="line">2803</span><br><span class="line">2804</span><br><span class="line">2805</span><br><span class="line">2806</span><br><span class="line">2807</span><br><span class="line">2808</span><br><span class="line">2809</span><br><span class="line">2810</span><br><span class="line">2811</span><br><span class="line">2812</span><br><span class="line">2813</span><br><span class="line">2814</span><br><span class="line">2815</span><br><span class="line">2816</span><br><span class="line">2817</span><br><span class="line">2818</span><br><span class="line">2819</span><br><span class="line">2820</span><br><span class="line">2821</span><br><span class="line">2822</span><br><span class="line">2823</span><br><span class="line">2824</span><br><span class="line">2825</span><br><span class="line">2826</span><br><span class="line">2827</span><br><span class="line">2828</span><br><span class="line">2829</span><br><span class="line">2830</span><br><span class="line">2831</span><br><span class="line">2832</span><br><span class="line">2833</span><br><span class="line">2834</span><br><span class="line">2835</span><br><span class="line">2836</span><br><span class="line">2837</span><br><span class="line">2838</span><br><span class="line">2839</span><br><span class="line">2840</span><br><span class="line">2841</span><br><span class="line">2842</span><br><span class="line">2843</span><br><span class="line">2844</span><br><span class="line">2845</span><br><span class="line">2846</span><br><span class="line">2847</span><br><span class="line">2848</span><br><span class="line">2849</span><br><span class="line">2850</span><br><span class="line">2851</span><br><span class="line">2852</span><br><span class="line">2853</span><br><span class="line">2854</span><br><span class="line">2855</span><br><span class="line">2856</span><br><span class="line">2857</span><br><span class="line">2858</span><br><span class="line">2859</span><br><span class="line">2860</span><br><span class="line">2861</span><br><span class="line">2862</span><br><span class="line">2863</span><br><span class="line">2864</span><br><span class="line">2865</span><br><span class="line">2866</span><br><span class="line">2867</span><br><span class="line">2868</span><br><span class="line">2869</span><br><span class="line">2870</span><br><span class="line">2871</span><br><span class="line">2872</span><br><span class="line">2873</span><br><span class="line">2874</span><br><span class="line">2875</span><br><span class="line">2876</span><br><span class="line">2877</span><br><span class="line">2878</span><br><span class="line">2879</span><br><span class="line">2880</span><br><span class="line">2881</span><br><span class="line">2882</span><br><span class="line">2883</span><br><span class="line">2884</span><br><span class="line">2885</span><br><span class="line">2886</span><br><span class="line">2887</span><br><span class="line">2888</span><br><span class="line">2889</span><br><span class="line">2890</span><br><span class="line">2891</span><br><span class="line">2892</span><br><span class="line">2893</span><br><span class="line">2894</span><br><span class="line">2895</span><br><span class="line">2896</span><br><span class="line">2897</span><br><span class="line">2898</span><br><span class="line">2899</span><br><span class="line">2900</span><br><span class="line">2901</span><br><span class="line">2902</span><br><span class="line">2903</span><br><span class="line">2904</span><br><span class="line">2905</span><br><span class="line">2906</span><br><span class="line">2907</span><br><span class="line">2908</span><br><span class="line">2909</span><br><span class="line">2910</span><br><span class="line">2911</span><br><span class="line">2912</span><br><span class="line">2913</span><br><span class="line">2914</span><br><span class="line">2915</span><br><span class="line">2916</span><br><span class="line">2917</span><br><span class="line">2918</span><br><span class="line">2919</span><br><span class="line">2920</span><br><span class="line">2921</span><br><span class="line">2922</span><br><span class="line">2923</span><br><span class="line">2924</span><br><span class="line">2925</span><br><span class="line">2926</span><br><span class="line">2927</span><br><span class="line">2928</span><br><span class="line">2929</span><br><span class="line">2930</span><br><span class="line">2931</span><br><span class="line">2932</span><br><span class="line">2933</span><br><span class="line">2934</span><br><span class="line">2935</span><br><span class="line">2936</span><br><span class="line">2937</span><br><span class="line">2938</span><br><span class="line">2939</span><br><span class="line">2940</span><br><span class="line">2941</span><br><span class="line">2942</span><br><span class="line">2943</span><br><span class="line">2944</span><br><span class="line">2945</span><br><span class="line">2946</span><br><span class="line">2947</span><br><span class="line">2948</span><br><span class="line">2949</span><br><span class="line">2950</span><br><span class="line">2951</span><br><span class="line">2952</span><br><span class="line">2953</span><br><span class="line">2954</span><br><span class="line">2955</span><br><span class="line">2956</span><br><span class="line">2957</span><br><span class="line">2958</span><br><span class="line">2959</span><br><span class="line">2960</span><br><span class="line">2961</span><br><span class="line">2962</span><br><span class="line">2963</span><br><span class="line">2964</span><br><span class="line">2965</span><br><span class="line">2966</span><br><span class="line">2967</span><br><span class="line">2968</span><br><span class="line">2969</span><br><span class="line">2970</span><br><span class="line">2971</span><br><span class="line">2972</span><br><span class="line">2973</span><br><span class="line">2974</span><br><span class="line">2975</span><br><span class="line">2976</span><br><span class="line">2977</span><br><span class="line">2978</span><br><span class="line">2979</span><br><span class="line">2980</span><br><span class="line">2981</span><br><span class="line">2982</span><br><span class="line">2983</span><br><span class="line">2984</span><br><span class="line">2985</span><br><span class="line">2986</span><br><span class="line">2987</span><br><span class="line">2988</span><br><span class="line">2989</span><br><span class="line">2990</span><br><span class="line">2991</span><br><span class="line">2992</span><br><span class="line">2993</span><br><span class="line">2994</span><br><span class="line">2995</span><br><span class="line">2996</span><br><span class="line">2997</span><br><span class="line">2998</span><br><span class="line">2999</span><br><span class="line">3000</span><br><span class="line">3001</span><br><span class="line">3002</span><br><span class="line">3003</span><br><span class="line">3004</span><br><span class="line">3005</span><br><span class="line">3006</span><br><span class="line">3007</span><br><span class="line">3008</span><br><span class="line">3009</span><br><span class="line">3010</span><br><span class="line">3011</span><br><span class="line">3012</span><br><span class="line">3013</span><br><span class="line">3014</span><br><span class="line">3015</span><br><span class="line">3016</span><br><span class="line">3017</span><br><span class="line">3018</span><br><span class="line">3019</span><br><span class="line">3020</span><br><span class="line">3021</span><br><span class="line">3022</span><br><span class="line">3023</span><br><span class="line">3024</span><br><span class="line">3025</span><br><span class="line">3026</span><br><span class="line">3027</span><br><span class="line">3028</span><br><span class="line">3029</span><br><span class="line">3030</span><br><span class="line">3031</span><br><span class="line">3032</span><br><span class="line">3033</span><br><span class="line">3034</span><br><span class="line">3035</span><br><span class="line">3036</span><br><span class="line">3037</span><br><span class="line">3038</span><br><span class="line">3039</span><br><span class="line">3040</span><br><span class="line">3041</span><br><span class="line">3042</span><br><span class="line">3043</span><br><span class="line">3044</span><br><span class="line">3045</span><br><span class="line">3046</span><br><span class="line">3047</span><br><span class="line">3048</span><br><span class="line">3049</span><br><span class="line">3050</span><br><span class="line">3051</span><br><span class="line">3052</span><br><span class="line">3053</span><br><span class="line">3054</span><br><span class="line">3055</span><br><span class="line">3056</span><br><span class="line">3057</span><br><span class="line">3058</span><br><span class="line">3059</span><br><span class="line">3060</span><br><span class="line">3061</span><br><span class="line">3062</span><br><span class="line">3063</span><br><span class="line">3064</span><br><span class="line">3065</span><br><span class="line">3066</span><br><span class="line">3067</span><br><span class="line">3068</span><br><span class="line">3069</span><br><span class="line">3070</span><br><span class="line">3071</span><br><span class="line">3072</span><br><span class="line">3073</span><br><span class="line">3074</span><br><span class="line">3075</span><br><span class="line">3076</span><br><span class="line">3077</span><br><span class="line">3078</span><br><span class="line">3079</span><br><span class="line">3080</span><br><span class="line">3081</span><br><span class="line">3082</span><br><span class="line">3083</span><br><span class="line">3084</span><br><span class="line">3085</span><br><span class="line">3086</span><br><span class="line">3087</span><br><span class="line">3088</span><br><span class="line">3089</span><br><span class="line">3090</span><br><span class="line">3091</span><br><span class="line">3092</span><br><span class="line">3093</span><br><span class="line">3094</span><br><span class="line">3095</span><br><span class="line">3096</span><br><span class="line">3097</span><br><span class="line">3098</span><br><span class="line">3099</span><br><span class="line">3100</span><br><span class="line">3101</span><br><span class="line">3102</span><br><span class="line">3103</span><br><span class="line">3104</span><br><span class="line">3105</span><br><span class="line">3106</span><br><span class="line">3107</span><br><span class="line">3108</span><br><span class="line">3109</span><br><span class="line">3110</span><br><span class="line">3111</span><br><span class="line">3112</span><br><span class="line">3113</span><br><span class="line">3114</span><br><span class="line">3115</span><br><span class="line">3116</span><br><span class="line">3117</span><br><span class="line">3118</span><br><span class="line">3119</span><br><span class="line">3120</span><br><span class="line">3121</span><br><span class="line">3122</span><br><span class="line">3123</span><br><span class="line">3124</span><br><span class="line">3125</span><br><span class="line">3126</span><br><span class="line">3127</span><br><span class="line">3128</span><br><span class="line">3129</span><br><span class="line">3130</span><br><span class="line">3131</span><br><span class="line">3132</span><br><span class="line">3133</span><br><span class="line">3134</span><br><span class="line">3135</span><br><span class="line">3136</span><br><span class="line">3137</span><br><span class="line">3138</span><br><span class="line">3139</span><br><span class="line">3140</span><br><span class="line">3141</span><br><span class="line">3142</span><br><span class="line">3143</span><br><span class="line">3144</span><br><span class="line">3145</span><br><span class="line">3146</span><br><span class="line">3147</span><br><span class="line">3148</span><br><span class="line">3149</span><br><span class="line">3150</span><br><span class="line">3151</span><br><span class="line">3152</span><br><span class="line">3153</span><br><span class="line">3154</span><br><span class="line">3155</span><br><span class="line">3156</span><br><span class="line">3157</span><br><span class="line">3158</span><br><span class="line">3159</span><br><span class="line">3160</span><br><span class="line">3161</span><br><span class="line">3162</span><br><span class="line">3163</span><br><span class="line">3164</span><br><span class="line">3165</span><br><span class="line">3166</span><br><span class="line">3167</span><br><span class="line">3168</span><br><span class="line">3169</span><br><span class="line">3170</span><br><span class="line">3171</span><br><span class="line">3172</span><br><span class="line">3173</span><br><span class="line">3174</span><br><span class="line">3175</span><br><span class="line">3176</span><br><span class="line">3177</span><br><span class="line">3178</span><br><span class="line">3179</span><br><span class="line">3180</span><br><span class="line">3181</span><br><span class="line">3182</span><br><span class="line">3183</span><br><span class="line">3184</span><br><span class="line">3185</span><br><span class="line">3186</span><br><span class="line">3187</span><br><span class="line">3188</span><br><span class="line">3189</span><br><span class="line">3190</span><br><span class="line">3191</span><br><span class="line">3192</span><br><span class="line">3193</span><br><span class="line">3194</span><br><span class="line">3195</span><br><span class="line">3196</span><br><span class="line">3197</span><br><span class="line">3198</span><br><span class="line">3199</span><br><span class="line">3200</span><br><span class="line">3201</span><br><span class="line">3202</span><br><span class="line">3203</span><br><span class="line">3204</span><br><span class="line">3205</span><br><span class="line">3206</span><br><span class="line">3207</span><br><span class="line">3208</span><br><span class="line">3209</span><br><span class="line">3210</span><br><span class="line">3211</span><br><span class="line">3212</span><br><span class="line">3213</span><br><span class="line">3214</span><br><span class="line">3215</span><br><span class="line">3216</span><br><span class="line">3217</span><br><span class="line">3218</span><br><span class="line">3219</span><br><span class="line">3220</span><br><span class="line">3221</span><br><span class="line">3222</span><br><span class="line">3223</span><br><span class="line">3224</span><br><span class="line">3225</span><br><span class="line">3226</span><br><span class="line">3227</span><br><span class="line">3228</span><br><span class="line">3229</span><br><span class="line">3230</span><br><span class="line">3231</span><br><span class="line">3232</span><br><span class="line">3233</span><br><span class="line">3234</span><br><span class="line">3235</span><br><span class="line">3236</span><br><span class="line">3237</span><br><span class="line">3238</span><br><span class="line">3239</span><br><span class="line">3240</span><br><span class="line">3241</span><br><span class="line">3242</span><br><span class="line">3243</span><br><span class="line">3244</span><br><span class="line">3245</span><br><span class="line">3246</span><br><span class="line">3247</span><br><span class="line">3248</span><br><span class="line">3249</span><br><span class="line">3250</span><br><span class="line">3251</span><br><span class="line">3252</span><br><span class="line">3253</span><br><span class="line">3254</span><br><span class="line">3255</span><br><span class="line">3256</span><br><span class="line">3257</span><br><span class="line">3258</span><br><span class="line">3259</span><br><span class="line">3260</span><br><span class="line">3261</span><br><span class="line">3262</span><br><span class="line">3263</span><br><span class="line">3264</span><br><span class="line">3265</span><br><span class="line">3266</span><br><span class="line">3267</span><br><span class="line">3268</span><br><span class="line">3269</span><br><span class="line">3270</span><br><span class="line">3271</span><br><span class="line">3272</span><br><span class="line">3273</span><br><span class="line">3274</span><br><span class="line">3275</span><br><span class="line">3276</span><br><span class="line">3277</span><br><span class="line">3278</span><br><span class="line">3279</span><br><span class="line">3280</span><br><span class="line">3281</span><br><span class="line">3282</span><br><span class="line">3283</span><br><span class="line">3284</span><br><span class="line">3285</span><br><span class="line">3286</span><br><span class="line">3287</span><br><span class="line">3288</span><br><span class="line">3289</span><br><span class="line">3290</span><br><span class="line">3291</span><br><span class="line">3292</span><br><span class="line">3293</span><br><span class="line">3294</span><br><span class="line">3295</span><br><span class="line">3296</span><br><span class="line">3297</span><br><span class="line">3298</span><br><span class="line">3299</span><br><span class="line">3300</span><br><span class="line">3301</span><br><span class="line">3302</span><br><span class="line">3303</span><br><span class="line">3304</span><br><span class="line">3305</span><br><span class="line">3306</span><br><span class="line">3307</span><br><span class="line">3308</span><br><span class="line">3309</span><br><span class="line">3310</span><br><span class="line">3311</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> <span class="keyword">replace</span> <span class="keyword">PACKAGE</span> <span class="keyword">BODY</span> q$error_manager</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">| This program is a part of the Quest Error Manager for Oracle.</span></span><br><span class="line"><span class="comment">| This product is freeware and is not supported by Quest.</span></span><br><span class="line"><span class="comment">|</span></span><br><span class="line"><span class="comment">| www.quest.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">?2008 Quest Software, Inc.</span></span><br><span class="line"><span class="comment">ALL RIGHTS RESERVED.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Redistribution and use of the Quest Error Manager for Oracle software in source and binary forms,</span></span><br><span class="line"><span class="comment">with or without modification, are permitted provided that the following conditions are met:</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">1.  Redistributions of source code must retain (i) the following copyright notice: "?008 Quest Software, Inc.</span></span><br><span class="line"><span class="comment">All rights reserved," (ii) this list of conditions, and (iii) the disclaimer below.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">2.  Redistributions in binary form must reproduce (i) the following copyright notice:</span></span><br><span class="line"><span class="comment">"?008 Quest Software, Inc. All rights reserved," (ii) this list of conditions, and (iii)</span></span><br><span class="line"><span class="comment">the disclaimer below, in the documentation and/or other materials provided with the distribution.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">3.  All advertising materials mentioning features or use of the Quest Error Manager</span></span><br><span class="line"><span class="comment">for Oracle software must display the following acknowledgement:</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">This product includes software developed by Quest Software, Inc. and its contributors.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">4.  Neither the name of Quest Software, Inc. nor the name its affiliates, subsidiaries</span></span><br><span class="line"><span class="comment">or contributors may be used to endorse or promote products derived from the Quest Error</span></span><br><span class="line"><span class="comment">Manager for Oracle software without specific prior written permission from Quest Software, Inc.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Disclaimer:</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">THIS SOFTWARE IS PROVIDED BY QUEST SOFTWARE, INC. AND ITS CONTRIBUTORS ``AS IS''</span></span><br><span class="line"><span class="comment">AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,</span></span><br><span class="line"><span class="comment">THE IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE,</span></span><br><span class="line"><span class="comment">AND NON-INFRINGEMENT ARE DISCLAIMED. IN NO EVENT SHALL QUEST SOFTWARE OR ITS</span></span><br><span class="line"><span class="comment">CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY,</span></span><br><span class="line"><span class="comment">OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE</span></span><br><span class="line"><span class="comment">GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)</span></span><br><span class="line"><span class="comment">HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,</span></span><br><span class="line"><span class="comment">OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THE</span></span><br><span class="line"><span class="comment">QUEST ERROR MANAGER SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">IS</span></span><br><span class="line">    c_default_error_code   <span class="keyword">CONSTANT</span> PLS_INTEGER := <span class="number">-20000</span>;</span><br><span class="line">    g_clipboard                     maxvarchar2_t;</span><br><span class="line">    g_clipboard_is_full             BOOLEAN DEFAULT FALSE;</span><br><span class="line">    <span class="comment">--</span></span><br><span class="line">    c_trunc_warning                 VARCHAR2 (100)</span><br><span class="line">        := '*** WARNING: Information truncated! ';</span><br><span class="line">    c_warning_len                   PLS_INTEGER := LENGTH (c_warning);</span><br><span class="line">    <span class="comment">--</span></span><br><span class="line">    <span class="comment">-- trace variables</span></span><br><span class="line">    g_trace_enabled                 BOOLEAN := FALSE;</span><br><span class="line">    g_error_trace_enabled           BOOLEAN := TRUE;</span><br><span class="line">    g_context_like                  q$log.context%TYPE := NULL;</span><br><span class="line">    g_include_timestamp             BOOLEAN := FALSE;</span><br><span class="line">    g_multiple_contexts             BOOLEAN := FALSE;</span><br><span class="line">    g_context_list                  DBMS_SQL.varchar2s;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    Flag to indicate that the error has already been registered</span></span><br><span class="line"><span class="comment">    and raised within QD, so just propagate it on up the call stack.</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    g_error_instance_raised         q$error_instance.id%TYPE DEFAULT NULL;</span><br><span class="line">    <span class="comment">-- system settings</span></span><br><span class="line">    g_grabbed_settings              error_info_rt;</span><br><span class="line">    <span class="comment">/* 1.4.0 flag to register is we want to append the remaining context to text */</span></span><br><span class="line">    g_add_remaining_context_msg     BOOLEAN := TRUE;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- Global contexts</span></span><br><span class="line">    TYPE gcontext_rt IS RECORD</span><br><span class="line">    (</span><br><span class="line">        name    q$error_context.name%TYPE</span><br><span class="line">       ,VALUE   q$error_context.VALUE%TYPE</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    TYPE gcontext_tt IS TABLE OF gcontext_rt</span><br><span class="line">                            INDEX BY BINARY_INTEGER;</span><br><span class="line"></span><br><span class="line">    g_gcontexts                     gcontext_tt;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- current program</span></span><br><span class="line">    TYPE runtime_rt IS RECORD</span><br><span class="line">    (</span><br><span class="line">        package_name   all_objects.object_name%TYPE</span><br><span class="line">       ,program_name   all_objects.object_name%TYPE</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 1.2.14 No longer used</span></span><br><span class="line"><span class="comment">    g_runtime runtime_rt; -- "current" running program</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">-- collection of record</span></span><br><span class="line">    TYPE runtime_nat IS TABLE OF runtime_rt;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- runtime stack implemented as a dense nested table.</span></span><br><span class="line">    <span class="comment">-- starts with element 1 and grows upward.</span></span><br><span class="line">    g_runtime_nat                   runtime_nat := runtime_nat ();</span><br><span class="line">    <span class="comment">-- trace target</span></span><br><span class="line">    c_screen               CONSTANT INTEGER := 0;</span><br><span class="line">    c_table                CONSTANT INTEGER := 1;</span><br><span class="line">    <span class="comment">--1.4.1   c_file                 CONSTANT INTEGER := 2;</span></span><br><span class="line">    g_target                        INTEGER := c_table;</span><br><span class="line"></span><br><span class="line">    TYPE trace_file_info_rt IS RECORD</span><br><span class="line">    (</span><br><span class="line">        dir             maxvarchar2_t</span><br><span class="line">       ,filename        maxvarchar2_t</span><br><span class="line">       ,lines_written   PLS_INTEGER</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    g_file_info                     trace_file_info_rt;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- Every hundred lines written, close and reopen.</span></span><br><span class="line">    <span class="comment">--1.4.1   c_close_threshold      CONSTANT PLS_INTEGER := 100;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* V1.2.11 show/hide setting */</span></span><br><span class="line">    TYPE show_oracle_rt IS RECORD</span><br><span class="line">    (</span><br><span class="line">        <span class="keyword">show</span>        <span class="built_in">BOOLEAN</span> <span class="keyword">DEFAULT</span> <span class="literal">FALSE</span></span><br><span class="line">       ,revert      <span class="built_in">BOOLEAN</span> <span class="keyword">DEFAULT</span> <span class="literal">FALSE</span></span><br><span class="line">       ,revert_to   <span class="built_in">BOOLEAN</span></span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    g_show_oracle                   show_oracle_rt;</span><br><span class="line">    <span class="comment">/* Option on how error is raised. */</span></span><br><span class="line">    c_with_handle          CONSTANT PLS_INTEGER := -98;</span><br><span class="line">    c_with_message         CONSTANT PLS_INTEGER := +75;</span><br><span class="line">    g_raise_with                    PLS_INTEGER := c_with_handle;</span><br><span class="line"></span><br><span class="line">    g_discard_error_state           BOOLEAN := FALSE;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    1.2.12 Provide switch to force display of "real" error in the error message,</span></span><br><span class="line"><span class="comment">     rather than simply showing the error handle. This is needed when</span></span><br><span class="line"><span class="comment">     user is running tests via the API and is not retrieving errors via</span></span><br><span class="line"><span class="comment">     get_error_info.</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    PROCEDURE raise_with_message</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        g_raise_with := c_with_message;</span><br><span class="line">    <span class="keyword">END</span> raise_with_message;</span><br><span class="line"></span><br><span class="line">    PROCEDURE raise_with_handle</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        g_raise_with := c_with_handle;</span><br><span class="line">    <span class="keyword">END</span> raise_with_handle;</span><br><span class="line"></span><br><span class="line">    FUNCTION raising_with_message</span><br><span class="line">        RETURN BOOLEAN</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">RETURN</span> g_raise_with = c_with_message;</span><br><span class="line">    <span class="keyword">END</span> raising_with_message;</span><br><span class="line"></span><br><span class="line">    FUNCTION raising_with_handle</span><br><span class="line">        RETURN BOOLEAN</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">RETURN</span> g_raise_with = c_with_handle;</span><br><span class="line">    <span class="keyword">END</span> raising_with_handle;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* END 1.2.12 changes */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">-- Private routines/handy utilities</span></span><br><span class="line">    FUNCTION error_backtrace (prefix_with_error_in IN BOOLEAN DEFAULT FALSE)</span><br><span class="line">        RETURN VARCHAR2</span><br><span class="line">    IS</span><br><span class="line">        l_errortrace   maxvarchar2_t := DBMS_UTILITY.format_error_stack;</span><br><span class="line">        l_backtrace    maxvarchar2_t;</span><br><span class="line">        l_return       maxvarchar2_t;</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">EXECUTE</span> <span class="keyword">IMMEDIATE</span> <span class="string">'BEGIN :val := DBMS_UTILITY.format_error_backtrace; END;'</span></span><br><span class="line">            <span class="keyword">USING</span> <span class="keyword">OUT</span> l_backtrace;</span><br><span class="line"></span><br><span class="line">        l_return :=</span><br><span class="line">            CASE</span><br><span class="line">                WHEN prefix_with_error_in</span><br><span class="line">                THEN</span><br><span class="line">                    l_errortrace || CHR (10) || CHR (10) || l_backtrace</span><br><span class="line">                ELSE</span><br><span class="line">                    l_backtrace</span><br><span class="line">            <span class="keyword">END</span>;</span><br><span class="line">        RETURN l_return;</span><br><span class="line">    EXCEPTION</span><br><span class="line">        WHEN OTHERS</span><br><span class="line">        THEN</span><br><span class="line">            RETURN l_errortrace;</span><br><span class="line">    <span class="keyword">END</span> error_backtrace;</span><br><span class="line"></span><br><span class="line">    FUNCTION oracle_app_error (code_in IN PLS_INTEGER)</span><br><span class="line">        RETURN BOOLEAN</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">RETURN</span> code_in <span class="keyword">BETWEEN</span> <span class="number">-20999</span> <span class="keyword">AND</span> <span class="number">-20000</span>;</span><br><span class="line">    <span class="keyword">END</span> oracle_app_error;</span><br><span class="line"></span><br><span class="line">    PROCEDURE validate_oracle_error (code_in        IN     PLS_INTEGER</span><br><span class="line">                                    ,message_out       OUT VARCHAR2</span><br><span class="line">                                    ,is_valid_out      OUT BOOLEAN)</span><br><span class="line">    IS</span><br><span class="line">        l_message   maxvarchar2_t;</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="comment">/* Take care of special case... */</span></span><br><span class="line">        <span class="keyword">IF</span> code_in <span class="keyword">IN</span> (<span class="number">100</span>, <span class="number">-1403</span>)</span><br><span class="line">        <span class="keyword">THEN</span></span><br><span class="line">            is_valid_out := <span class="literal">TRUE</span>;</span><br><span class="line">        ELSE</span><br><span class="line">            l_message := SQLERRM (code_in);</span><br><span class="line"></span><br><span class="line">            <span class="comment">-- If SQLERRM does not find an entry, it return a string like one of these:</span></span><br><span class="line">            <span class="comment">-- If the number is negative...</span></span><br><span class="line">            <span class="comment">-- ORA-NNNNN: Message NNNN not found; product=RDBMS; facility=ORA</span></span><br><span class="line">            <span class="comment">-- If the number is positive...</span></span><br><span class="line">            <span class="comment">--  -13000: non-ORACLE exception</span></span><br><span class="line">            <span class="comment">-- If the positive number is too big, we get numeric overflow.</span></span><br><span class="line">            IF l_message LIKE 'ORA-_____: Message%not found;%'</span><br><span class="line">               OR l_message LIKE '%: non-ORACLE exception%'</span><br><span class="line">            THEN</span><br><span class="line">                message_out := NULL;</span><br><span class="line">                is_valid_out := FALSE;</span><br><span class="line">            ELSE</span><br><span class="line">                message_out := l_message;</span><br><span class="line">                is_valid_out := TRUE;</span><br><span class="line">            <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line">    EXCEPTION</span><br><span class="line">        WHEN OTHERS</span><br><span class="line">        THEN</span><br><span class="line">            <span class="comment">--numeric overflow</span></span><br><span class="line">            IF SQLCODE = -1426</span><br><span class="line">            THEN</span><br><span class="line">                message_out := NULL;</span><br><span class="line">                is_valid_out := FALSE;</span><br><span class="line">            ELSE</span><br><span class="line">                RAISE;</span><br><span class="line">            <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line">    <span class="keyword">END</span> validate_oracle_error;</span><br><span class="line"></span><br><span class="line">    FUNCTION is_valid_oracle_error (code_in IN PLS_INTEGER)</span><br><span class="line">        RETURN BOOLEAN</span><br><span class="line">    IS</span><br><span class="line">        l_message   maxvarchar2_t;</span><br><span class="line">        retval      BOOLEAN;</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        validate_oracle_error (code_in, l_message, retval);</span><br><span class="line">        RETURN retval;</span><br><span class="line">    <span class="keyword">END</span> is_valid_oracle_error;</span><br><span class="line"></span><br><span class="line">    FUNCTION sqlcode_name (error_code_in IN PLS_INTEGER)</span><br><span class="line">        RETURN VARCHAR2</span><br><span class="line">    IS</span><br><span class="line">        l_return   maxvarchar2_t;   <span class="comment">/* 1.2.16 all_objects.object_name%TYPE; */</span></span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        l_return :=</span><br><span class="line">            <span class="keyword">CASE</span> error_code_in</span><br><span class="line">                <span class="keyword">WHEN</span> <span class="number">-6511</span></span><br><span class="line">                <span class="keyword">THEN</span></span><br><span class="line">                    <span class="string">'CURSOR_ALREADY_OPEN'</span></span><br><span class="line">                <span class="keyword">WHEN</span> <span class="number">-0001</span></span><br><span class="line">                <span class="keyword">THEN</span></span><br><span class="line">                    <span class="string">'DUP_VAL_ON_INDEX'</span></span><br><span class="line">                <span class="keyword">WHEN</span> <span class="number">-0051</span></span><br><span class="line">                <span class="keyword">THEN</span></span><br><span class="line">                    <span class="string">'TIMEOUT_ON_RESOURCE'</span></span><br><span class="line">                <span class="keyword">WHEN</span> <span class="number">-1001</span></span><br><span class="line">                <span class="keyword">THEN</span></span><br><span class="line">                    <span class="string">'INVALID_CURSOR'</span></span><br><span class="line">                <span class="keyword">WHEN</span> <span class="number">-1012</span></span><br><span class="line">                <span class="keyword">THEN</span></span><br><span class="line">                    <span class="string">'NOT_LOGGED_ON'</span></span><br><span class="line">                <span class="keyword">WHEN</span> <span class="number">-1017</span></span><br><span class="line">                <span class="keyword">THEN</span></span><br><span class="line">                    <span class="string">'LOGIN_DENIED'</span></span><br><span class="line">                <span class="keyword">WHEN</span> <span class="number">100</span></span><br><span class="line">                <span class="keyword">THEN</span></span><br><span class="line">                    <span class="string">'NO_DATA_FOUND'</span></span><br><span class="line">                <span class="keyword">WHEN</span> <span class="number">-1476</span></span><br><span class="line">                <span class="keyword">THEN</span></span><br><span class="line">                    <span class="string">'ZERO_DIVIDE'</span></span><br><span class="line">                <span class="keyword">WHEN</span> <span class="number">-1722</span></span><br><span class="line">                <span class="keyword">THEN</span></span><br><span class="line">                    <span class="string">'INVALID_NUMBER'</span></span><br><span class="line">                <span class="keyword">WHEN</span> <span class="number">-1422</span></span><br><span class="line">                <span class="keyword">THEN</span></span><br><span class="line">                    <span class="string">'TOO_MANY_ROWS'</span></span><br><span class="line">                <span class="keyword">WHEN</span> <span class="number">-6500</span></span><br><span class="line">                <span class="keyword">THEN</span></span><br><span class="line">                    <span class="string">'STORAGE_ERROR'</span></span><br><span class="line">                <span class="keyword">WHEN</span> <span class="number">-6501</span></span><br><span class="line">                <span class="keyword">THEN</span></span><br><span class="line">                    <span class="string">'PROGRAM_ERROR'</span></span><br><span class="line">                <span class="keyword">WHEN</span> <span class="number">-6502</span></span><br><span class="line">                <span class="keyword">THEN</span></span><br><span class="line">                    <span class="string">'VALUE_ERROR'</span></span><br><span class="line">                <span class="keyword">WHEN</span> <span class="number">-6530</span></span><br><span class="line">                <span class="keyword">THEN</span></span><br><span class="line">                    <span class="string">'ACCESS_INTO_NULL'</span></span><br><span class="line">                <span class="keyword">WHEN</span> <span class="number">-6531</span></span><br><span class="line">                <span class="keyword">THEN</span></span><br><span class="line">                    <span class="string">'COLLECTION_IS_NULL '</span></span><br><span class="line">                <span class="keyword">WHEN</span> <span class="number">-6532</span></span><br><span class="line">                <span class="keyword">THEN</span></span><br><span class="line">                    <span class="string">'SUBSCRIPT_OUTSIDE_LIMIT'</span></span><br><span class="line">                <span class="keyword">WHEN</span> <span class="number">-6533</span></span><br><span class="line">                <span class="keyword">THEN</span></span><br><span class="line">                    <span class="string">'SUBSCRIPT_BEYOND_COUNT '</span></span><br><span class="line">                <span class="keyword">WHEN</span> <span class="number">-650</span></span><br><span class="line">                <span class="keyword">THEN</span></span><br><span class="line">                    <span class="string">'ROWTYPE_MISMATCH'</span></span><br><span class="line">                <span class="keyword">WHEN</span> <span class="number">-1410</span></span><br><span class="line">                <span class="keyword">THEN</span></span><br><span class="line">                    <span class="string">'SYS_INVALID_ROWID'</span></span><br><span class="line">                <span class="keyword">WHEN</span> <span class="number">-30625</span></span><br><span class="line">                <span class="keyword">THEN</span></span><br><span class="line">                    <span class="string">'SELF_IS_NULL'</span></span><br><span class="line">                <span class="keyword">WHEN</span> <span class="number">-6592</span></span><br><span class="line">                <span class="keyword">THEN</span></span><br><span class="line">                    <span class="string">'CASE_NOT_FOUND'</span></span><br><span class="line">                <span class="keyword">WHEN</span> <span class="number">-1725</span></span><br><span class="line">                <span class="keyword">THEN</span></span><br><span class="line">                    <span class="string">'USERENV_COMMITSCN_ERROR'</span></span><br><span class="line">                <span class="keyword">WHEN</span> <span class="number">-6548</span></span><br><span class="line">                <span class="keyword">THEN</span></span><br><span class="line">                    <span class="string">'NO_DATA_NEEDED'</span></span><br><span class="line">                <span class="keyword">ELSE</span></span><br><span class="line">                    <span class="keyword">UPPER</span> (</span><br><span class="line">                        <span class="keyword">SUBSTR</span> (SQLERRM (error_code_in)</span><br><span class="line">                               ,<span class="keyword">INSTR</span> (SQLERRM (error_code_in), <span class="string">':'</span>) + <span class="number">2</span>))</span><br><span class="line">            <span class="keyword">END</span>;</span><br><span class="line">        RETURN l_return;</span><br><span class="line">    <span class="keyword">END</span> sqlcode_name;</span><br><span class="line"></span><br><span class="line">    FUNCTION sqlcode_text (error_code_in IN PLS_INTEGER)</span><br><span class="line">        RETURN VARCHAR2</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">IF</span> error_code_in <span class="keyword">IN</span> (<span class="number">100</span>, <span class="number">-1403</span>)</span><br><span class="line">        <span class="keyword">THEN</span></span><br><span class="line">            <span class="keyword">RETURN</span> <span class="string">'No data found'</span>;</span><br><span class="line">        ELSE</span><br><span class="line">            RETURN SQLERRM (error_code_in);</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line">    <span class="keyword">END</span> sqlcode_text;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- MOve from q$error_qp to remove dependency on package.</span></span><br><span class="line">    FUNCTION q$error_qp_onerow (id_in IN q$error.id%TYPE)</span><br><span class="line">        RETURN q$error%ROWTYPE</span><br><span class="line">    IS</span><br><span class="line">        CURSOR onerow_cur</span><br><span class="line">        IS</span><br><span class="line">            <span class="keyword">SELECT</span> *</span><br><span class="line">              <span class="keyword">FROM</span> q$<span class="keyword">error</span></span><br><span class="line">             <span class="keyword">WHERE</span> <span class="keyword">id</span> = id_in;</span><br><span class="line"></span><br><span class="line">        onerow_rec   q$error%ROWTYPE;</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">OPEN</span> onerow_cur;</span><br><span class="line"></span><br><span class="line">        FETCH onerow_cur INTO onerow_rec;</span><br><span class="line"></span><br><span class="line">        CLOSE onerow_cur;</span><br><span class="line"></span><br><span class="line">        RETURN onerow_rec;</span><br><span class="line">    <span class="keyword">END</span> q$error_qp_onerow;</span><br><span class="line"></span><br><span class="line">    FUNCTION q$error_instance_qp_onerow (id_in IN q$error_instance.id%TYPE)</span><br><span class="line">        RETURN q$error_instance%ROWTYPE</span><br><span class="line">    IS</span><br><span class="line">        CURSOR onerow_cur</span><br><span class="line">        IS</span><br><span class="line">            <span class="keyword">SELECT</span> *</span><br><span class="line">              <span class="keyword">FROM</span> q$error_instance</span><br><span class="line">             <span class="keyword">WHERE</span> <span class="keyword">id</span> = id_in;</span><br><span class="line"></span><br><span class="line">        onerow_rec   q$error_instance%ROWTYPE;</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">OPEN</span> onerow_cur;</span><br><span class="line"></span><br><span class="line">        FETCH onerow_cur INTO onerow_rec;</span><br><span class="line"></span><br><span class="line">        CLOSE onerow_cur;</span><br><span class="line"></span><br><span class="line">        RETURN onerow_rec;</span><br><span class="line">    <span class="keyword">END</span> q$error_instance_qp_onerow;</span><br><span class="line"></span><br><span class="line">    PROCEDURE mark_q$error_raised (id_in IN q$error_instance.id%TYPE)</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="comment">/* 1.2.17 Do not maintain state if user has requested this non-default</span></span><br><span class="line"><span class="comment">          behavior. That is, immediately mark it as handled. */</span></span><br><span class="line">        <span class="keyword">IF</span> error_state_discarded ()</span><br><span class="line">        <span class="keyword">THEN</span></span><br><span class="line">            mark_q$error_handled ();</span><br><span class="line">        ELSE</span><br><span class="line">            g_error_instance_raised := id_in;</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line">    <span class="keyword">END</span> mark_q$error_raised;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- Reset when get_error_info is called.</span></span><br><span class="line">    PROCEDURE mark_q$error_handled</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        g_error_instance_raised := <span class="literal">NULL</span>;</span><br><span class="line">        clear_gcontexts;</span><br><span class="line">    <span class="keyword">END</span> mark_q$error_handled;</span><br><span class="line"></span><br><span class="line">    FUNCTION q$error_instance_id_raised</span><br><span class="line">        RETURN q$error_instance.id%TYPE</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">RETURN</span> g_error_instance_raised;</span><br><span class="line">    <span class="keyword">END</span> q$error_instance_id_raised;</span><br><span class="line"></span><br><span class="line">    FUNCTION q$error_raised</span><br><span class="line">        RETURN BOOLEAN</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">RETURN</span> <span class="comment">/* 1.4.0 Do not directly reference variables</span></span><br><span class="line"><span class="comment">         g_error_instance_raised */</span></span><br><span class="line">              q$error_instance_id_raised () <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">END</span> q$error_raised;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- returns the program name at the "top" of the runtime stack</span></span><br><span class="line">    FUNCTION top_program_name</span><br><span class="line">        RETURN all_objects.object_name%TYPE</span><br><span class="line">    IS</span><br><span class="line">        v_program_name   all_objects.object_name%TYPE;</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">IF</span> (g_runtime_nat.COUNT &gt; <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">THEN</span></span><br><span class="line">            v_program_name := g_runtime_nat (g_runtime_nat.LAST).program_name;</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line"></span><br><span class="line">        RETURN (v_program_name);</span><br><span class="line">    <span class="keyword">END</span> top_program_name;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- PBA 20040518</span></span><br><span class="line">    FUNCTION top_package_name</span><br><span class="line">        RETURN all_objects.object_name%TYPE</span><br><span class="line">    IS</span><br><span class="line">        v_package_name   all_objects.object_name%TYPE;</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">IF</span> (g_runtime_nat.COUNT &gt; <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">THEN</span></span><br><span class="line">            v_package_name := g_runtime_nat (g_runtime_nat.LAST).program_name;</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line"></span><br><span class="line">        RETURN (v_package_name);</span><br><span class="line">    <span class="keyword">END</span> top_package_name;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- PBA 20040518</span></span><br><span class="line">    FUNCTION top_packprog_name</span><br><span class="line">        RETURN VARCHAR2</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">RETURN</span> top_package_name || <span class="string">'.'</span> || top_program_name;</span><br><span class="line">    <span class="keyword">END</span> top_packprog_name;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- returns the current runtime context at the "top" of the runtime stack</span></span><br><span class="line">    FUNCTION top_runtime</span><br><span class="line">        RETURN runtime_rt</span><br><span class="line">    IS</span><br><span class="line">        v_runtime   runtime_rt;</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">IF</span> (g_runtime_nat.COUNT &gt; <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">THEN</span></span><br><span class="line">            v_runtime := g_runtime_nat (g_runtime_nat.LAST);</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line"></span><br><span class="line">        RETURN (v_runtime);</span><br><span class="line">    <span class="keyword">END</span> top_runtime;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- convert Boolean value to String</span></span><br><span class="line">    FUNCTION strval (val IN BOOLEAN)</span><br><span class="line">        RETURN VARCHAR2</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">IF</span> val</span><br><span class="line">        <span class="keyword">THEN</span></span><br><span class="line">            <span class="keyword">RETURN</span> (<span class="string">'TRUE'</span>);</span><br><span class="line">        ELSIF NOT val</span><br><span class="line">        THEN</span><br><span class="line">            RETURN ('FALSE');</span><br><span class="line">        ELSE</span><br><span class="line">            RETURN ('NULL');</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line">    <span class="keyword">END</span> strval;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- public routines (exposed in the package header)</span></span><br><span class="line">    <span class="comment">-- -------------------------------------</span></span><br><span class="line">    <span class="comment">-- Tracing and DBMS_OUTPUT encapsulation</span></span><br><span class="line">    <span class="comment">-- -------------------------------------</span></span><br><span class="line">    <span class="comment">-- Tracing and DBMS_OUTPUT encapsulation</span></span><br><span class="line">    <span class="comment">-- switches output to the console</span></span><br><span class="line">    <span class="comment">-- <span class="doctag">NOTE:</span> default is to Table</span></span><br><span class="line">    PROCEDURE toscreen</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        g_target := c_screen;</span><br><span class="line">    <span class="keyword">END</span> toscreen;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- switches output to the q$log table</span></span><br><span class="line">    <span class="comment">-- <span class="doctag">NOTE:</span> this is the default destination</span></span><br><span class="line">    PROCEDURE totable</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        g_target := c_table;</span><br><span class="line">    <span class="keyword">END</span> totable;</span><br><span class="line"></span><br><span class="line">    PROCEDURE totable (purge_in IN BOOLEAN)</span><br><span class="line">    IS</span><br><span class="line">        <span class="keyword">PRAGMA</span> AUTONOMOUS_TRANSACTION;</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        totable ();</span><br><span class="line"></span><br><span class="line">        IF purge_in</span><br><span class="line">        THEN</span><br><span class="line">            <span class="keyword">DELETE</span> <span class="keyword">FROM</span> q$<span class="keyword">log</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">COMMIT</span>;</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line">    <span class="keyword">END</span> totable;</span><br><span class="line"></span><br><span class="line">    PROCEDURE tofile (dir_in         IN VARCHAR2</span><br><span class="line">                     ,file_in        IN VARCHAR2</span><br><span class="line">                     ,overwrite_in   IN BOOLEAN DEFAULT TRUE)</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        g_file_info.dir := dir_in;</span><br><span class="line">        g_file_info.filename := file_in;</span><br><span class="line">        g_file_info.lines_written := 0;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        Write to file now occurs in front end when tracing is terminated</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        g_file_info.file_handle :=</span></span><br><span class="line"><span class="comment">         utx_file.fopen (dir_in</span></span><br><span class="line"><span class="comment">         , file_in</span></span><br><span class="line"><span class="comment">         , CASE</span></span><br><span class="line"><span class="comment">         WHEN overwrite_in</span></span><br><span class="line"><span class="comment">         THEN 'W'</span></span><br><span class="line"><span class="comment">         ELSE 'A'</span></span><br><span class="line"><span class="comment">         END</span></span><br><span class="line"><span class="comment">         , max_linesize =&gt; 32767</span></span><br><span class="line"><span class="comment">          );*/</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        We still write to the table, and then dump to file later.</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        g_target := c_table;</span><br><span class="line">    <span class="keyword">END</span> tofile;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- simple DBMS_OUTPUT handling of 255 char limit</span></span><br><span class="line">    <span class="comment">-- looks for a newline, or chops to fit given length</span></span><br><span class="line">    PROCEDURE pl (string_in IN VARCHAR2, length_in IN PLS_INTEGER := 80)</span><br><span class="line">    IS</span><br><span class="line">        v_len     PLS_INTEGER := LEAST (length_in, 255);</span><br><span class="line">        v_len2    PLS_INTEGER;</span><br><span class="line">        v_chr10   PLS_INTEGER;</span><br><span class="line">        v_str     VARCHAR2 (2000);</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">IF</span> <span class="keyword">LENGTH</span> (string_in) &gt; v_len</span><br><span class="line">        <span class="keyword">THEN</span></span><br><span class="line">            v_chr10 := <span class="keyword">INSTR</span> (string_in, <span class="keyword">CHR</span> (<span class="number">10</span>));</span><br><span class="line"></span><br><span class="line">            IF v_chr10 &gt; 0 AND v_len &gt;= v_chr10</span><br><span class="line">            THEN</span><br><span class="line">                v_len := v_chr10 - 1;</span><br><span class="line">                v_len2 := v_chr10 + 1;</span><br><span class="line">            ELSE</span><br><span class="line">                v_len2 := v_len + 1;</span><br><span class="line">            <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line"></span><br><span class="line">            v_str := SUBSTR (string_in, 1, v_len);</span><br><span class="line">            DBMS_OUTPUT.put_line (v_str);</span><br><span class="line">            pl (string_in   =&gt; SUBSTR (string_in, v_len2)</span><br><span class="line">               ,length_in   =&gt; length_in);</span><br><span class="line">        ELSE</span><br><span class="line">            DBMS_OUTPUT.put_line (string_in);</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line">    EXCEPTION</span><br><span class="line">        <span class="comment">/* 1.3.1 Volker Bartuseck fix */</span></span><br><span class="line">        WHEN OTHERS</span><br><span class="line">        THEN</span><br><span class="line">            DBMS_OUTPUT.enable (1000000);</span><br><span class="line"></span><br><span class="line">            IF v_str IS NULL</span><br><span class="line">            THEN</span><br><span class="line">                DBMS_OUTPUT.put_line (string_in);</span><br><span class="line">            ELSE</span><br><span class="line">                DBMS_OUTPUT.put_line (v_str);</span><br><span class="line">            <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line">    <span class="keyword">END</span> pl;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- converts the given boolean value to string,</span></span><br><span class="line">    <span class="comment">-- then writes it out as above</span></span><br><span class="line">    PROCEDURE pl (val IN BOOLEAN)</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        pl (strval (val));</span><br><span class="line">    <span class="keyword">END</span> pl;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- as above but concatenates str with the string value of bool</span></span><br><span class="line">    <span class="comment">-- e.g., 'cursor%found TRUE'</span></span><br><span class="line">    PROCEDURE pl (str IN VARCHAR2, bool IN BOOLEAN, len IN PLS_INTEGER := 80)</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        pl (string_in =&gt; <span class="keyword">str</span> || <span class="string">' '</span> || strval (bool), length_in =&gt; <span class="keyword">len</span>);</span><br><span class="line">    <span class="keyword">END</span> pl;</span><br><span class="line"></span><br><span class="line">    PROCEDURE pl (clob_in IN CLOB, length_in IN PLS_INTEGER := 80)</span><br><span class="line">    IS</span><br><span class="line">        buffer     VARCHAR2 (255);</span><br><span class="line">        amount     BINARY_INTEGER := GREATEST (length_in, 255);</span><br><span class="line">        position   INTEGER := 1;</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">LOOP</span></span><br><span class="line">            DBMS_LOB.read (clob_in</span><br><span class="line">                          ,amount</span><br><span class="line">                          ,<span class="keyword">position</span></span><br><span class="line">                          ,buffer);</span><br><span class="line">            <span class="comment">/* Display the buffer contents using the string overloading */</span></span><br><span class="line">            pl (buffer);</span><br><span class="line">            position := position + amount;</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">LOOP</span>;</span><br><span class="line">    EXCEPTION</span><br><span class="line">        WHEN NO_DATA_FOUND OR VALUE_ERROR</span><br><span class="line">        THEN</span><br><span class="line">            pl ('** End of CLOB data **');</span><br><span class="line">    <span class="keyword">END</span> pl;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    PROCEDURE set_error_trace (onoff_in IN BOOLEAN)</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">IF</span> onoff_in</span><br><span class="line">        <span class="keyword">THEN</span></span><br><span class="line">            error_trace_on;</span><br><span class="line">        ELSE</span><br><span class="line">            error_trace_off;</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line">    <span class="keyword">END</span> set_error_trace;</span><br><span class="line"></span><br><span class="line">    PROCEDURE error_trace_on</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        g_error_trace_enabled := <span class="literal">TRUE</span>;</span><br><span class="line">    <span class="keyword">END</span> error_trace_on;</span><br><span class="line"></span><br><span class="line">    PROCEDURE error_trace_off</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        g_error_trace_enabled := <span class="literal">FALSE</span>;</span><br><span class="line">    <span class="keyword">END</span> error_trace_off;</span><br><span class="line"></span><br><span class="line">    FUNCTION error_trace_enabled</span><br><span class="line">        RETURN BOOLEAN</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">RETURN</span> g_error_trace_enabled;</span><br><span class="line">    <span class="keyword">END</span> error_trace_enabled;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*1.4.0 */</span></span><br><span class="line">    PROCEDURE add_remaining_context_msg_on</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        g_add_remaining_context_msg := <span class="literal">TRUE</span>;</span><br><span class="line">    <span class="keyword">END</span> add_remaining_context_msg_on;</span><br><span class="line"></span><br><span class="line">    PROCEDURE add_remaining_context_msg_off</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        g_add_remaining_context_msg := <span class="literal">FALSE</span>;</span><br><span class="line">    <span class="keyword">END</span> add_remaining_context_msg_off;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    PROCEDURE set_add_remaining_context_msg (onoff_in IN BOOLEAN)</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">IF</span> onoff_in</span><br><span class="line">        <span class="keyword">THEN</span></span><br><span class="line">            add_remaining_context_msg_on;</span><br><span class="line">        ELSE</span><br><span class="line">            add_remaining_context_msg_off;</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line">    <span class="keyword">END</span> set_add_remaining_context_msg;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    FUNCTION add_remaining_context_enabled</span><br><span class="line">        RETURN BOOLEAN</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">RETURN</span> g_add_remaining_context_msg;</span><br><span class="line">    <span class="keyword">END</span> add_remaining_context_enabled;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* end 1.4.0 */</span></span><br><span class="line">    FUNCTION string_to_list (string_in IN VARCHAR2, delim_in IN VARCHAR2)</span><br><span class="line">        RETURN DBMS_SQL.varchar2s</span><br><span class="line">    IS</span><br><span class="line">        c_end_of_list   CONSTANT PLS_INTEGER := -99;</span><br><span class="line">        l_item                   maxvarchar2_t;</span><br><span class="line">        l_startloc               PLS_INTEGER := 1;</span><br><span class="line">        items_out                DBMS_SQL.varchar2s;</span><br><span class="line"></span><br><span class="line">        PROCEDURE add_item (item_in IN VARCHAR2)</span><br><span class="line">        IS</span><br><span class="line">        <span class="keyword">BEGIN</span></span><br><span class="line">            <span class="keyword">IF</span> item_in = delim_in</span><br><span class="line">            <span class="keyword">THEN</span></span><br><span class="line">                <span class="comment">/* We don't put delimiters into the collection. */</span></span><br><span class="line">                <span class="literal">NULL</span>;</span><br><span class="line">            ELSE</span><br><span class="line">                items_out (items_out.COUNT + 1) := RTRIM (LTRIM (item_in));</span><br><span class="line">            <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line">        <span class="keyword">END</span> add_item;</span><br><span class="line"></span><br><span class="line">        PROCEDURE get_next_item (string_in        IN     VARCHAR2</span><br><span class="line">                                ,startloc_inout   IN OUT PLS_INTEGER</span><br><span class="line">                                ,item_out            OUT VARCHAR2)</span><br><span class="line">        IS</span><br><span class="line">            l_loc   PLS_INTEGER;</span><br><span class="line">        <span class="keyword">BEGIN</span></span><br><span class="line">            l_loc := <span class="keyword">INSTR</span> (string_in, delim_in, startloc_inout);</span><br><span class="line"></span><br><span class="line">            IF l_loc = startloc_inout                 <span class="comment">-- Previous item is NULL</span></span><br><span class="line">            THEN</span><br><span class="line">                item_out := NULL;</span><br><span class="line">            ELSIF l_loc = 0                     <span class="comment">-- Rest of string is last item</span></span><br><span class="line">            THEN</span><br><span class="line">                item_out := SUBSTR (string_in, startloc_inout);</span><br><span class="line">            ELSE</span><br><span class="line">                item_out :=</span><br><span class="line">                    SUBSTR (string_in</span><br><span class="line">                           ,startloc_inout</span><br><span class="line">                           ,l_loc - startloc_inout);</span><br><span class="line">            <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line"></span><br><span class="line">            IF l_loc = 0</span><br><span class="line">            THEN</span><br><span class="line">                startloc_inout := c_end_of_list;</span><br><span class="line">            ELSE</span><br><span class="line">                startloc_inout := l_loc + 1;</span><br><span class="line">            <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line">        <span class="keyword">END</span> get_next_item;</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">IF</span> string_in <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">AND</span> delim_in <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line">        <span class="keyword">THEN</span></span><br><span class="line">            <span class="keyword">LOOP</span></span><br><span class="line">                get_next_item (string_in, l_startloc, l_item);</span><br><span class="line">                add_item (l_item);</span><br><span class="line">                EXIT WHEN l_startloc = c_end_of_list;</span><br><span class="line">            <span class="keyword">END</span> <span class="keyword">LOOP</span>;</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line"></span><br><span class="line">        RETURN items_out;</span><br><span class="line">    <span class="keyword">END</span> string_to_list;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- Clears out the trace contents. Currently just deletes from q$log.</span></span><br><span class="line">    PROCEDURE clear_trace</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">EXECUTE</span> <span class="keyword">IMMEDIATE</span> <span class="string">'truncate table q$log'</span>;</span><br><span class="line">    EXCEPTION</span><br><span class="line">        WHEN OTHERS</span><br><span class="line">        THEN</span><br><span class="line">            NULL;</span><br><span class="line">    <span class="keyword">END</span> clear_trace;</span><br><span class="line"></span><br><span class="line">    PROCEDURE set_trace (onoff_in               IN BOOLEAN</span><br><span class="line">                        ,context_like_in        IN q$log.context%TYPE := NULL</span><br><span class="line">                        ,include_timestamp_in   IN BOOLEAN DEFAULT FALSE</span><br><span class="line">                        ,delimiter_in           IN VARCHAR2 DEFAULT ',')</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="comment">-- Special commands....</span></span><br><span class="line">        <span class="keyword">IF</span> onoff_in <span class="keyword">AND</span> <span class="keyword">UPPER</span> (context_like_in) = <span class="string">'QCTO#TOTABLE'</span></span><br><span class="line">        <span class="keyword">THEN</span></span><br><span class="line">            totable (purge_in =&gt; <span class="literal">TRUE</span>);</span><br><span class="line">            g_trace_enabled := onoff_in;</span><br><span class="line">            g_context_like := '%';</span><br><span class="line">            q$error_manager.trace (</span><br><span class="line">                'set_trace to table via override with context "%"'</span><br><span class="line">               ,g_trace_enabled);</span><br><span class="line">            g_include_timestamp := include_timestamp_in;</span><br><span class="line">        ELSE</span><br><span class="line">            g_trace_enabled := onoff_in;</span><br><span class="line">            g_context_like := UPPER (NVL (context_like_in, '%'));</span><br><span class="line">            q$error_manager.trace (</span><br><span class="line">                'set_trace with context "' || g_context_like || '"'</span><br><span class="line">               ,g_trace_enabled);</span><br><span class="line">            g_include_timestamp := include_timestamp_in;</span><br><span class="line"></span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">              Write to file now occurs in front end when tracing is terminated</span></span><br><span class="line"><span class="comment">              IF NOT g_trace_enabled AND g_target = c_file</span></span><br><span class="line"><span class="comment">              THEN</span></span><br><span class="line"><span class="comment">             utx_file.fclose (g_file_info.file_handle);</span></span><br><span class="line"><span class="comment">              END IF;*/</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">-- BM 1239 When turning off, set back to table, which is the default.</span></span><br><span class="line">            IF NOT g_trace_enabled</span><br><span class="line">            THEN</span><br><span class="line">                totable;</span><br><span class="line">            <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line"></span><br><span class="line">        g_multiple_contexts := INSTR (context_like_in, delimiter_in) &gt; 0;</span><br><span class="line"></span><br><span class="line">        IF g_multiple_contexts</span><br><span class="line">        THEN</span><br><span class="line">            g_context_list := string_to_list (context_like_in, delimiter_in);</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line">    <span class="keyword">END</span> set_trace;</span><br><span class="line"></span><br><span class="line">    PROCEDURE trace_on (context_like_in        IN q$log.context%TYPE := NULL</span><br><span class="line">                       ,include_timestamp_in   IN BOOLEAN DEFAULT FALSE</span><br><span class="line">                       ,delimiter_in           IN VARCHAR2 DEFAULT ',')</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        set_trace (onoff_in               =&gt; <span class="literal">TRUE</span></span><br><span class="line">                  ,context_like_in        =&gt; context_like_in</span><br><span class="line">                  ,include_timestamp_in   =&gt; include_timestamp_in);</span><br><span class="line">    <span class="keyword">END</span> trace_on;</span><br><span class="line"></span><br><span class="line">    PROCEDURE trace_off (context_like_in        IN q$log.context%TYPE := NULL</span><br><span class="line">                        ,include_timestamp_in   IN BOOLEAN DEFAULT FALSE)</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        set_trace (onoff_in               =&gt; <span class="literal">FALSE</span></span><br><span class="line">                  ,context_like_in        =&gt; context_like_in</span><br><span class="line">                  ,include_timestamp_in   =&gt; include_timestamp_in);</span><br><span class="line">    <span class="keyword">END</span> trace_off;</span><br><span class="line"></span><br><span class="line">    FUNCTION trace_enabled</span><br><span class="line">        RETURN BOOLEAN</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">RETURN</span> g_trace_enabled;</span><br><span class="line">    <span class="keyword">END</span> trace_enabled;</span><br><span class="line"></span><br><span class="line">    FUNCTION context_matches (context_in IN VARCHAR2)</span><br><span class="line">        RETURN BOOLEAN</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">FOR</span> indx <span class="keyword">IN</span> <span class="number">1</span> .. g_context_list.COUNT</span><br><span class="line">        <span class="keyword">LOOP</span></span><br><span class="line">            <span class="keyword">IF</span> <span class="keyword">UPPER</span> (context_in) <span class="keyword">LIKE</span> <span class="keyword">UPPER</span> (g_context_list (indx))</span><br><span class="line">            <span class="keyword">THEN</span></span><br><span class="line">                <span class="keyword">RETURN</span> <span class="literal">TRUE</span>;</span><br><span class="line">            <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">LOOP</span>;</span><br><span class="line"></span><br><span class="line">        RETURN FALSE;</span><br><span class="line">    <span class="keyword">END</span> context_matches;</span><br><span class="line"></span><br><span class="line">    FUNCTION trace_enabled (context_in IN q$log.context%TYPE)</span><br><span class="line">        RETURN BOOLEAN</span><br><span class="line">    IS</span><br><span class="line">        l_return   BOOLEAN DEFAULT FALSE;</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">IF</span> g_trace_enabled</span><br><span class="line">        <span class="keyword">THEN</span></span><br><span class="line">            <span class="comment">/* IF multiple contexts, then check for exact match. */</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">IF</span> g_multiple_contexts</span><br><span class="line">            <span class="keyword">THEN</span></span><br><span class="line">                l_return := context_matches (context_in);</span><br><span class="line">            <span class="comment">/* Use wildcarded comparision */</span></span><br><span class="line">            ELSE</span><br><span class="line">                l_return :=</span><br><span class="line">                    (g_context_like IS NULL</span><br><span class="line">                     OR UPPER (context_in) LIKE '%' || g_context_like || '%');</span><br><span class="line">            <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line"></span><br><span class="line">        RETURN l_return;</span><br><span class="line">    <span class="keyword">END</span> trace_enabled;</span><br><span class="line"></span><br><span class="line">    FUNCTION full_log_string (context_in   IN VARCHAR2</span><br><span class="line">                             ,text_in      IN VARCHAR2</span><br><span class="line">                             ,level_in     IN PLS_INTEGER)</span><br><span class="line">        RETURN VARCHAR2</span><br><span class="line">    IS</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        Cannot be longer than 4000 characters, since it is returned</span></span><br><span class="line"><span class="comment">        via a query.</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        c_timestamp   CONSTANT VARCHAR2 (100)</span><br><span class="line">            := TO_CHAR (SYSDATE, 'HH24:MI:SS-YYYYMMDD') ;</span><br><span class="line">        l_string               maxvarchar2_t;</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        l_string :=</span><br><span class="line">            <span class="keyword">CASE</span></span><br><span class="line">                <span class="keyword">WHEN</span> g_include_timestamp <span class="keyword">THEN</span> c_timestamp || <span class="string">' '</span></span><br><span class="line">                <span class="keyword">ELSE</span> <span class="literal">NULL</span></span><br><span class="line">            <span class="keyword">END</span></span><br><span class="line">            || context_in;</span><br><span class="line">        l_string :=</span><br><span class="line">            l_string || ' - '</span><br><span class="line">            || SUBSTR (text_in</span><br><span class="line">                      ,1</span><br><span class="line">                      ,c_varchar2_max_length_db - LENGTH (l_string) - 5);</span><br><span class="line">        <span class="comment">/* Ignore level</span></span><br><span class="line"><span class="comment">        || CASE</span></span><br><span class="line"><span class="comment">          WHEN level_in &gt; 0</span></span><br><span class="line"><span class="comment">         THEN LPAD (' ', level_in)</span></span><br><span class="line"><span class="comment">          ELSE NULL</span></span><br><span class="line"><span class="comment">         END</span></span><br><span class="line"><span class="comment">        || context_in</span></span><br><span class="line"><span class="comment">        || ' - '</span></span><br><span class="line"><span class="comment">        || text_in;*/</span></span><br><span class="line">        RETURN l_string;</span><br><span class="line">    EXCEPTION</span><br><span class="line">        WHEN VALUE_ERROR</span><br><span class="line">        THEN</span><br><span class="line">            RETURN SUBSTR (context_in || ' - ' || text_in</span><br><span class="line">                          ,1</span><br><span class="line">                          ,c_varchar2_max_length);</span><br><span class="line">    <span class="keyword">END</span> full_log_string;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- writes output to the screen or q$log table</span></span><br><span class="line">    <span class="comment">-- (see toscreen and totable above)</span></span><br><span class="line">    PROCEDURE trace (context_in       IN q$log.context%TYPE</span><br><span class="line">                    ,text_in          IN q$log.text%TYPE</span><br><span class="line">                    ,force_trace_in   IN BOOLEAN DEFAULT FALSE</span><br><span class="line">                    ,level_in         IN PLS_INTEGER DEFAULT NULL)</span><br><span class="line">    IS</span><br><span class="line">        <span class="keyword">PRAGMA</span> AUTONOMOUS_TRANSACTION;</span><br><span class="line">        l_context   q$log.context%TYPE;</span><br><span class="line">        l_text      q$log.text%TYPE;</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">IF</span> trace_enabled (context_in) <span class="keyword">OR</span> force_trace_in</span><br><span class="line">        <span class="keyword">THEN</span></span><br><span class="line">            <span class="comment">-- Bypass encapsulation; problems with infinite loop.</span></span><br><span class="line">            <span class="keyword">IF</span> g_target = c_table</span><br><span class="line">            <span class="keyword">THEN</span></span><br><span class="line">                <span class="comment">/* 1.2.18 Avoid context strings &gt; 500 characters */</span></span><br><span class="line">                l_context :=</span><br><span class="line">                    <span class="keyword">CASE</span></span><br><span class="line">                        <span class="keyword">WHEN</span> g_include_timestamp</span><br><span class="line">                        <span class="keyword">THEN</span></span><br><span class="line">                            TO_CHAR (<span class="keyword">SYSDATE</span>, <span class="string">'HH24:MI:SS-YYYYMMDD'</span>) || <span class="string">' '</span></span><br><span class="line">                        <span class="keyword">ELSE</span></span><br><span class="line">                            <span class="literal">NULL</span></span><br><span class="line">                    <span class="keyword">END</span>;</span><br><span class="line">                l_context := SUBSTR (l_context || context_in, 1, 500);</span><br><span class="line">                l_text := SUBSTR (text_in, 1, c_varchar2_max_length_db);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">INSERT</span> <span class="keyword">INTO</span> q$<span class="keyword">log</span> (<span class="keyword">id</span></span><br><span class="line">                                  ,<span class="keyword">context</span></span><br><span class="line">                                  ,<span class="built_in">text</span></span><br><span class="line">                                  ,call_stack</span><br><span class="line">                                  ,created_on</span><br><span class="line">                                  ,created_by)</span><br><span class="line">                <span class="keyword">VALUES</span> (</span><br><span class="line">                           q$log_seq.NEXTVAL</span><br><span class="line">                          ,l_context</span><br><span class="line">                          ,l_text</span><br><span class="line">                          ,<span class="keyword">SUBSTR</span> (DBMS_UTILITY.format_call_stack</span><br><span class="line">                                  ,<span class="number">1</span></span><br><span class="line">                                  ,c_varchar2_max_length_db)</span><br><span class="line">                          ,<span class="keyword">SYSDATE</span></span><br><span class="line">                          ,<span class="keyword">USER</span>);</span><br><span class="line">            ELSIF g_target = c_screen</span><br><span class="line">            THEN</span><br><span class="line">                pl (</span><br><span class="line">                    string_in =&gt; full_log_string (context_in</span><br><span class="line">                                                 ,text_in</span><br><span class="line">                                                 ,level_in));</span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">              Write to file now occurs in front end when tracing is terminated</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">              ELSIF g_target = c_file</span></span><br><span class="line"><span class="comment">              THEN</span></span><br><span class="line"><span class="comment">             utx_file.put_line (g_file_info.file_handle</span></span><br><span class="line"><span class="comment">              , full_log_string (context_in, text_in, level_in)</span></span><br><span class="line"><span class="comment">             );</span></span><br><span class="line"><span class="comment">             -- 1.2.3: close and reopen file</span></span><br><span class="line"><span class="comment">             g_file_info.lines_written := g_file_info.lines_written + 1;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">             IF g_file_info.lines_written &gt;= c_close_threshold</span></span><br><span class="line"><span class="comment">             THEN</span></span><br><span class="line"><span class="comment">              utx_file.fclose (g_file_info.file_handle);</span></span><br><span class="line"><span class="comment">              g_file_info.file_handle :=</span></span><br><span class="line"><span class="comment">             utx_file.fopen (g_file_info.dir</span></span><br><span class="line"><span class="comment">             , g_file_info.filename</span></span><br><span class="line"><span class="comment">             , 'A'</span></span><br><span class="line"><span class="comment">             , max_linesize  =&gt; 32767</span></span><br><span class="line"><span class="comment">              );</span></span><br><span class="line"><span class="comment">              g_file_info.lines_written := 0;</span></span><br><span class="line"><span class="comment">             END IF;*/</span></span><br><span class="line">            <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">COMMIT</span>;</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line">    EXCEPTION</span><br><span class="line">        WHEN OTHERS</span><br><span class="line">        THEN</span><br><span class="line">            <span class="keyword">ROLLBACK</span>;</span><br><span class="line">            RAISE;</span><br><span class="line">    <span class="keyword">END</span> <span class="keyword">trace</span>;</span><br><span class="line"></span><br><span class="line">    PROCEDURE trace (context_in       IN q$log.context%TYPE</span><br><span class="line">                    ,boolean_in       IN BOOLEAN</span><br><span class="line">                    ,force_trace_in   IN BOOLEAN DEFAULT FALSE</span><br><span class="line">                    ,level_in         IN PLS_INTEGER DEFAULT NULL)</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">IF</span> boolean_in</span><br><span class="line">        <span class="keyword">THEN</span></span><br><span class="line">            <span class="keyword">trace</span> (context_in</span><br><span class="line">                  ,<span class="string">'TRUE'</span></span><br><span class="line">                  ,force_trace_in   =&gt; force_trace_in</span><br><span class="line">                  ,level_in         =&gt; level_in);</span><br><span class="line">        ELSIF NOT boolean_in</span><br><span class="line">        THEN</span><br><span class="line">            trace (context_in</span><br><span class="line">                  ,'FALSE'</span><br><span class="line">                  ,force_trace_in   =&gt; force_trace_in</span><br><span class="line">                  ,level_in         =&gt; level_in);</span><br><span class="line">        ELSE</span><br><span class="line">            trace (context_in</span><br><span class="line">                  ,'NULL BOOLEAN'</span><br><span class="line">                  ,force_trace_in   =&gt; force_trace_in</span><br><span class="line">                  ,level_in         =&gt; level_in);</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line">    <span class="keyword">END</span> <span class="keyword">trace</span>;</span><br><span class="line"></span><br><span class="line">    PROCEDURE trace (context_in       IN q$log.context%TYPE</span><br><span class="line">                    ,number_in        IN NUMBER</span><br><span class="line">                    ,force_trace_in   IN BOOLEAN DEFAULT FALSE</span><br><span class="line">                    ,level_in         IN PLS_INTEGER DEFAULT NULL)</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">trace</span> (context_in</span><br><span class="line">              ,TO_CHAR (number_in)</span><br><span class="line">              ,force_trace_in   =&gt; force_trace_in</span><br><span class="line">              ,level_in         =&gt; level_in);</span><br><span class="line">    <span class="keyword">END</span> <span class="keyword">trace</span>;</span><br><span class="line"></span><br><span class="line">    PROCEDURE trace (context_in       IN q$log.context%TYPE</span><br><span class="line">                    ,date_in          IN DATE</span><br><span class="line">                    ,force_trace_in   IN BOOLEAN DEFAULT FALSE</span><br><span class="line">                    ,level_in         IN PLS_INTEGER DEFAULT NULL)</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">trace</span> (context_in</span><br><span class="line">              ,TO_CHAR (date_in, <span class="string">'YYYY MM DD HH24:MI:SS'</span>)</span><br><span class="line">              ,force_trace_in   =&gt; force_trace_in</span><br><span class="line">              ,level_in         =&gt; level_in);</span><br><span class="line">    <span class="keyword">END</span> <span class="keyword">trace</span>;</span><br><span class="line"></span><br><span class="line">    PROCEDURE trace (context_in       IN q$log.context%TYPE</span><br><span class="line">                    ,clob_in          IN CLOB</span><br><span class="line">                    ,force_trace_in   IN BOOLEAN DEFAULT FALSE</span><br><span class="line">                    ,level_in         IN PLS_INTEGER DEFAULT NULL)</span><br><span class="line">    IS</span><br><span class="line">        <span class="comment">-- Maximum size set by column restriction</span></span><br><span class="line">        buffer      VARCHAR2 (4000);</span><br><span class="line">        amount      BINARY_INTEGER := 4000;</span><br><span class="line">        position    INTEGER := 1;</span><br><span class="line">        l_notnull   BOOLEAN := FALSE;</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">LOOP</span></span><br><span class="line">            DBMS_LOB.read (clob_in</span><br><span class="line">                          ,amount</span><br><span class="line">                          ,<span class="keyword">position</span></span><br><span class="line">                          ,buffer);</span><br><span class="line">            l_notnull := TRUE;</span><br><span class="line">            trace (</span><br><span class="line">                CASE WHEN position = 1 THEN context_in ELSE NULL <span class="keyword">END</span></span><br><span class="line">               ,buffer</span><br><span class="line">               ,force_trace_in   =&gt; force_trace_in</span><br><span class="line">               ,level_in         =&gt; <span class="keyword">CASE</span></span><br><span class="line">                                       <span class="keyword">WHEN</span> <span class="keyword">position</span> = <span class="number">1</span> <span class="keyword">THEN</span> level_in</span><br><span class="line">                                       <span class="keyword">ELSE</span> <span class="number">0</span></span><br><span class="line">                                   <span class="keyword">END</span>);</span><br><span class="line">            position := position + amount;</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">LOOP</span>;</span><br><span class="line">    EXCEPTION</span><br><span class="line">        WHEN NO_DATA_FOUND OR VALUE_ERROR</span><br><span class="line">        THEN</span><br><span class="line">            <span class="comment">-- Make sure that at least the trace message is written.</span></span><br><span class="line">            IF NOT l_notnull</span><br><span class="line">            THEN</span><br><span class="line">                trace (context_in</span><br><span class="line">                      ,''</span><br><span class="line">                      ,force_trace_in</span><br><span class="line">                      ,level_in);</span><br><span class="line">            <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line">    <span class="keyword">END</span> <span class="keyword">trace</span>;</span><br><span class="line"></span><br><span class="line">    FUNCTION build_where_clause_show_trace (</span><br><span class="line">        from_id_in        IN q$log.id%TYPE := NULL</span><br><span class="line">       ,context_like_in   IN VARCHAR2 := '%'</span><br><span class="line">       ,text_like_in      IN VARCHAR2 := '%')</span><br><span class="line">        RETURN VARCHAR2</span><br><span class="line">    IS</span><br><span class="line">        l_where   VARCHAR2 (1000);</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">IF</span> from_id_in <span class="keyword">IS</span> <span class="literal">NULL</span></span><br><span class="line">        <span class="keyword">THEN</span></span><br><span class="line">            l_where := <span class="string">'1 = 1'</span>;</span><br><span class="line">        ELSE</span><br><span class="line">            l_where := 'id &gt;= ' || from_id_in;</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line"></span><br><span class="line">        l_where :=</span><br><span class="line">               l_where</span><br><span class="line">            || ' AND context LIKE ''%'</span><br><span class="line">            || context_like_in</span><br><span class="line">            || '%'' AND text LIKE ''%'</span><br><span class="line">            || text_like_in</span><br><span class="line">            || '%''';</span><br><span class="line">        RETURN l_where;</span><br><span class="line">    <span class="keyword">END</span> build_where_clause_show_trace;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- writes to the console the trace rows</span></span><br><span class="line">    <span class="comment">-- given (optionally filtered in any combination):</span></span><br><span class="line">    <span class="comment">--  trace id, context, text</span></span><br><span class="line">    <span class="comment">-- may be limited by limit_in</span></span><br><span class="line">    <span class="comment">-- call stack can also be displayed</span></span><br><span class="line">    PROCEDURE show_trace (from_id_in              IN q$log.id%TYPE := NULL</span><br><span class="line">                         ,context_like_in         IN VARCHAR2 := '%'</span><br><span class="line">                         ,text_like_in            IN VARCHAR2 := '%'</span><br><span class="line">                         ,limit_in                IN PLS_INTEGER := NULL</span><br><span class="line">                         ,include_call_stack_in   IN BOOLEAN := TRUE)</span><br><span class="line">    IS</span><br><span class="line">        l_where             VARCHAR2 (1000);</span><br><span class="line">        l_entries           q$log_tc;</span><br><span class="line">        l_index             PLS_INTEGER;</span><br><span class="line">        limit_not_reached   BOOLEAN := TRUE;</span><br><span class="line"></span><br><span class="line">        FUNCTION all_logs_by (where_clause_in IN VARCHAR2)</span><br><span class="line">            RETURN q$log_tc</span><br><span class="line">        IS</span><br><span class="line">            TYPE weak_rc IS REF CURSOR;</span><br><span class="line"></span><br><span class="line">            allrows_cur   weak_rc;</span><br><span class="line">            <span class="comment">--1.4.1    l_rows        PLS_INTEGER;</span></span><br><span class="line">            retval        q$log_tc;</span><br><span class="line">        <span class="keyword">BEGIN</span></span><br><span class="line">            <span class="keyword">OPEN</span> allrows_cur <span class="keyword">FOR</span></span><br><span class="line">                <span class="string">'SELECT</span></span><br><span class="line"><span class="string">                     ID,</span></span><br><span class="line"><span class="string">                     CONTEXT,</span></span><br><span class="line"><span class="string">                     TEXT,</span></span><br><span class="line"><span class="string">                     CALL_STACK,</span></span><br><span class="line"><span class="string">                     CREATED_ON,</span></span><br><span class="line"><span class="string">                     CREATED_BY,</span></span><br><span class="line"><span class="string">                     CHANGED_ON,</span></span><br><span class="line"><span class="string">                     CHANGED_BY</span></span><br><span class="line"><span class="string">              FROM q$log WHERE '</span> || where_clause_in;</span><br><span class="line"></span><br><span class="line">            LOOP</span><br><span class="line">                FETCH allrows_cur INTO retval (retval.COUNT + 1);</span><br><span class="line"></span><br><span class="line">                EXIT WHEN allrows_cur%NOTFOUND;</span><br><span class="line">            <span class="keyword">END</span> <span class="keyword">LOOP</span>;</span><br><span class="line"></span><br><span class="line">            RETURN retval;</span><br><span class="line">        <span class="keyword">END</span> all_logs_by;</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        l_where :=</span><br><span class="line">            build_where_clause_show_trace (</span><br><span class="line">                from_id_in        =&gt; from_id_in</span><br><span class="line">               ,context_like_in   =&gt; context_like_in</span><br><span class="line">               ,text_like_in      =&gt; text_like_in);</span><br><span class="line">        l_entries := all_logs_by (l_where);</span><br><span class="line">        l_index := l_entries.FIRST;</span><br><span class="line"></span><br><span class="line">        WHILE (l_index IS NOT NULL AND limit_not_reached)</span><br><span class="line">        LOOP</span><br><span class="line">            pl (</span><br><span class="line">                   'ID-Context-Text = '</span><br><span class="line">                || l_entries (l_index).id</span><br><span class="line">                || '-'</span><br><span class="line">                || l_entries (l_index).context</span><br><span class="line">                || '-'</span><br><span class="line">                || l_entries (l_index).text);</span><br><span class="line"></span><br><span class="line">            IF include_call_stack_in</span><br><span class="line">            THEN</span><br><span class="line">                pl (l_entries (l_index).call_stack);</span><br><span class="line">            <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line"></span><br><span class="line">            pl ('<span class="comment">------------------------------------------------');</span></span><br><span class="line">            l_index := l_entries.NEXT (l_index);</span><br><span class="line">            limit_not_reached := (l_index &lt;= limit_in OR limit_in IS NULL);</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">LOOP</span>;</span><br><span class="line">    <span class="keyword">END</span> show_trace;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-------------------------------------------</span></span><br><span class="line">    <span class="comment">-- Error handling and raising functionality</span></span><br><span class="line">    <span class="comment">-------------------------------------------</span></span><br><span class="line">    PROCEDURE internal_raise (code_in IN PLS_INTEGER, message_in IN VARCHAR2)</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="comment">-- 4/2004: Keep this trace call in? Offer it as an option?</span></span><br><span class="line">        <span class="comment">-- 5/2005: Made it optional, based on the trace setting.</span></span><br><span class="line">        <span class="keyword">IF</span> error_trace_enabled</span><br><span class="line">        <span class="keyword">THEN</span></span><br><span class="line">            <span class="keyword">trace</span> (</span><br><span class="line">                <span class="string">'ERROR RAISED'</span></span><br><span class="line">               ,   <span class="string">'Oracle error = '</span></span><br><span class="line">                || code_in</span><br><span class="line">                || <span class="string">' - Error instance handle = '</span></span><br><span class="line">                || message_in</span><br><span class="line">               ,<span class="literal">FALSE</span>);</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line"></span><br><span class="line">        raise_application_error (code_in, message_in);</span><br><span class="line">    <span class="keyword">END</span> internal_raise;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- Global contexts; not tied to any specific instance.</span></span><br><span class="line">    PROCEDURE add_gcontext (NAME_IN    IN q$error_context.name%TYPE</span><br><span class="line">                           ,value_in   IN q$error_context.VALUE%TYPE)</span><br><span class="line">    IS</span><br><span class="line">        l_name      q$error_context.name%TYPE := UPPER (NAME_IN);</span><br><span class="line">        l_row       PLS_INTEGER := g_gcontexts.FIRST;</span><br><span class="line">        l_matched   BOOLEAN := FALSE;</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">WHILE</span> (l_row <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">AND</span> <span class="keyword">NOT</span> l_matched)</span><br><span class="line">        <span class="keyword">LOOP</span></span><br><span class="line">            l_matched := l_name = g_gcontexts (l_row).name;</span><br><span class="line"></span><br><span class="line">            IF NOT l_matched</span><br><span class="line">            THEN</span><br><span class="line">                l_row := g_gcontexts.NEXT (l_row);</span><br><span class="line">            <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">LOOP</span>;</span><br><span class="line"></span><br><span class="line">        IF NOT l_matched</span><br><span class="line">        THEN</span><br><span class="line">            l_row := g_gcontexts.COUNT + 1;</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line"></span><br><span class="line">        g_gcontexts (l_row).name := l_name;</span><br><span class="line">        g_gcontexts (l_row).VALUE := value_in;</span><br><span class="line">    <span class="keyword">END</span> add_gcontext;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- Remove all global contexts.</span></span><br><span class="line">    <span class="comment">-- This is called by mark_q$error_handled as well.</span></span><br><span class="line">    PROCEDURE clear_gcontexts</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        g_gcontexts.delete;</span><br><span class="line">    <span class="keyword">END</span> clear_gcontexts;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- Set a single context value</span></span><br><span class="line">    PROCEDURE add_context (</span><br><span class="line">        error_instance_id_in   IN q$error_instance.id%TYPE</span><br><span class="line">       ,NAME_IN                IN q$error_context.name%TYPE</span><br><span class="line">       ,value_in               IN q$error_context.VALUE%TYPE</span><br><span class="line">       ,validate_in            IN BOOLEAN DEFAULT TRUE)</span><br><span class="line">    IS</span><br><span class="line">        <span class="keyword">PRAGMA</span> AUTONOMOUS_TRANSACTION;</span><br><span class="line">        l_error_instance   q$error_instance%ROWTYPE;</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">IF</span> NAME_IN <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line">        <span class="keyword">THEN</span></span><br><span class="line">            <span class="keyword">IF</span> validate_in</span><br><span class="line">            <span class="keyword">THEN</span></span><br><span class="line">                l_error_instance :=</span><br><span class="line">                    q$error_instance_qp_onerow (error_instance_id_in);</span><br><span class="line">            ELSE</span><br><span class="line">                l_error_instance.id := error_instance_id_in;</span><br><span class="line">            <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">INSERT</span> <span class="keyword">INTO</span> q$error_context (<span class="keyword">id</span></span><br><span class="line">                                        ,error_instance_id</span><br><span class="line">                                        ,<span class="keyword">name</span></span><br><span class="line">                                        ,<span class="keyword">VALUE</span>)</span><br><span class="line">            <span class="keyword">VALUES</span> (q$error_context_seq.NEXTVAL</span><br><span class="line">                   ,l_error_instance.id</span><br><span class="line">                   ,NAME_IN</span><br><span class="line">                   ,value_in);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">COMMIT</span>;</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line">    EXCEPTION</span><br><span class="line">        WHEN DUP_VAL_ON_INDEX</span><br><span class="line">        THEN</span><br><span class="line">            <span class="keyword">ROLLBACK</span>;</span><br><span class="line">        WHEN OTHERS</span><br><span class="line">        THEN</span><br><span class="line">            <span class="keyword">ROLLBACK</span>;</span><br><span class="line">            internal_raise (</span><br><span class="line">                c_default_error_code</span><br><span class="line">               ,   'Unable to <span class="keyword">insert</span> QD <span class="keyword">context</span> <span class="keyword">for</span> <span class="string">"'</span></span><br><span class="line"><span class="string">                || NAME_IN</span></span><br><span class="line"><span class="string">                || '"</span> <span class="keyword">with</span> <span class="keyword">value</span> <span class="string">"'</span></span><br><span class="line"><span class="string">                || value_in</span></span><br><span class="line"><span class="string">                || '"</span> <span class="keyword">for</span> <span class="keyword">instance</span> <span class="keyword">ID</span> <span class="string">'</span></span><br><span class="line"><span class="string">                || l_error_instance.id</span></span><br><span class="line"><span class="string">                || '</span> <span class="keyword">with</span> <span class="keyword">Oracle</span> <span class="keyword">error</span> = <span class="string">'</span></span><br><span class="line"><span class="string">                || SQLCODE);</span></span><br><span class="line"><span class="string">    END add_context;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    PROCEDURE add_context (err_instance_id_in   IN q$error_instance.id%TYPE</span></span><br><span class="line"><span class="string">                          ,NAME_IN              IN q$error_context.name%TYPE</span></span><br><span class="line"><span class="string">                          ,value_in             IN q$error_context.VALUE%TYPE</span></span><br><span class="line"><span class="string">                          ,validate_in          IN BOOLEAN DEFAULT TRUE)</span></span><br><span class="line"><span class="string">    IS</span></span><br><span class="line"><span class="string">    BEGIN</span></span><br><span class="line"><span class="string">        add_context (error_instance_id_in   =&gt; err_instance_id_in</span></span><br><span class="line"><span class="string">                    ,NAME_IN                =&gt; NAME_IN</span></span><br><span class="line"><span class="string">                    ,value_in               =&gt; value_in</span></span><br><span class="line"><span class="string">                    ,validate_in            =&gt; validate_in);</span></span><br><span class="line"><span class="string">    END add_context;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    -- An error needs to be raised or logged.</span></span><br><span class="line"><span class="string">    -- Get a message handle for this particular error instance.</span></span><br><span class="line"><span class="string">    -- The "error message" id keeps track of both the error</span></span><br><span class="line"><span class="string">    -- and message information. This program also serves as</span></span><br><span class="line"><span class="string">    -- "record and go" and "go". In other words, we do not</span></span><br><span class="line"><span class="string">    -- raise an error, but it is noted.</span></span><br><span class="line"><span class="string">    --</span></span><br><span class="line"><span class="string">    PROCEDURE register_error_instance (</span></span><br><span class="line"><span class="string">        error_in                IN     q$error%ROWTYPE</span></span><br><span class="line"><span class="string">       ,text_in                 IN     q$error_instance.MESSAGE%TYPE := NULL</span></span><br><span class="line"><span class="string">       ,error_instance_id_out   IN OUT q$error_instance.id%TYPE</span></span><br><span class="line"><span class="string">       ,name1_in                IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,value1_in               IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,name2_in                IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,value2_in               IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,name3_in                IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,value3_in               IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,name4_in                IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,value4_in               IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,name5_in                IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,value5_in               IN     VARCHAR2 DEFAULT NULL)</span></span><br><span class="line"><span class="string">    IS</span></span><br><span class="line"><span class="string">        l_error_instance_id   q$error_instance.id%TYPE;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        PROCEDURE add_context_values</span></span><br><span class="line"><span class="string">        IS</span></span><br><span class="line"><span class="string">            l_row   PLS_INTEGER;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            PROCEDURE add_one (NAME_IN IN VARCHAR2, value_in IN VARCHAR2)</span></span><br><span class="line"><span class="string">            IS</span></span><br><span class="line"><span class="string">            BEGIN</span></span><br><span class="line"><span class="string">                IF NAME_IN IS NOT NULL</span></span><br><span class="line"><span class="string">                THEN</span></span><br><span class="line"><span class="string">                    INSERT INTO q$error_context (id</span></span><br><span class="line"><span class="string">                                                ,error_instance_id</span></span><br><span class="line"><span class="string">                                                ,name</span></span><br><span class="line"><span class="string">                                                ,VALUE)</span></span><br><span class="line"><span class="string">                    VALUES (q$error_context_seq.NEXTVAL</span></span><br><span class="line"><span class="string">                           ,l_error_instance_id</span></span><br><span class="line"><span class="string">                           ,SUBSTR (NAME_IN, 1, c_varchar2_max_length_db)</span></span><br><span class="line"><span class="string">                           ,SUBSTR (value_in, 1, c_varchar2_max_length_db));</span></span><br><span class="line"><span class="string">                END IF;</span></span><br><span class="line"><span class="string">            EXCEPTION</span></span><br><span class="line"><span class="string">                WHEN DUP_VAL_ON_INDEX</span></span><br><span class="line"><span class="string">                THEN</span></span><br><span class="line"><span class="string">                    -- Entering another value for the same context. Mention it in the trace.</span></span><br><span class="line"><span class="string">                    trace (</span></span><br><span class="line"><span class="string">                        '</span><span class="keyword">ADD</span> <span class="keyword">CONTEXT</span><span class="string">'</span></span><br><span class="line"><span class="string">                       ,   '</span><span class="keyword">Duplicate</span> entry <span class="keyword">for</span> <span class="string">"'</span></span><br><span class="line"><span class="string">                        || NAME_IN</span></span><br><span class="line"><span class="string">                        || '"</span> <span class="keyword">with</span> <span class="keyword">value</span> <span class="string">"'</span></span><br><span class="line"><span class="string">                        || value_in</span></span><br><span class="line"><span class="string">                        || '"</span> <span class="keyword">for</span> <span class="keyword">instance</span> <span class="keyword">ID</span> <span class="string">'</span></span><br><span class="line"><span class="string">                        || l_error_instance_id</span></span><br><span class="line"><span class="string">                       ,TRUE);</span></span><br><span class="line"><span class="string">            END add_one;</span></span><br><span class="line"><span class="string">        BEGIN</span></span><br><span class="line"><span class="string">            add_one (name1_in, value1_in);</span></span><br><span class="line"><span class="string">            add_one (name2_in, value2_in);</span></span><br><span class="line"><span class="string">            add_one (name3_in, value3_in);</span></span><br><span class="line"><span class="string">            add_one (name4_in, value4_in);</span></span><br><span class="line"><span class="string">            add_one (name5_in, value5_in);</span></span><br><span class="line"><span class="string">            --</span></span><br><span class="line"><span class="string">            -- Add any global contexts</span></span><br><span class="line"><span class="string">            l_row := g_gcontexts.FIRST;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            WHILE (l_row IS NOT NULL)</span></span><br><span class="line"><span class="string">            LOOP</span></span><br><span class="line"><span class="string">                add_one (g_gcontexts (l_row).name, g_gcontexts (l_row).VALUE);</span></span><br><span class="line"><span class="string">                l_row := g_gcontexts.NEXT (l_row);</span></span><br><span class="line"><span class="string">            END LOOP;</span></span><br><span class="line"><span class="string">        END add_context_values;</span></span><br><span class="line"><span class="string">    BEGIN</span></span><br><span class="line"><span class="string">        IF q$error_raised</span></span><br><span class="line"><span class="string">        THEN</span></span><br><span class="line"><span class="string">            -- Just continue to propagate this error instance.</span></span><br><span class="line"><span class="string">            error_instance_id_out := q$error_instance_id_raised;</span></span><br><span class="line"><span class="string">        ELSE</span></span><br><span class="line"><span class="string">            SELECT q$error_instance_seq.NEXTVAL</span></span><br><span class="line"><span class="string">              INTO l_error_instance_id</span></span><br><span class="line"><span class="string">              FROM DUAL;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            INSERT INTO q$error_instance (id</span></span><br><span class="line"><span class="string">                                         ,error_id</span></span><br><span class="line"><span class="string">                                         ,error_stack</span></span><br><span class="line"><span class="string">                                         ,call_stack</span></span><br><span class="line"><span class="string">                                         ,MESSAGE</span></span><br><span class="line"><span class="string">                                         ,system_error_code</span></span><br><span class="line"><span class="string">                                         ,system_error_message)</span></span><br><span class="line"><span class="string">            VALUES (</span></span><br><span class="line"><span class="string">                       l_error_instance_id</span></span><br><span class="line"><span class="string">                      ,error_in.id</span></span><br><span class="line"><span class="string">                      ,SUBSTR (g_grabbed_settings.error_stack</span></span><br><span class="line"><span class="string">                              ,1</span></span><br><span class="line"><span class="string">                              ,c_varchar2_max_length_db)</span></span><br><span class="line"><span class="string">                      ,SUBSTR (g_grabbed_settings.call_stack</span></span><br><span class="line"><span class="string">                              ,1</span></span><br><span class="line"><span class="string">                              ,c_varchar2_max_length_db)</span></span><br><span class="line"><span class="string">                      ,SUBSTR (text_in, 1, c_varchar2_max_length_db)</span></span><br><span class="line"><span class="string">                      ,SUBSTR (g_grabbed_settings.system_error_code</span></span><br><span class="line"><span class="string">                              ,1</span></span><br><span class="line"><span class="string">                              ,c_varchar2_max_length_db)</span></span><br><span class="line"><span class="string">                      ,SUBSTR (g_grabbed_settings.system_error_message</span></span><br><span class="line"><span class="string">                              ,1</span></span><br><span class="line"><span class="string">                              ,c_varchar2_max_length_db));</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            add_context_values;</span></span><br><span class="line"><span class="string">            mark_q$error_raised (l_error_instance_id);</span></span><br><span class="line"><span class="string">            error_instance_id_out := l_error_instance_id;</span></span><br><span class="line"><span class="string">        END IF;</span></span><br><span class="line"><span class="string">    END register_error_instance;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    PROCEDURE grab_settings</span></span><br><span class="line"><span class="string">    IS</span></span><br><span class="line"><span class="string">    BEGIN</span></span><br><span class="line"><span class="string">        g_grabbed_settings.system_error_code := SQLCODE;</span></span><br><span class="line"><span class="string">        g_grabbed_settings.system_error_message :=</span></span><br><span class="line"><span class="string">            DBMS_UTILITY.format_error_stack;</span></span><br><span class="line"><span class="string">        g_grabbed_settings.error_stack := error_backtrace;</span></span><br><span class="line"><span class="string">        g_grabbed_settings.call_stack := DBMS_UTILITY.format_call_stack;</span></span><br><span class="line"><span class="string">    END grab_settings;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    PROCEDURE register_error (</span></span><br><span class="line"><span class="string">        error_code_in           IN     q$error.code%TYPE</span></span><br><span class="line"><span class="string">       ,error_instance_id_out   IN OUT q$error_instance.id%TYPE</span></span><br><span class="line"><span class="string">       ,text_in                 IN     q$error_instance.MESSAGE%TYPE := NULL</span></span><br><span class="line"><span class="string">       ,name1_in                IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,value1_in               IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,name2_in                IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,value2_in               IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,name3_in                IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,value3_in               IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,name4_in                IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,value4_in               IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,name5_in                IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,value5_in               IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,grab_settings_in        IN     BOOLEAN DEFAULT TRUE)</span></span><br><span class="line"><span class="string">    IS</span></span><br><span class="line"><span class="string">        PRAGMA AUTONOMOUS_TRANSACTION;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        FUNCTION error_from_repository (error_code_in IN PLS_INTEGER)</span></span><br><span class="line"><span class="string">            RETURN q$error%ROWTYPE</span></span><br><span class="line"><span class="string">        IS</span></span><br><span class="line"><span class="string">            l_error   q$error%ROWTYPE;</span></span><br><span class="line"><span class="string">        BEGIN</span></span><br><span class="line"><span class="string">            /* If the error code is an Oracle error, do not create</span></span><br><span class="line"><span class="string">             an "undefined" entry in the error log table.</span></span><br><span class="line"><span class="string">              */</span></span><br><span class="line"><span class="string">            BEGIN</span></span><br><span class="line"><span class="string">                SELECT id</span></span><br><span class="line"><span class="string">                  INTO l_error.id</span></span><br><span class="line"><span class="string">                  FROM q$error</span></span><br><span class="line"><span class="string">                 WHERE code = error_code_in;</span></span><br><span class="line"><span class="string">            EXCEPTION</span></span><br><span class="line"><span class="string">                WHEN NO_DATA_FOUND</span></span><br><span class="line"><span class="string">                THEN</span></span><br><span class="line"><span class="string">                    l_error.id := NULL;</span></span><br><span class="line"><span class="string">            END;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            IF l_error.id IS NULL          -- an unknown error; record as such</span></span><br><span class="line"><span class="string">            THEN</span></span><br><span class="line"><span class="string">                SELECT q$error_seq.NEXTVAL INTO l_error.id FROM DUAL;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                IF is_valid_oracle_error (error_code_in)</span></span><br><span class="line"><span class="string">                THEN</span></span><br><span class="line"><span class="string">                    l_error.name := sqlcode_name (error_code_in);</span></span><br><span class="line"><span class="string">                    l_error.description := sqlcode_text (error_code_in);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                    INSERT INTO q$error (id</span></span><br><span class="line"><span class="string">                                        ,code</span></span><br><span class="line"><span class="string">                                        ,name</span></span><br><span class="line"><span class="string">                                        ,description</span></span><br><span class="line"><span class="string">                                        ,error_category_name)</span></span><br><span class="line"><span class="string">                    VALUES (l_error.id</span></span><br><span class="line"><span class="string">                           ,error_code_in</span></span><br><span class="line"><span class="string">                           ,l_error.name</span></span><br><span class="line"><span class="string">                           ,l_error.description</span></span><br><span class="line"><span class="string">                           ,'</span><span class="keyword">Oracle</span> <span class="keyword">Error</span><span class="string">');</span></span><br><span class="line"><span class="string">                ELSE</span></span><br><span class="line"><span class="string">                    l_error.name := SQLERRM (error_code_in);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                    INSERT INTO q$error (id</span></span><br><span class="line"><span class="string">                                        ,code</span></span><br><span class="line"><span class="string">                                        ,name</span></span><br><span class="line"><span class="string">                                        ,description</span></span><br><span class="line"><span class="string">                                        ,error_category_name)</span></span><br><span class="line"><span class="string">                    VALUES (</span></span><br><span class="line"><span class="string">                               l_error.id</span></span><br><span class="line"><span class="string">                              ,error_code_in</span></span><br><span class="line"><span class="string">                              ,l_error.name</span></span><br><span class="line"><span class="string">                              ,'</span>Undefined runtime <span class="keyword">error</span>: <span class="string">' || error_code_in</span></span><br><span class="line"><span class="string">                               || '</span>. You should <span class="keyword">define</span> this <span class="keyword">in</span> the <span class="keyword">error</span> repository.<span class="string">'</span></span><br><span class="line"><span class="string">                              ,'</span>UNDEFINED<span class="string">');</span></span><br><span class="line"><span class="string">                END IF;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                l_error := q$error_qp_onerow (l_error.id);</span></span><br><span class="line"><span class="string">            END IF;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            RETURN l_error;</span></span><br><span class="line"><span class="string">        END error_from_repository;</span></span><br><span class="line"><span class="string">    BEGIN</span></span><br><span class="line"><span class="string">        IF q$error_raised</span></span><br><span class="line"><span class="string">        THEN</span></span><br><span class="line"><span class="string">            -- Just continue to propagate this error instance.</span></span><br><span class="line"><span class="string">            error_instance_id_out := q$error_instance_id_raised;</span></span><br><span class="line"><span class="string">        ELSE</span></span><br><span class="line"><span class="string">            IF grab_settings_in</span></span><br><span class="line"><span class="string">            THEN</span></span><br><span class="line"><span class="string">                grab_settings;</span></span><br><span class="line"><span class="string">            END IF;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            register_error_instance (</span></span><br><span class="line"><span class="string">                error_from_repository (error_code_in)</span></span><br><span class="line"><span class="string">               ,text_in                 =&gt; text_in</span></span><br><span class="line"><span class="string">               ,error_instance_id_out   =&gt; error_instance_id_out</span></span><br><span class="line"><span class="string">               ,name1_in                =&gt; name1_in</span></span><br><span class="line"><span class="string">               ,value1_in               =&gt; value1_in</span></span><br><span class="line"><span class="string">               ,name2_in                =&gt; name2_in</span></span><br><span class="line"><span class="string">               ,value2_in               =&gt; value2_in</span></span><br><span class="line"><span class="string">               ,name3_in                =&gt; name3_in</span></span><br><span class="line"><span class="string">               ,value3_in               =&gt; value3_in</span></span><br><span class="line"><span class="string">               ,name4_in                =&gt; name4_in</span></span><br><span class="line"><span class="string">               ,value4_in               =&gt; value4_in</span></span><br><span class="line"><span class="string">               ,name5_in                =&gt; name5_in</span></span><br><span class="line"><span class="string">               ,value5_in               =&gt; value5_in);</span></span><br><span class="line"><span class="string">            COMMIT;</span></span><br><span class="line"><span class="string">        END IF;</span></span><br><span class="line"><span class="string">    EXCEPTION</span></span><br><span class="line"><span class="string">        WHEN OTHERS</span></span><br><span class="line"><span class="string">        THEN</span></span><br><span class="line"><span class="string">            ROLLBACK;</span></span><br><span class="line"><span class="string">            RAISE;</span></span><br><span class="line"><span class="string">    END register_error;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    /* 1.3.6 Standardize arg name - this OL no longer needed</span></span><br><span class="line"><span class="string">    PROCEDURE register_error (</span></span><br><span class="line"><span class="string">       error_code_in       IN     q$error.code%TYPE</span></span><br><span class="line"><span class="string">     , error_instance_id_out IN OUT q$error_instance.id%TYPE</span></span><br><span class="line"><span class="string">     , text_in             IN     q$error_instance.MESSAGE%TYPE:= NULL</span></span><br><span class="line"><span class="string">     , name1_in            IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">     , value1_in           IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">     , name2_in            IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">     , value2_in           IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">     , name3_in            IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">     , value3_in           IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">     , name4_in            IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">     , value4_in           IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">     , name5_in            IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">     , value5_in           IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">     , grab_settings_in    IN     BOOLEAN DEFAULT TRUE</span></span><br><span class="line"><span class="string">    )</span></span><br><span class="line"><span class="string">    IS</span></span><br><span class="line"><span class="string">    BEGIN</span></span><br><span class="line"><span class="string">       register_error (error_code_in =&gt; error_code_in</span></span><br><span class="line"><span class="string">                     , error_instance_id_out =&gt; err_instance_id_out</span></span><br><span class="line"><span class="string">                     , text_in =&gt; text_in</span></span><br><span class="line"><span class="string">                     , name1_in =&gt; name1_in</span></span><br><span class="line"><span class="string">                     , value1_in =&gt; value1_in</span></span><br><span class="line"><span class="string">                     , name2_in =&gt; name2_in</span></span><br><span class="line"><span class="string">                     , value2_in =&gt; value2_in</span></span><br><span class="line"><span class="string">                     , name3_in =&gt; name3_in</span></span><br><span class="line"><span class="string">                     , value3_in =&gt; value3_in</span></span><br><span class="line"><span class="string">                     , name4_in =&gt; name4_in</span></span><br><span class="line"><span class="string">                     , value4_in =&gt; value4_in</span></span><br><span class="line"><span class="string">                     , name5_in =&gt; name5_in</span></span><br><span class="line"><span class="string">                     , value5_in =&gt; value5_in</span></span><br><span class="line"><span class="string">                     , grab_settings_in =&gt; grab_settings_in</span></span><br><span class="line"><span class="string">                      );</span></span><br><span class="line"><span class="string">    END;</span></span><br><span class="line"><span class="string">    */</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    PROCEDURE register_error (</span></span><br><span class="line"><span class="string">        error_name_in           IN     q$error.name%TYPE</span></span><br><span class="line"><span class="string">       ,error_instance_id_out   IN OUT q$error_instance.id%TYPE</span></span><br><span class="line"><span class="string">       ,text_in                 IN     q$error_instance.MESSAGE%TYPE := NULL</span></span><br><span class="line"><span class="string">       ,name1_in                IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,value1_in               IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,name2_in                IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,value2_in               IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,name3_in                IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,value3_in               IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,name4_in                IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,value4_in               IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,name5_in                IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,value5_in               IN     VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,grab_settings_in        IN     BOOLEAN DEFAULT TRUE)</span></span><br><span class="line"><span class="string">    IS</span></span><br><span class="line"><span class="string">        PRAGMA AUTONOMOUS_TRANSACTION;</span></span><br><span class="line"><span class="string">        l_error   q$error%ROWTYPE;</span></span><br><span class="line"><span class="string">    BEGIN</span></span><br><span class="line"><span class="string">        IF q$error_raised</span></span><br><span class="line"><span class="string">        THEN</span></span><br><span class="line"><span class="string">            -- Just continue to propagate this error instance.</span></span><br><span class="line"><span class="string">            error_instance_id_out := q$error_instance_id_raised;</span></span><br><span class="line"><span class="string">        ELSE</span></span><br><span class="line"><span class="string">            IF grab_settings_in</span></span><br><span class="line"><span class="string">            THEN</span></span><br><span class="line"><span class="string">                grab_settings;</span></span><br><span class="line"><span class="string">            END IF;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            BEGIN</span></span><br><span class="line"><span class="string">                SELECT id</span></span><br><span class="line"><span class="string">                  INTO l_error.id</span></span><br><span class="line"><span class="string">                  FROM q$error</span></span><br><span class="line"><span class="string">                 WHERE name = error_name_in;</span></span><br><span class="line"><span class="string">            EXCEPTION</span></span><br><span class="line"><span class="string">                WHEN NO_DATA_FOUND</span></span><br><span class="line"><span class="string">                THEN</span></span><br><span class="line"><span class="string">                    l_error.id := NULL;    -- Create new error if not present.</span></span><br><span class="line"><span class="string">            END;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            IF l_error.id IS NULL          -- an unknown error; record as such</span></span><br><span class="line"><span class="string">            THEN</span></span><br><span class="line"><span class="string">                SELECT q$error_seq.NEXTVAL INTO l_error.id FROM DUAL;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                INSERT INTO q$error (id, name, description)</span></span><br><span class="line"><span class="string">                VALUES (</span></span><br><span class="line"><span class="string">                           l_error.id</span></span><br><span class="line"><span class="string">                          ,error_name_in</span></span><br><span class="line"><span class="string">                          ,'</span>Undefined runtime <span class="keyword">error</span>: <span class="string">' || error_name_in</span></span><br><span class="line"><span class="string">                           || '</span>. You should <span class="keyword">define</span> this <span class="keyword">in</span> the <span class="keyword">error</span> repository.<span class="string">');</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                l_error := q$error_qp_onerow (l_error.id);</span></span><br><span class="line"><span class="string">            END IF;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            register_error_instance (</span></span><br><span class="line"><span class="string">                l_error</span></span><br><span class="line"><span class="string">               ,text_in                 =&gt; text_in</span></span><br><span class="line"><span class="string">               ,error_instance_id_out   =&gt; error_instance_id_out</span></span><br><span class="line"><span class="string">               ,name1_in                =&gt; name1_in</span></span><br><span class="line"><span class="string">               ,value1_in               =&gt; value1_in</span></span><br><span class="line"><span class="string">               ,name2_in                =&gt; name2_in</span></span><br><span class="line"><span class="string">               ,value2_in               =&gt; value2_in</span></span><br><span class="line"><span class="string">               ,name3_in                =&gt; name3_in</span></span><br><span class="line"><span class="string">               ,value3_in               =&gt; value3_in</span></span><br><span class="line"><span class="string">               ,name4_in                =&gt; name4_in</span></span><br><span class="line"><span class="string">               ,value4_in               =&gt; value4_in</span></span><br><span class="line"><span class="string">               ,name5_in                =&gt; name5_in</span></span><br><span class="line"><span class="string">               ,value5_in               =&gt; value5_in);</span></span><br><span class="line"><span class="string">            COMMIT;</span></span><br><span class="line"><span class="string">        END IF;</span></span><br><span class="line"><span class="string">    END register_error;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    PROCEDURE register_error (</span></span><br><span class="line"><span class="string">        error_code_in      IN q$error.code%TYPE</span></span><br><span class="line"><span class="string">       ,text_in            IN q$error_instance.MESSAGE%TYPE := NULL</span></span><br><span class="line"><span class="string">       ,name1_in           IN VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,value1_in          IN VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,name2_in           IN VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,value2_in          IN VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,name3_in           IN VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,value3_in          IN VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,name4_in           IN VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,value4_in          IN VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,name5_in           IN VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,value5_in          IN VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,grab_settings_in   IN BOOLEAN DEFAULT TRUE)</span></span><br><span class="line"><span class="string">    IS</span></span><br><span class="line"><span class="string">        l_error_instance_id   q$error_instance.id%TYPE;</span></span><br><span class="line"><span class="string">    BEGIN</span></span><br><span class="line"><span class="string">        IF q$error_raised</span></span><br><span class="line"><span class="string">        THEN</span></span><br><span class="line"><span class="string">            -- Just continue to propagate this error instance.</span></span><br><span class="line"><span class="string">            l_error_instance_id := q$error_instance_id_raised;</span></span><br><span class="line"><span class="string">        ELSE</span></span><br><span class="line"><span class="string">            IF grab_settings_in</span></span><br><span class="line"><span class="string">            THEN</span></span><br><span class="line"><span class="string">                grab_settings;</span></span><br><span class="line"><span class="string">            END IF;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            register_error (error_code_in           =&gt; error_code_in</span></span><br><span class="line"><span class="string">                           ,error_instance_id_out   =&gt; l_error_instance_id</span></span><br><span class="line"><span class="string">                           ,text_in                 =&gt; text_in</span></span><br><span class="line"><span class="string">                           ,name1_in                =&gt; name1_in</span></span><br><span class="line"><span class="string">                           ,value1_in               =&gt; value1_in</span></span><br><span class="line"><span class="string">                           ,name2_in                =&gt; name2_in</span></span><br><span class="line"><span class="string">                           ,value2_in               =&gt; value2_in</span></span><br><span class="line"><span class="string">                           ,name3_in                =&gt; name3_in</span></span><br><span class="line"><span class="string">                           ,value3_in               =&gt; value3_in</span></span><br><span class="line"><span class="string">                           ,name4_in                =&gt; name4_in</span></span><br><span class="line"><span class="string">                           ,value4_in               =&gt; value4_in</span></span><br><span class="line"><span class="string">                           ,name5_in                =&gt; name5_in</span></span><br><span class="line"><span class="string">                           ,value5_in               =&gt; value5_in</span></span><br><span class="line"><span class="string">                           ,grab_settings_in        =&gt; FALSE);</span></span><br><span class="line"><span class="string">        END IF;</span></span><br><span class="line"><span class="string">    END register_error;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    PROCEDURE register_error (</span></span><br><span class="line"><span class="string">        error_name_in      IN q$error.name%TYPE</span></span><br><span class="line"><span class="string">       ,text_in            IN q$error_instance.MESSAGE%TYPE := NULL</span></span><br><span class="line"><span class="string">       ,name1_in           IN VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,value1_in          IN VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,name2_in           IN VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,value2_in          IN VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,name3_in           IN VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,value3_in          IN VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,name4_in           IN VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,value4_in          IN VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,name5_in           IN VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,value5_in          IN VARCHAR2 DEFAULT NULL</span></span><br><span class="line"><span class="string">       ,grab_settings_in   IN BOOLEAN DEFAULT TRUE)</span></span><br><span class="line"><span class="string">    IS</span></span><br><span class="line"><span class="string">        l_error_instance_id   q$error_instance.id%TYPE;</span></span><br><span class="line"><span class="string">    BEGIN</span></span><br><span class="line"><span class="string">        IF q$error_raised</span></span><br><span class="line"><span class="string">        THEN</span></span><br><span class="line"><span class="string">            -- Just continue to propagate this error instance.</span></span><br><span class="line"><span class="string">            l_error_instance_id := q$error_instance_id_raised;</span></span><br><span class="line"><span class="string">        ELSE</span></span><br><span class="line"><span class="string">            IF grab_settings_in</span></span><br><span class="line"><span class="string">            THEN</span></span><br><span class="line"><span class="string">                grab_settings;</span></span><br><span class="line"><span class="string">            END IF;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            register_error (error_name_in           =&gt; error_name_in</span></span><br><span class="line"><span class="string">                           ,error_instance_id_out   =&gt; l_error_instance_id</span></span><br><span class="line"><span class="string">                           ,text_in                 =&gt; text_in</span></span><br><span class="line"><span class="string">                           ,name1_in                =&gt; name1_in</span></span><br><span class="line"><span class="string">                           ,value1_in               =&gt; value1_in</span></span><br><span class="line"><span class="string">                           ,name2_in                =&gt; name2_in</span></span><br><span class="line"><span class="string">                           ,value2_in               =&gt; value2_in</span></span><br><span class="line"><span class="string">                           ,name3_in                =&gt; name3_in</span></span><br><span class="line"><span class="string">                           ,value3_in               =&gt; value3_in</span></span><br><span class="line"><span class="string">                           ,name4_in                =&gt; name4_in</span></span><br><span class="line"><span class="string">                           ,value4_in               =&gt; value4_in</span></span><br><span class="line"><span class="string">                           ,name5_in                =&gt; name5_in</span></span><br><span class="line"><span class="string">                           ,value5_in               =&gt; value5_in);</span></span><br><span class="line"><span class="string">        END IF;</span></span><br><span class="line"><span class="string">    END register_error;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    /* V1.2.11 Allow user to specify that Oracle errors should be passed</span></span><br><span class="line"><span class="string">     directly in the Oracle error information, and not hidden</span></span><br><span class="line"><span class="string">     behind the "error instance" information.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">     "Hide" (don'</span>t <span class="keyword">show</span>) <span class="keyword">is</span> the <span class="keyword">default</span> setting.</span><br><span class="line">    */</span><br><span class="line">    <span class="keyword">PROCEDURE</span> show_oracle_error (</span><br><span class="line">        show_in                 <span class="keyword">IN</span> <span class="built_in">BOOLEAN</span></span><br><span class="line">       ,revert_after_raise_in   <span class="keyword">IN</span> <span class="built_in">BOOLEAN</span> <span class="keyword">DEFAULT</span> <span class="literal">FALSE</span>)</span><br><span class="line">    <span class="keyword">IS</span></span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        g_show_oracle.show := NVL (show_in, <span class="literal">FALSE</span>);</span><br><span class="line"></span><br><span class="line">        IF g_show_oracle.revert</span><br><span class="line">        THEN</span><br><span class="line">            g_show_oracle.revert_to := g_show_oracle.show;</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line"></span><br><span class="line">        g_show_oracle.revert := NVL (revert_after_raise_in, FALSE);</span><br><span class="line">    <span class="keyword">END</span> show_oracle_error;</span><br><span class="line"></span><br><span class="line">    PROCEDURE revert_oracle_error</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">IF</span> g_show_oracle.revert</span><br><span class="line">        <span class="keyword">THEN</span></span><br><span class="line">            g_show_oracle.show := g_show_oracle.revert_to;</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line">    <span class="keyword">END</span> revert_oracle_error;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- Now raise the error that has been defined.</span></span><br><span class="line">    PROCEDURE raise_error_instance (</span><br><span class="line">        error_instance_id_in IN q$error_instance.id%TYPE)</span><br><span class="line">    IS</span><br><span class="line">        l_error_instance   q$error_instance%ROWTYPE;</span><br><span class="line"></span><br><span class="line">        PROCEDURE issue_oracle_raise (</span><br><span class="line">            error_instance_in IN q$error_instance%ROWTYPE)</span><br><span class="line">        IS</span><br><span class="line">            l_error        q$error%ROWTYPE;</span><br><span class="line">            l_error_code   PLS_INTEGER;</span><br><span class="line">            l_error_info   error_info_rt;</span><br><span class="line">        <span class="keyword">BEGIN</span></span><br><span class="line">            l_error := q$error_qp_onerow (id_in =&gt; error_instance_in.error_id);</span><br><span class="line">            l_error_code :=</span><br><span class="line">                NVL (l_error.code, error_instance_in.system_error_code);</span><br><span class="line"></span><br><span class="line">            <span class="comment">/* 1.2.12 If raising with message, load up the error message string. */</span></span><br><span class="line">            IF raising_with_message ()</span><br><span class="line">            THEN</span><br><span class="line">                get_error_info (error_instance_in.id, l_error_info);</span><br><span class="line">                internal_raise (</span><br><span class="line">                    c_default_error_code</span><br><span class="line">                   ,   'Error Code = '</span><br><span class="line">                    || l_error_info.code</span><br><span class="line">                    || CHR (10)</span><br><span class="line">                    || 'Error Message = '</span><br><span class="line">                    || l_error_info.text</span><br><span class="line">                    || CHR (10)</span><br><span class="line">                    || CHR (10)</span><br><span class="line">                    || 'Error Stack = '</span><br><span class="line">                    || l_error_info.error_stack</span><br><span class="line">                    || CHR (10)</span><br><span class="line">                    || '<span class="keyword">Call</span> Stack = <span class="string">'</span></span><br><span class="line"><span class="string">                    || l_error_info.call_stack);</span></span><br><span class="line"><span class="string">            ELSIF oracle_app_error (l_error_code)</span></span><br><span class="line"><span class="string">            THEN</span></span><br><span class="line"><span class="string">                internal_raise (l_error_code, error_instance_in.MESSAGE);</span></span><br><span class="line"><span class="string">            -- 1.0.5 Special case needed; cannot use EXCEPTION INIT with -1403 error.</span></span><br><span class="line"><span class="string">            ELSIF l_error_code IN (100, -1403)</span></span><br><span class="line"><span class="string">            THEN</span></span><br><span class="line"><span class="string">                RAISE NO_DATA_FOUND;</span></span><br><span class="line"><span class="string">            ELSIF l_error_code = 1</span></span><br><span class="line"><span class="string">            THEN</span></span><br><span class="line"><span class="string">                -- Undefined error information.</span></span><br><span class="line"><span class="string">                internal_raise (</span></span><br><span class="line"><span class="string">                    c_default_error_code</span></span><br><span class="line"><span class="string">                   ,NVL (error_instance_in.MESSAGE, '</span><span class="keyword">User</span>-defined <span class="keyword">error</span><span class="string">'));</span></span><br><span class="line"><span class="string">            /* No Oracle error (0). */</span></span><br><span class="line"><span class="string">            ELSIF l_error_code = 0</span></span><br><span class="line"><span class="string">            THEN</span></span><br><span class="line"><span class="string">                internal_raise (c_default_error_code</span></span><br><span class="line"><span class="string">                               ,error_instance_in.MESSAGE);</span></span><br><span class="line"><span class="string">            /* Using positive error numbers or we have an error instance</span></span><br><span class="line"><span class="string">             with no error code (runtime-defined error). */</span></span><br><span class="line"><span class="string">            ELSIF l_error_code &gt; 0</span></span><br><span class="line"><span class="string">                  OR (l_error_code IS NULL</span></span><br><span class="line"><span class="string">                      AND error_instance_in.id IS NOT NULL)</span></span><br><span class="line"><span class="string">            THEN</span></span><br><span class="line"><span class="string">                internal_raise (</span></span><br><span class="line"><span class="string">                    c_default_error_code</span></span><br><span class="line"><span class="string">                   ,c_error_prefix</span></span><br><span class="line"><span class="string">                    || LPAD (TO_CHAR (error_instance_in.id)</span></span><br><span class="line"><span class="string">                            ,c_error_code_len</span></span><br><span class="line"><span class="string">                            ,'</span><span class="number">0</span><span class="string">')</span></span><br><span class="line"><span class="string">                    || c_oracle_separator</span></span><br><span class="line"><span class="string">                    || LPAD (</span></span><br><span class="line"><span class="string">                           TO_CHAR (</span></span><br><span class="line"><span class="string">                               ABS (error_instance_in.system_error_code))</span></span><br><span class="line"><span class="string">                          ,c_oracle_code_len</span></span><br><span class="line"><span class="string">                          ,'</span><span class="number">0</span><span class="string">'));</span></span><br><span class="line"><span class="string">            -- We have a message to pass back, at least.</span></span><br><span class="line"><span class="string">            ELSIF l_error_code IS NULL</span></span><br><span class="line"><span class="string">                  AND error_instance_in.MESSAGE IS NOT NULL</span></span><br><span class="line"><span class="string">            THEN</span></span><br><span class="line"><span class="string">                internal_raise (c_default_error_code</span></span><br><span class="line"><span class="string">                               ,error_instance_in.MESSAGE);</span></span><br><span class="line"><span class="string">            ELSIF is_valid_oracle_error (l_error_code)</span></span><br><span class="line"><span class="string">            THEN</span></span><br><span class="line"><span class="string">                /* Negative Oracle error. */</span></span><br><span class="line"><span class="string">                EXECUTE IMMEDIATE   '</span><span class="keyword">DECLARE</span> <span class="string">'</span></span><br><span class="line"><span class="string">                                 || '</span>   myexc <span class="keyword">EXCEPTION</span>; '</span><br><span class="line">                                 || '   <span class="keyword">PRAGMA</span> EXCEPTION_INIT (myexc, <span class="string">'</span></span><br><span class="line"><span class="string">                                 || TO_CHAR (l_error_code)</span></span><br><span class="line"><span class="string">                                 || '</span>);'</span><br><span class="line">                                 || '<span class="keyword">BEGIN</span> <span class="string">'</span></span><br><span class="line"><span class="string">                                 || '</span>   <span class="keyword">RAISE</span> myexc;'</span><br><span class="line">                                 || '<span class="keyword">END</span>;';</span><br><span class="line">            ELSE</span><br><span class="line">                <span class="comment">-- Undefined error information.</span></span><br><span class="line">                internal_raise (</span><br><span class="line">                    c_default_error_code</span><br><span class="line">                   ,   'Unable to raise error instance '</span><br><span class="line">                    || error_instance_id_in</span><br><span class="line">                    || ' with error code '</span><br><span class="line">                    || l_error_code);</span><br><span class="line">            <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line">        <span class="keyword">END</span> issue_oracle_raise;</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        l_error_instance := q$error_instance_qp_onerow (error_instance_id_in);</span><br><span class="line">        <span class="comment">-- Turn back on when we can check individual context values</span></span><br><span class="line">        <span class="comment">-- to see if they are required.</span></span><br><span class="line">        <span class="comment">--check_contexts (error_instance_in =&gt; l_error_instance);</span></span><br><span class="line">        issue_oracle_raise (l_error_instance);</span><br><span class="line">    <span class="keyword">END</span> raise_error_instance;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 1.3.6 Standardize arg name - this OL not needed</span></span><br><span class="line"><span class="comment">    PROCEDURE raise_error_instance (</span></span><br><span class="line"><span class="comment">       error_instance_id_in IN q$error_instance.id%TYPE</span></span><br><span class="line"><span class="comment">    )</span></span><br><span class="line"><span class="comment">    IS</span></span><br><span class="line"><span class="comment">    BEGIN</span></span><br><span class="line"><span class="comment">       raise_error_instance (error_instance_id_in =&gt; err_instance_id_in);</span></span><br><span class="line"><span class="comment">    END;*/</span></span><br><span class="line"></span><br><span class="line">    PROCEDURE raise_error (</span><br><span class="line">        error_code_in      IN q$error.code%TYPE</span><br><span class="line">       ,text_in            IN q$error_instance.MESSAGE%TYPE := NULL</span><br><span class="line">       ,name1_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value1_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name2_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value2_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name3_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value3_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name4_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value4_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name5_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value5_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,grab_settings_in   IN BOOLEAN DEFAULT TRUE)</span><br><span class="line">    IS</span><br><span class="line">        l_error_instance_id   q$error_instance.id%TYPE;</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">IF</span> q$error_raised</span><br><span class="line">        <span class="keyword">THEN</span></span><br><span class="line">            <span class="comment">-- Just continue to propagate this error instance.</span></span><br><span class="line">            l_error_instance_id := q$error_instance_id_raised;</span><br><span class="line">        ELSE</span><br><span class="line">            IF grab_settings_in</span><br><span class="line">            THEN</span><br><span class="line">                grab_settings;</span><br><span class="line">            <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line"></span><br><span class="line">            register_error (error_code_in           =&gt; error_code_in</span><br><span class="line">                           ,error_instance_id_out   =&gt; l_error_instance_id</span><br><span class="line">                           ,text_in                 =&gt; text_in</span><br><span class="line">                           ,name1_in                =&gt; name1_in</span><br><span class="line">                           ,value1_in               =&gt; value1_in</span><br><span class="line">                           ,name2_in                =&gt; name2_in</span><br><span class="line">                           ,value2_in               =&gt; value2_in</span><br><span class="line">                           ,name3_in                =&gt; name3_in</span><br><span class="line">                           ,value3_in               =&gt; value3_in</span><br><span class="line">                           ,name4_in                =&gt; name4_in</span><br><span class="line">                           ,value4_in               =&gt; value4_in</span><br><span class="line">                           ,name5_in                =&gt; name5_in</span><br><span class="line">                           ,value5_in               =&gt; value5_in</span><br><span class="line">                           ,grab_settings_in        =&gt; FALSE);</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line"></span><br><span class="line">        raise_error_instance (error_instance_id_in =&gt; l_error_instance_id);</span><br><span class="line">    <span class="keyword">END</span> raise_error;</span><br><span class="line"></span><br><span class="line">    PROCEDURE raise_error (</span><br><span class="line">        error_name_in      IN q$error.name%TYPE</span><br><span class="line">       ,text_in            IN q$error_instance.MESSAGE%TYPE := NULL</span><br><span class="line">       ,name1_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value1_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name2_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value2_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name3_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value3_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name4_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value4_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name5_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value5_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,grab_settings_in   IN BOOLEAN DEFAULT TRUE)</span><br><span class="line">    IS</span><br><span class="line">        l_error_instance_id   q$error_instance.id%TYPE;</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">IF</span> q$error_raised</span><br><span class="line">        <span class="keyword">THEN</span></span><br><span class="line">            <span class="comment">-- Just continue to propagate this error instance.</span></span><br><span class="line">            l_error_instance_id := q$error_instance_id_raised;</span><br><span class="line">        ELSE</span><br><span class="line">            IF grab_settings_in</span><br><span class="line">            THEN</span><br><span class="line">                grab_settings;</span><br><span class="line">            <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line"></span><br><span class="line">            register_error (error_name_in           =&gt; error_name_in</span><br><span class="line">                           ,error_instance_id_out   =&gt; l_error_instance_id</span><br><span class="line">                           ,text_in                 =&gt; text_in</span><br><span class="line">                           ,name1_in                =&gt; name1_in</span><br><span class="line">                           ,value1_in               =&gt; value1_in</span><br><span class="line">                           ,name2_in                =&gt; name2_in</span><br><span class="line">                           ,value2_in               =&gt; value2_in</span><br><span class="line">                           ,name3_in                =&gt; name3_in</span><br><span class="line">                           ,value3_in               =&gt; value3_in</span><br><span class="line">                           ,name4_in                =&gt; name4_in</span><br><span class="line">                           ,value4_in               =&gt; value4_in</span><br><span class="line">                           ,name5_in                =&gt; name5_in</span><br><span class="line">                           ,value5_in               =&gt; value5_in</span><br><span class="line">                           ,grab_settings_in        =&gt; FALSE);</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line"></span><br><span class="line">        raise_error_instance (error_instance_id_in =&gt; l_error_instance_id);</span><br><span class="line">    <span class="keyword">END</span> raise_error;</span><br><span class="line"></span><br><span class="line">    PROCEDURE raise_unanticipated (</span><br><span class="line">        text_in            IN q$error_instance.MESSAGE%TYPE := NULL</span><br><span class="line">       ,name1_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value1_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name2_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value2_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name3_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value3_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name4_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value4_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name5_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value5_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,grab_settings_in   IN BOOLEAN DEFAULT TRUE)</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        raise_error (error_code_in      =&gt; <span class="keyword">SQLCODE</span>   <span class="comment">/*'UNANTICIPATED-ERROR'*/</span></span><br><span class="line">                    ,text_in            =&gt; text_in</span><br><span class="line">                    ,name1_in           =&gt; name1_in</span><br><span class="line">                    ,value1_in          =&gt; value1_in</span><br><span class="line">                    ,name2_in           =&gt; name2_in</span><br><span class="line">                    ,value2_in          =&gt; value2_in</span><br><span class="line">                    ,name3_in           =&gt; name3_in</span><br><span class="line">                    ,value3_in          =&gt; value3_in</span><br><span class="line">                    ,name4_in           =&gt; name4_in</span><br><span class="line">                    ,value4_in          =&gt; value4_in</span><br><span class="line">                    ,name5_in           =&gt; name5_in</span><br><span class="line">                    ,value5_in          =&gt; value5_in</span><br><span class="line">                    ,grab_settings_in   =&gt; grab_settings_in);</span><br><span class="line">    <span class="keyword">END</span> raise_unanticipated;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* V1.2.11 Allow user to specify that an Oracle error should be registered</span></span><br><span class="line"><span class="comment">     (but not re-raised) or raised (registered and re-raised).</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    PROCEDURE register_oracle_error (</span><br><span class="line">        text_in            IN q$error_instance.MESSAGE%TYPE := NULL</span><br><span class="line">       ,name1_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value1_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name2_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value2_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name3_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value3_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name4_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value4_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name5_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value5_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,grab_settings_in   IN BOOLEAN DEFAULT TRUE)</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="comment">/* 1.2.15 Call register, not raise */</span></span><br><span class="line">        register_error (error_code_in      =&gt; <span class="keyword">SQLCODE</span></span><br><span class="line">                       ,text_in            =&gt; text_in</span><br><span class="line">                       ,name1_in           =&gt; name1_in</span><br><span class="line">                       ,value1_in          =&gt; value1_in</span><br><span class="line">                       ,name2_in           =&gt; name2_in</span><br><span class="line">                       ,value2_in          =&gt; value2_in</span><br><span class="line">                       ,name3_in           =&gt; name3_in</span><br><span class="line">                       ,value3_in          =&gt; value3_in</span><br><span class="line">                       ,name4_in           =&gt; name4_in</span><br><span class="line">                       ,value4_in          =&gt; value4_in</span><br><span class="line">                       ,name5_in           =&gt; name5_in</span><br><span class="line">                       ,value5_in          =&gt; value5_in</span><br><span class="line">                       ,grab_settings_in   =&gt; grab_settings_in);</span><br><span class="line">    <span class="keyword">END</span> register_oracle_error;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 1.2.15 Return error instance */</span></span><br><span class="line">    PROCEDURE register_oracle_error (</span><br><span class="line">        text_in                 IN     q$error_instance.MESSAGE%TYPE := NULL</span><br><span class="line">       ,name1_in                IN     VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value1_in               IN     VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name2_in                IN     VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value2_in               IN     VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name3_in                IN     VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value3_in               IN     VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name4_in                IN     VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value4_in               IN     VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name5_in                IN     VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value5_in               IN     VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,grab_settings_in        IN     BOOLEAN DEFAULT TRUE</span><br><span class="line">       ,error_instance_id_out      OUT q$error_instance.id%TYPE)</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        register_error (error_code_in           =&gt; <span class="keyword">SQLCODE</span></span><br><span class="line">                       ,error_instance_id_out   =&gt; error_instance_id_out</span><br><span class="line">                       ,text_in                 =&gt; text_in</span><br><span class="line">                       ,name1_in                =&gt; name1_in</span><br><span class="line">                       ,value1_in               =&gt; value1_in</span><br><span class="line">                       ,name2_in                =&gt; name2_in</span><br><span class="line">                       ,value2_in               =&gt; value2_in</span><br><span class="line">                       ,name3_in                =&gt; name3_in</span><br><span class="line">                       ,value3_in               =&gt; value3_in</span><br><span class="line">                       ,name4_in                =&gt; name4_in</span><br><span class="line">                       ,value4_in               =&gt; value4_in</span><br><span class="line">                       ,name5_in                =&gt; name5_in</span><br><span class="line">                       ,value5_in               =&gt; value5_in</span><br><span class="line">                       ,grab_settings_in        =&gt; grab_settings_in);</span><br><span class="line">    <span class="keyword">END</span> register_oracle_error;</span><br><span class="line"></span><br><span class="line">    PROCEDURE raise_oracle_error (</span><br><span class="line">        text_in            IN q$error_instance.MESSAGE%TYPE := NULL</span><br><span class="line">       ,name1_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value1_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name2_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value2_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name3_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value3_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name4_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value4_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name5_in           IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value5_in          IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,grab_settings_in   IN BOOLEAN DEFAULT TRUE)</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        raise_error (error_code_in      =&gt; <span class="keyword">SQLCODE</span></span><br><span class="line">                    ,text_in            =&gt; text_in</span><br><span class="line">                    ,name1_in           =&gt; name1_in</span><br><span class="line">                    ,value1_in          =&gt; value1_in</span><br><span class="line">                    ,name2_in           =&gt; name2_in</span><br><span class="line">                    ,value2_in          =&gt; value2_in</span><br><span class="line">                    ,name3_in           =&gt; name3_in</span><br><span class="line">                    ,value3_in          =&gt; value3_in</span><br><span class="line">                    ,name4_in           =&gt; name4_in</span><br><span class="line">                    ,value4_in          =&gt; value4_in</span><br><span class="line">                    ,name5_in           =&gt; name5_in</span><br><span class="line">                    ,value5_in          =&gt; value5_in</span><br><span class="line">                    ,grab_settings_in   =&gt; grab_settings_in);</span><br><span class="line">    <span class="keyword">END</span> raise_oracle_error;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- Retrieval of error information</span></span><br><span class="line">    PROCEDURE parse_message (string_in               IN     VARCHAR2</span><br><span class="line">                            ,error_instance_id_out      OUT PLS_INTEGER</span><br><span class="line">                            ,extra_out                  OUT VARCHAR2)</span><br><span class="line">    IS</span><br><span class="line">        l_startloc   PLS_INTEGER := INSTR (string_in, ':');</span><br><span class="line">        <span class="comment">--1.4.1    l_endloc     PLS_INTEGER;</span></span><br><span class="line">        l_errmsg     q$error.description%TYPE</span><br><span class="line">                         := LTRIM (SUBSTR (string_in, l_startloc + 1));</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="comment">/* V1.2.11 Get latest instance from global package variable.</span></span><br><span class="line"><span class="comment">         If that is not available, then fall back on the</span></span><br><span class="line"><span class="comment">         error message; in any case try to extract the</span></span><br><span class="line"><span class="comment">         extra text.</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="keyword">IF</span> <span class="comment">/* 1.2.14 Do not directly reference variables</span></span><br><span class="line"><span class="comment">          g_error_instance_raised */</span></span><br><span class="line">          q$error_instance_id_raised () <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line">        <span class="keyword">THEN</span></span><br><span class="line">            error_instance_id_out := q$error_instance_id_raised ();</span><br><span class="line">        ELSE</span><br><span class="line">            IF SUBSTR (LTRIM (l_errmsg), 1, c_error_prefix_len) =</span><br><span class="line">                   c_error_prefix</span><br><span class="line">            THEN</span><br><span class="line">                error_instance_id_out :=</span><br><span class="line">                    TO_NUMBER (</span><br><span class="line">                        SUBSTR (l_errmsg</span><br><span class="line">                               ,c_error_prefix_len + 1</span><br><span class="line">                               ,c_error_code_len));</span><br><span class="line">            ELSE</span><br><span class="line">                error_instance_id_out := NULL;</span><br><span class="line">            <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line"></span><br><span class="line">        extra_out :=</span><br><span class="line">            SUBSTR (l_errmsg, c_error_prefix_len + c_error_code_len + 1);</span><br><span class="line">    <span class="keyword">END</span> parse_message;</span><br><span class="line"></span><br><span class="line">    FUNCTION error_instance_from_string (string_in IN VARCHAR2)</span><br><span class="line">        RETURN PLS_INTEGER</span><br><span class="line">    IS</span><br><span class="line">        l_errmsg   q$error.description%TYPE;</span><br><span class="line">        retval     PLS_INTEGER;</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        parse_message (string_in, retval, l_errmsg);</span><br><span class="line">        RETURN retval;</span><br><span class="line">    <span class="keyword">END</span> error_instance_from_string;</span><br><span class="line"></span><br><span class="line">    FUNCTION error_instance_from_sqlerrm</span><br><span class="line">        RETURN PLS_INTEGER</span><br><span class="line">    IS</span><br><span class="line">    <span class="comment">--1.4.1     l_loc      PLS_INTEGER;</span></span><br><span class="line">    <span class="comment">--1.4.1   l_errmsg   q$error.description%TYPE;</span></span><br><span class="line">    <span class="comment">--1.4.1    retval     PLS_INTEGER;</span></span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">RETURN</span> error_instance_from_string (DBMS_UTILITY.format_error_stack);</span><br><span class="line">    <span class="keyword">END</span> error_instance_from_sqlerrm;</span><br><span class="line"></span><br><span class="line">    PROCEDURE substitute_strings (</span><br><span class="line">        error_message_inout    IN OUT q$error.substitute_string%TYPE</span><br><span class="line">       ,recommendation_inout   IN OUT q$error.recommendation%TYPE</span><br><span class="line">       ,contexts_inout         IN OUT q$error_context_tc)</span><br><span class="line">    IS</span><br><span class="line">        l_row   PLS_INTEGER;</span><br><span class="line"></span><br><span class="line">        <span class="comment">--1.4.1   retval   q$error.substitute_string%TYPE;</span></span><br><span class="line"></span><br><span class="line">        PROCEDURE replace_all_occurrences (</span><br><span class="line">            context_in       IN q$error_context%ROWTYPE</span><br><span class="line">           ,context_row_in   IN PLS_INTEGER)</span><br><span class="line">        IS</span><br><span class="line">            <span class="comment">-- Maintain format of string while doing replacements on</span></span><br><span class="line">            <span class="comment">-- on named strings case IN sensitively.</span></span><br><span class="line">            c_upper_subst_name   q$error_context.name%TYPE</span><br><span class="line">                := c_subst_char || UPPER (context_in.name);</span><br><span class="line">            c_len                PLS_INTEGER := LENGTH (context_in.name);</span><br><span class="line">            l_loc                PLS_INTEGER;</span><br><span class="line">            l_found              BOOLEAN DEFAULT FALSE;</span><br><span class="line">        <span class="keyword">BEGIN</span></span><br><span class="line">            <span class="keyword">IF</span> error_message_inout <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line">            <span class="keyword">THEN</span></span><br><span class="line">                <span class="keyword">LOOP</span></span><br><span class="line">                    l_loc :=</span><br><span class="line">                        <span class="keyword">INSTR</span> (<span class="keyword">UPPER</span> (error_message_inout)</span><br><span class="line">                              ,c_upper_subst_name</span><br><span class="line">                              ,<span class="number">1</span>);</span><br><span class="line">                    EXIT WHEN l_loc = 0;</span><br><span class="line">                    l_found := TRUE;</span><br><span class="line">                    error_message_inout :=</span><br><span class="line">                           SUBSTR (error_message_inout, 1, l_loc - 1)</span><br><span class="line">                        || context_in.VALUE</span><br><span class="line">                        || SUBSTR (error_message_inout, l_loc + c_len + 1);</span><br><span class="line">                <span class="keyword">END</span> <span class="keyword">LOOP</span>;</span><br><span class="line">            <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line"></span><br><span class="line">            IF recommendation_inout IS NOT NULL</span><br><span class="line">            THEN</span><br><span class="line">                LOOP</span><br><span class="line">                    l_loc :=</span><br><span class="line">                        INSTR (UPPER (recommendation_inout)</span><br><span class="line">                              ,c_upper_subst_name</span><br><span class="line">                              ,1);</span><br><span class="line">                    EXIT WHEN l_loc = 0;</span><br><span class="line">                    l_found := TRUE;</span><br><span class="line">                    recommendation_inout :=</span><br><span class="line">                           SUBSTR (recommendation_inout, 1, l_loc - 1)</span><br><span class="line">                        || context_in.VALUE</span><br><span class="line">                        || SUBSTR (recommendation_inout, l_loc + c_len + 1);</span><br><span class="line">                <span class="keyword">END</span> <span class="keyword">LOOP</span>;</span><br><span class="line">            <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line"></span><br><span class="line">            IF l_found</span><br><span class="line">            THEN</span><br><span class="line">                contexts_inout.delete (context_row_in);</span><br><span class="line">            <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line">        <span class="keyword">END</span> replace_all_occurrences;</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">IF</span> error_message_inout <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line">           <span class="keyword">OR</span> recommendation_inout <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line">        <span class="keyword">THEN</span></span><br><span class="line">            l_row := contexts_inout.FIRST;</span><br><span class="line"></span><br><span class="line">            WHILE (l_row IS NOT NULL)</span><br><span class="line">            LOOP</span><br><span class="line">                replace_all_occurrences (contexts_inout (l_row), l_row);</span><br><span class="line">                l_row := contexts_inout.NEXT (l_row);</span><br><span class="line">            <span class="keyword">END</span> <span class="keyword">LOOP</span>;</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line">    <span class="keyword">END</span> substitute_strings;</span><br><span class="line"></span><br><span class="line">    PROCEDURE get_error_info (</span><br><span class="line">        error_instance_id_in   IN     q$error_instance.id%TYPE</span><br><span class="line">       ,error_info_out            OUT error_info_rt</span><br><span class="line">       ,context_delimiter_in   IN     VARCHAR2 DEFAULT c_newline)</span><br><span class="line">    IS</span><br><span class="line">        l_error_instance   q$error_instance%ROWTYPE;</span><br><span class="line">        l_error            q$error%ROWTYPE;</span><br><span class="line"></span><br><span class="line">        PROCEDURE subst_for_msg_help_strings</span><br><span class="line">        IS</span><br><span class="line">            l_contexts   q$error_context_tc;</span><br><span class="line"></span><br><span class="line">            PROCEDURE add_to_text (new_string_in IN VARCHAR2)</span><br><span class="line">            IS</span><br><span class="line">            <span class="keyword">BEGIN</span></span><br><span class="line">                <span class="keyword">IF</span> new_string_in <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line">                <span class="keyword">THEN</span></span><br><span class="line">                    error_info_out.text :=</span><br><span class="line">                        error_info_out.text</span><br><span class="line">                        || <span class="keyword">CASE</span></span><br><span class="line">                               <span class="keyword">WHEN</span> error_info_out.text <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line">                               <span class="keyword">THEN</span></span><br><span class="line">                                   context_delimiter_in</span><br><span class="line">                               <span class="keyword">ELSE</span></span><br><span class="line">                                   <span class="literal">NULL</span></span><br><span class="line">                           <span class="keyword">END</span></span><br><span class="line">                        || new_string_in;</span><br><span class="line">                <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line">            <span class="keyword">END</span> add_to_text;</span><br><span class="line"></span><br><span class="line">            PROCEDURE add_to_context (new_string_in IN VARCHAR2)</span><br><span class="line">            IS</span><br><span class="line">            <span class="keyword">BEGIN</span></span><br><span class="line">                <span class="keyword">IF</span> new_string_in <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line">                <span class="keyword">THEN</span></span><br><span class="line">                    error_info_out.contexts :=</span><br><span class="line">                        <span class="keyword">CASE</span></span><br><span class="line">                            <span class="keyword">WHEN</span> error_info_out.contexts <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line">                            <span class="keyword">THEN</span></span><br><span class="line">                                   error_info_out.contexts</span><br><span class="line">                                || context_delimiter_in</span><br><span class="line">                                || new_string_in</span><br><span class="line">                            <span class="keyword">ELSE</span></span><br><span class="line">                                new_string_in</span><br><span class="line">                        <span class="keyword">END</span>;</span><br><span class="line">                <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line">            <span class="keyword">END</span> add_to_context;</span><br><span class="line"></span><br><span class="line">            PROCEDURE add_remaining_contexts</span><br><span class="line">            IS</span><br><span class="line">                l_row   PLS_INTEGER;</span><br><span class="line">            <span class="keyword">BEGIN</span></span><br><span class="line">                l_row := l_contexts.FIRST;</span><br><span class="line"></span><br><span class="line">                IF l_row IS NOT NULL</span><br><span class="line">                THEN</span><br><span class="line">                    <span class="comment">-- Insert a blank line.</span></span><br><span class="line">                    add_to_context (' ');</span><br><span class="line"></span><br><span class="line">                    WHILE (l_row IS NOT NULL)</span><br><span class="line">                    LOOP</span><br><span class="line">                        add_to_context (</span><br><span class="line">                               l_contexts (l_row).name</span><br><span class="line">                            || ' = '</span><br><span class="line">                            || l_contexts (l_row).VALUE);</span><br><span class="line">                        l_row := l_contexts.NEXT (l_row);</span><br><span class="line">                    <span class="keyword">END</span> <span class="keyword">LOOP</span>;</span><br><span class="line">                <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line">            <span class="comment">--1.0.4 If string gets too big then just pass back what we've got.</span></span><br><span class="line">            EXCEPTION</span><br><span class="line">                WHEN VALUE_ERROR</span><br><span class="line">                THEN</span><br><span class="line">                    NULL;</span><br><span class="line">            <span class="keyword">END</span> add_remaining_contexts;</span><br><span class="line">        <span class="keyword">BEGIN</span></span><br><span class="line">            error_info_out.text := l_error_instance.MESSAGE;</span><br><span class="line"></span><br><span class="line">            <span class="comment">-- Use context values for substitution, then add any contexts</span></span><br><span class="line">            <span class="comment">-- that were not used at the end of the string.</span></span><br><span class="line">            <span class="keyword">SELECT</span> *</span><br><span class="line">              <span class="keyword">BULK</span> <span class="keyword">COLLECT</span> <span class="keyword">INTO</span> l_contexts</span><br><span class="line">              <span class="keyword">FROM</span> q$error_context</span><br><span class="line">             <span class="keyword">WHERE</span> error_instance_id = l_error_instance.id;</span><br><span class="line"></span><br><span class="line">            substitute_strings (l_error.substitute_string</span><br><span class="line">                               ,l_error.recommendation</span><br><span class="line">                               ,l_contexts);</span><br><span class="line">            error_info_out.recommendation := l_error.recommendation;</span><br><span class="line"></span><br><span class="line">            IF error_info_out.text IS NULL</span><br><span class="line">               AND l_error.substitute_string IS NULL</span><br><span class="line">            THEN</span><br><span class="line">                <span class="comment">-- Fall back on the generic descriptoin.</span></span><br><span class="line">                error_info_out.text := l_error.description;</span><br><span class="line">            ELSE</span><br><span class="line">                add_to_text (l_error.substitute_string);</span><br><span class="line">            <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line"></span><br><span class="line">            add_remaining_contexts;</span><br><span class="line"></span><br><span class="line">            <span class="comment">/* 1.4.0 option to disgard the remaining_context in the text*/</span></span><br><span class="line">            IF add_remaining_context_enabled ()</span><br><span class="line">            THEN</span><br><span class="line">                <span class="keyword">BEGIN</span></span><br><span class="line">                    add_to_text (error_info_out.contexts);</span><br><span class="line">                EXCEPTION</span><br><span class="line">                    WHEN VALUE_ERROR</span><br><span class="line">                    THEN</span><br><span class="line">                        add_to_text (</span><br><span class="line">                            SUBSTR (</span><br><span class="line">                                error_info_out.contexts</span><br><span class="line">                               ,1</span><br><span class="line">                               ,  c_varchar2_max_length</span><br><span class="line">                                - LENGTH (error_info_out.text)</span><br><span class="line">                                - 2));</span><br><span class="line">                <span class="keyword">END</span>;</span><br><span class="line">            <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line">        <span class="keyword">END</span> subst_for_msg_help_strings;</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">IF</span> error_instance_id_in <span class="keyword">IS</span> <span class="literal">NULL</span></span><br><span class="line">        <span class="keyword">THEN</span></span><br><span class="line">            <span class="comment">-- Fall back on current error information.</span></span><br><span class="line">            error_info_out.code := <span class="keyword">SQLCODE</span>;</span><br><span class="line">            error_info_out.name := 'Oracle Error';</span><br><span class="line">            error_info_out.system_error_code := SQLCODE;</span><br><span class="line">            error_info_out.system_error_message :=</span><br><span class="line">                DBMS_UTILITY.format_error_stack;</span><br><span class="line">            error_info_out.text := DBMS_UTILITY.format_error_stack;</span><br><span class="line">        ELSE</span><br><span class="line">            l_error_instance :=</span><br><span class="line">                q$error_instance_qp_onerow (error_instance_id_in);</span><br><span class="line">            l_error := q$error_qp_onerow (l_error_instance.error_id);</span><br><span class="line">            <span class="comment">--</span></span><br><span class="line">            error_info_out.code := l_error.code;</span><br><span class="line">            error_info_out.name := l_error.name;</span><br><span class="line">            <span class="comment">/* 1.4.0 */</span></span><br><span class="line">            error_info_out.error_category_name := l_error.error_category_name;</span><br><span class="line">            <span class="comment">--</span></span><br><span class="line">            subst_for_msg_help_strings;</span><br><span class="line">            error_info_out.system_error_code :=</span><br><span class="line">                l_error_instance.system_error_code;</span><br><span class="line">            error_info_out.system_error_message :=</span><br><span class="line">                l_error_instance.system_error_message;</span><br><span class="line">            error_info_out.call_stack := l_error_instance.call_stack;</span><br><span class="line">            <span class="comment">/* 1.3.1 If an assertion, then error stack is empty. */</span></span><br><span class="line">            error_info_out.error_stack :=</span><br><span class="line">                NVL (l_error_instance.error_stack</span><br><span class="line">                    ,l_error_instance.call_stack);</span><br><span class="line">            error_info_out.environment_info :=</span><br><span class="line">                l_error_instance.environment_info;</span><br><span class="line"></span><br><span class="line">            <span class="comment">/* 1.3 Add id and message, also environment info. */</span></span><br><span class="line">            error_info_out.id := l_error_instance.id;</span><br><span class="line">            error_info_out.error_id := l_error_instance.error_id;</span><br><span class="line">            error_info_out.created_on := l_error_instance.created_on;</span><br><span class="line">            error_info_out.created_by := l_error_instance.created_by;</span><br><span class="line">            error_info_out.changed_on := l_error_instance.changed_on;</span><br><span class="line">            error_info_out.changed_by := l_error_instance.changed_by;</span><br><span class="line">            error_info_out.MESSAGE := l_error_instance.MESSAGE;</span><br><span class="line"></span><br><span class="line">            <span class="comment">-- All done, revert to "no error" state.</span></span><br><span class="line">            mark_q$error_handled;</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line">    <span class="keyword">END</span> get_error_info;</span><br><span class="line"></span><br><span class="line">    PROCEDURE get_error_info (error_info_out OUT error_info_rt)</span><br><span class="line">    IS</span><br><span class="line">        l_message             maxvarchar2_t := DBMS_UTILITY.format_error_stack;</span><br><span class="line">        l_extra               q$error.description%TYPE;</span><br><span class="line">        l_error_instance_id   q$error_instance.id%TYPE;</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        parse_message (l_message, l_error_instance_id, l_extra);</span><br><span class="line"></span><br><span class="line">        IF l_error_instance_id IS NOT NULL</span><br><span class="line">        THEN</span><br><span class="line">            get_error_info (error_instance_id_in   =&gt; l_error_instance_id</span><br><span class="line">                           ,error_info_out         =&gt; error_info_out);</span><br><span class="line">        ELSE</span><br><span class="line">            <span class="comment">-- Of the form ORA-NNNNN: Message</span></span><br><span class="line">            error_info_out.code :=</span><br><span class="line">                SUBSTR (l_message, 4, INSTR (l_message, ':') - 4);</span><br><span class="line">            error_info_out.name := 'System Error';</span><br><span class="line">            error_info_out.text := l_message;</span><br><span class="line">            error_info_out.system_error_code := error_info_out.code;</span><br><span class="line">            error_info_out.system_error_message := error_info_out.text;</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">-- All done, revert to "no error" state.</span></span><br><span class="line">        mark_q$error_handled;</span><br><span class="line">    <span class="keyword">END</span> get_error_info;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 1.4.0 */</span></span><br><span class="line">    FUNCTION last_error_info</span><br><span class="line">        RETURN error_info_rt</span><br><span class="line">    IS</span><br><span class="line">        l_error   error_info_rt;</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        get_error_info (l_error);</span><br><span class="line">        RETURN l_error;</span><br><span class="line">    <span class="keyword">END</span> last_error_info;</span><br><span class="line"></span><br><span class="line">    PROCEDURE get_error_info (</span><br><span class="line">        error_instance_id_in       IN     q$error_instance.id%TYPE</span><br><span class="line">       ,code_out                      OUT q$error.code%TYPE</span><br><span class="line">       ,name_out                      OUT q$error.name%TYPE</span><br><span class="line">       ,text_out                      OUT q$error_instance.MESSAGE%TYPE</span><br><span class="line">       ,system_error_code_out         OUT q$error_instance.system_error_code%TYPE</span><br><span class="line">       ,system_error_message_out      OUT q$error_instance.system_error_message%TYPE</span><br><span class="line">       ,recommendation_out            OUT q$error.recommendation%TYPE</span><br><span class="line">       ,error_stack_out               OUT q$error_instance.error_stack%TYPE</span><br><span class="line">       ,call_stack_out                OUT q$error_instance.call_stack%TYPE</span><br><span class="line">       ,environment_info_out          OUT q$error_instance.environment_info%TYPE</span><br><span class="line">       ,id_out                        OUT q$error_instance.id%TYPE</span><br><span class="line">       ,message_out                   OUT q$error_instance.MESSAGE%TYPE</span><br><span class="line">       ,contexts_out                  OUT VARCHAR2</span><br><span class="line">       ,context_delimiter_in       IN     VARCHAR2 DEFAULT c_newline)</span><br><span class="line">    IS</span><br><span class="line">        l_error   error_info_rt;</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        get_error_info (error_instance_id_in   =&gt; error_instance_id_in</span><br><span class="line">                       ,error_info_out         =&gt; l_error</span><br><span class="line">                       ,context_delimiter_in   =&gt; context_delimiter_in);</span><br><span class="line">        <span class="comment">--</span></span><br><span class="line">        <span class="comment">-- All this logic repeated in next overloading!</span></span><br><span class="line">        code_out := l_error.code;</span><br><span class="line">        name_out := l_error.name;</span><br><span class="line">        text_out := l_error.text;</span><br><span class="line">        recommendation_out := l_error.recommendation;</span><br><span class="line">        system_error_code_out := l_error.system_error_code;</span><br><span class="line">        system_error_message_out := l_error.system_error_message;</span><br><span class="line">        error_stack_out := l_error.error_stack;</span><br><span class="line">        call_stack_out := l_error.call_stack;</span><br><span class="line">        environment_info_out := l_error.environment_info;</span><br><span class="line">        contexts_out := l_error.contexts;</span><br><span class="line">        id_out := l_error.id;</span><br><span class="line">        message_out := l_error.MESSAGE;</span><br><span class="line">    <span class="keyword">END</span> get_error_info;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 1.4.0 */</span></span><br><span class="line">    FUNCTION last_error_id</span><br><span class="line">        RETURN q$error.id%TYPE</span><br><span class="line">    IS</span><br><span class="line">        l_error   error_info_rt;</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        get_error_info (l_error);</span><br><span class="line">        RETURN l_error.error_id;</span><br><span class="line">    <span class="keyword">END</span> last_error_id;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 1.4.0 */</span></span><br><span class="line">    FUNCTION last_instance_id</span><br><span class="line">        RETURN q$error_instance.id%TYPE</span><br><span class="line">    IS</span><br><span class="line">        l_error   error_info_rt;</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        get_error_info (l_error);</span><br><span class="line">        RETURN l_error.id;</span><br><span class="line">    <span class="keyword">END</span> last_instance_id;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 1.4.0 */</span></span><br><span class="line">    FUNCTION last_error_category_name</span><br><span class="line">        RETURN q$error.error_category_name%TYPE</span><br><span class="line">    IS</span><br><span class="line">        l_error   error_info_rt;</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        get_error_info (l_error);</span><br><span class="line">        RETURN l_error.error_category_name;</span><br><span class="line">    <span class="keyword">END</span> last_error_category_name;</span><br><span class="line"></span><br><span class="line">    FUNCTION last_code</span><br><span class="line">        RETURN q$error.code%TYPE</span><br><span class="line">    IS</span><br><span class="line">        l_error   error_info_rt;</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        get_error_info (l_error);</span><br><span class="line">        RETURN l_error.code;</span><br><span class="line">    <span class="keyword">END</span> last_code;</span><br><span class="line"></span><br><span class="line">    FUNCTION last_name</span><br><span class="line">        RETURN q$error.name%TYPE</span><br><span class="line">    IS</span><br><span class="line">        l_error   error_info_rt;</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        get_error_info (l_error);</span><br><span class="line">        RETURN l_error.name;</span><br><span class="line">    <span class="keyword">END</span> last_name;</span><br><span class="line"></span><br><span class="line">    FUNCTION last_text</span><br><span class="line">        RETURN q$error_instance.MESSAGE%TYPE</span><br><span class="line">    IS</span><br><span class="line">        l_error   error_info_rt;</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        get_error_info (l_error);</span><br><span class="line">        RETURN l_error.text;</span><br><span class="line">    <span class="keyword">END</span> last_text;</span><br><span class="line"></span><br><span class="line">    FUNCTION last_system_error_code</span><br><span class="line">        RETURN q$error_instance.system_error_code%TYPE</span><br><span class="line">    IS</span><br><span class="line">        l_error   error_info_rt;</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        get_error_info (l_error);</span><br><span class="line">        RETURN l_error.system_error_code;</span><br><span class="line">    <span class="keyword">END</span> last_system_error_code;</span><br><span class="line"></span><br><span class="line">    FUNCTION last_system_error_message</span><br><span class="line">        RETURN q$error_instance.system_error_message%TYPE</span><br><span class="line">    IS</span><br><span class="line">        l_error   error_info_rt;</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        get_error_info (l_error);</span><br><span class="line">        RETURN l_error.system_error_message;</span><br><span class="line">    <span class="keyword">END</span> last_system_error_message;</span><br><span class="line"></span><br><span class="line">    PROCEDURE get_error_info (</span><br><span class="line">        error_instance_id_in       IN     q$error_instance.id%TYPE</span><br><span class="line">       ,code_out                      OUT q$error.code%TYPE</span><br><span class="line">       ,name_out                      OUT q$error.name%TYPE</span><br><span class="line">       ,text_out                      OUT q$error_instance.MESSAGE%TYPE</span><br><span class="line">       ,system_error_code_out         OUT q$error_instance.system_error_code%TYPE</span><br><span class="line">       ,system_error_message_out      OUT q$error_instance.system_error_message%TYPE</span><br><span class="line">       ,recommendation_out            OUT q$error.recommendation%TYPE</span><br><span class="line">       ,error_stack_out               OUT q$error_instance.error_stack%TYPE</span><br><span class="line">       ,call_stack_out                OUT q$error_instance.call_stack%TYPE</span><br><span class="line">       ,environment_info_out          OUT q$error_instance.environment_info%TYPE)</span><br><span class="line">    IS</span><br><span class="line">        l_id         q$error_instance.id%TYPE;</span><br><span class="line">        l_message    q$error_instance.MESSAGE%TYPE;</span><br><span class="line">        l_contexts   maxvarchar2_t;</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        get_error_info (error_instance_id_in       =&gt; error_instance_id_in</span><br><span class="line">                       ,code_out                   =&gt; code_out</span><br><span class="line">                       ,name_out                   =&gt; name_out</span><br><span class="line">                       ,text_out                   =&gt; text_out</span><br><span class="line">                       ,system_error_code_out      =&gt; system_error_code_out</span><br><span class="line">                       ,system_error_message_out   =&gt; system_error_message_out</span><br><span class="line">                       ,recommendation_out         =&gt; recommendation_out</span><br><span class="line">                       ,error_stack_out            =&gt; error_stack_out</span><br><span class="line">                       ,call_stack_out             =&gt; call_stack_out</span><br><span class="line">                       ,environment_info_out       =&gt; environment_info_out</span><br><span class="line">                       ,id_out                     =&gt; l_id</span><br><span class="line">                       ,message_out                =&gt; l_message</span><br><span class="line">                       ,contexts_out               =&gt; l_contexts);</span><br><span class="line">    <span class="keyword">END</span> get_error_info;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 1.3.6 Standardize arg name */</span></span><br><span class="line">    PROCEDURE get_error_info (</span><br><span class="line">        error_message_in           IN     VARCHAR2</span><br><span class="line">       ,code_out                      OUT q$error.code%TYPE</span><br><span class="line">       ,name_out                      OUT q$error.name%TYPE</span><br><span class="line">       ,text_out                      OUT q$error_instance.MESSAGE%TYPE</span><br><span class="line">       ,system_error_code_out         OUT q$error_instance.system_error_code%TYPE</span><br><span class="line">       ,system_error_message_out      OUT q$error_instance.system_error_message%TYPE</span><br><span class="line">       ,recommendation_out            OUT q$error.recommendation%TYPE</span><br><span class="line">       ,error_stack_out               OUT q$error_instance.error_stack%TYPE</span><br><span class="line">       ,call_stack_out                OUT q$error_instance.call_stack%TYPE</span><br><span class="line">       ,environment_info_out          OUT q$error_instance.environment_info%TYPE</span><br><span class="line">       ,id_out                        OUT q$error_instance.id%TYPE</span><br><span class="line">       ,message_out                   OUT q$error_instance.MESSAGE%TYPE</span><br><span class="line">       ,contexts_out                  OUT VARCHAR2</span><br><span class="line">       ,context_delimiter_in       IN     VARCHAR2 DEFAULT c_newline)</span><br><span class="line">    IS</span><br><span class="line">        l_error               error_info_rt;</span><br><span class="line">        l_extra               q$error.description%TYPE;</span><br><span class="line">        l_error_instance_id   q$error_instance.id%TYPE;</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        parse_message (error_message_in, l_error_instance_id, l_extra);</span><br><span class="line"></span><br><span class="line">        IF l_error_instance_id IS NOT NULL</span><br><span class="line">        THEN</span><br><span class="line">            get_error_info (error_instance_id_in   =&gt; l_error_instance_id</span><br><span class="line">                           ,error_info_out         =&gt; l_error</span><br><span class="line">                           ,context_delimiter_in   =&gt; context_delimiter_in);</span><br><span class="line">            code_out := l_error.code;</span><br><span class="line">            name_out := l_error.name;</span><br><span class="line">            text_out := l_error.text;</span><br><span class="line">            recommendation_out := l_error.recommendation;</span><br><span class="line">            system_error_code_out := l_error.system_error_code;</span><br><span class="line">            system_error_message_out := l_error.system_error_message;</span><br><span class="line">            error_stack_out := l_error.error_stack;</span><br><span class="line">            call_stack_out := l_error.call_stack;</span><br><span class="line">            id_out := l_error.id;</span><br><span class="line">            message_out := error_message_in;</span><br><span class="line">            environment_info_out := l_error.environment_info;</span><br><span class="line">            contexts_out := l_error.contexts;</span><br><span class="line">        ELSE</span><br><span class="line">            <span class="comment">-- Of the form ORA-NNNNN: Message</span></span><br><span class="line">            code_out :=</span><br><span class="line">                SUBSTR (error_message_in</span><br><span class="line">                       ,4</span><br><span class="line">                       ,INSTR (error_message_in, ':') - 4);</span><br><span class="line">            name_out := 'System Error';</span><br><span class="line">            text_out := error_message_in;</span><br><span class="line">            system_error_code_out := code_out;</span><br><span class="line">            system_error_message_out := text_out;</span><br><span class="line">            id_out := NULL;</span><br><span class="line">            message_out := error_message_in;</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">-- All done, revert to "no error" state.</span></span><br><span class="line">        mark_q$error_handled;</span><br><span class="line">    <span class="keyword">END</span> get_error_info;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 1.3.6 Standardize arg name */</span></span><br><span class="line">    PROCEDURE get_error_info (</span><br><span class="line">        error_message_in           IN     VARCHAR2</span><br><span class="line">       ,code_out                      OUT q$error.code%TYPE</span><br><span class="line">       ,name_out                      OUT q$error.name%TYPE</span><br><span class="line">       ,text_out                      OUT q$error_instance.MESSAGE%TYPE</span><br><span class="line">       ,system_error_code_out         OUT q$error_instance.system_error_code%TYPE</span><br><span class="line">       ,system_error_message_out      OUT q$error_instance.system_error_message%TYPE</span><br><span class="line">       ,recommendation_out            OUT q$error.recommendation%TYPE</span><br><span class="line">       ,error_stack_out               OUT q$error_instance.error_stack%TYPE</span><br><span class="line">       ,call_stack_out                OUT q$error_instance.call_stack%TYPE</span><br><span class="line">       ,environment_info_out          OUT q$error_instance.environment_info%TYPE)</span><br><span class="line">    IS</span><br><span class="line">        l_id         q$error_instance.id%TYPE;</span><br><span class="line">        l_message    q$error_instance.MESSAGE%TYPE;</span><br><span class="line">        l_contexts   maxvarchar2_t;</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        get_error_info (error_message_in           =&gt; DBMS_UTILITY.format_error_stack</span><br><span class="line">                       ,code_out                   =&gt; code_out</span><br><span class="line">                       ,name_out                   =&gt; name_out</span><br><span class="line">                       ,text_out                   =&gt; text_out</span><br><span class="line">                       ,system_error_code_out      =&gt; system_error_code_out</span><br><span class="line">                       ,system_error_message_out   =&gt; system_error_message_out</span><br><span class="line">                       ,recommendation_out         =&gt; recommendation_out</span><br><span class="line">                       ,error_stack_out            =&gt; error_stack_out</span><br><span class="line">                       ,call_stack_out             =&gt; call_stack_out</span><br><span class="line">                       ,environment_info_out       =&gt; environment_info_out</span><br><span class="line">                       ,id_out                     =&gt; l_id</span><br><span class="line">                       ,message_out                =&gt; l_message</span><br><span class="line">                       ,contexts_out               =&gt; l_contexts);</span><br><span class="line">    <span class="keyword">END</span> get_error_info;</span><br><span class="line"></span><br><span class="line">    PROCEDURE get_error_info (</span><br><span class="line">        code_out                   OUT q$error.code%TYPE</span><br><span class="line">       ,name_out                   OUT q$error.name%TYPE</span><br><span class="line">       ,text_out                   OUT q$error_instance.MESSAGE%TYPE</span><br><span class="line">       ,system_error_code_out      OUT q$error_instance.system_error_code%TYPE</span><br><span class="line">       ,system_error_message_out   OUT q$error_instance.system_error_message%TYPE</span><br><span class="line">       ,recommendation_out         OUT q$error.recommendation%TYPE</span><br><span class="line">       ,error_stack_out            OUT q$error_instance.error_stack%TYPE</span><br><span class="line">       ,call_stack_out             OUT q$error_instance.call_stack%TYPE</span><br><span class="line">       ,environment_info_out       OUT q$error_instance.environment_info%TYPE)</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        get_error_info (error_message_in           =&gt; DBMS_UTILITY.format_error_stack</span><br><span class="line">                       ,code_out                   =&gt; code_out</span><br><span class="line">                       ,name_out                   =&gt; name_out</span><br><span class="line">                       ,text_out                   =&gt; text_out</span><br><span class="line">                       ,system_error_code_out      =&gt; system_error_code_out</span><br><span class="line">                       ,system_error_message_out   =&gt; system_error_message_out</span><br><span class="line">                       ,recommendation_out         =&gt; recommendation_out</span><br><span class="line">                       ,error_stack_out            =&gt; error_stack_out</span><br><span class="line">                       ,call_stack_out             =&gt; call_stack_out</span><br><span class="line">                       ,environment_info_out       =&gt; environment_info_out);</span><br><span class="line">    <span class="keyword">END</span> get_error_info;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 1.3 Add id and message as OUT arguments */</span></span><br><span class="line">    PROCEDURE get_error_info (</span><br><span class="line">        code_out                      OUT q$error.code%TYPE</span><br><span class="line">       ,name_out                      OUT q$error.name%TYPE</span><br><span class="line">       ,text_out                      OUT q$error_instance.MESSAGE%TYPE</span><br><span class="line">       ,system_error_code_out         OUT q$error_instance.system_error_code%TYPE</span><br><span class="line">       ,system_error_message_out      OUT q$error_instance.system_error_message%TYPE</span><br><span class="line">       ,recommendation_out            OUT q$error.recommendation%TYPE</span><br><span class="line">       ,error_stack_out               OUT q$error_instance.error_stack%TYPE</span><br><span class="line">       ,call_stack_out                OUT q$error_instance.call_stack%TYPE</span><br><span class="line">       ,environment_info_out          OUT q$error_instance.environment_info%TYPE</span><br><span class="line">       ,id_out                        OUT q$error_instance.id%TYPE</span><br><span class="line">       ,message_out                   OUT q$error_instance.MESSAGE%TYPE</span><br><span class="line">       ,contexts_out                  OUT VARCHAR2</span><br><span class="line">       ,context_delimiter_in       IN     VARCHAR2 DEFAULT c_newline)</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        get_error_info (error_message_in           =&gt; DBMS_UTILITY.format_error_stack</span><br><span class="line">                       ,code_out                   =&gt; code_out</span><br><span class="line">                       ,name_out                   =&gt; name_out</span><br><span class="line">                       ,text_out                   =&gt; text_out</span><br><span class="line">                       ,system_error_code_out      =&gt; system_error_code_out</span><br><span class="line">                       ,system_error_message_out   =&gt; system_error_message_out</span><br><span class="line">                       ,recommendation_out         =&gt; recommendation_out</span><br><span class="line">                       ,error_stack_out            =&gt; error_stack_out</span><br><span class="line">                       ,call_stack_out             =&gt; call_stack_out</span><br><span class="line">                       ,environment_info_out       =&gt; environment_info_out</span><br><span class="line">                       ,id_out                     =&gt; id_out</span><br><span class="line">                       ,message_out                =&gt; message_out</span><br><span class="line">                       ,context_delimiter_in       =&gt; context_delimiter_in</span><br><span class="line">                       ,contexts_out               =&gt; contexts_out);</span><br><span class="line">    <span class="keyword">END</span> get_error_info;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">-- 1.2 Get message text only</span></span><br><span class="line">    FUNCTION error_message</span><br><span class="line">        RETURN VARCHAR2</span><br><span class="line">    IS</span><br><span class="line">        l_extra               q$error.description%TYPE;</span><br><span class="line">        l_error_instance_id   q$error_instance.id%TYPE;</span><br><span class="line">        l_error               error_info_rt;</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        parse_message (DBMS_UTILITY.format_error_stack</span><br><span class="line">                      ,l_error_instance_id</span><br><span class="line">                      ,l_extra);</span><br><span class="line">        get_error_info (error_instance_id_in   =&gt; l_error_instance_id</span><br><span class="line">                       ,error_info_out         =&gt; l_error);</span><br><span class="line">        RETURN NVL (l_error.text, l_error.system_error_message);</span><br><span class="line">    <span class="keyword">END</span> error_message;</span><br><span class="line"></span><br><span class="line">    FUNCTION error_clipboard (clear_clipboard_in IN BOOLEAN DEFAULT TRUE)</span><br><span class="line">        RETURN VARCHAR2</span><br><span class="line">    IS</span><br><span class="line">        l_clipboard   maxvarchar2_t;</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        l_clipboard := g_clipboard;</span><br><span class="line"></span><br><span class="line">        IF clear_clipboard_in</span><br><span class="line">        THEN</span><br><span class="line">            clear_error_clipboard;</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line"></span><br><span class="line">        RETURN l_clipboard;</span><br><span class="line">    <span class="keyword">END</span> error_clipboard;</span><br><span class="line"></span><br><span class="line">    FUNCTION error_clipboard_is_full</span><br><span class="line">        RETURN BOOLEAN</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">RETURN</span> g_clipboard_is_full;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     IF g_clipboard IS NULL</span></span><br><span class="line"><span class="comment">    THEN</span></span><br><span class="line"><span class="comment">     RETURN FALSE;</span></span><br><span class="line"><span class="comment">    ELSE</span></span><br><span class="line"><span class="comment">     RETURN (c_warning LIKE g_clipboard || '%');</span></span><br><span class="line"><span class="comment">    END IF;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">END</span> error_clipboard_is_full;</span><br><span class="line"></span><br><span class="line">    PROCEDURE clear_error_clipboard</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        g_clipboard := <span class="literal">NULL</span>;</span><br><span class="line">        g_clipboard_is_full := FALSE;</span><br><span class="line">    <span class="keyword">END</span> clear_error_clipboard;</span><br><span class="line"></span><br><span class="line">    PROCEDURE add_to_error_clipboard (str IN VARCHAR2)</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">IF</span> g_clipboard <span class="keyword">IS</span> <span class="literal">NULL</span></span><br><span class="line">        <span class="keyword">THEN</span></span><br><span class="line">            g_clipboard := <span class="keyword">str</span>;</span><br><span class="line">        ELSE</span><br><span class="line">            g_clipboard := g_clipboard || CHR (10) || str;</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line">    <span class="keyword">END</span> add_to_error_clipboard;</span><br><span class="line"></span><br><span class="line">    PROCEDURE show_error_info (</span><br><span class="line">        error_instance_id_in   IN q$error_instance.id%TYPE</span><br><span class="line">       ,copy_to_clipboard_in   IN BOOLEAN DEFAULT FALSE)</span><br><span class="line">    IS</span><br><span class="line">        code_out                   q$error.code%TYPE;</span><br><span class="line">        name_out                   q$error.name%TYPE;</span><br><span class="line">        text_out                   q$error_instance.MESSAGE%TYPE;</span><br><span class="line">        system_error_code_out      q$error_instance.system_error_code%TYPE;</span><br><span class="line">        system_error_message_out   q$error_instance.system_error_message%TYPE;</span><br><span class="line">        recommendation_out         q$error.recommendation%TYPE;</span><br><span class="line">        error_stack_out            q$error_instance.error_stack%TYPE;</span><br><span class="line">        call_stack_out             q$error_instance.call_stack%TYPE;</span><br><span class="line">        environment_info_out       q$error_instance.environment_info%TYPE;</span><br><span class="line"></span><br><span class="line">        PROCEDURE pl (str IN VARCHAR2)</span><br><span class="line">        IS</span><br><span class="line">            already_full   EXCEPTION;</span><br><span class="line">        <span class="keyword">BEGIN</span></span><br><span class="line">            <span class="keyword">IF</span> error_clipboard_is_full</span><br><span class="line">            <span class="keyword">THEN</span></span><br><span class="line">                <span class="keyword">RAISE</span> already_full;</span><br><span class="line">            <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line"></span><br><span class="line">            IF copy_to_clipboard_in</span><br><span class="line">            THEN</span><br><span class="line">                add_to_error_clipboard (str);</span><br><span class="line">            ELSE</span><br><span class="line">                q$error_manager.pl (str);</span><br><span class="line">            <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line">        EXCEPTION</span><br><span class="line">            WHEN already_full</span><br><span class="line">            THEN</span><br><span class="line">                NULL;</span><br><span class="line">            WHEN VALUE_ERROR</span><br><span class="line">            THEN</span><br><span class="line">                g_clipboard_is_full := TRUE;</span><br><span class="line"></span><br><span class="line">                IF LENGTH (g_clipboard) &gt;</span><br><span class="line">                       (c_varchar2_max_length - c_warning_len)</span><br><span class="line">                THEN</span><br><span class="line">                    g_clipboard :=</span><br><span class="line">                        c_trunc_warning</span><br><span class="line">                        || SUBSTR (g_clipboard</span><br><span class="line">                                  ,1</span><br><span class="line">                                  ,c_varchar2_max_length - c_warning_len);</span><br><span class="line">                ELSE</span><br><span class="line">                    g_clipboard := c_trunc_warning || g_clipboard;</span><br><span class="line">                <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line">        <span class="keyword">END</span> pl;</span><br><span class="line"></span><br><span class="line">        PROCEDURE pl_header (str IN VARCHAR2)</span><br><span class="line">        IS</span><br><span class="line">        <span class="keyword">BEGIN</span></span><br><span class="line">            pl (<span class="string">'================================================='</span>);</span><br><span class="line">            pl (str);</span><br><span class="line">        <span class="keyword">END</span> pl_header;</span><br><span class="line"></span><br><span class="line">        PROCEDURE show_contexts</span><br><span class="line">        IS</span><br><span class="line">            l_context   q$error_context_tc;</span><br><span class="line">            l_row       PLS_INTEGER;</span><br><span class="line">        <span class="keyword">BEGIN</span></span><br><span class="line">            <span class="keyword">SELECT</span> *</span><br><span class="line">              <span class="keyword">BULK</span> <span class="keyword">COLLECT</span> <span class="keyword">INTO</span> l_context</span><br><span class="line">              <span class="keyword">FROM</span> q$error_context</span><br><span class="line">             <span class="keyword">WHERE</span> error_instance_id = error_instance_id_in;</span><br><span class="line"></span><br><span class="line">            l_row := l_context.FIRST;</span><br><span class="line"></span><br><span class="line">            IF l_row IS NOT NULL</span><br><span class="line">            THEN</span><br><span class="line">                pl ('   &gt; Error context information:');</span><br><span class="line"></span><br><span class="line">                WHILE (l_row IS NOT NULL)</span><br><span class="line">                LOOP</span><br><span class="line">                    pl ('      Context = "' || l_context (l_row).name || '"');</span><br><span class="line">                    pl ('      Value = "' || l_context (l_row).VALUE || '"');</span><br><span class="line">                    l_row := l_context.NEXT (l_row);</span><br><span class="line">                <span class="keyword">END</span> <span class="keyword">LOOP</span>;</span><br><span class="line">            <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line">        <span class="keyword">END</span> show_contexts;</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        get_error_info (error_instance_id_in       =&gt; error_instance_id_in</span><br><span class="line">                       ,code_out                   =&gt; code_out</span><br><span class="line">                       ,name_out                   =&gt; name_out</span><br><span class="line">                       ,text_out                   =&gt; text_out</span><br><span class="line">                       ,system_error_code_out      =&gt; system_error_code_out</span><br><span class="line">                       ,system_error_message_out   =&gt; system_error_message_out</span><br><span class="line">                       ,recommendation_out         =&gt; recommendation_out</span><br><span class="line">                       ,error_stack_out            =&gt; error_stack_out</span><br><span class="line">                       ,call_stack_out             =&gt; call_stack_out</span><br><span class="line">                       ,environment_info_out       =&gt; environment_info_out);</span><br><span class="line">        pl_header (</span><br><span class="line">            'Error report for error instance ' || error_instance_id_in);</span><br><span class="line">        pl ('   &gt; Code-Name: ' || code_out || '-' || name_out);</span><br><span class="line">        pl ('   &gt; Text: ' || text_out);</span><br><span class="line">        pl ('   &gt; System error code: ' || system_error_code_out);</span><br><span class="line">        pl ('   &gt; System error message: ' || system_error_message_out);</span><br><span class="line">        pl ('   &gt; Recommendation: ' || recommendation_out);</span><br><span class="line">        pl ('   &gt; Error stack: ' || error_stack_out);</span><br><span class="line">        pl ('   &gt; Call stack: ' || call_stack_out);</span><br><span class="line"></span><br><span class="line">        IF environment_info_out IS NOT NULL</span><br><span class="line">        THEN</span><br><span class="line">            pl_header ('   &gt; Environmental Information');</span><br><span class="line">            pl ('   ' || environment_info_out);</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line"></span><br><span class="line">        show_contexts;</span><br><span class="line">    <span class="keyword">END</span> show_error_info;</span><br><span class="line"></span><br><span class="line">    PROCEDURE show_errors (cursor_in              IN weak_refcursor</span><br><span class="line">                          ,copy_to_clipboard_in   IN BOOLEAN DEFAULT FALSE)</span><br><span class="line">    IS</span><br><span class="line">        l_error_id   PLS_INTEGER;</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">LOOP</span></span><br><span class="line">            <span class="keyword">FETCH</span> cursor_in <span class="keyword">INTO</span> l_error_id;</span><br><span class="line"></span><br><span class="line">            EXIT WHEN cursor_in%NOTFOUND;</span><br><span class="line">            show_error_info (l_error_id</span><br><span class="line">                            ,copy_to_clipboard_in   =&gt; copy_to_clipboard_in);</span><br><span class="line">            EXIT WHEN error_clipboard_is_full;</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">LOOP</span>;</span><br><span class="line">    <span class="keyword">END</span> show_errors;</span><br><span class="line"></span><br><span class="line">    PROCEDURE show_errors_after (</span><br><span class="line">        date_in                IN DATE</span><br><span class="line">       ,copy_to_clipboard_in   IN BOOLEAN DEFAULT FALSE)</span><br><span class="line">    IS</span><br><span class="line">        l_cursor   weak_refcursor;</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">OPEN</span> l_cursor <span class="keyword">FOR</span></span><br><span class="line">            <span class="keyword">SELECT</span> <span class="keyword">id</span></span><br><span class="line">              <span class="keyword">FROM</span> q$error_instance</span><br><span class="line">             <span class="keyword">WHERE</span> created_on &gt;= date_in</span><br><span class="line">            <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">id</span>;</span><br><span class="line"></span><br><span class="line">        show_errors (l_cursor, copy_to_clipboard_in =&gt; copy_to_clipboard_in);</span><br><span class="line"></span><br><span class="line">        CLOSE l_cursor;</span><br><span class="line">    <span class="keyword">END</span> show_errors_after;</span><br><span class="line"></span><br><span class="line">    PROCEDURE show_errors_with_message (</span><br><span class="line">        text_in                IN VARCHAR2</span><br><span class="line">       ,copy_to_clipboard_in   IN BOOLEAN DEFAULT FALSE)</span><br><span class="line">    IS</span><br><span class="line">        l_cursor   weak_refcursor;</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">OPEN</span> l_cursor <span class="keyword">FOR</span></span><br><span class="line">            <span class="keyword">SELECT</span> <span class="keyword">id</span></span><br><span class="line">              <span class="keyword">FROM</span> q$error_instance</span><br><span class="line">             <span class="keyword">WHERE</span> <span class="keyword">INSTR</span> (<span class="keyword">UPPER</span> (MESSAGE), <span class="keyword">UPPER</span> (text_in)) &gt; <span class="number">0</span></span><br><span class="line">            <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">id</span>;</span><br><span class="line"></span><br><span class="line">        show_errors (l_cursor, copy_to_clipboard_in =&gt; copy_to_clipboard_in);</span><br><span class="line"></span><br><span class="line">        CLOSE l_cursor;</span><br><span class="line">    <span class="keyword">END</span> show_errors_with_message;</span><br><span class="line"></span><br><span class="line">    PROCEDURE show_errors_with_code (</span><br><span class="line">        error_code_in             IN PLS_INTEGER</span><br><span class="line">       ,is_system_error_code_in   IN BOOLEAN DEFAULT FALSE</span><br><span class="line">       ,copy_to_clipboard_in      IN BOOLEAN DEFAULT FALSE)</span><br><span class="line">    IS</span><br><span class="line">        l_cursor   weak_refcursor;</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">IF</span> is_system_error_code_in</span><br><span class="line">        <span class="keyword">THEN</span></span><br><span class="line">            <span class="keyword">OPEN</span> l_cursor <span class="keyword">FOR</span></span><br><span class="line">                <span class="keyword">SELECT</span> <span class="keyword">id</span></span><br><span class="line">                  <span class="keyword">FROM</span> q$error_instance</span><br><span class="line">                 <span class="keyword">WHERE</span> system_error_code = error_code_in</span><br><span class="line">                <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">id</span>;</span><br><span class="line">        ELSE</span><br><span class="line">            OPEN l_cursor FOR</span><br><span class="line">                <span class="keyword">SELECT</span> i.id</span><br><span class="line">                  <span class="keyword">FROM</span> q$error_instance i, q$<span class="keyword">error</span> e</span><br><span class="line">                 <span class="keyword">WHERE</span> i.error_id = e.id <span class="keyword">AND</span> code = error_code_in</span><br><span class="line">                <span class="keyword">ORDER</span> <span class="keyword">BY</span> i.id;</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line"></span><br><span class="line">        show_errors (l_cursor, copy_to_clipboard_in =&gt; copy_to_clipboard_in);</span><br><span class="line"></span><br><span class="line">        CLOSE l_cursor;</span><br><span class="line">    <span class="keyword">END</span> show_errors_with_code;</span><br><span class="line"></span><br><span class="line">    PROCEDURE show_errors_for (</span><br><span class="line">        where_clause_in        IN VARCHAR2</span><br><span class="line">       ,copy_to_clipboard_in   IN BOOLEAN DEFAULT FALSE)</span><br><span class="line">    IS</span><br><span class="line">        l_cursor   weak_refcursor;</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">OPEN</span> l_cursor <span class="keyword">FOR</span></span><br><span class="line">               <span class="string">'SELECT ID FROM q$error_instance WHERE '</span></span><br><span class="line">            || where_clause_in</span><br><span class="line">            || <span class="string">' ORDER BY ID'</span>;</span><br><span class="line"></span><br><span class="line">        show_errors (l_cursor, copy_to_clipboard_in =&gt; copy_to_clipboard_in);</span><br><span class="line"></span><br><span class="line">        CLOSE l_cursor;</span><br><span class="line">    <span class="keyword">END</span> show_errors_for;</span><br><span class="line"></span><br><span class="line">    PROCEDURE assert (condition_in    IN BOOLEAN</span><br><span class="line">                     ,text_in         IN q$error_instance.MESSAGE%TYPE</span><br><span class="line">                     ,error_code_in   IN q$error.code%TYPE</span><br><span class="line">                     ,name1_in        IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,value1_in       IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,name2_in        IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,value2_in       IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,name3_in        IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,value3_in       IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,name4_in        IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,value4_in       IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,name5_in        IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,value5_in       IN VARCHAR2 DEFAULT NULL)</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">IF</span> condition_in <span class="keyword">IS</span> <span class="literal">NULL</span> <span class="keyword">OR</span> <span class="keyword">NOT</span> condition_in</span><br><span class="line">        <span class="keyword">THEN</span></span><br><span class="line">            <span class="keyword">trace</span> (<span class="string">'ASSERTION FAILURE'</span>, text_in, <span class="literal">FALSE</span>);</span><br><span class="line">            raise_error (error_code_in      =&gt; error_code_in</span><br><span class="line">                        ,text_in            =&gt; text_in</span><br><span class="line">                        ,name1_in           =&gt; name1_in</span><br><span class="line">                        ,value1_in          =&gt; value1_in</span><br><span class="line">                        ,name2_in           =&gt; name2_in</span><br><span class="line">                        ,value2_in          =&gt; value2_in</span><br><span class="line">                        ,name3_in           =&gt; name3_in</span><br><span class="line">                        ,value3_in          =&gt; value3_in</span><br><span class="line">                        ,name4_in           =&gt; name4_in</span><br><span class="line">                        ,value4_in          =&gt; value4_in</span><br><span class="line">                        ,name5_in           =&gt; name5_in</span><br><span class="line">                        ,value5_in          =&gt; value5_in</span><br><span class="line">                        ,grab_settings_in   =&gt; TRUE);</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line">    <span class="keyword">END</span> assert;</span><br><span class="line"></span><br><span class="line">    PROCEDURE assert (condition_in    IN BOOLEAN</span><br><span class="line">                     ,text_in         IN q$error_instance.MESSAGE%TYPE</span><br><span class="line">                     ,error_name_in   IN q$error.name%TYPE</span><br><span class="line">                     ,name1_in        IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,value1_in       IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,name2_in        IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,value2_in       IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,name3_in        IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,value3_in       IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,name4_in        IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,value4_in       IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,name5_in        IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,value5_in       IN VARCHAR2 DEFAULT NULL)</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">IF</span> condition_in <span class="keyword">IS</span> <span class="literal">NULL</span> <span class="keyword">OR</span> <span class="keyword">NOT</span> condition_in</span><br><span class="line">        <span class="keyword">THEN</span></span><br><span class="line">            <span class="keyword">trace</span> (<span class="string">'ASSERT'</span>, text_in, <span class="literal">TRUE</span>);</span><br><span class="line">            raise_error (error_name_in      =&gt; error_name_in</span><br><span class="line">                        ,text_in            =&gt; text_in</span><br><span class="line">                        ,name1_in           =&gt; name1_in</span><br><span class="line">                        ,value1_in          =&gt; value1_in</span><br><span class="line">                        ,name2_in           =&gt; name2_in</span><br><span class="line">                        ,value2_in          =&gt; value2_in</span><br><span class="line">                        ,name3_in           =&gt; name3_in</span><br><span class="line">                        ,value3_in          =&gt; value3_in</span><br><span class="line">                        ,name4_in           =&gt; name4_in</span><br><span class="line">                        ,value4_in          =&gt; value4_in</span><br><span class="line">                        ,name5_in           =&gt; name5_in</span><br><span class="line">                        ,value5_in          =&gt; value5_in</span><br><span class="line">                        ,grab_settings_in   =&gt; TRUE);</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line">    <span class="keyword">END</span> assert;</span><br><span class="line"></span><br><span class="line">    PROCEDURE assert (condition_in   IN BOOLEAN</span><br><span class="line">                     ,text_in        IN q$error_instance.MESSAGE%TYPE</span><br><span class="line">                     ,name1_in       IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,value1_in      IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,name2_in       IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,value2_in      IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,name3_in       IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,value3_in      IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,name4_in       IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,value4_in      IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,name5_in       IN VARCHAR2 DEFAULT NULL</span><br><span class="line">                     ,value5_in      IN VARCHAR2 DEFAULT NULL)</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">IF</span> condition_in <span class="keyword">IS</span> <span class="literal">NULL</span> <span class="keyword">OR</span> <span class="keyword">NOT</span> condition_in</span><br><span class="line">        <span class="keyword">THEN</span></span><br><span class="line">            <span class="keyword">trace</span> (<span class="string">'ASSERT'</span>, text_in, <span class="literal">TRUE</span>);</span><br><span class="line">            raise_error (error_name_in      =&gt; 'ASSERTION-FAILURE'</span><br><span class="line">                        ,text_in            =&gt; text_in</span><br><span class="line">                        ,name1_in           =&gt; name1_in</span><br><span class="line">                        ,value1_in          =&gt; value1_in</span><br><span class="line">                        ,name2_in           =&gt; name2_in</span><br><span class="line">                        ,value2_in          =&gt; value2_in</span><br><span class="line">                        ,name3_in           =&gt; name3_in</span><br><span class="line">                        ,value3_in          =&gt; value3_in</span><br><span class="line">                        ,name4_in           =&gt; name4_in</span><br><span class="line">                        ,value4_in          =&gt; value4_in</span><br><span class="line">                        ,name5_in           =&gt; name5_in</span><br><span class="line">                        ,value5_in          =&gt; value5_in</span><br><span class="line">                        ,grab_settings_in   =&gt; TRUE);</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line">    <span class="keyword">END</span> assert;</span><br><span class="line"></span><br><span class="line">    PROCEDURE simple_assert (</span><br><span class="line">        condition_in         IN BOOLEAN</span><br><span class="line">       ,text_in              IN q$error_instance.MESSAGE%TYPE</span><br><span class="line">       ,name1_in             IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value1_in            IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name2_in             IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value2_in            IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name3_in             IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value3_in            IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name4_in             IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value4_in            IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,name5_in             IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,value5_in            IN VARCHAR2 DEFAULT NULL</span><br><span class="line">       ,raise_with_code_in   IN PLS_INTEGER DEFAULT -20000)</span><br><span class="line">    IS</span><br><span class="line">        l_text   maxvarchar2_t := text_in;</span><br><span class="line"></span><br><span class="line">        PROCEDURE add_nv (text_inout   IN OUT VARCHAR2</span><br><span class="line">                         ,nm_in        IN     VARCHAR2</span><br><span class="line">                         ,val_in       IN     VARCHAR2)</span><br><span class="line">        IS</span><br><span class="line">        <span class="keyword">BEGIN</span></span><br><span class="line">            text_inout :=</span><br><span class="line">                text_inout</span><br><span class="line">                || <span class="keyword">CASE</span></span><br><span class="line">                       <span class="keyword">WHEN</span> nm_in <span class="keyword">IS</span> <span class="literal">NULL</span> <span class="keyword">THEN</span> <span class="literal">NULL</span></span><br><span class="line">                       <span class="keyword">ELSE</span> <span class="keyword">CHR</span> (<span class="number">10</span>) || nm_in || <span class="string">' = '</span> || val_in</span><br><span class="line">                   <span class="keyword">END</span>;</span><br><span class="line">        <span class="keyword">END</span> add_nv;</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">IF</span> condition_in <span class="keyword">IS</span> <span class="literal">NULL</span> <span class="keyword">OR</span> <span class="keyword">NOT</span> condition_in</span><br><span class="line">        <span class="keyword">THEN</span></span><br><span class="line">            add_nv (l_text, name1_in, value1_in);</span><br><span class="line">            add_nv (l_text, name2_in, value2_in);</span><br><span class="line">            add_nv (l_text, name3_in, value3_in);</span><br><span class="line">            add_nv (l_text, name4_in, value4_in);</span><br><span class="line">            add_nv (l_text, name5_in, value5_in);</span><br><span class="line"></span><br><span class="line">            raise_application_error (raise_with_code_in, l_text);</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line">    <span class="keyword">END</span> simple_assert;</span><br><span class="line"></span><br><span class="line">    PROCEDURE start_execution (program_name_in   IN VARCHAR2 := NULL</span><br><span class="line">                              ,information_in    IN VARCHAR2 := NULL)</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">END</span> start_execution;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    Test builder validation:</span></span><br><span class="line"><span class="comment">     * return a status string composed of type:message</span></span><br><span class="line"><span class="comment">     * if no prefix, then it is an error</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    FUNCTION is_warning (status_in IN VARCHAR2)</span><br><span class="line">        RETURN BOOLEAN</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">RETURN</span> status_in <span class="keyword">LIKE</span> c_warning || <span class="string">'%'</span>;</span><br><span class="line">    <span class="keyword">END</span> is_warning;</span><br><span class="line"></span><br><span class="line">    FUNCTION is_error (status_in IN VARCHAR2)</span><br><span class="line">        RETURN BOOLEAN</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">RETURN</span> status_in <span class="keyword">LIKE</span> c_error || <span class="string">'%'</span>;</span><br><span class="line">    <span class="keyword">END</span> is_error;</span><br><span class="line"></span><br><span class="line">    FUNCTION is_info_msg (status_in IN VARCHAR2)</span><br><span class="line">        RETURN BOOLEAN</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">RETURN</span> status_in <span class="keyword">LIKE</span> c_info_msg || <span class="string">'%'</span>;</span><br><span class="line">    <span class="keyword">END</span> is_info_msg;</span><br><span class="line"></span><br><span class="line">    PROCEDURE parse_status_string (status_in         IN     VARCHAR2</span><br><span class="line">                                  ,status_type_out      OUT VARCHAR2</span><br><span class="line">                                  ,message_out          OUT VARCHAR2)</span><br><span class="line">    IS</span><br><span class="line">        l_loc   PLS_INTEGER := INSTR (status_in, c_status_delimiter);</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">IF</span> l_loc = <span class="number">0</span></span><br><span class="line">        <span class="keyword">THEN</span></span><br><span class="line">            status_type_out := c_error;</span><br><span class="line">            message_out := status_in;</span><br><span class="line">        ELSE</span><br><span class="line">            status_type_out := SUBSTR (status_in, 1, l_loc - 1);</span><br><span class="line">            message_out := SUBSTR (status_in, l_loc + 1);</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line">    <span class="keyword">END</span> parse_status_string;</span><br><span class="line"></span><br><span class="line">    FUNCTION make_a_string (header_in IN VARCHAR2, status_in IN VARCHAR2)</span><br><span class="line">        RETURN VARCHAR2</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">RETURN</span> header_in || c_status_delimiter || status_in</span><br><span class="line">               || <span class="keyword">CASE</span></span><br><span class="line">                      <span class="keyword">WHEN</span> trace_enabled</span><br><span class="line">                      <span class="keyword">THEN</span></span><br><span class="line">                          <span class="keyword">CHR</span> (<span class="number">10</span>) || <span class="keyword">CHR</span> (<span class="number">10</span>) || error_backtrace</span><br><span class="line">                      <span class="keyword">ELSE</span></span><br><span class="line">                          <span class="literal">NULL</span></span><br><span class="line">                  <span class="keyword">END</span>;</span><br><span class="line">    <span class="keyword">END</span> make_a_string;</span><br><span class="line"></span><br><span class="line">    FUNCTION make_an_info_msg (status_in IN VARCHAR2)</span><br><span class="line">        RETURN VARCHAR2</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">RETURN</span> make_a_string (c_info_msg, status_in);</span><br><span class="line">    <span class="keyword">END</span> make_an_info_msg;</span><br><span class="line"></span><br><span class="line">    FUNCTION make_a_warning (status_in IN VARCHAR2)</span><br><span class="line">        RETURN VARCHAR2</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">RETURN</span> make_a_string (c_warning, status_in);</span><br><span class="line">    <span class="keyword">END</span> make_a_warning;</span><br><span class="line"></span><br><span class="line">    FUNCTION make_an_error (status_in IN VARCHAR2)</span><br><span class="line">        RETURN VARCHAR2</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">RETURN</span> make_a_string (c_error, status_in);</span><br><span class="line">    <span class="keyword">END</span> make_an_error;</span><br><span class="line"></span><br><span class="line">    PROCEDURE make_a_warning (status_inout IN OUT VARCHAR2)</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        status_inout := make_a_warning (status_inout);</span><br><span class="line">    <span class="keyword">END</span> make_a_warning;</span><br><span class="line"></span><br><span class="line">    PROCEDURE make_an_error (status_inout IN OUT VARCHAR2)</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        status_inout := make_an_error (status_inout);</span><br><span class="line">    <span class="keyword">END</span> make_an_error;</span><br><span class="line"></span><br><span class="line">    PROCEDURE make_an_info_msg (status_inout IN OUT VARCHAR2)</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        status_inout := make_an_info_msg (status_inout);</span><br><span class="line">    <span class="keyword">END</span> make_an_info_msg;</span><br><span class="line"></span><br><span class="line">    FUNCTION log_entries_after (timestamp_in IN DATE)</span><br><span class="line">        RETURN SYS_REFCURSOR</span><br><span class="line">    IS</span><br><span class="line">        CV   SYS_REFCURSOR;</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">IF</span> trace_enabled</span><br><span class="line">        <span class="keyword">THEN</span></span><br><span class="line">            <span class="keyword">trace</span> (<span class="string">'log_entries_after for date'</span>, timestamp_in, <span class="literal">TRUE</span>);</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line"></span><br><span class="line">        OPEN CV FOR</span><br><span class="line">            <span class="keyword">SELECT</span> full_log_string (<span class="keyword">context</span>, <span class="built_in">text</span>, <span class="literal">NULL</span>)</span><br><span class="line">              <span class="keyword">FROM</span> q$<span class="keyword">log</span> ql</span><br><span class="line">            <span class="comment">/* WHERE BM2066 return all rows for now</span></span><br><span class="line"><span class="comment">             ql.created_on &gt;= timestamp_in*/</span></span><br><span class="line">            <span class="keyword">ORDER</span> <span class="keyword">BY</span> ql.id;</span><br><span class="line"></span><br><span class="line">        RETURN CV;</span><br><span class="line">    <span class="keyword">END</span> log_entries_after;</span><br><span class="line"></span><br><span class="line">    PROCEDURE not_yet_implemented (program_name_in IN VARCHAR2)</span><br><span class="line">    IS</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        DBMS_OUTPUT.put_line (</span><br><span class="line">            <span class="string">'Callstack that found its way to "'</span> || program_name_in || <span class="string">'"'</span>);</span><br><span class="line">        DBMS_OUTPUT.put_line (DBMS_UTILITY.format_call_stack);</span><br><span class="line">        raise_application_error (</span><br><span class="line">            c_not_yet_implemented</span><br><span class="line">           ,   'Program named "'</span><br><span class="line">            || program_name_in</span><br><span class="line">            || '" has not yet been implemented.'</span><br><span class="line">            || ' Enable SERVEROUTPUT to see callstack for this program call.<span class="string">');</span></span><br><span class="line"><span class="string">    END not_yet_implemented;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    PROCEDURE discard_error_state</span></span><br><span class="line"><span class="string">    IS</span></span><br><span class="line"><span class="string">    BEGIN</span></span><br><span class="line"><span class="string">        g_discard_error_state := TRUE;</span></span><br><span class="line"><span class="string">        /*fds: 1.4.1 - discard_error_state: clear state already stored */</span></span><br><span class="line"><span class="string">        g_error_instance_raised := NULL;</span></span><br><span class="line"><span class="string">        clear_gcontexts;</span></span><br><span class="line"><span class="string">    END discard_error_state;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    PROCEDURE keep_error_state</span></span><br><span class="line"><span class="string">    IS</span></span><br><span class="line"><span class="string">    BEGIN</span></span><br><span class="line"><span class="string">        g_discard_error_state := FALSE;</span></span><br><span class="line"><span class="string">    END keep_error_state;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    FUNCTION error_state_discarded</span></span><br><span class="line"><span class="string">        RETURN BOOLEAN</span></span><br><span class="line"><span class="string">    IS</span></span><br><span class="line"><span class="string">    BEGIN</span></span><br><span class="line"><span class="string">        RETURN g_discard_error_state;</span></span><br><span class="line"><span class="string">    END error_state_discarded;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    PROCEDURE clean_up_errors (older_than_in IN DATE DEFAULT NULL)</span></span><br><span class="line"><span class="string">    IS</span></span><br><span class="line"><span class="string">        PRAGMA AUTONOMOUS_TRANSACTION;</span></span><br><span class="line"><span class="string">    BEGIN</span></span><br><span class="line"><span class="string">        DELETE FROM q$error_instance</span></span><br><span class="line"><span class="string">         WHERE older_than_in IS NULL OR created_on &lt;= older_than_in;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        COMMIT;</span></span><br><span class="line"><span class="string">    END clean_up_errors;</span></span><br><span class="line"><span class="string">END q$error_manager;</span></span><br><span class="line"><span class="string">/</span></span><br></pre></td></tr></table></figure><h2 id="自定义错误"><a href="#自定义错误" class="headerlink" title="自定义错误"></a>自定义错误</h2><blockquote><p><code>qem$define_errors.sql</code></p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">| This program is a part of the Quest Error Manager for Oracle.</span></span><br><span class="line"><span class="comment">| This product is freeware and is not supported by Quest.</span></span><br><span class="line"><span class="comment">|</span></span><br><span class="line"><span class="comment">| You may copy and change the data in these statements to meet</span></span><br><span class="line"><span class="comment">| your own application-specific requirements. That is, you can</span></span><br><span class="line"><span class="comment">| define your own errors in this script.</span></span><br><span class="line"><span class="comment">|</span></span><br><span class="line"><span class="comment">| www.quest.com</span></span><br><span class="line"><span class="comment">| </span></span><br><span class="line"><span class="comment">| Copyright, Quest Software, Inc, 2007</span></span><br><span class="line"><span class="comment">| All rights reserved</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">DECLARE</span></span><br><span class="line">   c_support   <span class="keyword">CONSTANT</span> VARCHAR2 (<span class="number">32767</span>)</span><br><span class="line">                        := <span class="string">'&lt;PUT IN YOUR OWN "CONTACT SUPPORT" MESSAGE HERE&gt;'</span>;</span><br><span class="line"></span><br><span class="line">   PROCEDURE ins (</span><br><span class="line">      error_category_name_in IN VARCHAR2</span><br><span class="line">    , code_in IN NUMBER DEFAULT NULL</span><br><span class="line">    , NAME_IN IN VARCHAR2 DEFAULT NULL</span><br><span class="line">    , description_in IN VARCHAR2 DEFAULT NULL</span><br><span class="line">    , substitute_string_in IN VARCHAR2 DEFAULT NULL</span><br><span class="line">    , recommendation_in IN VARCHAR2 DEFAULT NULL</span><br><span class="line">   )</span><br><span class="line">   IS</span><br><span class="line">   <span class="keyword">BEGIN</span></span><br><span class="line">      <span class="keyword">INSERT</span> <span class="keyword">INTO</span> q$<span class="keyword">error</span></span><br><span class="line">                  (<span class="keyword">ID</span>, error_category_name, code</span><br><span class="line">                 , <span class="keyword">NAME</span>, description, substitute_string</span><br><span class="line">                 , recommendation</span><br><span class="line">                  )</span><br><span class="line">           <span class="keyword">VALUES</span> (q$error_seq.NEXTVAL, error_category_name_in, code_in</span><br><span class="line">                 , NAME_IN, description_in, substitute_string_in</span><br><span class="line">                 , recommendation_in</span><br><span class="line">                  );</span><br><span class="line">   EXCEPTION</span><br><span class="line">      WHEN DUP_VAL_ON_INDEX</span><br><span class="line">      THEN</span><br><span class="line">         <span class="comment">/* Running install over existing install. Just ignore. */</span></span><br><span class="line">         NULL;</span><br><span class="line">   <span class="keyword">END</span> ins;</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">   ins</span><br><span class="line">      (error_category_name_in      =&gt; <span class="string">'GENERAL ADMINISTRATION'</span></span><br><span class="line">     , code_in                     =&gt; <span class="number">10000001</span></span><br><span class="line">     , NAME_IN                     =&gt; <span class="string">'ASSERTION-FAILURE'</span></span><br><span class="line">     , description_in              =&gt; <span class="string">'This exception is raised when you:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">*  call q$error_manager.assert</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">* pass it a Boolean expression that evaluates to FALSE or NULL</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">* and do not provide a specific error code or name to be raised for you.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">There are no pre-defined context values used in the error message. Instead, if you set any name-value pairs when you call q$error_manager.assert, these will be displayed.'</span></span><br><span class="line">     , recommendation_in           =&gt; <span class="string">''</span></span><br><span class="line">     , substitute_string_in        =&gt; <span class="string">'The Boolean expression provided evaluated to FALSE or NULL. The condition checked by the assertion program has failed.'</span></span><br><span class="line">      );</span><br><span class="line">   ins</span><br><span class="line">      (error_category_name_in      =&gt; 'GENERAL ADMINISTRATION'</span><br><span class="line">     , code_in                     =&gt; 10000003</span><br><span class="line">     , NAME_IN                     =&gt; 'DEPRECATED-FUNCTIONALITY'</span><br><span class="line">     , description_in              =&gt; 'The user tried to run a program that has been deprecated.'</span><br><span class="line">     , recommendation_in           =&gt; 'This is NOT a user error. '</span><br><span class="line">                                      || c_support</span><br><span class="line">     , substitute_string_in        =&gt; 'The application attempted to run a program named "$program_name" that has been deprecated; that is, it is no longer available and should not be executed.'</span><br><span class="line">      );</span><br><span class="line">   ins (error_category_name_in      =&gt; 'GENERAL ADMINISTRATION'</span><br><span class="line">      , code_in                     =&gt; 10000000</span><br><span class="line">      , NAME_IN                     =&gt; 'NOEXCEPTION'</span><br><span class="line">      , description_in              =&gt; 'No exception has been raised.'</span><br><span class="line">      , recommendation_in           =&gt; ''</span><br><span class="line">      , substitute_string_in        =&gt; c_support</span><br><span class="line">       );</span><br><span class="line">   ins</span><br><span class="line">      (error_category_name_in      =&gt; 'GENERAL ADMINISTRATION'</span><br><span class="line">     , code_in                     =&gt; 10000002</span><br><span class="line">     , NAME_IN                     =&gt; 'UNANTICIPATED-ERROR'</span><br><span class="line">     , description_in              =&gt; 'This exception should be used in a PL/SQL WHEN OTHERS clause or other similar ''catch all'' handler for errors. You could not in advance know that this error was raised, and therefore could not handle it specifically. Instead, you will pass as much information possible and hope that the user or tester can figure out the problem.'</span><br><span class="line">     , recommendation_in           =&gt;    'If you cannot figure out the cause of the difficulty, '</span><br><span class="line">                                      || c_support</span><br><span class="line">     , substitute_string_in        =&gt; 'An unanticipated error has occurred. Please review the information below and see if it will help you resolve the problem.'</span><br><span class="line">      );</span><br><span class="line">   ins</span><br><span class="line">      (error_category_name_in      =&gt; 'DML ERRORS'</span><br><span class="line">     , code_in                     =&gt; -2290</span><br><span class="line">     , NAME_IN                     =&gt; 'CHECK-CONSTRAINT-FAILURE'</span><br><span class="line">     , description_in              =&gt; 'A check constraint failed.'</span><br><span class="line">     , recommendation_in           =&gt; 'Determine the logic of the constraint and change the data so that it will not fail.'</span><br><span class="line">     , substitute_string_in        =&gt; 'The constaint named $constaint_name, defined on table $table_name and owned by $owner, failed. This means that a rule that was defined on this table was violated in the process of inserting or updating a row of data.'</span><br><span class="line">      );</span><br><span class="line">   ins</span><br><span class="line">      (error_category_name_in      =&gt; 'DML ERRORS'</span><br><span class="line">     , code_in                     =&gt; -1400</span><br><span class="line">     , NAME_IN                     =&gt; 'COLUMN-CANNOT-BE-NULL'</span><br><span class="line">     , description_in              =&gt; 'The column has been defined to be NOT NULL, yet a DML operation attempted to set it to NULL.'</span><br><span class="line">     , recommendation_in           =&gt;    'If you can change the value to something that is not blank, do so. If this is not under your control, '</span><br><span class="line">                                      || c_support</span><br><span class="line">     , substitute_string_in        =&gt; 'You have tried to set the column $COLUMN_NAME of table $OWNER.$TABLE_NAME to NULL or a blank line; this is not allowed.'</span><br><span class="line">      );</span><br><span class="line"></span><br><span class="line">   <span class="comment">/* V1.2.11 Error number is changed to -1. Remove existing row. */</span></span><br><span class="line">   <span class="keyword">DELETE</span> <span class="keyword">FROM</span> q$<span class="keyword">error</span></span><br><span class="line">         <span class="keyword">WHERE</span> <span class="keyword">name</span> = <span class="string">'DUPLICATE-VALUE'</span>;</span><br><span class="line"></span><br><span class="line">   ins</span><br><span class="line">      (error_category_name_in      =&gt; 'DML ERRORS'</span><br><span class="line">     , code_in                     =&gt; -1</span><br><span class="line">     , NAME_IN                     =&gt; 'DUPLICATE-VALUE'</span><br><span class="line">     , description_in              =&gt; 'A duplicate value on index error (ORA-00001) was raised for an insert or update'</span><br><span class="line">     , recommendation_in           =&gt; 'This means that either the primary key is a repeated value, which is almost certainly a software error, or you are repeating a value in a column that must be unique. For example, in many applications the NAME will be unique. Perhaps you entered a name that is already in use.'</span><br><span class="line">     , substitute_string_in        =&gt; 'We tried to insert or update a row of data, and ran into the following problem: at least one of the values are already in the database and you are not allowed to have duplicates.</span><br><span class="line"></span><br><span class="line">This error occurred on the table named $table_name, which is owned by $owner. The name of this unique constraint is $constraint_name. In some cases, we may be able to also display the columns and values that triggered the conflict. If available, they follow below.'</span><br><span class="line">      );</span><br><span class="line">   ins</span><br><span class="line">      (error_category_name_in      =&gt; 'DML ERRORS'</span><br><span class="line">     , code_in                     =&gt; -2266</span><br><span class="line">     , NAME_IN                     =&gt; 'EXISTING-FKY-REFERENCE'</span><br><span class="line">     , description_in              =&gt; 'An DROP TABLE, TRUNCATE TABLE or DELETE statement attempted to remove a row in which the primary key or unique values are referenced by the foreign key value in another table.'</span><br><span class="line">     , recommendation_in           =&gt; c_support</span><br><span class="line">     , substitute_string_in        =&gt; 'We were unable to remove a row from table $owner.$table because it contains a primary key or unique value that is referenced by the foreign key value in another table.'</span><br><span class="line">      );</span><br><span class="line">   ins</span><br><span class="line">      (error_category_name_in      =&gt; 'DML ERRORS'</span><br><span class="line">     , code_in                     =&gt; -24381</span><br><span class="line">     , NAME_IN                     =&gt; 'FORALL-INSERT-FAILURE'</span><br><span class="line">     , description_in              =&gt; 'An error occurred while performing a bulk insert operation.'</span><br><span class="line">     , recommendation_in           =&gt; ''</span><br><span class="line">     , substitute_string_in        =&gt; 'An attempt to perform a FORALL on table $TABLE_NAME failed. The incoming array had $ROW_COUNT'' rows in it. The last action taken during that procedure''s execution was:</span><br><span class="line"></span><br><span class="line">$PROGRESS_INDICATOR'</span><br><span class="line">      );</span><br><span class="line">   ins</span><br><span class="line">      (error_category_name_in      =&gt; 'DML ERRORS'</span><br><span class="line">     , code_in                     =&gt; -2291</span><br><span class="line">     , NAME_IN                     =&gt; 'INTEGRITY-CONSTRAINT-FAILURE'</span><br><span class="line">     , description_in              =&gt; 'An integrity constraint (primary key, foreign key, etc.) failed.'</span><br><span class="line">     , recommendation_in           =&gt;    'Make sure that you are entering data correctly. If that seems to be the case, '</span><br><span class="line">                                      || c_support</span><br><span class="line">     , substitute_string_in        =&gt; 'The constraint named $constraint_name, defined on table $table_name and owned by $owner, failed.'</span><br><span class="line">      );</span><br><span class="line">   ins</span><br><span class="line">      (error_category_name_in      =&gt; 'DML ERRORS'</span><br><span class="line">     , code_in                     =&gt; 10010008</span><br><span class="line">     , NAME_IN                     =&gt; 'SEQUENCE-GENERATION-FAILURE'</span><br><span class="line">     , description_in              =&gt; 'An attempt to generate a sequence with the next primary key function resulted in failure.'</span><br><span class="line">     , recommendation_in           =&gt; 'Make sure the sequence exists and that you have the authority necessary (SELECT) to obtain the next value from this sequence.'</span><br><span class="line">     , substitute_string_in        =&gt; 'An attempt to obtain the next sequence value from $sequence failed.'</span><br><span class="line">      );</span><br><span class="line">   <span class="keyword">COMMIT</span>;</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line">/</span><br></pre></td></tr></table></figure><h2 id="卸载"><a href="#卸载" class="headerlink" title="卸载"></a>卸载</h2><blockquote><p><code>qem$uninstall.sql</code></p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">| This program is a part of the Quest Error Manager for Oracle.</span></span><br><span class="line"><span class="comment">| This product is freeware and is not supported by Quest.</span></span><br><span class="line"><span class="comment">| </span></span><br><span class="line"><span class="comment">| www.quest.com</span></span><br><span class="line"><span class="comment">| </span></span><br><span class="line"><span class="comment">| Copyright, Quest Software, Inc, 2007</span></span><br><span class="line"><span class="comment">| All rights reserved</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">SEQUENCE</span> q$error_seq</span><br><span class="line">/</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">SEQUENCE</span> q$log_seq</span><br><span class="line">/</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">SEQUENCE</span> q$error_context_seq</span><br><span class="line">/</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">SEQUENCE</span> q$error_instance_seq</span><br><span class="line">/</span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> q$error_context</span><br><span class="line">/</span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> q$error_instance</span><br><span class="line">/</span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> q$<span class="keyword">error</span></span><br><span class="line">/</span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> q$<span class="keyword">log</span></span><br><span class="line">/</span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">PACKAGE</span> q$error_manager</span><br><span class="line">/</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;qem-manual-使用手册&quot;&gt;&lt;a href=&quot;#qem-manual-使用手册&quot; class=&quot;headerlink&quot; title=&quot;qem-manual(使用手册)&quot;&gt;&lt;/a&gt;qem-manual(使用手册)&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;q$e
      
    
    </summary>
    
      <category term="Oracle" scheme="https://betgar.github.io/categories/Oracle/"/>
    
    
      <category term="Oracle" scheme="https://betgar.github.io/tags/Oracle/"/>
    
      <category term="PLSQL" scheme="https://betgar.github.io/tags/PLSQL/"/>
    
      <category term="qem" scheme="https://betgar.github.io/tags/qem/"/>
    
  </entry>
  
  <entry>
    <title>Oracle 绑定变量(bind variable)</title>
    <link href="https://betgar.github.io/2018/04/16/oracle-bind-variable/"/>
    <id>https://betgar.github.io/2018/04/16/oracle-bind-variable/</id>
    <published>2018-04-16T12:00:00.000Z</published>
    <updated>2018-06-28T11:24:48.097Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Oracle-绑定变量-bind-variable"><a href="#Oracle-绑定变量-bind-variable" class="headerlink" title="Oracle 绑定变量(bind variable)"></a>Oracle 绑定变量(bind variable)</h1><blockquote><p>转载： <a href="http://www.ecdoer.com/post/oracle-dynamic-sql.html" target="_blank" rel="noopener">http://www.ecdoer.com/post/oracle-dynamic-sql.html</a></p></blockquote><h2 id="【动态SQL定义】"><a href="#【动态SQL定义】" class="headerlink" title="【动态SQL定义】"></a>【动态SQL定义】</h2><p>动态SQL是指在PL/SQL块中，可以根据不同参数拼接不同的SQL字符串，即执行前不能确定该SQL是什么（如表名、字段名或条件值未知）。</p><h2 id="【动态SQL与静态SQL区别】"><a href="#【动态SQL与静态SQL区别】" class="headerlink" title="【动态SQL与静态SQL区别】"></a>【动态SQL与静态SQL区别】</h2><p>1）静态SQL是确定的，在执行前已经完成编译（随PL/SQL块一起完成了编译），执行时数据库直接执行编译好的SQL；而动态SQL是不确定的，是在程序运行时才编译并执行（不随PL/SQL块编译时编译）。</p><p>2）静态SQL一次编译，多次调用，使用相同的执行计划。动态SQL每次运行均要先对其编译，即多次调用则需要多次编译。</p><p>3）静态SQL使用相同的执行计划，对于确定的任务而言，静态SQL更具有高效性，但缺乏灵活性；动态SQL使用了不同的执行计划，效率不如静态SQL，但能够解决复杂的问题。</p><p>4）动态SQL容易产生SQL注入，为数据库安全带来隐患。</p><h2 id="【动态SQL用途】"><a href="#【动态SQL用途】" class="headerlink" title="【动态SQL用途】"></a>【动态SQL用途】</h2><p>1）处理PL/SQL块中不能处理的DDL或DCL语句；</p><p>2）处理PL/SQL块中带参数具有不确定性的SQL（如表名、字段名或条件值作为变量）；</p><p>3）PL/SQL中静态SQL出现性能瓶颈；</p><h2 id="【动态SQL语法】"><a href="#【动态SQL语法】" class="headerlink" title="【动态SQL语法】"></a>【动态SQL语法】</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">execute</span> <span class="keyword">immediate</span> <span class="string">'sql'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--区别于静态SQL变量赋值的INTO位置，select col into var from table;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">execute</span> <span class="keyword">immediate</span> <span class="string">'sql_select'</span> <span class="keyword">into</span> var_1, var_2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">execute</span> <span class="keyword">immediate</span> <span class="string">'sql'</span> <span class="keyword">using</span> bind_var_1,bind_var_2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">execute</span> <span class="keyword">immediate</span> <span class="string">'sql_select'</span> <span class="keyword">into</span> var_1, var_2 <span class="keyword">using</span> bind_var_1,bind_var_2;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- returning子句在insert之后返回新加的值，update之后返回修改后的值，delete返回删除前的值</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">execute</span> <span class="keyword">immediate</span> <span class="string">'sql_dml'</span> <span class="keyword">returning</span> <span class="keyword">into</span> var_1;</span><br><span class="line"></span><br><span class="line"><span class="comment">--批量动态SQL，即在动态SQL中使用BULK子句，或使用游标变量时在fetch中使用BULK，或在FORALL语句中使用BULK子句来实现</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">execute</span> <span class="keyword">immediate</span> <span class="string">'sql'</span> <span class="keyword">bulk</span> <span class="keyword">collect</span> <span class="keyword">into</span> var_array;</span><br><span class="line"></span><br><span class="line"><span class="comment">--动态REF游标，不同于静态游标声明方式</span></span><br><span class="line"></span><br><span class="line">open cursor_name for ‘sql’ using bind_var_1;</span><br></pre></td></tr></table></figure><h2 id="【动态SQL举例】"><a href="#【动态SQL举例】" class="headerlink" title="【动态SQL举例】"></a>【动态SQL举例】</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*动态SQL执行DDL语句（不能跟using）*/</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">  sql_statement varchar2(<span class="number">100</span>);</span><br><span class="line">  table_name    varchar2(20);</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  table_name := <span class="string">'emp'</span>;</span><br><span class="line">  sql_statement := '<span class="keyword">truncate</span> <span class="keyword">table</span> <span class="string">' || table_name;</span></span><br><span class="line"><span class="string">  execute immediate sql_statement;</span></span><br><span class="line"><span class="string">end;</span></span><br></pre></td></tr></table></figure><p>–注：变量不能放在引号内，否则会解析成文本而不是变量，但若在DML语句的绑定变量，则需要在引号内，拼SQL时一定要注意关键字后的空格，如truncate table之后是有一个空格的</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*动态SELECT语句（不能跟returning）*/</span></span><br><span class="line"><span class="comment">/*SELECT中表名是变量*/</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">  sql_stat varchar2(<span class="number">100</span>);</span><br><span class="line">  v_tab    varchar2(20);</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  v_tab := <span class="string">'emp'</span>;</span><br><span class="line">  sql_stat := '<span class="keyword">select</span> sal <span class="keyword">from</span> <span class="string">'|| v_tab || '</span> <span class="keyword">where</span> empno = <span class="number">1</span><span class="string">';</span></span><br><span class="line"><span class="string">  dbms_output.put_line(sql_stat);</span></span><br><span class="line"><span class="string">  execute immediate sql_stat;</span></span><br><span class="line"><span class="string">end;</span></span><br><span class="line"><span class="string">--注：注意from后面和where前面是有空格的</span></span><br><span class="line"><span class="string">/*SELECT INTO变量赋值*/</span></span><br><span class="line"><span class="string">declare</span></span><br><span class="line"><span class="string">  sql_stat varchar2(100);</span></span><br><span class="line"><span class="string">  v_sal    number(6, 2);</span></span><br><span class="line"><span class="string">begin</span></span><br><span class="line"><span class="string">  sql_stat := '</span><span class="keyword">select</span> sal <span class="keyword">from</span> emp <span class="keyword">where</span> empno = :<span class="number">1</span><span class="string">';</span></span><br><span class="line"><span class="string">  execute immediate sql_stat</span></span><br><span class="line"><span class="string">    into v_sal</span></span><br><span class="line"><span class="string">    using 1;</span></span><br><span class="line"><span class="string">  dbms_output.put_line(v_sal);</span></span><br><span class="line"><span class="string">end;</span></span><br></pre></td></tr></table></figure><p>–注：INTO的位置，不像静态SQL一样在字段名后，而是在execute immediate时才加，且关键字在using之前；另外，注意区分有returning子句的，returning子句在SQL文本和execute immediate子句中均有出现，但此时INTO的位置在using之后。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*动态SQL执行DML语句（含returning子句）*/</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">  v_sal    <span class="built_in">number</span>(<span class="number">6</span>, <span class="number">2</span>);</span><br><span class="line">  sql_stat varchar2(100);</span><br><span class="line">  v_eno    number(2);</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  v_eno    := <span class="number">1</span>;</span><br><span class="line">  sql_stat := '<span class="keyword">update</span> emp <span class="keyword">set</span> sal = sal * (<span class="number">1</span> + :<span class="keyword">percent</span> / <span class="number">100</span>) <span class="keyword">where</span> empno = :<span class="number">2</span> <span class="keyword">returning</span> sal <span class="keyword">into</span> :<span class="number">3</span><span class="string">';</span></span><br><span class="line"><span class="string">  execute immediate sql_stat</span></span><br><span class="line"><span class="string">    using &amp;1, v_eno</span></span><br><span class="line"><span class="string">    returning into v_sal;</span></span><br><span class="line"><span class="string">  commit;</span></span><br><span class="line"><span class="string">  dbms_output.put_line('</span><span class="keyword">new</span> salary: <span class="string">' || v_sal);</span></span><br><span class="line"><span class="string">end;</span></span><br></pre></td></tr></table></figure><p>–注：动态SQL内的结尾不加分号“;”，但PL/SQL的语句结尾加“;”，且冒号后的占位符是字母或数字完全没有影响，using的变量值可以是绑定变量、或变量或常量均可。如：占位符:percent对应绑定变量&amp;1，虽然名字完全不同，但也不影响，另外，占位符:2对应了变量v_eno，也是完全不同。即，按顺序占位，与占位符名无关。按顺序绑定变量，与绑定变量名无关。给占位符或绑定变量命名只是为了程序的可读性。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span></span><br><span class="line">  <span class="keyword">type</span> cur_totalvaue_type <span class="keyword">is</span> <span class="keyword">ref</span> <span class="keyword">cursor</span>;</span><br><span class="line">  cur_totalvaue     cur_totalvaue_type;</span><br><span class="line">  sql_stat          VARCHAR2(100);</span><br><span class="line">  record_totalvalue t_threeyear_hour%rowtype;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  sql_stat := <span class="string">'select * from t_threeyear_hour t where t.time = :1'</span>;</span><br><span class="line">  open cur_totalvaue for sql_stat</span><br><span class="line">    using to_date('20130209', 'yyyymmdd');</span><br><span class="line">  loop</span><br><span class="line">    fetch cur_totalvaue</span><br><span class="line">      into record_totalvalue;</span><br><span class="line">    exit when cur_totalvaue%NOTFOUND;</span><br><span class="line">    dbms_output.put_line(record_totalvalue.time || ' is ' || record_totalvalue.totalvalue);</span><br><span class="line">  <span class="keyword">end</span> <span class="keyword">loop</span>;</span><br><span class="line">  close cur_totalvaue;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"><span class="comment">/*批量动态SQL（BULK COLLECT INTO ）*/</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">  <span class="keyword">type</span> ename_table_type <span class="keyword">is</span> <span class="keyword">table</span> <span class="keyword">of</span> emp.ename%<span class="keyword">type</span> <span class="keyword">index</span> <span class="keyword">by</span> binary_integer;</span><br><span class="line">  type sal_table_type is table of emp.sal%type index by binary_integer;</span><br><span class="line">  ename_table ename_table_type;</span><br><span class="line">  sal_table   sal_table_type;</span><br><span class="line">  sql_stat    varchar2(120);</span><br><span class="line">  v_percent   number := &amp;percent;</span><br><span class="line">  v_dno       number := &amp;dno;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  sql_stat := <span class="string">'update emp set sal = sal * (1 + :percent / 100)'</span> ||</span><br><span class="line">              <span class="string">' where deptno = :dno'</span> ||</span><br><span class="line">              <span class="string">' returning ename, sal into :name, :salary'</span>;</span><br><span class="line">  <span class="keyword">execute</span> <span class="keyword">immediate</span> sql_stat</span><br><span class="line">    <span class="keyword">using</span> v_percent, v_dno</span><br><span class="line">    <span class="keyword">returning</span> <span class="keyword">bulk</span> <span class="keyword">collect</span></span><br><span class="line">    <span class="keyword">into</span> ename_table, sal_table;</span><br><span class="line">  for i in 1 .. ename_table.count loop</span><br><span class="line">    dbms_output.put_line('employee ' || ename_table(i) || ' salary is: ' || sal_table(i));</span><br><span class="line">  <span class="keyword">end</span> <span class="keyword">loop</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"><span class="comment">/*动态游标+BULK*/</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">  <span class="keyword">type</span> cur_emp_type <span class="keyword">is</span> <span class="keyword">ref</span> <span class="keyword">cursor</span>;</span><br><span class="line">  cur_emp cur_emp_type;</span><br><span class="line">  type ename_table_type is table of emp.ename%type index by binary_integer;</span><br><span class="line">  ename_table ename_table_type;</span><br><span class="line">  sql_stat    varchar2(120);</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  sql_stat := <span class="string">'select ename from emp where deptno = :dno'</span>;</span><br><span class="line">  open cur_emp for sql_stat</span><br><span class="line">    using &amp;dno;</span><br><span class="line">  fetch cur_emp bulk collect</span><br><span class="line">    into ename_table;</span><br><span class="line">  for i in 1 .. ename_table.count loop</span><br><span class="line">    dbms_output.put_line('employee name is ' || ename_table(i));</span><br><span class="line">  <span class="keyword">end</span> <span class="keyword">loop</span>;</span><br><span class="line">  close cur_emp;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"><span class="comment">/*FORALL+BULK（仅支持DML）*/</span></span><br><span class="line"><span class="keyword">declare</span></span><br><span class="line">  <span class="keyword">type</span> ename_table_type <span class="keyword">is</span> <span class="keyword">table</span> <span class="keyword">of</span> tb2.ename%<span class="keyword">type</span>;</span><br><span class="line">  type sal_table_type is table of tb2.sal%type;</span><br><span class="line">  ename_table ename_table_type;</span><br><span class="line">  sal_table   sal_table_type;</span><br><span class="line">  sql_stat    varchar2(100);</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  ename_table := ename_table_type(<span class="string">'blake'</span>, <span class="string">'ford'</span>, <span class="string">'miller'</span>); <span class="comment">--为复合类型赋值</span></span><br><span class="line">  sql_stat    := '<span class="keyword">update</span> tb2 <span class="keyword">set</span> sal = sal * <span class="number">1.1</span> <span class="keyword">where</span> ename = :<span class="number">1</span> <span class="keyword">returning</span> sal <span class="keyword">into</span> :<span class="number">2</span><span class="string">';</span></span><br><span class="line"><span class="string">  forall i in 1 .. ename_table.count</span></span><br><span class="line"><span class="string">  execute immediate sql_stat using ename_table(i)</span></span><br><span class="line"><span class="string">  returning bulk collect into sal_table;</span></span><br><span class="line"><span class="string">  for j in 1 .. ename_table.count loop</span></span><br><span class="line"><span class="string">    dbms_output.put_line('</span>the <span class="keyword">new</span> salary <span class="keyword">is</span> <span class="string">' || sal_table(j) || '</span> <span class="keyword">for</span> <span class="string">' || ename_table(j));</span></span><br><span class="line"><span class="string">  end loop;</span></span><br><span class="line"><span class="string">end;</span></span><br></pre></td></tr></table></figure><h2 id="【绑定变量】"><a href="#【绑定变量】" class="headerlink" title="【绑定变量】"></a>【绑定变量】</h2><p>Oracle会自动把循环中带参数SQL语句转换为采用绑定变量方式执行，以减少硬解析和latch竞争。所以，很多时候我们并不需要专门去注意在PL/SQL块中使用绑定变量，Oracle会自动帮我们完成这个动作。至于SQLPLUS中使用绑定变量，其实我们日常也较少使用SQLPLUSE，故也无需专门注意该问题。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- sqlplus中使用绑定变量</span></span><br><span class="line"></span><br><span class="line">variable x number(4);</span><br><span class="line"></span><br><span class="line">exec :x := 1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp t <span class="keyword">where</span> empno = :x;</span><br></pre></td></tr></table></figure><p>–注：必须先使用关键字variable声明变量，再使用exec给绑定变量赋值（变量前带冒号），最后使用绑定变量。</p><p><strong>绑定变量效率高的原因</strong></p><p>Oracle中，对于一个提交的sql语句，存在两种可选的解析过程，一种叫做硬解析，一种叫做软解析。当一个sql语句提交后，oracle会首先检查一下共享缓冲池（shared pool）里有没有与之完全相同的语句，如果有的话只须执行软分析即可，否则就得进行硬分析。</p><p>硬解析需要经解析，制定执行路径、优化访问计划等许多的步骤。硬解释不仅仅耗费大量的cpu，更重要的是会占据重要闩（latch）资源，严重的影响系统规模扩大（即限制了系统的并发行），而且引起的问题不能通过增加内存条和cpu的数量来解决。之所以这样是因为闩是为了顺序访问以及修改一些内存区域而设置的，这些内存区域是不能被同时修改。</p><p>若Oracle在shared pool中查找相同SQL语句的过程中，SQL语句使用了绑定变量（bind variable），那么就是比较SQL语句的静态部分，前面我们已经知道，静态部分是有限的，很容易就能够缓存在内存里，从而找到相同的SQL语句的概率很高。如果没有使用绑定变量，则就是比较SQL语句的静态部分和动态部分，而动态部分的变化是无限的，因此这样的SQL语句很难被缓存在shared pool里。毕竟内存是有限的，不可能把所有的动态部分都缓存在sharedpool里，即便能够缓存，管理这样一个无限大的shared pool也是不可能完成的任务。不使用绑定变量导致的直接结果就是，找到相同的SQL语句的概率很低，导致必须完整的解析SQL语句，也就导致消耗更多的资源。</p><p><strong>绑定变量的使用环境 </strong></p><p>由于在OLTP中，SQL语句大多是比较简单或者操作的结果集都很小。当一个表上创建了索引，那么这种极小结果集的操作使用索引最合适，并且几乎所有的SQL的执行计划的索引都会被选择，因为这种情况下，索引可能只需要扫描几个数据块就可以定位到数据，而全表扫描将会相当耗资源。因此，这种情况下，即使每个用户的谓词条件不一样，执行计划也是一样的，就是都用索引来访问数据，基本不会出现全表扫描的情况。在这种执行计划几乎唯一的情况下，使用绑定变量来代替谓词常量是合适的。</p><p>注意，在OLTP中使用绑定变量一定要注意，变量的类型要与表字段类型一样，否则若造成了隐式转换，索引将失效而采用全表扫描，此时会造成系统性能的极大下降。</p><p>在OLAP系统中，SQL的操作就复杂很多，OLAP数据库上大多数时候运行的一些报表SQL，这些SQL经常会用到聚合查询（如：groupby），而且结果集也是非常庞大，在这种情况下，索引并不是必然的选择，甚至有时候全表扫描的性能会更优于索引，即使相同的SQL，如果谓词不同，执行计划都可能不同。让Oracle对每条SQL做硬分析，确切的知道谓词条件的值，这对执行计划的选择至关重要，这样做的原因是为了得到一个最优的执行计划。在OLAP系统中，系统的资源基本上是用于做大的SQL查询，和查询比起来SQL解析消耗的资源显得微不足道，SQL硬分析的代价是可以忽略的。因此让Oracle确切地知道谓词的数值至关重要，它直接决定了SQL执行计划的选择，所以在OLAP系统完全没有必要绑定变量，那样很可能带来负面影响，比如导致SQL选择错误的执行，这个代价有时是灾难性的。</p><p>【文章参考】</p><p><a href="http://blog.csdn.net/leshami/article/details/6118010" target="_blank" rel="noopener">http://blog.csdn.net/leshami/article/details/6118010</a></p><p><a href="http://czmmiao.iteye.com/blog/1489625" target="_blank" rel="noopener">http://czmmiao.iteye.com/blog/1489625</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Oracle-绑定变量-bind-variable&quot;&gt;&lt;a href=&quot;#Oracle-绑定变量-bind-variable&quot; class=&quot;headerlink&quot; title=&quot;Oracle 绑定变量(bind variable)&quot;&gt;&lt;/a&gt;Oracle 绑定变
      
    
    </summary>
    
      <category term="PLSQL" scheme="https://betgar.github.io/categories/PLSQL/"/>
    
    
      <category term="Oracle" scheme="https://betgar.github.io/tags/Oracle/"/>
    
      <category term="PLSQL" scheme="https://betgar.github.io/tags/PLSQL/"/>
    
  </entry>
  
  <entry>
    <title>plsql-forall</title>
    <link href="https://betgar.github.io/2018/04/11/plsql-forall/"/>
    <id>https://betgar.github.io/2018/04/11/plsql-forall/</id>
    <published>2018-04-10T16:00:00.000Z</published>
    <updated>2018-06-28T11:24:48.097Z</updated>
    
    <content type="html"><![CDATA[<h1 id="PL-SQL-FORALL"><a href="#PL-SQL-FORALL" class="headerlink" title="PL/SQL FORALL"></a>PL/SQL FORALL</h1><blockquote><p>forall语法</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">DECLARE</span><br><span class="line">  V_INPUT_STR VARCHAR2(1000);</span><br><span class="line">  V_INSER_SQL VARCHAR2(1000);</span><br><span class="line">  V_STR_LIST  DBMS_SQL.VARCHAR2S;</span><br><span class="line">BEGIN</span><br><span class="line">  V_INPUT_STR := &apos;2003130, 2003131, 2003132, 2003116, 2001100,,2001101,&apos;;</span><br><span class="line">  V_STR_LIST  := TEST_STRING_TO_LIST(V_INPUT_STR, &apos;,&apos;, FALSE);</span><br><span class="line">  FORALL V_INDEX IN V_STR_LIST.FIRST .. V_STR_LIST.LAST</span><br><span class="line">    INSERT INTO GT_KM_IMP</span><br><span class="line">      (ITEMCODE)</span><br><span class="line">    VALUES</span><br><span class="line">      (:ITEMCODE) USING V_STR_LIST</span><br><span class="line">      (V_INDEX);</span><br><span class="line">END;</span><br><span class="line"></span><br><span class="line">DECLARE</span><br><span class="line">  V_INPUT_STR VARCHAR2(1000);</span><br><span class="line">  V_INSER_SQL VARCHAR2(1000);</span><br><span class="line">  V_STR_LIST  DBMS_SQL.VARCHAR2S;</span><br><span class="line">BEGIN</span><br><span class="line">  V_INPUT_STR := &apos;2003130, 2003131, 2003132, 2003116, 2001100,,2001101,&apos;;</span><br><span class="line">  V_STR_LIST  := TEST_STRING_TO_LIST(V_INPUT_STR, &apos;,&apos;, FALSE);</span><br><span class="line">  FORALL V_INDEX IN INDICES OF</span><br><span class="line">                    V_STR_LIST BETWEEN V_STR_LIST.FIRST AND V_STR_LIST.LAST</span><br><span class="line">    INSERT INTO GT_KM_IMP (ITEMCODE) VALUES (V_STR_LIST(V_INDEX));</span><br><span class="line">END;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;PL-SQL-FORALL&quot;&gt;&lt;a href=&quot;#PL-SQL-FORALL&quot; class=&quot;headerlink&quot; title=&quot;PL/SQL FORALL&quot;&gt;&lt;/a&gt;PL/SQL FORALL&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;forall语法&lt;/p&gt;

      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>解析URI中的query string</title>
    <link href="https://betgar.github.io/2018/03/24/parse-uri-string-into-key-value-collection-in-java/"/>
    <id>https://betgar.github.io/2018/03/24/parse-uri-string-into-key-value-collection-in-java/</id>
    <published>2018-03-24T12:00:00.000Z</published>
    <updated>2018-06-28T11:24:48.097Z</updated>
    
    <content type="html"><![CDATA[<h1 id="解析URI中的query-string"><a href="#解析URI中的query-string" class="headerlink" title="解析URI中的query string"></a>解析URI中的query string</h1><blockquote><p>解析URL中的query string成集合.</p><p>前端可以配合使用$.param生成序列化字符串。</p></blockquote><h2 id="JavaScript解析URI中的query-string"><a href="#JavaScript解析URI中的query-string" class="headerlink" title="JavaScript解析URI中的query string"></a>JavaScript解析URI中的query string</h2><h3 id="原生解析"><a href="#原生解析" class="headerlink" title="原生解析"></a>原生解析</h3><blockquote><p>查找指定name的参数值，只会匹配第一个找到的。</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getParameterByName</span>(<span class="params">name, url</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!url) url = <span class="built_in">window</span>.location.href;</span><br><span class="line">    name = name.replace(<span class="regexp">/[\[\]]/g</span>, <span class="string">"\\$&amp;"</span>);</span><br><span class="line">    <span class="keyword">var</span> regex = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">"[?&amp;]"</span> + name + <span class="string">"(=([^&amp;#]*)|&amp;|#|$)"</span>),</span><br><span class="line">        results = regex.exec(url);</span><br><span class="line">    <span class="keyword">if</span> (!results) <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">if</span> (!results[<span class="number">2</span>]) <span class="keyword">return</span> <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">decodeURIComponent</span>(results[<span class="number">2</span>].replace(<span class="regexp">/\+/g</span>, <span class="string">" "</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="qs-js库解析query-string"><a href="#qs-js库解析query-string" class="headerlink" title="qs.js库解析query string"></a><code>qs.js</code>库解析query string</h3><blockquote><p><code>qs.js</code>支持解析 query string，也支持序列化query string，而且<code>qs</code>支持解析query string中的<code>Object</code>和<code>Aarry</code>，前提是按照<code>qs</code>的支持的格式书写。</p></blockquote><blockquote><p>parse</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = qs.parse(<span class="string">'a=c'</span>);</span><br><span class="line">assert.deepEqual(obj, &#123; <span class="attr">a</span>: <span class="string">'c'</span> &#125;);</span><br></pre></td></tr></table></figure><blockquote><p>stringifying</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = qs.stringify(obj);</span><br><span class="line">assert.equal(str, <span class="string">'a=c'</span>);</span><br></pre></td></tr></table></figure><h2 id="Java解析编码过的字符串"><a href="#Java解析编码过的字符串" class="headerlink" title="Java解析编码过的字符串"></a>Java解析编码过的字符串</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String, List&lt;String&gt;&gt; splitQuery(URL url, String charset) <span class="keyword">throws</span> UnsupportedEncodingException &#123;</span><br><span class="line">  <span class="keyword">final</span> Map&lt;String, List&lt;String&gt;&gt; queryPairs = <span class="keyword">new</span> LinkedHashMap&lt;String, List&lt;String&gt;&gt;();</span><br><span class="line">  <span class="keyword">final</span> String[] pairs = url.getQuery().split(<span class="string">"&amp;"</span>);</span><br><span class="line">  <span class="keyword">for</span> (String pair : pairs) &#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span> idx = pair.indexOf(<span class="string">"="</span>);</span><br><span class="line">    <span class="keyword">final</span> String key = idx &gt; <span class="number">0</span> ? URLDecoder.decode(pair.substring(<span class="number">0</span>, idx), charset) : pair;</span><br><span class="line">    <span class="keyword">if</span> (!queryPairs.containsKey(key)) &#123;</span><br><span class="line">      queryPairs.put(key, <span class="keyword">new</span> LinkedList&lt;String&gt;());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">final</span> String value = idx &gt; <span class="number">0</span> &amp;&amp; pair.length() &gt; idx + <span class="number">1</span> ? URLDecoder.decode(pair.substring(idx + <span class="number">1</span>), <span class="string">"UTF-8"</span>) : <span class="keyword">null</span>;</span><br><span class="line">    queryPairs.get(key).add(value);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> queryPairs;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p><code>JDK 8 version</code></p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Map&lt;String, List&lt;String&gt;&gt; splitQuery(URL url) &#123;</span><br><span class="line">    <span class="keyword">if</span> (Strings.isNullOrEmpty(url.getQuery())) &#123;</span><br><span class="line">        <span class="keyword">return</span> Collections.emptyMap();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> Arrays.stream(url.getQuery().split(<span class="string">"&amp;"</span>))</span><br><span class="line">            .map(<span class="keyword">this</span>::splitQueryParameter)</span><br><span class="line">            .collect(Collectors.groupingBy(SimpleImmutableEntry::getKey, LinkedHashMap::<span class="keyword">new</span>, mapping(Map.Entry::getValue, toList())));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> SimpleImmutableEntry&lt;String, String&gt; <span class="title">splitQueryParameter</span><span class="params">(String it)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span> idx = it.indexOf(<span class="string">"="</span>);</span><br><span class="line">    <span class="keyword">final</span> String key = idx &gt; <span class="number">0</span> ? it.substring(<span class="number">0</span>, idx) : it;</span><br><span class="line">    <span class="keyword">final</span> String value = idx &gt; <span class="number">0</span> &amp;&amp; it.length() &gt; idx + <span class="number">1</span> ? it.substring(idx + <span class="number">1</span>) : <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> SimpleImmutableEntry&lt;&gt;(key, value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p><code>common-httpclients.jar</code></p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.hc.client5.http.utils.URLEncodedUtils</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">  String url = <span class="string">"http://www.example.com/something.html?one=1&amp;two=2&amp;three=3&amp;three=3a"</span>;</span><br><span class="line">  List&lt;NameValuePair&gt; params = URLEncodedUtils.parse(<span class="keyword">new</span> URI(url), <span class="string">"UTF-8"</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (NameValuePair param : params) &#123;</span><br><span class="line">    System.out.println(param.getName() + <span class="string">" : "</span> + param.getValue());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p><code>Spring Framework</code></p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">  String uri = <span class="string">"http://youhost.com/test?param1=abc&amp;param2=def&amp;param2=ghi"</span>;</span><br><span class="line">  MultiValueMap&lt;String, String&gt; parameters =</span><br><span class="line">          UriComponentsBuilder.fromUriString(uri).build().getQueryParams();</span><br><span class="line">  List&lt;String&gt; param1 = parameters.get(<span class="string">"param1"</span>);</span><br><span class="line">  List&lt;String&gt; param2 = parameters.get(<span class="string">"param2"</span>);</span><br><span class="line">  System.out.println(<span class="string">"param1: "</span> + param1.get(<span class="number">0</span>));</span><br><span class="line">  System.out.println(<span class="string">"param2: "</span> + param2.get(<span class="number">0</span>) + <span class="string">","</span> + param2.get(<span class="number">1</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://stackoverflow.com/questions/13592236/parse-a-uri-string-into-name-value-collection" target="_blank" rel="noopener">Parse a URI String into Name-Value Collection</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;解析URI中的query-string&quot;&gt;&lt;a href=&quot;#解析URI中的query-string&quot; class=&quot;headerlink&quot; title=&quot;解析URI中的query string&quot;&gt;&lt;/a&gt;解析URI中的query string&lt;/h1&gt;&lt;bloc
      
    
    </summary>
    
      <category term="JavaScript" scheme="https://betgar.github.io/categories/JavaScript/"/>
    
    
      <category term="qs" scheme="https://betgar.github.io/tags/qs/"/>
    
  </entry>
  
  <entry>
    <title>在Oracle和Java中使用Base64</title>
    <link href="https://betgar.github.io/2018/03/13/how-to-use-base64-between-oracle-and-java/"/>
    <id>https://betgar.github.io/2018/03/13/how-to-use-base64-between-oracle-and-java/</id>
    <published>2018-03-13T12:00:00.000Z</published>
    <updated>2018-06-28T11:24:48.097Z</updated>
    
    <content type="html"><![CDATA[<h1 id="在Oracle和Java中使用Base64"><a href="#在Oracle和Java中使用Base64" class="headerlink" title="在Oracle和Java中使用Base64"></a>在Oracle和Java中使用Base64</h1><h2 id="Oracle"><a href="#Oracle" class="headerlink" title="Oracle"></a>Oracle</h2><blockquote><p>UTL_RAW：处理二进制的数据包。</p><p>UTL_ENCODE：处理编码包。</p></blockquote><ul><li><p>UTL_ENCODE.BASE64_ENCODE使用</p><p>步骤：</p><ol><li>先用UTL_RAW.CAST_TO_RAW把varchar2转换为raw类型.</li><li>使用UTL_ENCODE.BASE64_ENCODE编码.</li><li><p>使用UTL_RAW.CAST_TO_VARCHAR2从raw(二进制类型)转换为varchar2类型转换.</p><p><strong>注意：</strong> raw类型也可以进行传递，但是Java中要使用Byte进行解析。</p></li></ol><p>​</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> utl_raw.cast_to_varchar2(utl_encode.base64_encode(utl_raw.cast_to_raw(<span class="string">'&#123;"count": 1000&#125;'</span>)))</span><br><span class="line">  <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure></li><li><p>UTL_ENCODE.BASE64_DECODE使用</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> utl_raw.cast_to_varchar2(utl_encode.base64_decode(utl_raw.cast_to_raw(<span class="string">'e1wiY291bnRcIjogMTAwMH0='</span>))) <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure></li><li><p>指定字符编码</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">UTL_ENCODE.TEXT_ENCODE(string, charset);</span><br><span class="line">UTL_ENCODE.TEXT_DECODE(string, charset);</span><br></pre></td></tr></table></figure><p>​</p></li></ul><h2 id="Java"><a href="#Java" class="headerlink" title="Java"></a>Java</h2><blockquote><p>BASE64Decoder</p><p>BASE64Encoder</p><p>EncodeUtil：工具类</p></blockquote><ul><li><p>BASE64Encoder使用</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">encodeString</span><span class="params">(String plainText, String charSet)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        BASE64Encoder encoder = <span class="keyword">new</span> BASE64Encoder();</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> encoder.encode(plainText.getBytes(charSet));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span>(UnsupportedEncodingException e)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> EncodeException(<span class="string">"E0208.0013"</span>, EcpI18nUtil.localizedString(<span class="string">"E0208.0013"</span>, <span class="string">"\u4E0D\u652F\u6301\u7684\u5B57\u7B26\u96C6"</span>), e, <span class="keyword">new</span> Object[<span class="number">0</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></li><li><p>BASE64Decoder使用</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">decodeString</span><span class="params">(String encodedText, String charSet)</span></span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">       BASE64Decoder decoder = <span class="keyword">new</span> BASE64Decoder();</span><br><span class="line">       <span class="keyword">try</span></span><br><span class="line">       &#123;</span><br><span class="line">           <span class="keyword">return</span> <span class="keyword">new</span> String(decoder.decodeBuffer(encodedText), charSet);</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">catch</span>(Exception e)</span><br><span class="line">       &#123;</span><br><span class="line">           <span class="keyword">throw</span> <span class="keyword">new</span> EncodeException(<span class="string">"E0208.0013"</span>, EcpI18nUtil.localizedString(<span class="string">"E0208.0013"</span>, <span class="string">"\u89E3\u7801\u5931\u8D25"</span>), e, <span class="keyword">new</span> Object[<span class="number">0</span>]);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></li><li><p>Java中byte和String相互转换</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// String -&gt; byte</span></span><br><span class="line">String str = <span class="string">"count"</span>;</span><br><span class="line"><span class="keyword">byte</span>[] bytes = str.getBytes(<span class="string">"GBK"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// byte -&gt; String</span></span><br><span class="line">String str2 = <span class="keyword">new</span> String(bytes, <span class="string">'GBK'</span>);</span><br></pre></td></tr></table></figure></li><li><p>字符集</p><blockquote><p> 编码和解码都可以指定字符集。如果<strong>字符串</strong>中有<strong>中文</strong> 编码之后解码会出现乱码，因为Ecp工具类默认使用GBK字符集<strong>编码</strong>和<strong>解码</strong>。</p></blockquote></li><li><p>注意</p><blockquote><p>如果希望<strong>服务端Java</strong>编码之后可以在<strong>数据库过程</strong>中进行解码（反之亦然），请不要在关键业务数据中出现<strong>中文</strong> 。</p></blockquote></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;在Oracle和Java中使用Base64&quot;&gt;&lt;a href=&quot;#在Oracle和Java中使用Base64&quot; class=&quot;headerlink&quot; title=&quot;在Oracle和Java中使用Base64&quot;&gt;&lt;/a&gt;在Oracle和Java中使用Base64&lt;/
      
    
    </summary>
    
      <category term="Base64" scheme="https://betgar.github.io/categories/Base64/"/>
    
    
      <category term="Base64" scheme="https://betgar.github.io/tags/Base64/"/>
    
  </entry>
  
  <entry>
    <title>SQL style guide</title>
    <link href="https://betgar.github.io/2018/02/26/sqlstyle.guide/"/>
    <id>https://betgar.github.io/2018/02/26/sqlstyle.guide/</id>
    <published>2018-02-26T12:00:00.000Z</published>
    <updated>2018-06-28T11:24:48.097Z</updated>
    
    <content type="html"><![CDATA[<h1 id="SQL-style-guide"><a href="#SQL-style-guide" class="headerlink" title="SQL style guide"></a>SQL style guide</h1><h2 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h2><p>You can use this set of guidelines, <a href="https://github.com/treffynnon/sqlstyle.guide/fork" title="Fork SQL style guide on GitHub" target="_blank" rel="noopener">fork them</a> or make your own - the<br>key here is that you pick a style and stick to it. To suggest changes<br>or fix bugs please open an <a href="https://github.com/treffynnon/sqlstyle.guide/issues" title="SQL style guide issues on GitHub" target="_blank" rel="noopener">issue</a> or <a href="https://github.com/treffynnon/sqlstyle.guide/pulls/" title="SQL style guide pull requests on GitHub" target="_blank" rel="noopener">pull request</a> on GitHub.</p><p>These guidelines are designed to be compatible with Joe Celko’s <a href="https://www.amazon.com/gp/product/0120887975/ref=as_li_ss_tl?ie=UTF8&amp;linkCode=ll1&amp;tag=treffynnon-20&amp;linkId=9c88eac8cd420e979675c815771313d5" title="Joe Celko&#39;s SQL Programming Style (The Morgan Kaufmann Series in Data Management Systems)" target="_blank" rel="noopener">SQL Programming<br>Style</a> book to make adoption for teams who have already read that book<br>easier. This guide is a little more opinionated in some areas and in others a<br>little more relaxed. It is certainly more succinct where <a href="https://www.amazon.com/gp/product/0120887975/ref=as_li_ss_tl?ie=UTF8&amp;linkCode=ll1&amp;tag=treffynnon-20&amp;linkId=9c88eac8cd420e979675c815771313d5" title="Joe Celko&#39;s SQL Programming Style (The Morgan Kaufmann Series in Data Management Systems)" target="_blank" rel="noopener">Celko’s book</a><br>contains anecdotes and reasoning behind each rule as thoughtful prose.</p><p>It is easy to include this guide in <a href="https://raw.githubusercontent.com/treffynnon/sqlstyle.guide/gh-pages/_includes/sqlstyle.guide.md" title="Download the guide in Markdown format" target="_blank" rel="noopener">Markdown format</a> as a part of a<br>project’s code base or reference it here for anyone on the project to freely<br>read—much harder with a physical book.</p><p>SQL style guide by <a href="https://www.simonholywell.com/?utm_source=sqlstyle.guide&amp;utm_medium=link&amp;utm_campaign=md-document" title="SimonHolywell.com" target="_blank" rel="noopener">Simon Holywell</a> is licensed under a <a href="http://creativecommons.org/licenses/by-sa/4.0/" title="Creative Commons Attribution-ShareAlike 4.0 International License" target="_blank" rel="noopener">Creative Commons<br>Attribution-ShareAlike 4.0 International License</a>.<br>Based on a work at <a href="http://www.sqlstyle.guide" title="SQL style guide by Simon Holywell" target="_blank" rel="noopener">http://www.sqlstyle.guide</a>.</p><h2 id="General"><a href="#General" class="headerlink" title="General"></a>General</h2><h3 id="Do"><a href="#Do" class="headerlink" title="Do"></a>Do</h3><ul><li>Use consistent and descriptive identifiers and names.</li><li>Make judicious use of white space and indentation to make code easier to read.</li><li>Store <a href="https://en.wikipedia.org/wiki/ISO_8601" title="Wikipedia: ISO 8601" target="_blank" rel="noopener">ISO-8601</a> compliant time and date information<br>(<code>YYYY-MM-DD HH:MM:SS.SSSSS</code>).</li><li>Try to use only standard SQL functions instead of vendor specific functions for<br>reasons of portability.</li><li>Keep code succinct and devoid of redundant SQL—such as unnecessary quoting or<br>parentheses or <code>WHERE</code> clauses that can otherwise be derived.</li><li>Include comments in SQL code where necessary. Use the C style opening <code>/*</code> and<br>closing <code>*/</code> where possible otherwise precede comments with <code>--</code> and finish<br>them with a new line.</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> file_hash  <span class="comment">-- stored ssdeep hash</span></span><br><span class="line">  <span class="keyword">FROM</span> file_system</span><br><span class="line"> <span class="keyword">WHERE</span> file_name = <span class="string">'.vimrc'</span>;</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Updating the file record after writing to the file */</span></span><br><span class="line"><span class="keyword">UPDATE</span> file_system</span><br><span class="line">   <span class="keyword">SET</span> file_modified_date = <span class="string">'1980-02-22 13:19:01.00000'</span>,</span><br><span class="line">       file_size = <span class="number">209732</span></span><br><span class="line"> <span class="keyword">WHERE</span> file_name = <span class="string">'.vimrc'</span>;</span><br></pre></td></tr></table></figure><h3 id="Avoid"><a href="#Avoid" class="headerlink" title="Avoid"></a>Avoid</h3><ul><li>CamelCase—it is difficult to scan quickly.</li><li>Descriptive prefixes or Hungarian notation such as <code>sp_</code> or <code>tbl</code>.</li><li>Plurals—use the more natural collective term where possible instead. For example<br><code>staff</code> instead of <code>employees</code> or <code>people</code> instead of <code>individuals</code>.</li><li>Quoted identifiers—if you must use them then stick to SQL92 double quotes for<br>portability (you may need to configure your SQL server to support this depending<br>on vendor).</li><li>Object oriented design principles should not be applied to SQL or database<br>structures.</li></ul><h2 id="Naming-conventions"><a href="#Naming-conventions" class="headerlink" title="Naming conventions"></a>Naming conventions</h2><h3 id="General-1"><a href="#General-1" class="headerlink" title="General"></a>General</h3><ul><li>Ensure the name is unique and does not exist as a<br><a href="#reserved-keyword-reference" title="Reserved keyword reference">reserved keyword</a>.</li><li>Keep the length to a maximum of 30 bytes—in practice this is 30 characters<br>unless you are using multi-byte character set.</li><li>Names must begin with a letter and may not end with an underscore.</li><li>Only use letters, numbers and underscores in names.</li><li>Avoid the use of multiple consecutive underscores—these can be hard to read.</li><li>Use underscores where you would naturally include a space in the name (first<br>name becomes <code>first_name</code>).</li><li>Avoid abbreviations and if you have to use them make sure they are commonly<br>understood.</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> first_name</span><br><span class="line">  <span class="keyword">FROM</span> staff;</span><br></pre></td></tr></table></figure><h3 id="Tables"><a href="#Tables" class="headerlink" title="Tables"></a>Tables</h3><ul><li>Use a collective name or, less ideally, a plural form. For example (in order of<br>preference) <code>staff</code> and <code>employees</code>.</li><li>Do not prefix with <code>tbl</code> or any other such descriptive prefix or Hungarian<br>notation.</li><li>Never give a table the same name as one of its columns and vice versa.</li><li>Avoid, where possible, concatenating two table names together to create the name<br>of a relationship table. Rather than <code>cars_mechanics</code> prefer <code>services</code>.</li></ul><h3 id="Columns"><a href="#Columns" class="headerlink" title="Columns"></a>Columns</h3><ul><li>Always use the singular name.</li><li>Where possible avoid simply using <code>id</code> as the primary identifier for the table.</li><li>Do not add a column with the same name as its table and vice versa.</li><li>Always use lowercase except where it may make sense not to such as proper nouns.</li></ul><h3 id="Aliasing-or-correlations"><a href="#Aliasing-or-correlations" class="headerlink" title="Aliasing or correlations"></a>Aliasing or correlations</h3><ul><li>Should relate in some way to the object or expression they are aliasing.</li><li>As a rule of thumb the correlation name should be the first letter of each word<br>in the object’s name.</li><li>If there is already a correlation with the same name then append a number.</li><li>Always include the <code>AS</code> keyword—makes it easier to read as it is explicit.</li><li>For computed data (<code>SUM()</code> or <code>AVG()</code>) use the name you would give it were it<br>a column defined in the schema.</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> first_name <span class="keyword">AS</span> fn</span><br><span class="line">  <span class="keyword">FROM</span> staff <span class="keyword">AS</span> s1</span><br><span class="line">  <span class="keyword">JOIN</span> students <span class="keyword">AS</span> s2</span><br><span class="line">    <span class="keyword">ON</span> s2.mentor_id = s1.staff_num;</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">SUM</span>(s.monitor_tally) <span class="keyword">AS</span> monitor_total</span><br><span class="line">  <span class="keyword">FROM</span> staff <span class="keyword">AS</span> s;</span><br></pre></td></tr></table></figure><h3 id="Stored-procedures"><a href="#Stored-procedures" class="headerlink" title="Stored procedures"></a>Stored procedures</h3><ul><li>The name must contain a verb.</li><li>Do not prefix with <code>sp_</code> or any other such descriptive prefix or Hungarian<br>notation.</li></ul><h3 id="Uniform-suffixes"><a href="#Uniform-suffixes" class="headerlink" title="Uniform suffixes"></a>Uniform suffixes</h3><p>The following suffixes have a universal meaning ensuring the columns can be read<br>and understood easily from SQL code. Use the correct suffix where appropriate.</p><ul><li><code>_id</code>—a unique identifier such as a column that is a primary key.</li><li><code>_status</code>—flag value or some other status of any type such as<br><code>publication_status</code>.</li><li><code>_total</code>—the total or sum of a collection of values.</li><li><code>_num</code>—denotes the field contains any kind of number.</li><li><code>_name</code>—signifies a name such as <code>first_name</code>.</li><li><code>_seq</code>—contains a contiguous sequence of values.</li><li><code>_date</code>—denotes a column that contains the date of something.</li><li><code>_tally</code>—a count.</li><li><code>_size</code>—the size of something such as a file size or clothing.</li><li><code>_addr</code>—an address for the record could be physical or intangible such as<br><code>ip_addr</code>.</li></ul><h2 id="Query-syntax"><a href="#Query-syntax" class="headerlink" title="Query syntax"></a>Query syntax</h2><h3 id="Reserved-words"><a href="#Reserved-words" class="headerlink" title="Reserved words"></a>Reserved words</h3><p>Always use uppercase for the <a href="#reserved-keyword-reference" title="Reserved keyword reference">reserved keywords</a><br>like <code>SELECT</code> and <code>WHERE</code>.</p><p>It is best to avoid the abbreviated keywords and use the full length ones where<br>available (prefer <code>ABSOLUTE</code> to <code>ABS</code>).</p><p>Do not use database server specific keywords where an ANSI SQL keyword already<br>exists performing the same function. This helps to make code more portable.</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> model_num</span><br><span class="line">  <span class="keyword">FROM</span> phones <span class="keyword">AS</span> p</span><br><span class="line"> <span class="keyword">WHERE</span> p.release_date &gt; <span class="string">'2014-09-30'</span>;</span><br></pre></td></tr></table></figure><h3 id="White-space"><a href="#White-space" class="headerlink" title="White space"></a>White space</h3><p>To make the code easier to read it is important that the correct compliment of<br>spacing is used. Do not crowd code or remove natural language spaces.</p><h4 id="Spaces"><a href="#Spaces" class="headerlink" title="Spaces"></a>Spaces</h4><p>Spaces should be used to line up the code so that the root keywords all end on<br>the same character boundary. This forms a river down the middle making it easy for<br>the readers eye to scan over the code and separate the keywords from the<br>implementation detail. Rivers are <a href="http://practicaltypography.com/one-space-between-sentences.html" title="Practical Typography: one space between sentences" target="_blank" rel="noopener">bad in typography</a>, but helpful here.</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> f.average_height, f.average_diameter</span><br><span class="line">  <span class="keyword">FROM</span> flora <span class="keyword">AS</span> f</span><br><span class="line"> <span class="keyword">WHERE</span> f.species_name = <span class="string">'Banksia'</span></span><br><span class="line">    <span class="keyword">OR</span> f.species_name = <span class="string">'Sheoak'</span></span><br><span class="line">    <span class="keyword">OR</span> f.species_name = <span class="string">'Wattle'</span>;</span><br></pre></td></tr></table></figure><p>Notice that <code>SELECT</code>, <code>FROM</code>, etc. are all right aligned while the actual column<br>names and implementation specific details are left aligned.</p><p>Although not exhaustive always include spaces:</p><ul><li>before and after equals (<code>=</code>)</li><li>after commas (<code>,</code>)</li><li>surrounding apostrophes (<code>&#39;</code>) where not within parentheses or with a trailing<br>comma or semicolon.</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> a.title, a.release_date, a.recording_date</span><br><span class="line">  <span class="keyword">FROM</span> albums <span class="keyword">AS</span> a</span><br><span class="line"> <span class="keyword">WHERE</span> a.title = <span class="string">'Charcoal Lane'</span></span><br><span class="line">    <span class="keyword">OR</span> a.title = <span class="string">'The New Danger'</span>;</span><br></pre></td></tr></table></figure><h4 id="Line-spacing"><a href="#Line-spacing" class="headerlink" title="Line spacing"></a>Line spacing</h4><p>Always include newlines/vertical space:</p><ul><li>before <code>AND</code> or <code>OR</code></li><li>after semicolons to separate queries for easier reading</li><li>after each keyword definition</li><li>after a comma when separating multiple columns into logical groups</li><li>to separate code into related sections, which helps to ease the readability of<br>large chunks of code.</li></ul><p>Keeping all the keywords aligned to the righthand side and the values left aligned<br>creates a uniform gap down the middle of query. It makes it much easier to scan<br>the query definition over quickly too.</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> albums (title, release_date, recording_date)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="string">'Charcoal Lane'</span>, <span class="string">'1990-01-01 01:01:01.00000'</span>, <span class="string">'1990-01-01 01:01:01.00000'</span>),</span><br><span class="line">       (<span class="string">'The New Danger'</span>, <span class="string">'2008-01-01 01:01:01.00000'</span>, <span class="string">'1990-01-01 01:01:01.00000'</span>);</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> albums</span><br><span class="line">   <span class="keyword">SET</span> release_date = <span class="string">'1990-01-01 01:01:01.00000'</span></span><br><span class="line"> <span class="keyword">WHERE</span> title = <span class="string">'The New Danger'</span>;</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> a.title,</span><br><span class="line">       a.release_date, a.recording_date, a.production_date <span class="comment">-- grouped dates together</span></span><br><span class="line">  <span class="keyword">FROM</span> albums <span class="keyword">AS</span> a</span><br><span class="line"> <span class="keyword">WHERE</span> a.title = <span class="string">'Charcoal Lane'</span></span><br><span class="line">    <span class="keyword">OR</span> a.title = <span class="string">'The New Danger'</span>;</span><br></pre></td></tr></table></figure><h3 id="Indentation"><a href="#Indentation" class="headerlink" title="Indentation"></a>Indentation</h3><p>To ensure that SQL is readable it is important that standards of indentation<br>are followed.</p><h4 id="Joins"><a href="#Joins" class="headerlink" title="Joins"></a>Joins</h4><p>Joins should be indented to the other side of the river and grouped with a new<br>line where necessary.</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> r.last_name</span><br><span class="line">  <span class="keyword">FROM</span> riders <span class="keyword">AS</span> r</span><br><span class="line">       <span class="keyword">INNER</span> <span class="keyword">JOIN</span> bikes <span class="keyword">AS</span> b</span><br><span class="line">       <span class="keyword">ON</span> r.bike_vin_num = b.vin_num</span><br><span class="line">          <span class="keyword">AND</span> b.engines &gt; <span class="number">2</span></span><br><span class="line"></span><br><span class="line">       <span class="keyword">INNER</span> <span class="keyword">JOIN</span> crew <span class="keyword">AS</span> c</span><br><span class="line">       <span class="keyword">ON</span> r.crew_chief_last_name = c.last_name</span><br><span class="line">          <span class="keyword">AND</span> c.chief = <span class="string">'Y'</span>;</span><br></pre></td></tr></table></figure><h4 id="Subqueries"><a href="#Subqueries" class="headerlink" title="Subqueries"></a>Subqueries</h4><p>Subqueries should also be aligned to the right side of the river and then laid<br>out using the same style as any other query. Sometimes it will make sense to have<br>the closing parenthesis on a new line at the same character position as it’s<br>opening partner—this is especially true where you have nested subqueries.</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> r.last_name,</span><br><span class="line">       (<span class="keyword">SELECT</span> <span class="keyword">MAX</span>(<span class="keyword">YEAR</span>(championship_date))</span><br><span class="line">          <span class="keyword">FROM</span> champions <span class="keyword">AS</span> c</span><br><span class="line">         <span class="keyword">WHERE</span> c.last_name = r.last_name</span><br><span class="line">           <span class="keyword">AND</span> c.confirmed = <span class="string">'Y'</span>) <span class="keyword">AS</span> last_championship_year</span><br><span class="line">  <span class="keyword">FROM</span> riders <span class="keyword">AS</span> r</span><br><span class="line"> <span class="keyword">WHERE</span> r.last_name <span class="keyword">IN</span></span><br><span class="line">       (<span class="keyword">SELECT</span> c.last_name</span><br><span class="line">          <span class="keyword">FROM</span> champions <span class="keyword">AS</span> c</span><br><span class="line">         <span class="keyword">WHERE</span> <span class="keyword">YEAR</span>(championship_date) &gt; <span class="string">'2008'</span></span><br><span class="line">           <span class="keyword">AND</span> c.confirmed = <span class="string">'Y'</span>);</span><br></pre></td></tr></table></figure><h3 id="Preferred-formalisms"><a href="#Preferred-formalisms" class="headerlink" title="Preferred formalisms"></a>Preferred formalisms</h3><ul><li>Make use of <code>BETWEEN</code> where possible instead of combining multiple statements<br>with <code>AND</code>.</li><li>Similarly use <code>IN()</code> instead of multiple <code>OR</code> clauses.</li><li>Where a value needs to be interpreted before leaving the database use the <code>CASE</code><br>expression. <code>CASE</code> statements can be nested to form more complex logical structures.</li><li>Avoid the use of <code>UNION</code> clauses and temporary tables where possible. If the<br>schema can be optimised to remove the reliance on these features then it most<br>likely should be.</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">CASE</span> postcode</span><br><span class="line">       <span class="keyword">WHEN</span> <span class="string">'BN1'</span> <span class="keyword">THEN</span> <span class="string">'Brighton'</span></span><br><span class="line">       <span class="keyword">WHEN</span> <span class="string">'EH1'</span> <span class="keyword">THEN</span> <span class="string">'Edinburgh'</span></span><br><span class="line">       <span class="keyword">END</span> <span class="keyword">AS</span> city</span><br><span class="line">  <span class="keyword">FROM</span> office_locations</span><br><span class="line"> <span class="keyword">WHERE</span> country = <span class="string">'United Kingdom'</span></span><br><span class="line">   <span class="keyword">AND</span> opening_time <span class="keyword">BETWEEN</span> <span class="number">8</span> <span class="keyword">AND</span> <span class="number">9</span></span><br><span class="line">   <span class="keyword">AND</span> postcode <span class="keyword">IN</span> (<span class="string">'EH1'</span>, <span class="string">'BN1'</span>, <span class="string">'NN1'</span>, <span class="string">'KW1'</span>)</span><br></pre></td></tr></table></figure><h2 id="Create-syntax"><a href="#Create-syntax" class="headerlink" title="Create syntax"></a>Create syntax</h2><p>When declaring schema information it is also important to maintain human<br>readable code. To facilitate this ensure the column definitions are ordered and<br>grouped where it makes sense to do so.</p><p>Indent column definitions by four (4) spaces within the <code>CREATE</code> definition.</p><h3 id="Choosing-data-types"><a href="#Choosing-data-types" class="headerlink" title="Choosing data types"></a>Choosing data types</h3><ul><li>Where possible do not use vendor specific data types—these are not portable and<br>may not be available in older versions of the same vendor’s software.</li><li>Only use <code>REAL</code> or <code>FLOAT</code> types where it is strictly necessary for floating<br>point mathematics otherwise prefer <code>NUMERIC</code> and <code>DECIMAL</code> at all times. Floating<br>point rounding errors are a nuisance!</li></ul><h3 id="Specifying-default-values"><a href="#Specifying-default-values" class="headerlink" title="Specifying default values"></a>Specifying default values</h3><ul><li>The default value must be the same type as the column—if a column is declared<br>a <code>DECIMAL</code> do not provide an <code>INTEGER</code> default value.</li><li>Default values must follow the data type declaration and come before any<br><code>NOT NULL</code> statement.</li></ul><h3 id="Constraints-and-keys"><a href="#Constraints-and-keys" class="headerlink" title="Constraints and keys"></a>Constraints and keys</h3><p>Constraints and their subset, keys, are a very important component of any<br>database definition. They can quickly become very difficult to read and reason<br>about though so it is important that a standard set of guidelines are followed.</p><h4 id="Choosing-keys"><a href="#Choosing-keys" class="headerlink" title="Choosing keys"></a>Choosing keys</h4><p>Deciding the column(s) that will form the keys in the definition should be a<br>carefully considered activity as it will effect performance and data integrity.</p><ol><li>The key should be unique to some degree.</li><li>Consistency in terms of data type for the value across the schema and a lower<br>likelihood of this changing in the future.</li><li>Can the value be validated against a standard format (such as one published by<br>ISO)? Encouraging conformity to point 2.</li><li>Keeping the key as simple as possible whilst not being scared to use compound<br>keys where necessary.</li></ol><p>It is a reasoned and considered balancing act to be performed at the definition<br>of a database. Should requirements evolve in the future it is possible to make<br>changes to the definitions to keep them up to date.</p><h4 id="Defining-constraints"><a href="#Defining-constraints" class="headerlink" title="Defining constraints"></a>Defining constraints</h4><p>Once the keys are decided it is possible to define them in the system using<br>constraints along with field value validation.</p><h5 id="General-2"><a href="#General-2" class="headerlink" title="General"></a>General</h5><ul><li>Tables must have at least one key to be complete and useful.</li><li>Constraints should be given a custom name excepting <code>UNIQUE</code>, <code>PRIMARY KEY</code><br>and <code>FOREIGN KEY</code> where the database vendor will generally supply sufficiently<br>intelligible names automatically.</li></ul><h5 id="Layout-and-order"><a href="#Layout-and-order" class="headerlink" title="Layout and order"></a>Layout and order</h5><ul><li>Specify the primary key first right after the <code>CREATE TABLE</code> statement.</li><li>Constraints should be defined directly beneath the column they correspond to.<br>Indent the constraint so that it aligns to the right of the column name.</li><li>If it is a multi-column constraint then consider putting it as close to both<br>column definitions as possible and where this is difficult as a last resort<br>include them at the end of the <code>CREATE TABLE</code> definition.</li><li>If it is a table level constraint that applies to the entire table then it<br>should also appear at the end.</li><li>Use alphabetical order where <code>ON DELETE</code> comes before <code>ON UPDATE</code>.</li><li>If it make senses to do so align each aspect of the query on the same character<br>position. For example all <code>NOT NULL</code> definitions could start at the same<br>character position. This is not hard and fast, but it certainly makes the code<br>much easier to scan and read.</li></ul><h5 id="Validation"><a href="#Validation" class="headerlink" title="Validation"></a>Validation</h5><ul><li>Use <code>LIKE</code> and <code>SIMILAR TO</code> constraints to ensure the integrity of strings<br>where the format is known.</li><li>Where the ultimate range of a numerical value is known it must be written as a<br>range <code>CHECK()</code> to prevent incorrect values entering the database or the silent<br>truncation of data too large to fit the column definition. In the least it<br>should check that the value is greater than zero in most cases.</li><li><code>CHECK()</code> constraints should be kept in separate clauses to ease debugging.</li></ul><h5 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> staff (</span><br><span class="line">    PRIMARY <span class="keyword">KEY</span> (staff_num),</span><br><span class="line">    staff_num      <span class="built_in">INT</span>(<span class="number">5</span>)       <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    first_name     <span class="built_in">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    pens_in_drawer <span class="built_in">INT</span>(<span class="number">2</span>)       <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">                   <span class="keyword">CONSTRAINT</span> pens_in_drawer_range</span><br><span class="line">                   <span class="keyword">CHECK</span>(pens_in_drawer &gt;= <span class="number">1</span> <span class="keyword">AND</span> pens_in_drawer &lt; <span class="number">100</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><h3 id="Designs-to-avoid"><a href="#Designs-to-avoid" class="headerlink" title="Designs to avoid"></a>Designs to avoid</h3><ul><li>Object oriented design principles do not effectively translate to relational<br>database designs—avoid this pitfall.</li><li>Placing the value in one column and the units in another column. The column<br>should make the units self evident to prevent the requirement to combine<br>columns again later in the application. Use <code>CHECK()</code> to ensure valid data is<br>inserted into the column.</li><li><a href="https://en.wikipedia.org/wiki/Entity%E2%80%93attribute%E2%80%93value_model" title="Wikipedia: Entity–attribute–value model" target="_blank" rel="noopener">EAV (Entity Attribute Value)</a> tables—use a specialist product intended for<br>handling such schema-less data instead.</li><li>Splitting up data that should be in one table across many because of arbitrary<br>concerns such as time-based archiving or location in a multi-national<br>organisation. Later queries must then work across multiple tables with <code>UNION</code><br>rather than just simply querying one table.</li></ul><h2 id="Appendix"><a href="#Appendix" class="headerlink" title="Appendix"></a>Appendix</h2><h3 id="Reserved-keyword-reference"><a href="#Reserved-keyword-reference" class="headerlink" title="Reserved keyword reference"></a>Reserved keyword reference</h3><p>A list of ANSI SQL (92, 99 and 2003), MySQL 3 to 5.x, PostgreSQL 8.1, MS SQL Server 2000, MS ODBC and Oracle 10.2 reserved keywords.</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br></pre></td><td class="code"><pre><span class="line">A</span><br><span class="line">ABORT</span><br><span class="line">ABS</span><br><span class="line">ABSOLUTE</span><br><span class="line">ACCESS</span><br><span class="line">ACTION</span><br><span class="line">ADA</span><br><span class="line">ADD</span><br><span class="line">ADMIN</span><br><span class="line">AFTER</span><br><span class="line">AGGREGATE</span><br><span class="line">ALIAS</span><br><span class="line">ALL</span><br><span class="line">ALLOCATE</span><br><span class="line">ALSO</span><br><span class="line"><span class="keyword">ALTER</span></span><br><span class="line"><span class="keyword">ALWAYS</span></span><br><span class="line">ANALYSE</span><br><span class="line"><span class="keyword">ANALYZE</span></span><br><span class="line"><span class="keyword">AND</span></span><br><span class="line"><span class="keyword">ANY</span></span><br><span class="line"><span class="keyword">ARE</span></span><br><span class="line"><span class="built_in">ARRAY</span></span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">ASC</span></span><br><span class="line">ASENSITIVE</span><br><span class="line"><span class="keyword">ASSERTION</span></span><br><span class="line">ASSIGNMENT</span><br><span class="line">ASYMMETRIC</span><br><span class="line"><span class="keyword">AT</span></span><br><span class="line">ATOMIC</span><br><span class="line"><span class="keyword">ATTRIBUTE</span></span><br><span class="line"><span class="keyword">ATTRIBUTES</span></span><br><span class="line"><span class="keyword">AUDIT</span></span><br><span class="line">AUTHORIZATION</span><br><span class="line">AUTO_INCREMENT</span><br><span class="line"><span class="keyword">AVG</span></span><br><span class="line">AVG_ROW_LENGTH</span><br><span class="line"><span class="keyword">BACKUP</span></span><br><span class="line">BACKWARD</span><br><span class="line"><span class="keyword">BEFORE</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">BERNOULLI</span><br><span class="line"><span class="keyword">BETWEEN</span></span><br><span class="line"><span class="built_in">BIGINT</span></span><br><span class="line"><span class="built_in">BINARY</span></span><br><span class="line"><span class="built_in">BIT</span></span><br><span class="line"><span class="keyword">BIT_LENGTH</span></span><br><span class="line">BITVAR</span><br><span class="line"><span class="built_in">BLOB</span></span><br><span class="line">BOOL</span><br><span class="line"><span class="built_in">BOOLEAN</span></span><br><span class="line"><span class="keyword">BOTH</span></span><br><span class="line">BREADTH</span><br><span class="line">BREAK</span><br><span class="line">BROWSE</span><br><span class="line"><span class="keyword">BULK</span></span><br><span class="line"><span class="keyword">BY</span></span><br><span class="line">C</span><br><span class="line"><span class="keyword">CACHE</span></span><br><span class="line"><span class="keyword">CALL</span></span><br><span class="line">CALLED</span><br><span class="line">CARDINALITY</span><br><span class="line"><span class="keyword">CASCADE</span></span><br><span class="line"><span class="keyword">CASCADED</span></span><br><span class="line"><span class="keyword">CASE</span></span><br><span class="line"><span class="keyword">CAST</span></span><br><span class="line"><span class="keyword">CATALOG</span></span><br><span class="line">CATALOG_NAME</span><br><span class="line"><span class="keyword">CEIL</span></span><br><span class="line"><span class="keyword">CEILING</span></span><br><span class="line"><span class="keyword">CHAIN</span></span><br><span class="line"><span class="keyword">CHANGE</span></span><br><span class="line"><span class="built_in">CHAR</span></span><br><span class="line"><span class="keyword">CHAR_LENGTH</span></span><br><span class="line"><span class="built_in">CHARACTER</span></span><br><span class="line"><span class="keyword">CHARACTER_LENGTH</span></span><br><span class="line">CHARACTER_SET_CATALOG</span><br><span class="line">CHARACTER_SET_NAME</span><br><span class="line">CHARACTER_SET_SCHEMA</span><br><span class="line">CHARACTERISTICS</span><br><span class="line"><span class="keyword">CHARACTERS</span></span><br><span class="line"><span class="keyword">CHECK</span></span><br><span class="line">CHECKED</span><br><span class="line">CHECKPOINT</span><br><span class="line"><span class="keyword">CHECKSUM</span></span><br><span class="line"><span class="keyword">CLASS</span></span><br><span class="line">CLASS_ORIGIN</span><br><span class="line"><span class="keyword">CLOB</span></span><br><span class="line"><span class="keyword">CLOSE</span></span><br><span class="line">CLUSTER</span><br><span class="line">CLUSTERED</span><br><span class="line"><span class="keyword">COALESCE</span></span><br><span class="line">COBOL</span><br><span class="line"><span class="keyword">COLLATE</span></span><br><span class="line"><span class="keyword">COLLATION</span></span><br><span class="line">COLLATION_CATALOG</span><br><span class="line">COLLATION_NAME</span><br><span class="line">COLLATION_SCHEMA</span><br><span class="line"><span class="keyword">COLLECT</span></span><br><span class="line"><span class="keyword">COLUMN</span></span><br><span class="line">COLUMN_NAME</span><br><span class="line"><span class="keyword">COLUMNS</span></span><br><span class="line">COMMAND_FUNCTION</span><br><span class="line">COMMAND_FUNCTION_CODE</span><br><span class="line"><span class="keyword">COMMENT</span></span><br><span class="line"><span class="keyword">COMMIT</span></span><br><span class="line">COMMITTED</span><br><span class="line">COMPLETION</span><br><span class="line"><span class="keyword">COMPRESS</span></span><br><span class="line"><span class="keyword">COMPUTE</span></span><br><span class="line">CONDITION</span><br><span class="line">CONDITION_NUMBER</span><br><span class="line"><span class="keyword">CONNECT</span></span><br><span class="line"><span class="keyword">CONNECTION</span></span><br><span class="line">CONNECTION_NAME</span><br><span class="line"><span class="keyword">CONSTRAINT</span></span><br><span class="line">CONSTRAINT_CATALOG</span><br><span class="line">CONSTRAINT_NAME</span><br><span class="line">CONSTRAINT_SCHEMA</span><br><span class="line"><span class="keyword">CONSTRAINTS</span></span><br><span class="line"><span class="keyword">CONSTRUCTOR</span></span><br><span class="line">CONTAINS</span><br><span class="line">CONTAINSTABLE</span><br><span class="line">CONTINUE</span><br><span class="line">CONVERSION</span><br><span class="line"><span class="keyword">CONVERT</span></span><br><span class="line">COPY</span><br><span class="line"><span class="keyword">CORR</span></span><br><span class="line"><span class="keyword">CORRESPONDING</span></span><br><span class="line"><span class="keyword">COUNT</span></span><br><span class="line"><span class="keyword">COVAR_POP</span></span><br><span class="line"><span class="keyword">COVAR_SAMP</span></span><br><span class="line"><span class="keyword">CREATE</span></span><br><span class="line">CREATEDB</span><br><span class="line">CREATEROLE</span><br><span class="line">CREATEUSER</span><br><span class="line"><span class="keyword">CROSS</span></span><br><span class="line">CSV</span><br><span class="line"><span class="keyword">CUBE</span></span><br><span class="line"><span class="keyword">CUME_DIST</span></span><br><span class="line"><span class="keyword">CURRENT</span></span><br><span class="line"><span class="keyword">CURRENT_DATE</span></span><br><span class="line">CURRENT_DEFAULT_TRANSFORM_GROUP</span><br><span class="line">CURRENT_PATH</span><br><span class="line">CURRENT_ROLE</span><br><span class="line"><span class="keyword">CURRENT_TIME</span></span><br><span class="line"><span class="keyword">CURRENT_TIMESTAMP</span></span><br><span class="line">CURRENT_TRANSFORM_GROUP_FOR_TYPE</span><br><span class="line"><span class="keyword">CURRENT_USER</span></span><br><span class="line"><span class="keyword">CURSOR</span></span><br><span class="line">CURSOR_NAME</span><br><span class="line"><span class="keyword">CYCLE</span></span><br><span class="line"><span class="keyword">DATA</span></span><br><span class="line"><span class="keyword">DATABASE</span></span><br><span class="line"><span class="keyword">DATABASES</span></span><br><span class="line"><span class="built_in">DATE</span></span><br><span class="line">DATETIME</span><br><span class="line">DATETIME_INTERVAL_CODE</span><br><span class="line">DATETIME_INTERVAL_PRECISION</span><br><span class="line"><span class="keyword">DAY</span></span><br><span class="line">DAY_HOUR</span><br><span class="line">DAY_MICROSECOND</span><br><span class="line">DAY_MINUTE</span><br><span class="line">DAY_SECOND</span><br><span class="line"><span class="keyword">DAYOFMONTH</span></span><br><span class="line"><span class="keyword">DAYOFWEEK</span></span><br><span class="line"><span class="keyword">DAYOFYEAR</span></span><br><span class="line">DBCC</span><br><span class="line"><span class="keyword">DEALLOCATE</span></span><br><span class="line"><span class="built_in">DEC</span></span><br><span class="line"><span class="built_in">DECIMAL</span></span><br><span class="line"><span class="keyword">DECLARE</span></span><br><span class="line"><span class="keyword">DEFAULT</span></span><br><span class="line"><span class="keyword">DEFAULTS</span></span><br><span class="line">DEFERRABLE</span><br><span class="line"><span class="keyword">DEFERRED</span></span><br><span class="line">DEFINED</span><br><span class="line">DEFINER</span><br><span class="line">DEGREE</span><br><span class="line">DELAY_KEY_WRITE</span><br><span class="line"><span class="keyword">DELAYED</span></span><br><span class="line"><span class="keyword">DELETE</span></span><br><span class="line">DELIMITER</span><br><span class="line">DELIMITERS</span><br><span class="line"><span class="keyword">DENSE_RANK</span></span><br><span class="line">DENY</span><br><span class="line"><span class="keyword">DEPTH</span></span><br><span class="line">DEREF</span><br><span class="line">DERIVED</span><br><span class="line"><span class="keyword">DESC</span></span><br><span class="line"><span class="keyword">DESCRIBE</span></span><br><span class="line"><span class="keyword">DESCRIPTOR</span></span><br><span class="line">DESTROY</span><br><span class="line">DESTRUCTOR</span><br><span class="line"><span class="keyword">DETERMINISTIC</span></span><br><span class="line"><span class="keyword">DIAGNOSTICS</span></span><br><span class="line">DICTIONARY</span><br><span class="line"><span class="keyword">DISABLE</span></span><br><span class="line"><span class="keyword">DISCONNECT</span></span><br><span class="line">DISK</span><br><span class="line">DISPATCH</span><br><span class="line"><span class="keyword">DISTINCT</span></span><br><span class="line"><span class="keyword">DISTINCTROW</span></span><br><span class="line"><span class="keyword">DISTRIBUTED</span></span><br><span class="line"><span class="keyword">DIV</span></span><br><span class="line"><span class="keyword">DO</span></span><br><span class="line"><span class="keyword">DOMAIN</span></span><br><span class="line"><span class="keyword">DOUBLE</span></span><br><span class="line"><span class="keyword">DROP</span></span><br><span class="line">DUAL</span><br><span class="line">DUMMY</span><br><span class="line">DUMP</span><br><span class="line">DYNAMIC</span><br><span class="line">DYNAMIC_FUNCTION</span><br><span class="line">DYNAMIC_FUNCTION_CODE</span><br><span class="line"><span class="keyword">EACH</span></span><br><span class="line"><span class="keyword">ELEMENT</span></span><br><span class="line"><span class="keyword">ELSE</span></span><br><span class="line">ELSEIF</span><br><span class="line"><span class="keyword">ENABLE</span></span><br><span class="line"><span class="keyword">ENCLOSED</span></span><br><span class="line"><span class="keyword">ENCODING</span></span><br><span class="line">ENCRYPTED</span><br><span class="line"><span class="keyword">END</span></span><br><span class="line"><span class="keyword">END</span>-EXEC</span><br><span class="line">ENUM</span><br><span class="line">EQUALS</span><br><span class="line">ERRLVL</span><br><span class="line">ESCAPE</span><br><span class="line"><span class="keyword">ESCAPED</span></span><br><span class="line">EVERY</span><br><span class="line"><span class="keyword">EXCEPT</span></span><br><span class="line"><span class="keyword">EXCEPTION</span></span><br><span class="line"><span class="keyword">EXCLUDE</span></span><br><span class="line"><span class="keyword">EXCLUDING</span></span><br><span class="line">EXCLUSIVE</span><br><span class="line">EXEC</span><br><span class="line"><span class="keyword">EXECUTE</span></span><br><span class="line">EXISTING</span><br><span class="line"><span class="keyword">EXISTS</span></span><br><span class="line"><span class="keyword">EXIT</span></span><br><span class="line"><span class="keyword">EXP</span></span><br><span class="line"><span class="keyword">EXPLAIN</span></span><br><span class="line"><span class="keyword">EXTERNAL</span></span><br><span class="line"><span class="keyword">EXTRACT</span></span><br><span class="line"><span class="literal">FALSE</span></span><br><span class="line"><span class="keyword">FETCH</span></span><br><span class="line"><span class="keyword">FIELDS</span></span><br><span class="line"><span class="keyword">FILE</span></span><br><span class="line">FILLFACTOR</span><br><span class="line">FILTER</span><br><span class="line"><span class="keyword">FINAL</span></span><br><span class="line"><span class="keyword">FIRST</span></span><br><span class="line"><span class="built_in">FLOAT</span></span><br><span class="line">FLOAT4</span><br><span class="line">FLOAT8</span><br><span class="line"><span class="keyword">FLOOR</span></span><br><span class="line"><span class="keyword">FLUSH</span></span><br><span class="line"><span class="keyword">FOLLOWING</span></span><br><span class="line"><span class="keyword">FOR</span></span><br><span class="line"><span class="keyword">FORCE</span></span><br><span class="line">FOREIGN</span><br><span class="line">FORTRAN</span><br><span class="line">FORWARD</span><br><span class="line"><span class="keyword">FOUND</span></span><br><span class="line">FREE</span><br><span class="line">FREETEXT</span><br><span class="line">FREETEXTTABLE</span><br><span class="line">FREEZE</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line"><span class="keyword">FULL</span></span><br><span class="line">FULLTEXT</span><br><span class="line"><span class="keyword">FUNCTION</span></span><br><span class="line">FUSION</span><br><span class="line">G</span><br><span class="line"><span class="keyword">GENERAL</span></span><br><span class="line"><span class="keyword">GENERATED</span></span><br><span class="line"><span class="keyword">GET</span></span><br><span class="line"><span class="keyword">GLOBAL</span></span><br><span class="line"><span class="keyword">GO</span></span><br><span class="line"><span class="keyword">GOTO</span></span><br><span class="line"><span class="keyword">GRANT</span></span><br><span class="line">GRANTED</span><br><span class="line"><span class="keyword">GRANTS</span></span><br><span class="line"><span class="keyword">GREATEST</span></span><br><span class="line"><span class="keyword">GROUP</span></span><br><span class="line"><span class="keyword">GROUPING</span></span><br><span class="line"><span class="keyword">HANDLER</span></span><br><span class="line"><span class="keyword">HAVING</span></span><br><span class="line">HEADER</span><br><span class="line"><span class="keyword">HEAP</span></span><br><span class="line"><span class="keyword">HIERARCHY</span></span><br><span class="line"><span class="keyword">HIGH_PRIORITY</span></span><br><span class="line">HOLD</span><br><span class="line">HOLDLOCK</span><br><span class="line">HOST</span><br><span class="line"><span class="keyword">HOSTS</span></span><br><span class="line"><span class="keyword">HOUR</span></span><br><span class="line">HOUR_MICROSECOND</span><br><span class="line">HOUR_MINUTE</span><br><span class="line">HOUR_SECOND</span><br><span class="line"><span class="keyword">IDENTIFIED</span></span><br><span class="line"><span class="keyword">IDENTITY</span></span><br><span class="line">IDENTITY_INSERT</span><br><span class="line">IDENTITYCOL</span><br><span class="line"><span class="keyword">IF</span></span><br><span class="line"><span class="keyword">IGNORE</span></span><br><span class="line"><span class="keyword">ILIKE</span></span><br><span class="line"><span class="keyword">IMMEDIATE</span></span><br><span class="line">IMMUTABLE</span><br><span class="line">IMPLEMENTATION</span><br><span class="line">IMPLICIT</span><br><span class="line"><span class="keyword">IN</span></span><br><span class="line"><span class="keyword">INCLUDE</span></span><br><span class="line"><span class="keyword">INCLUDING</span></span><br><span class="line"><span class="keyword">INCREMENT</span></span><br><span class="line"><span class="keyword">INDEX</span></span><br><span class="line"><span class="keyword">INDICATOR</span></span><br><span class="line"><span class="keyword">INFILE</span></span><br><span class="line">INFIX</span><br><span class="line">INHERIT</span><br><span class="line">INHERITS</span><br><span class="line"><span class="keyword">INITIAL</span></span><br><span class="line">INITIALIZE</span><br><span class="line"><span class="keyword">INITIALLY</span></span><br><span class="line"><span class="keyword">INNER</span></span><br><span class="line">INOUT</span><br><span class="line"><span class="keyword">INPUT</span></span><br><span class="line">INSENSITIVE</span><br><span class="line"><span class="keyword">INSERT</span></span><br><span class="line">INSERT_ID</span><br><span class="line"><span class="keyword">INSTANCE</span></span><br><span class="line"><span class="keyword">INSTANTIABLE</span></span><br><span class="line">INSTEAD</span><br><span class="line"><span class="built_in">INT</span></span><br><span class="line">INT1</span><br><span class="line">INT2</span><br><span class="line">INT3</span><br><span class="line">INT4</span><br><span class="line"><span class="built_in">INT8</span></span><br><span class="line"><span class="built_in">INTEGER</span></span><br><span class="line"><span class="keyword">INTERSECT</span></span><br><span class="line">INTERSECTION</span><br><span class="line"><span class="built_in">INTERVAL</span></span><br><span class="line"><span class="keyword">INTO</span></span><br><span class="line">INVOKER</span><br><span class="line"><span class="keyword">IS</span></span><br><span class="line">ISAM</span><br><span class="line"><span class="keyword">ISNULL</span></span><br><span class="line"><span class="keyword">ISOLATION</span></span><br><span class="line"><span class="keyword">ITERATE</span></span><br><span class="line"><span class="keyword">JOIN</span></span><br><span class="line">K</span><br><span class="line"><span class="keyword">KEY</span></span><br><span class="line">KEY_MEMBER</span><br><span class="line">KEY_TYPE</span><br><span class="line"><span class="keyword">KEYS</span></span><br><span class="line"><span class="keyword">KILL</span></span><br><span class="line">LANCOMPILER</span><br><span class="line"><span class="keyword">LANGUAGE</span></span><br><span class="line"><span class="keyword">LARGE</span></span><br><span class="line"><span class="keyword">LAST</span></span><br><span class="line"><span class="keyword">LAST_INSERT_ID</span></span><br><span class="line">LATERAL</span><br><span class="line"><span class="keyword">LEADING</span></span><br><span class="line"><span class="keyword">LEAST</span></span><br><span class="line">LEAVE</span><br><span class="line"><span class="keyword">LEFT</span></span><br><span class="line"><span class="keyword">LENGTH</span></span><br><span class="line"><span class="keyword">LESS</span></span><br><span class="line"><span class="keyword">LEVEL</span></span><br><span class="line"><span class="keyword">LIKE</span></span><br><span class="line"><span class="keyword">LIMIT</span></span><br><span class="line">LINENO</span><br><span class="line"><span class="keyword">LINES</span></span><br><span class="line">LISTEN</span><br><span class="line"><span class="keyword">LN</span></span><br><span class="line"><span class="keyword">LOAD</span></span><br><span class="line"><span class="keyword">LOCAL</span></span><br><span class="line"><span class="keyword">LOCALTIME</span></span><br><span class="line"><span class="keyword">LOCALTIMESTAMP</span></span><br><span class="line">LOCATION</span><br><span class="line"><span class="keyword">LOCATOR</span></span><br><span class="line"><span class="keyword">LOCK</span></span><br><span class="line">LOGIN</span><br><span class="line"><span class="keyword">LOGS</span></span><br><span class="line"><span class="keyword">LONG</span></span><br><span class="line">LONGBLOB</span><br><span class="line">LONGTEXT</span><br><span class="line"><span class="keyword">LOOP</span></span><br><span class="line"><span class="keyword">LOW_PRIORITY</span></span><br><span class="line"><span class="keyword">LOWER</span></span><br><span class="line">M</span><br><span class="line"><span class="keyword">MAP</span></span><br><span class="line"><span class="keyword">MATCH</span></span><br><span class="line"><span class="keyword">MATCHED</span></span><br><span class="line"><span class="keyword">MAX</span></span><br><span class="line">MAX_ROWS</span><br><span class="line"><span class="keyword">MAXEXTENTS</span></span><br><span class="line">MAXVALUE</span><br><span class="line">MEDIUMBLOB</span><br><span class="line">MEDIUMINT</span><br><span class="line">MEDIUMTEXT</span><br><span class="line"><span class="keyword">MEMBER</span></span><br><span class="line"><span class="keyword">MERGE</span></span><br><span class="line">MESSAGE_LENGTH</span><br><span class="line">MESSAGE_OCTET_LENGTH</span><br><span class="line">MESSAGE_TEXT</span><br><span class="line">METHOD</span><br><span class="line">MIDDLEINT</span><br><span class="line"><span class="keyword">MIN</span></span><br><span class="line">MIN_ROWS</span><br><span class="line"><span class="keyword">MINUS</span></span><br><span class="line"><span class="keyword">MINUTE</span></span><br><span class="line">MINUTE_MICROSECOND</span><br><span class="line">MINUTE_SECOND</span><br><span class="line"><span class="keyword">MINVALUE</span></span><br><span class="line">MLSLABEL</span><br><span class="line"><span class="keyword">MOD</span></span><br><span class="line"><span class="keyword">MODE</span></span><br><span class="line">MODIFIES</span><br><span class="line"><span class="keyword">MODIFY</span></span><br><span class="line"><span class="keyword">MODULE</span></span><br><span class="line"><span class="keyword">MONTH</span></span><br><span class="line">MONTHNAME</span><br><span class="line">MORE</span><br><span class="line"><span class="keyword">MOVE</span></span><br><span class="line"><span class="keyword">MULTISET</span></span><br><span class="line">MUMPS</span><br><span class="line">MYISAM</span><br><span class="line"><span class="keyword">NAME</span></span><br><span class="line"><span class="keyword">NAMES</span></span><br><span class="line"><span class="keyword">NATIONAL</span></span><br><span class="line"><span class="keyword">NATURAL</span></span><br><span class="line"><span class="keyword">NCHAR</span></span><br><span class="line"><span class="keyword">NCLOB</span></span><br><span class="line">NESTING</span><br><span class="line"><span class="keyword">NEW</span></span><br><span class="line"><span class="keyword">NEXT</span></span><br><span class="line"><span class="keyword">NO</span></span><br><span class="line"><span class="keyword">NO_WRITE_TO_BINLOG</span></span><br><span class="line"><span class="keyword">NOAUDIT</span></span><br><span class="line"><span class="keyword">NOCHECK</span></span><br><span class="line"><span class="keyword">NOCOMPRESS</span></span><br><span class="line">NOCREATEDB</span><br><span class="line">NOCREATEROLE</span><br><span class="line">NOCREATEUSER</span><br><span class="line">NOINHERIT</span><br><span class="line">NOLOGIN</span><br><span class="line">NONCLUSTERED</span><br><span class="line"><span class="keyword">NONE</span></span><br><span class="line">NORMALIZE</span><br><span class="line">NORMALIZED</span><br><span class="line">NOSUPERUSER</span><br><span class="line"><span class="keyword">NOT</span></span><br><span class="line"><span class="keyword">NOTHING</span></span><br><span class="line">NOTIFY</span><br><span class="line">NOTNULL</span><br><span class="line"><span class="keyword">NOWAIT</span></span><br><span class="line"><span class="literal">NULL</span></span><br><span class="line">NULLABLE</span><br><span class="line"><span class="keyword">NULLIF</span></span><br><span class="line"><span class="keyword">NULLS</span></span><br><span class="line"><span class="built_in">NUMBER</span></span><br><span class="line"><span class="built_in">NUMERIC</span></span><br><span class="line"><span class="keyword">OBJECT</span></span><br><span class="line"><span class="keyword">OCTET_LENGTH</span></span><br><span class="line">OCTETS</span><br><span class="line"><span class="keyword">OF</span></span><br><span class="line"><span class="keyword">OFF</span></span><br><span class="line"><span class="keyword">OFFLINE</span></span><br><span class="line"><span class="keyword">OFFSET</span></span><br><span class="line">OFFSETS</span><br><span class="line">OIDS</span><br><span class="line"><span class="keyword">OLD</span></span><br><span class="line"><span class="keyword">ON</span></span><br><span class="line"><span class="keyword">ONLINE</span></span><br><span class="line"><span class="keyword">ONLY</span></span><br><span class="line"><span class="keyword">OPEN</span></span><br><span class="line">OPENDATASOURCE</span><br><span class="line">OPENQUERY</span><br><span class="line">OPENROWSET</span><br><span class="line">OPENXML</span><br><span class="line">OPERATION</span><br><span class="line"><span class="keyword">OPERATOR</span></span><br><span class="line"><span class="keyword">OPTIMIZE</span></span><br><span class="line"><span class="keyword">OPTION</span></span><br><span class="line"><span class="keyword">OPTIONALLY</span></span><br><span class="line">OPTIONS</span><br><span class="line"><span class="keyword">OR</span></span><br><span class="line"><span class="keyword">ORDER</span></span><br><span class="line">ORDERING</span><br><span class="line"><span class="keyword">ORDINALITY</span></span><br><span class="line">OTHERS</span><br><span class="line"><span class="keyword">OUT</span></span><br><span class="line"><span class="keyword">OUTER</span></span><br><span class="line"><span class="keyword">OUTFILE</span></span><br><span class="line"><span class="keyword">OUTPUT</span></span><br><span class="line"><span class="keyword">OVER</span></span><br><span class="line">OVERLAPS</span><br><span class="line">OVERLAY</span><br><span class="line"><span class="keyword">OVERRIDING</span></span><br><span class="line">OWNER</span><br><span class="line">PACK_KEYS</span><br><span class="line"><span class="keyword">PAD</span></span><br><span class="line">PARAMETER</span><br><span class="line">PARAMETER_MODE</span><br><span class="line">PARAMETER_NAME</span><br><span class="line">PARAMETER_ORDINAL_POSITION</span><br><span class="line">PARAMETER_SPECIFIC_CATALOG</span><br><span class="line">PARAMETER_SPECIFIC_NAME</span><br><span class="line">PARAMETER_SPECIFIC_SCHEMA</span><br><span class="line"><span class="keyword">PARAMETERS</span></span><br><span class="line"><span class="keyword">PARTIAL</span></span><br><span class="line"><span class="keyword">PARTITION</span></span><br><span class="line"><span class="keyword">PASCAL</span></span><br><span class="line"><span class="keyword">PASSWORD</span></span><br><span class="line"><span class="keyword">PATH</span></span><br><span class="line">PCTFREE</span><br><span class="line"><span class="keyword">PERCENT</span></span><br><span class="line"><span class="keyword">PERCENT_RANK</span></span><br><span class="line"><span class="keyword">PERCENTILE_CONT</span></span><br><span class="line"><span class="keyword">PERCENTILE_DISC</span></span><br><span class="line">PLACING</span><br><span class="line">PLAN</span><br><span class="line">PLI</span><br><span class="line"><span class="keyword">POSITION</span></span><br><span class="line">POSTFIX</span><br><span class="line"><span class="keyword">POWER</span></span><br><span class="line"><span class="keyword">PRECEDING</span></span><br><span class="line"><span class="keyword">PRECISION</span></span><br><span class="line">PREFIX</span><br><span class="line">PREORDER</span><br><span class="line"><span class="keyword">PREPARE</span></span><br><span class="line">PREPARED</span><br><span class="line"><span class="keyword">PRESERVE</span></span><br><span class="line">PRIMARY</span><br><span class="line">PRINT</span><br><span class="line"><span class="keyword">PRIOR</span></span><br><span class="line"><span class="keyword">PRIVILEGES</span></span><br><span class="line">PROC</span><br><span class="line"><span class="keyword">PROCEDURAL</span></span><br><span class="line"><span class="keyword">PROCEDURE</span></span><br><span class="line">PROCESS</span><br><span class="line"><span class="keyword">PROCESSLIST</span></span><br><span class="line"><span class="keyword">PUBLIC</span></span><br><span class="line"><span class="keyword">PURGE</span></span><br><span class="line">QUOTE</span><br><span class="line">RAID0</span><br><span class="line">RAISERROR</span><br><span class="line"><span class="keyword">RANGE</span></span><br><span class="line"><span class="keyword">RANK</span></span><br><span class="line"><span class="keyword">RAW</span></span><br><span class="line"><span class="keyword">READ</span></span><br><span class="line"><span class="keyword">READS</span></span><br><span class="line">READTEXT</span><br><span class="line"><span class="built_in">REAL</span></span><br><span class="line">RECHECK</span><br><span class="line">RECONFIGURE</span><br><span class="line"><span class="keyword">RECURSIVE</span></span><br><span class="line"><span class="keyword">REF</span></span><br><span class="line"><span class="keyword">REFERENCES</span></span><br><span class="line"><span class="keyword">REFERENCING</span></span><br><span class="line">REGEXP</span><br><span class="line"><span class="keyword">REGR_AVGX</span></span><br><span class="line"><span class="keyword">REGR_AVGY</span></span><br><span class="line"><span class="keyword">REGR_COUNT</span></span><br><span class="line"><span class="keyword">REGR_INTERCEPT</span></span><br><span class="line"><span class="keyword">REGR_R2</span></span><br><span class="line"><span class="keyword">REGR_SLOPE</span></span><br><span class="line"><span class="keyword">REGR_SXX</span></span><br><span class="line"><span class="keyword">REGR_SXY</span></span><br><span class="line">REGR_SYY</span><br><span class="line">REINDEX</span><br><span class="line"><span class="keyword">RELATIVE</span></span><br><span class="line"><span class="keyword">RELEASE</span></span><br><span class="line">RELOAD</span><br><span class="line"><span class="keyword">RENAME</span></span><br><span class="line"><span class="keyword">REPEAT</span></span><br><span class="line">REPEATABLE</span><br><span class="line"><span class="keyword">REPLACE</span></span><br><span class="line"><span class="keyword">REPLICATION</span></span><br><span class="line">REQUIRE</span><br><span class="line"><span class="keyword">RESET</span></span><br><span class="line">RESIGNAL</span><br><span class="line"><span class="keyword">RESOURCE</span></span><br><span class="line">RESTART</span><br><span class="line"><span class="keyword">RESTORE</span></span><br><span class="line">RESTRICT</span><br><span class="line"><span class="keyword">RESULT</span></span><br><span class="line"><span class="keyword">RETURN</span></span><br><span class="line">RETURNED_CARDINALITY</span><br><span class="line">RETURNED_LENGTH</span><br><span class="line">RETURNED_OCTET_LENGTH</span><br><span class="line">RETURNED_SQLSTATE</span><br><span class="line"><span class="keyword">RETURNS</span></span><br><span class="line"><span class="keyword">REVOKE</span></span><br><span class="line"><span class="keyword">RIGHT</span></span><br><span class="line"><span class="keyword">RLIKE</span></span><br><span class="line"><span class="keyword">ROLE</span></span><br><span class="line"><span class="keyword">ROLLBACK</span></span><br><span class="line"><span class="keyword">ROLLUP</span></span><br><span class="line">ROUTINE</span><br><span class="line">ROUTINE_CATALOG</span><br><span class="line">ROUTINE_NAME</span><br><span class="line">ROUTINE_SCHEMA</span><br><span class="line"><span class="keyword">ROW</span></span><br><span class="line"><span class="keyword">ROW_COUNT</span></span><br><span class="line">ROW_NUMBER</span><br><span class="line">ROWCOUNT</span><br><span class="line">ROWGUIDCOL</span><br><span class="line"><span class="keyword">ROWID</span></span><br><span class="line"><span class="keyword">ROWNUM</span></span><br><span class="line"><span class="keyword">ROWS</span></span><br><span class="line">RULE</span><br><span class="line"><span class="keyword">SAVE</span></span><br><span class="line"><span class="keyword">SAVEPOINT</span></span><br><span class="line">SCALE</span><br><span class="line"><span class="keyword">SCHEMA</span></span><br><span class="line">SCHEMA_NAME</span><br><span class="line">SCHEMAS</span><br><span class="line"><span class="keyword">SCOPE</span></span><br><span class="line">SCOPE_CATALOG</span><br><span class="line">SCOPE_NAME</span><br><span class="line">SCOPE_SCHEMA</span><br><span class="line"><span class="keyword">SCROLL</span></span><br><span class="line"><span class="keyword">SEARCH</span></span><br><span class="line"><span class="keyword">SECOND</span></span><br><span class="line">SECOND_MICROSECOND</span><br><span class="line"><span class="keyword">SECTION</span></span><br><span class="line"><span class="keyword">SECURITY</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line"><span class="keyword">SELF</span></span><br><span class="line">SENSITIVE</span><br><span class="line">SEPARATOR</span><br><span class="line"><span class="keyword">SEQUENCE</span></span><br><span class="line"><span class="keyword">SERIALIZABLE</span></span><br><span class="line">SERVER_NAME</span><br><span class="line"><span class="keyword">SESSION</span></span><br><span class="line"><span class="keyword">SESSION_USER</span></span><br><span class="line"><span class="keyword">SET</span></span><br><span class="line">SETOF</span><br><span class="line"><span class="keyword">SETS</span></span><br><span class="line">SETUSER</span><br><span class="line"><span class="keyword">SHARE</span></span><br><span class="line"><span class="keyword">SHOW</span></span><br><span class="line"><span class="keyword">SHUTDOWN</span></span><br><span class="line">SIGNAL</span><br><span class="line">SIMILAR</span><br><span class="line">SIMPLE</span><br><span class="line"><span class="keyword">SIZE</span></span><br><span class="line"><span class="built_in">SMALLINT</span></span><br><span class="line"><span class="keyword">SOME</span></span><br><span class="line"><span class="keyword">SONAME</span></span><br><span class="line"><span class="keyword">SOURCE</span></span><br><span class="line"><span class="keyword">SPACE</span></span><br><span class="line">SPATIAL</span><br><span class="line">SPECIFIC</span><br><span class="line">SPECIFIC_NAME</span><br><span class="line">SPECIFICTYPE</span><br><span class="line"><span class="keyword">SQL</span></span><br><span class="line"><span class="keyword">SQL_BIG_RESULT</span></span><br><span class="line">SQL_BIG_SELECTS</span><br><span class="line">SQL_BIG_TABLES</span><br><span class="line"><span class="keyword">SQL_CALC_FOUND_ROWS</span></span><br><span class="line">SQL_LOG_OFF</span><br><span class="line">SQL_LOG_UPDATE</span><br><span class="line">SQL_LOW_PRIORITY_UPDATES</span><br><span class="line">SQL_SELECT_LIMIT</span><br><span class="line"><span class="keyword">SQL_SMALL_RESULT</span></span><br><span class="line">SQL_WARNINGS</span><br><span class="line">SQLCA</span><br><span class="line"><span class="keyword">SQLCODE</span></span><br><span class="line"><span class="keyword">SQLERROR</span></span><br><span class="line">SQLEXCEPTION</span><br><span class="line"><span class="keyword">SQLSTATE</span></span><br><span class="line">SQLWARNING</span><br><span class="line"><span class="keyword">SQRT</span></span><br><span class="line">SSL</span><br><span class="line">STABLE</span><br><span class="line"><span class="keyword">START</span></span><br><span class="line"><span class="keyword">STARTING</span></span><br><span class="line">STATE</span><br><span class="line"><span class="keyword">STATEMENT</span></span><br><span class="line"><span class="keyword">STATIC</span></span><br><span class="line"><span class="keyword">STATISTICS</span></span><br><span class="line"><span class="keyword">STATUS</span></span><br><span class="line"><span class="keyword">STDDEV_POP</span></span><br><span class="line"><span class="keyword">STDDEV_SAMP</span></span><br><span class="line">STDIN</span><br><span class="line">STDOUT</span><br><span class="line"><span class="keyword">STORAGE</span></span><br><span class="line"><span class="keyword">STRAIGHT_JOIN</span></span><br><span class="line"><span class="keyword">STRICT</span></span><br><span class="line"><span class="keyword">STRING</span></span><br><span class="line">STRUCTURE</span><br><span class="line"><span class="keyword">STYLE</span></span><br><span class="line">SUBCLASS_ORIGIN</span><br><span class="line">SUBLIST</span><br><span class="line">SUBMULTISET</span><br><span class="line"><span class="keyword">SUBSTRING</span></span><br><span class="line">SUCCESSFUL</span><br><span class="line"><span class="keyword">SUM</span></span><br><span class="line">SUPERUSER</span><br><span class="line">SYMMETRIC</span><br><span class="line"><span class="keyword">SYNONYM</span></span><br><span class="line"><span class="keyword">SYSDATE</span></span><br><span class="line">SYSID</span><br><span class="line"><span class="keyword">SYSTEM</span></span><br><span class="line"><span class="keyword">SYSTEM_USER</span></span><br><span class="line"><span class="keyword">TABLE</span></span><br><span class="line">TABLE_NAME</span><br><span class="line"><span class="keyword">TABLES</span></span><br><span class="line">TABLESAMPLE</span><br><span class="line"><span class="keyword">TABLESPACE</span></span><br><span class="line">TEMP</span><br><span class="line"><span class="keyword">TEMPLATE</span></span><br><span class="line"><span class="keyword">TEMPORARY</span></span><br><span class="line">TERMINATE</span><br><span class="line"><span class="keyword">TERMINATED</span></span><br><span class="line"><span class="built_in">TEXT</span></span><br><span class="line">TEXTSIZE</span><br><span class="line"><span class="keyword">THAN</span></span><br><span class="line"><span class="keyword">THEN</span></span><br><span class="line"><span class="keyword">TIES</span></span><br><span class="line"><span class="keyword">TIME</span></span><br><span class="line"><span class="keyword">TIMESTAMP</span></span><br><span class="line">TIMEZONE_HOUR</span><br><span class="line"><span class="keyword">TIMEZONE_MINUTE</span></span><br><span class="line">TINYBLOB</span><br><span class="line">TINYINT</span><br><span class="line">TINYTEXT</span><br><span class="line"><span class="keyword">TO</span></span><br><span class="line">TOAST</span><br><span class="line">TOP</span><br><span class="line">TOP_LEVEL_COUNT</span><br><span class="line">TRAILING</span><br><span class="line">TRAN</span><br><span class="line"><span class="keyword">TRANSACTION</span></span><br><span class="line">TRANSACTION_ACTIVE</span><br><span class="line">TRANSACTIONS_COMMITTED</span><br><span class="line">TRANSACTIONS_ROLLED_BACK</span><br><span class="line">TRANSFORM</span><br><span class="line">TRANSFORMS</span><br><span class="line"><span class="keyword">TRANSLATE</span></span><br><span class="line"><span class="keyword">TRANSLATION</span></span><br><span class="line"><span class="keyword">TREAT</span></span><br><span class="line"><span class="keyword">TRIGGER</span></span><br><span class="line">TRIGGER_CATALOG</span><br><span class="line">TRIGGER_NAME</span><br><span class="line">TRIGGER_SCHEMA</span><br><span class="line"><span class="keyword">TRIM</span></span><br><span class="line"><span class="literal">TRUE</span></span><br><span class="line"><span class="keyword">TRUNCATE</span></span><br><span class="line">TRUSTED</span><br><span class="line">TSEQUAL</span><br><span class="line"><span class="keyword">TYPE</span></span><br><span class="line">UESCAPE</span><br><span class="line">UID</span><br><span class="line"><span class="keyword">UNBOUNDED</span></span><br><span class="line">UNCOMMITTED</span><br><span class="line"><span class="keyword">UNDER</span></span><br><span class="line"><span class="keyword">UNDO</span></span><br><span class="line">UNENCRYPTED</span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">UNIQUE</span></span><br><span class="line"><span class="keyword">UNKNOWN</span></span><br><span class="line">UNLISTEN</span><br><span class="line"><span class="keyword">UNLOCK</span></span><br><span class="line">UNNAMED</span><br><span class="line">UNNEST</span><br><span class="line"><span class="keyword">UNSIGNED</span></span><br><span class="line"><span class="keyword">UNTIL</span></span><br><span class="line"><span class="keyword">UPDATE</span></span><br><span class="line">UPDATETEXT</span><br><span class="line"><span class="keyword">UPPER</span></span><br><span class="line"><span class="keyword">USAGE</span></span><br><span class="line"><span class="keyword">USE</span></span><br><span class="line"><span class="keyword">USER</span></span><br><span class="line">USER_DEFINED_TYPE_CATALOG</span><br><span class="line">USER_DEFINED_TYPE_CODE</span><br><span class="line">USER_DEFINED_TYPE_NAME</span><br><span class="line">USER_DEFINED_TYPE_SCHEMA</span><br><span class="line"><span class="keyword">USING</span></span><br><span class="line"><span class="keyword">UTC_DATE</span></span><br><span class="line">UTC_TIME</span><br><span class="line"><span class="keyword">UTC_TIMESTAMP</span></span><br><span class="line">VACUUM</span><br><span class="line">VALID</span><br><span class="line"><span class="keyword">VALIDATE</span></span><br><span class="line">VALIDATOR</span><br><span class="line"><span class="keyword">VALUE</span></span><br><span class="line"><span class="keyword">VALUES</span></span><br><span class="line">VAR_POP</span><br><span class="line"><span class="keyword">VAR_SAMP</span></span><br><span class="line">VARBINARY</span><br><span class="line"><span class="built_in">VARCHAR</span></span><br><span class="line">VARCHAR2</span><br><span class="line">VARCHARACTER</span><br><span class="line"><span class="keyword">VARIABLE</span></span><br><span class="line"><span class="keyword">VARIABLES</span></span><br><span class="line"><span class="built_in">VARYING</span></span><br><span class="line">VERBOSE</span><br><span class="line"><span class="keyword">VIEW</span></span><br><span class="line">VOLATILE</span><br><span class="line">WAITFOR</span><br><span class="line"><span class="keyword">WHEN</span></span><br><span class="line"><span class="keyword">WHENEVER</span></span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line"><span class="keyword">WHILE</span></span><br><span class="line">WIDTH_BUCKET</span><br><span class="line">WINDOW</span><br><span class="line"><span class="keyword">WITH</span></span><br><span class="line"><span class="keyword">WITHIN</span></span><br><span class="line"><span class="keyword">WITHOUT</span></span><br><span class="line"><span class="keyword">WORK</span></span><br><span class="line">WRITE</span><br><span class="line">WRITETEXT</span><br><span class="line">X509</span><br><span class="line"><span class="keyword">XOR</span></span><br><span class="line"><span class="keyword">YEAR</span></span><br><span class="line">YEAR_MONTH</span><br><span class="line">ZEROFILL</span><br><span class="line">ZONE</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;SQL-style-guide&quot;&gt;&lt;a href=&quot;#SQL-style-guide&quot; class=&quot;headerlink&quot; title=&quot;SQL style guide&quot;&gt;&lt;/a&gt;SQL style guide&lt;/h1&gt;&lt;h2 id=&quot;Overview&quot;&gt;&lt;a 
      
    
    </summary>
    
      <category term="SQL" scheme="https://betgar.github.io/categories/SQL/"/>
    
    
      <category term="SQL" scheme="https://betgar.github.io/tags/SQL/"/>
    
  </entry>
  
  <entry>
    <title>jQuery cookie插件使用例子</title>
    <link href="https://betgar.github.io/2018/02/26/jquery-cookie-plug-api/"/>
    <id>https://betgar.github.io/2018/02/26/jquery-cookie-plug-api/</id>
    <published>2018-02-26T12:00:00.000Z</published>
    <updated>2018-06-28T11:24:48.097Z</updated>
    
    <content type="html"><![CDATA[<h1 id="jQuery-cookie插件使用例子"><a href="#jQuery-cookie插件使用例子" class="headerlink" title="jQuery cookie插件使用例子"></a>jQuery cookie插件使用例子</h1><blockquote><p>记录一下jQuery-cookie的使用方法。</p></blockquote><h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><blockquote><p>jQuery.cookie使用非常的简单，只有一个构造函数。</p></blockquote><h3 id="构造函数"><a href="#构造函数" class="headerlink" title="构造函数"></a>构造函数</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* @param &#123;string&#125; name - cookie键.</span></span><br><span class="line"><span class="comment"> * @param &#123;string&#125; value - cookie值.</span></span><br><span class="line"><span class="comment"> * @param &#123;Object&#125; options - cookie的控制参数</span></span><br><span class="line"><span class="comment"> * @param &#123;Number|Date&#125; options.expires  </span></span><br><span class="line"><span class="comment"> *               期望什么时候cookie过期，从当前时间计算（浏览器时间）。</span></span><br><span class="line"><span class="comment"> *               如果expires为null或者被忽略，则cookie在当前session有效，退出浏览器失效。</span></span><br><span class="line"><span class="comment"> *                            </span></span><br><span class="line"><span class="comment"> * @param &#123;string&#125; options.path - 设置cookie的页面路径；默认设置页面。</span></span><br><span class="line"><span class="comment"> * @param &#123;string&#125; options.domain - cookie的域地址 (default: 默认创建cookie页面).</span></span><br><span class="line"><span class="comment"> * @param &#123;Boolean&#125; options.secure - 设置给cookie之后，传递cookie给服务端</span></span><br><span class="line"><span class="comment"> *需要使用安全协议(例如:https)</span></span><br><span class="line"><span class="comment"> * @type undefined</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">$.cookie(<span class="string">'the_cookie'</span>, <span class="string">'the_value'</span>, &#123;<span class="attr">expires</span>: <span class="number">7</span>, <span class="attr">path</span>: <span class="string">'/'</span>, <span class="attr">domain</span>: <span class="string">'jquery.com'</span>, <span class="attr">secure</span>: <span class="literal">true</span>&#125;);</span><br></pre></td></tr></table></figure><h3 id="创建cookie"><a href="#创建cookie" class="headerlink" title="创建cookie"></a>创建cookie</h3><blockquote><p>设置cookie</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Set the value of a cookie.</span></span><br><span class="line">$.cookie(<span class="string">'the_cookie'</span>, <span class="string">'the_value'</span>);</span><br></pre></td></tr></table></figure><blockquote><p>使用options</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Create a cookie with all available options.</span></span><br><span class="line">$.cookie(<span class="string">'the_cookie'</span>, <span class="string">'the_value'</span>, &#123;<span class="attr">expires</span>: <span class="number">7</span>, <span class="attr">path</span>: <span class="string">'/'</span>, <span class="attr">domain</span>: <span class="string">'jquery.com'</span>, <span class="attr">secure</span>: <span class="literal">true</span>&#125;);</span><br></pre></td></tr></table></figure><blockquote><p>删除cookie</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Delete a cookie by passing null as value.</span></span><br><span class="line">$.cookie(<span class="string">'the_cookie'</span>, <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 注意版本</span></span><br><span class="line">$.removeCookie(<span class="string">'the_cookie'</span>, options);</span><br></pre></td></tr></table></figure><h3 id="读取cookie"><a href="#读取cookie" class="headerlink" title="读取cookie"></a>读取cookie</h3><blockquote><p>获取cookie</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$.cookie(<span class="string">'the_cookie'</span>);</span><br></pre></td></tr></table></figure><h2 id="source-code"><a href="#source-code" class="headerlink" title="source-code"></a>source-code</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*!</span></span><br><span class="line"><span class="comment"> * jQuery Cookie Plugin v1.4.1</span></span><br><span class="line"><span class="comment"> * https://github.com/carhartl/jquery-cookie</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Copyright 2013 Klaus Hartl</span></span><br><span class="line"><span class="comment"> * Released under the MIT license</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">factory</span>) </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">typeof</span> define === <span class="string">'function'</span> &amp;&amp; define.amd) &#123;</span><br><span class="line"><span class="comment">// AMD</span></span><br><span class="line">define([<span class="string">'jquery'</span>], factory);</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> exports === <span class="string">'object'</span>) &#123;</span><br><span class="line"><span class="comment">// CommonJS</span></span><br><span class="line">factory(<span class="built_in">require</span>(<span class="string">'jquery'</span>));</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="comment">// Browser globals</span></span><br><span class="line">factory(jQuery);</span><br><span class="line">&#125;</span><br><span class="line">&#125;(<span class="function"><span class="keyword">function</span> (<span class="params">$</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> pluses = <span class="regexp">/\+/g</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">encode</span>(<span class="params">s</span>) </span>&#123;</span><br><span class="line"><span class="keyword">return</span> config.raw ? s : <span class="built_in">encodeURIComponent</span>(s);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">decode</span>(<span class="params">s</span>) </span>&#123;</span><br><span class="line"><span class="keyword">return</span> config.raw ? s : <span class="built_in">decodeURIComponent</span>(s);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">stringifyCookieValue</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line"><span class="keyword">return</span> encode(config.json ? <span class="built_in">JSON</span>.stringify(value) : <span class="built_in">String</span>(value));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">parseCookieValue</span>(<span class="params">s</span>) </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (s.indexOf(<span class="string">'"'</span>) === <span class="number">0</span>) &#123;</span><br><span class="line"><span class="comment">// This is a quoted cookie as according to RFC2068, unescape...</span></span><br><span class="line">s = s.slice(<span class="number">1</span>, <span class="number">-1</span>).replace(<span class="regexp">/\\"/g</span>, <span class="string">'"'</span>).replace(<span class="regexp">/\\\\/g</span>, <span class="string">'\\'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line"><span class="comment">// Replace server-side written pluses with spaces.</span></span><br><span class="line"><span class="comment">// If we can't decode the cookie, ignore it, it's unusable.</span></span><br><span class="line"><span class="comment">// If we can't parse the cookie, ignore it, it's unusable.</span></span><br><span class="line">s = <span class="built_in">decodeURIComponent</span>(s.replace(pluses, <span class="string">' '</span>));</span><br><span class="line"><span class="keyword">return</span> config.json ? <span class="built_in">JSON</span>.parse(s) : s;</span><br><span class="line">&#125; <span class="keyword">catch</span>(e) &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">read</span>(<span class="params">s, converter</span>) </span>&#123;</span><br><span class="line"><span class="keyword">var</span> value = config.raw ? s : parseCookieValue(s);</span><br><span class="line"><span class="keyword">return</span> $.isFunction(converter) ? converter(value) : value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> config = $.cookie = <span class="function"><span class="keyword">function</span> (<span class="params">key, value, options</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Write</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (value !== <span class="literal">undefined</span> &amp;&amp; !$.isFunction(value)) &#123;</span><br><span class="line">options = $.extend(&#123;&#125;, config.defaults, options);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">typeof</span> options.expires === <span class="string">'number'</span>) &#123;</span><br><span class="line"><span class="keyword">var</span> days = options.expires, t = options.expires = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">t.setTime(+t + days * <span class="number">864e+5</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> (<span class="built_in">document</span>.cookie = [</span><br><span class="line">encode(key), <span class="string">'='</span>, stringifyCookieValue(value),</span><br><span class="line">options.expires ? <span class="string">'; expires='</span> + options.expires.toUTCString() : <span class="string">''</span>, <span class="comment">// use expires attribute, max-age is not supported by IE</span></span><br><span class="line">options.path    ? <span class="string">'; path='</span> + options.path : <span class="string">''</span>,</span><br><span class="line">options.domain  ? <span class="string">'; domain='</span> + options.domain : <span class="string">''</span>,</span><br><span class="line">options.secure  ? <span class="string">'; secure'</span> : <span class="string">''</span></span><br><span class="line">].join(<span class="string">''</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Read</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> result = key ? <span class="literal">undefined</span> : &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// To prevent the for loop in the first place assign an empty array</span></span><br><span class="line"><span class="comment">// in case there are no cookies at all. Also prevents odd result when</span></span><br><span class="line"><span class="comment">// calling $.cookie().</span></span><br><span class="line"><span class="keyword">var</span> cookies = <span class="built_in">document</span>.cookie ? <span class="built_in">document</span>.cookie.split(<span class="string">'; '</span>) : [];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, l = cookies.length; i &lt; l; i++) &#123;</span><br><span class="line"><span class="keyword">var</span> parts = cookies[i].split(<span class="string">'='</span>);</span><br><span class="line"><span class="keyword">var</span> name = decode(parts.shift());</span><br><span class="line"><span class="keyword">var</span> cookie = parts.join(<span class="string">'='</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (key &amp;&amp; key === name) &#123;</span><br><span class="line"><span class="comment">// If second argument (value) is a function it's a converter...</span></span><br><span class="line">result = read(cookie, value);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Prevent storing a cookie that we couldn't decode.</span></span><br><span class="line"><span class="keyword">if</span> (!key &amp;&amp; (cookie = read(cookie)) !== <span class="literal">undefined</span>) &#123;</span><br><span class="line">result[name] = cookie;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> result;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">config.defaults = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">$.removeCookie = <span class="function"><span class="keyword">function</span> (<span class="params">key, options</span>) </span>&#123;</span><br><span class="line"><span class="keyword">if</span> ($.cookie(key) === <span class="literal">undefined</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Must not alter options, thus extending a fresh object...</span></span><br><span class="line">$.cookie(key, <span class="string">''</span>, $.extend(&#123;&#125;, options, &#123; <span class="attr">expires</span>: <span class="number">-1</span> &#125;));</span><br><span class="line"><span class="keyword">return</span> !$.cookie(key);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">&#125;));</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;jQuery-cookie插件使用例子&quot;&gt;&lt;a href=&quot;#jQuery-cookie插件使用例子&quot; class=&quot;headerlink&quot; title=&quot;jQuery cookie插件使用例子&quot;&gt;&lt;/a&gt;jQuery cookie插件使用例子&lt;/h1&gt;&lt;bloc
      
    
    </summary>
    
      <category term="jQuery" scheme="https://betgar.github.io/categories/jQuery/"/>
    
      <category term="cookie" scheme="https://betgar.github.io/categories/jQuery/cookie/"/>
    
    
      <category term="jQuery" scheme="https://betgar.github.io/tags/jQuery/"/>
    
      <category term="cookie" scheme="https://betgar.github.io/tags/cookie/"/>
    
  </entry>
  
  <entry>
    <title>NPM的正确使用姿势</title>
    <link href="https://betgar.github.io/2018/01/08/how-to-use-utldtree/"/>
    <id>https://betgar.github.io/2018/01/08/how-to-use-utldtree/</id>
    <published>2018-01-08T12:00:00.000Z</published>
    <updated>2018-06-28T11:24:48.034Z</updated>
    
    <content type="html"><![CDATA[<h1 id="utldtree"><a href="#utldtree" class="headerlink" title="utldtree"></a>utldtree</h1><blockquote><p>utldtree.sql是Oracle 提供的一个分析依赖的sql文件。</p><p>路径：%ORACLE_CLIENT%\RDBMS\ADMIN</p><p>因为没有包含在数据库标准包中，所以需要<strong>自己手动在数据库中执行utldtree</strong>下。</p></blockquote><h2 id="utldtree创建的objects"><a href="#utldtree创建的objects" class="headerlink" title="utldtree创建的objects:"></a>utldtree创建的objects:</h2><blockquote><p>序列：deptree_seq</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; create sequence deptree_seq cache 200</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><blockquote><p>表：deptree_temptab</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt; create table deptree_temptab</span><br><span class="line">&gt; (</span><br><span class="line">&gt; object_id            number,</span><br><span class="line">&gt; referenced_object_id number,</span><br><span class="line">&gt; nest_level           number,</span><br><span class="line">&gt; seq#                 number      </span><br><span class="line">&gt; )</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><blockquote><p>视图：deptree，ideptree</p><p>过程：deptree_fill</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; create or replace procedure deptree_fill (type char, schema char, name char)</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><h2 id="生成依赖关系步骤"><a href="#生成依赖关系步骤" class="headerlink" title="生成依赖关系步骤"></a>生成依赖关系步骤</h2><h3 id="生成依赖关系"><a href="#生成依赖关系" class="headerlink" title="生成依赖关系"></a>生成依赖关系</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">-- 1.生成依赖关系</span><br><span class="line">-- 说明：每一次调用会“清空”表DEPTREE_TEMPTAB</span><br><span class="line">-- 参数说明：</span><br><span class="line">--  type：对象类型（table,view,procedure...）</span><br><span class="line">--  schema：当前用户名称</span><br><span class="line">--  name：对象名称（待查询的被人依赖的对象）</span><br><span class="line"></span><br><span class="line">CALL DEPTREE_FILL(&apos;PROCEDURE&apos;, &apos;EXCEL&apos;, &apos;CONCAT&apos;);</span><br></pre></td></tr></table></figure><h3 id="查询依赖关系结果1"><a href="#查询依赖关系结果1" class="headerlink" title="查询依赖关系结果1"></a>查询依赖关系结果1</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-- 2. 查询依赖关系结果</span><br><span class="line">-- 说明：</span><br><span class="line">--   这个视图附带嵌套层次</span><br><span class="line"></span><br><span class="line">SELECT * FROM DEPTREE D ORDER BY D.SEQ#;</span><br></pre></td></tr></table></figure><h3 id="查询依赖关系结果2"><a href="#查询依赖关系结果2" class="headerlink" title="查询依赖关系结果2"></a>查询依赖关系结果2</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-- 3. 查询依赖关系结果</span><br><span class="line">-- 说明：</span><br><span class="line">--   步骤：3和2一样，只是展示方式不同</span><br><span class="line"></span><br><span class="line">SELECT * FROM IDEPTREE;</span><br></pre></td></tr></table></figure><h3 id="动态语句中的object依赖无法分析"><a href="#动态语句中的object依赖无法分析" class="headerlink" title="动态语句中的object依赖无法分析"></a>动态语句中的object依赖无法分析</h3><blockquote><p>动态的SQL语句中的依赖关系是无法分析出来。所以建议少用动态语句。</p><p>动态语句解决方法：ASK TOM上提供了间接的方法。</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; </span><br><span class="line">1 CREATE or replace PROCEDURE testproc IS </span><br><span class="line">2 i PLS_INTEGER; </span><br><span class="line">3 var_table varchar2(7):=&apos;TESTTAB&apos;; </span><br><span class="line">-- 创建一个间接依赖，但是在过程中没有使用。</span><br><span class="line">4 cursor dummy is select * from TESTTAB; </span><br><span class="line">5 BEGIN </span><br><span class="line">6 execute immediate &apos;SELECT COUNT(*) FROM &apos;||var_table||&apos;&apos; INTO i; </span><br><span class="line">7 dbms_output.put_line(TO_CHAR(i)); </span><br><span class="line">8* END testproc; </span><br><span class="line">9 / </span><br><span class="line"></span><br><span class="line">Procedure created. </span><br><span class="line"></span><br><span class="line">Elapsed: 00:00:00.09 </span><br><span class="line">SQL&gt; exec dbms_utility.get_dependency(&apos;TABLE&apos;, &apos;DWHADMIN&apos;,&apos;TESTTAB&apos;);</span><br></pre></td></tr></table></figure><h3 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h3><p><a href="https://asktom.oracle.com/pls/apex/f?p=100:11:0::::P11_QUESTION_ID:128114400346342023" target="_blank" rel="noopener">how to find the dependencies of table?</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;utldtree&quot;&gt;&lt;a href=&quot;#utldtree&quot; class=&quot;headerlink&quot; title=&quot;utldtree&quot;&gt;&lt;/a&gt;utldtree&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;utldtree.sql是Oracle 提供的一个分析依赖的sql
      
    
    </summary>
    
      <category term="PLSQL" scheme="https://betgar.github.io/categories/PLSQL/"/>
    
    
      <category term="PLSQL" scheme="https://betgar.github.io/tags/PLSQL/"/>
    
      <category term="utldtree" scheme="https://betgar.github.io/tags/utldtree/"/>
    
  </entry>
  
  <entry>
    <title>Oracle 管理用户对象依赖关系</title>
    <link href="https://betgar.github.io/2018/01/08/how-to-find-schema-object-dependencies/"/>
    <id>https://betgar.github.io/2018/01/08/how-to-find-schema-object-dependencies/</id>
    <published>2018-01-08T12:00:00.000Z</published>
    <updated>2018-06-28T11:24:48.034Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Oracle-管理用户对象依赖关系"><a href="#Oracle-管理用户对象依赖关系" class="headerlink" title="Oracle 管理用户对象依赖关系"></a>Oracle 管理用户对象依赖关系</h2><blockquote><p>背景：</p><p>项目组使用很多的procedure作为取数接口，现在需要重构底层取数过程，但是无法找出“底层取数procedure”被哪些“逻辑对象”（procedure, function…etc.）依赖。无法评估影响的范围，Java服务端可以通过调用层次分析出，但是直接在数据库端，进行调用时就很难分析。</p><p>通过查找官方文档，找到两个方法，现在分享给大家。</p><p>方法：</p><ol><li>utldtree.sql</li><li>DBMS_UTILITY.get_dependency(type, schema, object_name);</li></ol></blockquote><h3 id="utldtree"><a href="#utldtree" class="headerlink" title="utldtree"></a>utldtree</h3><blockquote><p>utldtree.sql是Oracle 提供的一个分析依赖的sql文件。</p><p>路径：%ORACLE_CLIENT%\RDBMS\ADMIN</p><p>因为没有包含在数据库标准包中，所以需要<strong>自己手动在数据库中执行utldtree</strong>下。</p></blockquote><h4 id="utldtree创建的objects"><a href="#utldtree创建的objects" class="headerlink" title="utldtree创建的objects:"></a>utldtree创建的objects:</h4><blockquote><p>序列：deptree_seq</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; create sequence deptree_seq cache 200</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><blockquote><p>表：deptree_temptab</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt; create table deptree_temptab</span><br><span class="line">&gt; (</span><br><span class="line">&gt; object_id            number,</span><br><span class="line">&gt; referenced_object_id number,</span><br><span class="line">&gt; nest_level           number,</span><br><span class="line">&gt; seq#                 number      </span><br><span class="line">&gt; )</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><blockquote><p>视图：deptree，ideptree</p><p>过程：deptree_fill</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; create or replace procedure deptree_fill (type char, schema char, name char)</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><h4 id="utldtree生成依赖关系步骤"><a href="#utldtree生成依赖关系步骤" class="headerlink" title="utldtree生成依赖关系步骤"></a>utldtree生成依赖关系步骤</h4><h5 id="生成依赖关系"><a href="#生成依赖关系" class="headerlink" title="生成依赖关系"></a>生成依赖关系</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">-- 1.生成依赖关系</span><br><span class="line">-- 说明：每一次调用会“清空”表DEPTREE_TEMPTAB</span><br><span class="line">-- 参数说明：</span><br><span class="line">--  type：对象类型（table,view,procedure...）</span><br><span class="line">--  schema：当前用户名称</span><br><span class="line">--  name：对象名称（待查询的被人依赖的对象）</span><br><span class="line"></span><br><span class="line">CALL DEPTREE_FILL(&apos;PROCEDURE&apos;, &apos;FMIS0200&apos;, &apos;GET_ZWCS_DATA_KM&apos;);</span><br></pre></td></tr></table></figure><h5 id="查询依赖关系结果1"><a href="#查询依赖关系结果1" class="headerlink" title="查询依赖关系结果1"></a>查询依赖关系结果1</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-- 2. 查询依赖关系结果</span><br><span class="line">-- 说明：</span><br><span class="line">--   这个视图附带嵌套层次</span><br><span class="line"></span><br><span class="line">SELECT * FROM DEPTREE D ORDER BY D.SEQ#;</span><br></pre></td></tr></table></figure><h5 id="查询依赖关系结果2"><a href="#查询依赖关系结果2" class="headerlink" title="查询依赖关系结果2"></a>查询依赖关系结果2</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-- 3. 查询依赖关系结果</span><br><span class="line">-- 说明：</span><br><span class="line">--   步骤：3和2一样，只是展示方式不同</span><br><span class="line"></span><br><span class="line">SELECT * FROM IDEPTREE;</span><br></pre></td></tr></table></figure><h3 id="DBMS-UTILITY-get-dependency"><a href="#DBMS-UTILITY-get-dependency" class="headerlink" title="DBMS_UTILITY.get_dependency"></a>DBMS_UTILITY.get_dependency</h3><blockquote><p>oracle 11g R1开始提供管理object dependencies关系.</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">-- sql window 执行sql语句</span><br><span class="line">-- 参数说明：</span><br><span class="line">--   type：对象类型</span><br><span class="line">--   schema：模式名称（用户名称）</span><br><span class="line">--   name：object的对象名称</span><br><span class="line">call dbms_utility.get_dependency(&apos;PROCEDURE&apos;, &apos;LALAL&apos;, &apos;TEST&apos;);</span><br><span class="line"></span><br><span class="line">-- output tab页面查看结果</span><br><span class="line">/*</span><br><span class="line">DEPENDENCIES ON LALAL.TEST</span><br><span class="line">------------------------------------------------------------------</span><br><span class="line">...</span><br><span class="line">*/</span><br></pre></td></tr></table></figure><h3 id="动态语句中的object依赖无法分析"><a href="#动态语句中的object依赖无法分析" class="headerlink" title="动态语句中的object依赖无法分析"></a>动态语句中的object依赖无法分析</h3><blockquote><p>动态的SQL语句中的依赖关系是无法分析出来。所以建议少用动态语句。</p><p>动态语句解决方法：ASK TOM上提供了间接的方法。</p><p>在创建procedure或者function中在declare部分，创建一个显示依赖。</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"> CREATE or replace PROCEDURE testproc IS </span><br><span class="line"> i PLS_INTEGER; </span><br><span class="line"> var_table varchar2(7):=&apos;TESTTAB&apos;; </span><br><span class="line">-- 创建一个“直接”依赖，但是在过程中没有使用dummy变量。</span><br><span class="line"> cursor dummy is select * from TESTTAB; </span><br><span class="line"> BEGIN </span><br><span class="line">    -- 动态语句依赖的object(table对象)</span><br><span class="line"> execute immediate &apos;SELECT COUNT(*) FROM &apos;||var_table||&apos;&apos; INTO i; </span><br><span class="line"> dbms_output.put_line(TO_CHAR(i)); </span><br><span class="line"> END testproc; </span><br><span class="line"> / </span><br><span class="line">-- 查询依赖</span><br><span class="line">exec dbms_utility.get_dependency(&apos;TABLE&apos;, &apos;DWHADMIN&apos;,&apos;TESTTAB&apos;);</span><br></pre></td></tr></table></figure><p>虽然“动态语句依赖”在依赖关系中无法分析，但是在procedure的declare部分显示依赖了TESTTAB，所以使用Oracle的依赖管理还是可以找到“依赖关系”。</p><blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; -- 声明“游标”，oracle是只会分配“游标的储存空间”</span><br><span class="line">&gt; -- 不会真正执行sql语句取数，如果你怕影响性能，可以加上where条件，取数为0条记录即可。</span><br><span class="line">&gt; -- 详情可以查看where does the Cursor stores the rows?</span><br><span class="line">&gt; cursor dummy is select * from TESTTAB; </span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote><blockquote><p>显示依赖，但是不使用dummy变量，这是不好的实践。好的实践是要消灭动态SQL语句，因为动态带来了极大的维护成本。</p></blockquote><h3 id="附录-utldtree-sql（utldtree-is-stand-for-utility-deep-tree）"><a href="#附录-utldtree-sql（utldtree-is-stand-for-utility-deep-tree）" class="headerlink" title="附录-utldtree.sql（utldtree is stand for utility deep tree）"></a>附录-utldtree.sql（utldtree is stand for utility deep tree）</h3><blockquote><p>使用command window 执行它。</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line">Rem </span><br><span class="line">Rem $Header: utldtree.sql,v 1.2 1992/10/26 16:24:44 RKOOI Stab $ </span><br><span class="line">Rem </span><br><span class="line">Rem  Copyright (c) 1991 by Oracle Corporation </span><br><span class="line">Rem    NAME</span><br><span class="line">Rem      deptree.sql - Show objects recursively dependent on given object</span><br><span class="line">Rem    DESCRIPTION</span><br><span class="line">Rem      This procedure, view and temp table will allow you to see all</span><br><span class="line">Rem      objects that are (recursively) dependent on the given object.</span><br><span class="line">Rem      Note: you will only see objects for which you have permission.</span><br><span class="line">Rem      Examples:</span><br><span class="line">Rem        execute deptree_fill(&apos;procedure&apos;, &apos;scott&apos;, &apos;billing&apos;);</span><br><span class="line">Rem        select * from deptree order by seq#;</span><br><span class="line">Rem</span><br><span class="line">Rem        execute deptree_fill(&apos;table&apos;, &apos;scott&apos;, &apos;emp&apos;);</span><br><span class="line">Rem        select * from deptree order by seq#;</span><br><span class="line">Rem</span><br><span class="line">Rem        execute deptree_fill(&apos;package body&apos;, &apos;scott&apos;, &apos;accts_payable&apos;);</span><br><span class="line">Rem        select * from deptree order by seq#;</span><br><span class="line">Rem</span><br><span class="line">Rem        A prettier way to display this information than</span><br><span class="line">Remselect * from deptree order by seq#;</span><br><span class="line">Rem   is</span><br><span class="line">Rem             select * from ideptree;</span><br><span class="line">Rem        This shows the dependency relationship via indenting.  Notice</span><br><span class="line">Rem        that no order by clause is needed with ideptree.</span><br><span class="line">Rem    RETURNS</span><br><span class="line">Rem </span><br><span class="line">Rem    NOTES</span><br><span class="line">Rem      Run this script once for each schema that needs this utility.</span><br><span class="line">Rem      </span><br><span class="line">Rem    MODIFIED   (MM/DD/YY)</span><br><span class="line">Rem     rkooi      10/26/92 -  owner -&gt; schema for SQL2 </span><br><span class="line">Rem     glumpkin   10/20/92 -  Renamed from DEPTREE.SQL </span><br><span class="line">Rem     rkooi      09/02/92 -  change ORU errors </span><br><span class="line">Rem     rkooi      06/10/92 -  add rae errors </span><br><span class="line">Rem     rkooi      01/13/92 -  update for sys vs. regular user </span><br><span class="line">Rem     rkooi      01/10/92 -  fix ideptree </span><br><span class="line">Rem     rkooi      01/10/92 -  Better formatting, add ideptree view </span><br><span class="line">Rem     rkooi      12/02/91 -  deal with cursors </span><br><span class="line">Rem     rkooi      10/19/91 -  Creation </span><br><span class="line"></span><br><span class="line">drop sequence deptree_seq</span><br><span class="line">/</span><br><span class="line">create sequence deptree_seq cache 200 /* cache 200 to make sequence faster */</span><br><span class="line">/</span><br><span class="line">drop table deptree_temptab</span><br><span class="line">/</span><br><span class="line">create table deptree_temptab</span><br><span class="line">(</span><br><span class="line">  object_id            number,</span><br><span class="line">  referenced_object_id number,</span><br><span class="line">  nest_level           number,</span><br><span class="line">  seq#                 number      </span><br><span class="line">)</span><br><span class="line">/</span><br><span class="line">create or replace procedure deptree_fill (type char, schema char, name char) is</span><br><span class="line">  obj_id number;</span><br><span class="line">begin</span><br><span class="line">  delete from deptree_temptab;</span><br><span class="line">  commit;</span><br><span class="line">  select object_id into obj_id from all_objects</span><br><span class="line">    where owner        = upper(deptree_fill.schema)</span><br><span class="line">    and   object_name  = upper(deptree_fill.name)</span><br><span class="line">    and   object_type  = upper(deptree_fill.type);</span><br><span class="line">  insert into deptree_temptab</span><br><span class="line">    values(obj_id, 0, 0, 0);</span><br><span class="line">  insert into deptree_temptab</span><br><span class="line">    select object_id, referenced_object_id,</span><br><span class="line">        level, deptree_seq.nextval</span><br><span class="line">      from public_dependency</span><br><span class="line">      connect by prior object_id = referenced_object_id</span><br><span class="line">      start with referenced_object_id = deptree_fill.obj_id;</span><br><span class="line">exception</span><br><span class="line">  when no_data_found then</span><br><span class="line">    raise_application_error(-20000, &apos;ORU-10013: &apos; ||</span><br><span class="line">      type || &apos; &apos; || schema || &apos;.&apos; || name || &apos; was not found.&apos;);</span><br><span class="line">end;</span><br><span class="line">/</span><br><span class="line"></span><br><span class="line">drop view deptree</span><br><span class="line">/</span><br><span class="line"></span><br><span class="line">set echo on</span><br><span class="line"></span><br><span class="line">REM This view will succeed if current user is sys.  This view shows </span><br><span class="line">REM which shared cursors depend on the given object.  If the current</span><br><span class="line">REM user is not sys, then this view get an error either about lack</span><br><span class="line">REM of privileges or about the non-existence of table x$kglxs.</span><br><span class="line"></span><br><span class="line">set echo off</span><br><span class="line">create view sys.deptree</span><br><span class="line">  (nested_level, type, schema, name, seq#)</span><br><span class="line">as</span><br><span class="line">  select d.nest_level, o.object_type, o.owner, o.object_name, d.seq#</span><br><span class="line">  from deptree_temptab d, dba_objects o</span><br><span class="line">  where d.object_id = o.object_id (+)</span><br><span class="line">union all</span><br><span class="line">  select d.nest_level+1, &apos;CURSOR&apos;, &apos;&lt;shared&gt;&apos;, &apos;&quot;&apos;||c.kglnaobj||&apos;&quot;&apos;, d.seq#+.5</span><br><span class="line">  from deptree_temptab d, x$kgldp k, x$kglob g, obj$ o, user$ u, x$kglob c,</span><br><span class="line">      x$kglxs a</span><br><span class="line">    where d.object_id = o.obj#</span><br><span class="line">    and   o.name = g.kglnaobj</span><br><span class="line">    and   o.owner# = u.user#</span><br><span class="line">    and   u.name = g.kglnaown</span><br><span class="line">    and   g.kglhdadr = k.kglrfhdl</span><br><span class="line">    and   k.kglhdadr = a.kglhdadr   /* make sure it is not a transitive */</span><br><span class="line">    and   k.kgldepno = a.kglxsdep   /* reference, but a direct one */</span><br><span class="line">    and   k.kglhdadr = c.kglhdadr</span><br><span class="line">    and   c.kglhdnsp = 0 /* a cursor */</span><br><span class="line">/</span><br><span class="line"></span><br><span class="line">set echo on</span><br><span class="line"></span><br><span class="line">REM This view will succeed if current user is not sys.  This view</span><br><span class="line">REM does *not* show which shared cursors depend on the given object.</span><br><span class="line">REM If the current user is sys then this view will get an error </span><br><span class="line">REM indicating that the view already exists (since prior view create</span><br><span class="line">REM will have succeeded).</span><br><span class="line"></span><br><span class="line">set echo off</span><br><span class="line">create view deptree</span><br><span class="line">  (nested_level, type, schema, name, seq#)</span><br><span class="line">as</span><br><span class="line">  select d.nest_level, o.object_type, o.owner, o.object_name, d.seq#</span><br><span class="line">  from deptree_temptab d, all_objects o</span><br><span class="line">  where d.object_id = o.object_id (+)</span><br><span class="line">/</span><br><span class="line"></span><br><span class="line">drop view ideptree</span><br><span class="line">/</span><br><span class="line">create view ideptree (dependencies)</span><br><span class="line">as</span><br><span class="line">  select lpad(&apos; &apos;,3*(max(nested_level))) || max(nvl(type, &apos;&lt;no permission&gt;&apos;)</span><br><span class="line">    || &apos; &apos; || schema || decode(type, NULL, &apos;&apos;, &apos;.&apos;) || name)</span><br><span class="line">  from deptree</span><br><span class="line">  group by seq# /* So user can omit sort-by when selecting from ideptree */</span><br><span class="line">/</span><br></pre></td></tr></table></figure><h3 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h3><p><a href="https://asktom.oracle.com/pls/apex/f?p=100:11:0::::P11_QUESTION_ID:128114400346342023" target="_blank" rel="noopener">how to find the dependencies of table?</a></p><p><a href="https://asktom.oracle.com/pls/asktom/f?p=100:11:0::::P11_QUESTION_ID:213366500346264333" target="_blank" rel="noopener">where does the Cursor stores the rows?</a></p><p>6-schema object dependencies (Oracle Database Concepts, 11g Release 1)</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;Oracle-管理用户对象依赖关系&quot;&gt;&lt;a href=&quot;#Oracle-管理用户对象依赖关系&quot; class=&quot;headerlink&quot; title=&quot;Oracle 管理用户对象依赖关系&quot;&gt;&lt;/a&gt;Oracle 管理用户对象依赖关系&lt;/h2&gt;&lt;blockquote&gt;

      
    
    </summary>
    
      <category term="Oracle" scheme="https://betgar.github.io/categories/Oracle/"/>
    
    
      <category term="Oracle" scheme="https://betgar.github.io/tags/Oracle/"/>
    
      <category term="PLSQL" scheme="https://betgar.github.io/tags/PLSQL/"/>
    
  </entry>
  
  <entry>
    <title>excel的concatenate函数</title>
    <link href="https://betgar.github.io/2017/12/28/excel-function-concatenate/"/>
    <id>https://betgar.github.io/2017/12/28/excel-function-concatenate/</id>
    <published>2017-12-28T12:00:00.000Z</published>
    <updated>2018-06-28T11:24:48.034Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Excel的concatenate函数"><a href="#Excel的concatenate函数" class="headerlink" title="Excel的concatenate函数"></a>Excel的concatenate函数</h1><blockquote><p>Excel中的字符串连接函数，类似一些concat函数。</p><p>限制：最多支持255个参数连接。</p><p>注意：连接字符时，每一个字符当成一个元素看待。</p></blockquote><p>栗子：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 连接单元格，B2,C2,D2内容</span></span><br><span class="line">CONCATENATE(B2,C2,D2)</span><br></pre></td></tr></table></figure><h2 id="concatenate生成sql语句"><a href="#concatenate生成sql语句" class="headerlink" title="concatenate生成sql语句"></a>concatenate生成sql语句</h2><blockquote><p>如果想把Excel，然后想导入数据库，这种方式比较方便。</p></blockquote><h3 id="字符串和数字类型"><a href="#字符串和数字类型" class="headerlink" title="字符串和数字类型"></a>字符串和数字类型</h3><blockquote><p>字符串和数字类型的连接方式</p></blockquote><p>栗子：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// 字符串：B2</span><br><span class="line">// 数字: C2,D2</span><br><span class="line">CONCATENATE(&quot;INSERT INTO TEST () VALUES(&quot;, &apos;&quot;, B2, &quot;&apos;&quot;, &quot;,&quot;, C2, &quot;,&quot;, D2, &quot;);&quot;)</span><br><span class="line"></span><br><span class="line">// 单元格栏输入：A2:A200</span><br><span class="line">// A2:A200 ：能够选中A2-A200的单元格</span><br><span class="line">// 公式栏输入：公式</span><br><span class="line">// 输入公式，CTRL+ENTER，A2:A200都会填充一样的公式。</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Excel的concatenate函数&quot;&gt;&lt;a href=&quot;#Excel的concatenate函数&quot; class=&quot;headerlink&quot; title=&quot;Excel的concatenate函数&quot;&gt;&lt;/a&gt;Excel的concatenate函数&lt;/h1&gt;&lt;bloc
      
    
    </summary>
    
      <category term="Excel" scheme="https://betgar.github.io/categories/Excel/"/>
    
    
      <category term="Excel" scheme="https://betgar.github.io/tags/Excel/"/>
    
  </entry>
  
  <entry>
    <title>PL/SQL注释风格</title>
    <link href="https://betgar.github.io/2017/12/21/plsql-comment-style/"/>
    <id>https://betgar.github.io/2017/12/21/plsql-comment-style/</id>
    <published>2017-12-21T12:00:00.000Z</published>
    <updated>2018-06-28T11:24:48.034Z</updated>
    
    <content type="html"><![CDATA[<h1 id="PL-SQL注释风格"><a href="#PL-SQL注释风格" class="headerlink" title="PL/SQL注释风格"></a>PL/SQL注释风格</h1><h2 id="PL-SQL-Comment-Style"><a href="#PL-SQL-Comment-Style" class="headerlink" title="PL/SQL Comment Style"></a>PL/SQL Comment Style</h2><blockquote><p>常常纠结程序的编程风格和注释的风格。PL/SQL中的编程风格也是各种流派，所以我就看了下Oracle内置函数的编程风格和注释风格，自己总结了下，记录下来，当作参考。</p></blockquote><h3 id="Document-Style"><a href="#Document-Style" class="headerlink" title="Document Style"></a>Document Style</h3><figure class="highlight pl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">----------------</span><br><span class="line">--  主题(大写)</span><br><span class="line">--</span><br><span class="line">--  正文开始</span><br><span class="line">--  啦啦啦啦</span><br><span class="line">--  第一段落结束.</span><br><span class="line">-- </span><br><span class="line">--  第二段开始</span><br><span class="line">--  啦啦啦</span><br><span class="line">--  第二段结束。</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line">-- 主题<span class="number">1</span></span><br><span class="line">-- </span><br><span class="line">-- 正文开始</span><br><span class="line">-- 正文结束。</span><br></pre></td></tr></table></figure><h3 id="Procedure-Example"><a href="#Procedure-Example" class="headerlink" title="Procedure Example"></a>Procedure Example</h3><blockquote><p>存储过程栗子</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">procedure waitany(name out varchar2,</span><br><span class="line">                    message out varchar2,</span><br><span class="line">                    status out integer,</span><br><span class="line">                    timeout in number default maxwait);</span><br><span class="line">--  描述过程的作用...</span><br><span class="line">--   接着说...</span><br><span class="line">--  输入参数：</span><br><span class="line">--    第一个参数：...</span><br><span class="line">--      第一个参数参数描述...</span><br><span class="line">--    第N个参数: ....</span><br><span class="line">--  输出参数(返回值)：</span><br><span class="line">--    第一个参数： ...</span><br><span class="line">--  异常处理：...</span><br><span class="line">--    处理描述...</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">procedure waitany(name out varchar2,</span><br><span class="line">                    message out varchar2,</span><br><span class="line">                    status out integer,</span><br><span class="line">                    timeout in number default maxwait);</span><br><span class="line">  --  Wait for an alert to occur for any of the alerts for which this</span><br><span class="line">  --    session is registered.  Although probably unusual, the same session</span><br><span class="line">  --    that waits for the alert may also first signal the alert.  In this</span><br><span class="line">  --    case remember to commit after the signal and prior to the wait.</span><br><span class="line">  --    Otherwise a lock request exception (status 4) will occur.  This</span><br><span class="line">  --    call always performs a commit.</span><br><span class="line">  --  Input parameters:</span><br><span class="line">  --    timeout</span><br><span class="line">  --      The maximum time to wait for an alert.  If no alert occurs before</span><br><span class="line">  --      timeout seconds, then this call will return with status of 1.</span><br><span class="line">  --  Output parameters:</span><br><span class="line">  --    name</span><br><span class="line">  --      The name of the alert that occurred, in uppercase.</span><br><span class="line">  --    message</span><br><span class="line">  --      The message associated with the alert.  This is the message</span><br><span class="line">  --      provided by the &apos;signal&apos; call.  Note that if multiple signals</span><br><span class="line">  --      on this alert occurred before the waitany call, then the message</span><br><span class="line">  --      will correspond to the most recent signal call.  Messages from</span><br><span class="line">  --      prior signal calls will be discarded.</span><br><span class="line">  --    status</span><br><span class="line">  --      0 - alert occurred</span><br><span class="line">  --      1 - timeout occurred</span><br><span class="line">  --  Errors raised:</span><br><span class="line">  --    -20000, ORU-10024: there are no alerts registered.</span><br><span class="line">  --       Cause: You must register an alert before waiting.</span><br><span class="line">  --</span><br></pre></td></tr></table></figure><h3 id="DBMS-ALERT-Example"><a href="#DBMS-ALERT-Example" class="headerlink" title="DBMS_ALERT Example"></a>DBMS_ALERT Example</h3><blockquote><p>oracle中的DBMS_ALERT栗子。</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br></pre></td><td class="code"><pre><span class="line">create or replace package sys.dbms_alert is</span><br><span class="line"></span><br><span class="line">  ------------</span><br><span class="line">  --  OVERVIEW</span><br><span class="line">  --</span><br><span class="line">  --  This package provides support for the asynchronous (as opposed to</span><br><span class="line">  --  polling) notification of database events.  By appropriate use of</span><br><span class="line">  --  this package and database triggers, an application can cause itself</span><br><span class="line">  --  to be notified whenever values of interest in the database are</span><br><span class="line">  --  changed.</span><br><span class="line">  --</span><br><span class="line">  --  For example, suppose a graphics tool is displaying a graph of some</span><br><span class="line">  --  data from a database table.  The graphics tool can, after reading and</span><br><span class="line">  --  graphing the data, wait on a database alert (&apos;dbms_alert.waitone&apos;)</span><br><span class="line">  --  covering the data just read.  The tool will automatically wake up when</span><br><span class="line">  --  the data is changed by any other user.  All that is required is that a</span><br><span class="line">  --  trigger be placed on the database table which then performs a signal</span><br><span class="line">  --  (&apos;dbms_alert.signal&apos;) whenever the trigger is fired.</span><br><span class="line">  --</span><br><span class="line">  --  Alerts are transaction based.  This means that the waiting session</span><br><span class="line">  --  does not get alerted until the transaction signalling the alert commits.</span><br><span class="line">  --</span><br><span class="line">  --  There can be any number of concurrent signallers of a given alert, and</span><br><span class="line">  --  there can be any number of concurrent waiters on a given alert.</span><br><span class="line">  --</span><br><span class="line">  --  A waiting application will be blocked in the database and cannot do</span><br><span class="line">  --  any other work.</span><br><span class="line">  --</span><br><span class="line">  --  Most of the calls in the package, except for &apos;signal&apos;, do commits.</span><br><span class="line">  --</span><br><span class="line"></span><br><span class="line">  -----------</span><br><span class="line">  --  EXAMPLE</span><br><span class="line">  --</span><br><span class="line">  --  Suppose the application wishes to graph average salaries, say by</span><br><span class="line">  --  department, for all employees.  So the application needs to know</span><br><span class="line">  --  whenever &apos;emp&apos; is changed.  The application would look like this:</span><br><span class="line">  --</span><br><span class="line">  --      dbms_alert.register(&apos;emp_table_alert&apos;);</span><br><span class="line">  --    readagain:</span><br><span class="line">  --      &lt;read the emp table and graph it&gt;</span><br><span class="line">  --      dbms_alert.waitone(&apos;emp_table_alert&apos;, :message, :status);</span><br><span class="line">  --      if status = 0 then goto readagain; else &lt;error condition&gt;</span><br><span class="line">  --</span><br><span class="line">  --  The &apos;emp&apos; table would have a trigger similar to the following:</span><br><span class="line">  --</span><br><span class="line">  --    create trigger emptrig after insert or update or delete on emp</span><br><span class="line">  --    begin</span><br><span class="line">  --      dbms_alert.signal(&apos;emp_table_alert&apos;, &apos;message_text&apos;);</span><br><span class="line">  --    end;</span><br><span class="line">  --</span><br><span class="line">  --  When the application is no longer interested in the alert, it does</span><br><span class="line">  --    dbms_alert.remove(&apos;emp_table_alert&apos;);</span><br><span class="line">  --  This is important since it reduces the amount of work required by</span><br><span class="line">  --  the alert signaller.</span><br><span class="line">  --</span><br><span class="line">  --  If a session exits (or dies) while there exist registered alerts,</span><br><span class="line">  --  they will eventually be cleaned up by future users of this package.</span><br><span class="line">  --</span><br><span class="line">  --  The above example guarantees that the application will always see</span><br><span class="line">  --  the latest data, although it may not see every intermediate value.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  --------------</span><br><span class="line">  --  VARIATIONS</span><br><span class="line">  --</span><br><span class="line">  --  The application can register for multiple events and can then wait for</span><br><span class="line">  --  any of them to occur using the &apos;waitany&apos; call.</span><br><span class="line">  --</span><br><span class="line">  --  An application can also supply an optional &apos;timeout&apos; parameter to the</span><br><span class="line">  --  &apos;waitone&apos; or &apos;waitany&apos; calls.  A &apos;timeout&apos; of 0 returns immediately</span><br><span class="line">  --  if there is no pending alert.</span><br><span class="line">  --</span><br><span class="line">  --  The signalling session can optionally pass a message which will be</span><br><span class="line">  --  received by the waiting session.</span><br><span class="line">  --</span><br><span class="line">  --  Alerts may be signalled more often than the corresponding application</span><br><span class="line">  --  &apos;wait&apos; calls.  In such cases the older alerts are discaded.  The</span><br><span class="line">  --  application always gets the latest alert (based on transaction commit</span><br><span class="line">  --  times).</span><br><span class="line">  --</span><br><span class="line">  --  If the application does not require transaction based alerts, then the</span><br><span class="line">  --  &apos;dbms_pipe&apos; package may provide a useful alternative</span><br><span class="line">  --</span><br><span class="line">  --  If the transaction is rolled back after the call to &apos;dbms_alert.signal&apos;,</span><br><span class="line">  --  no alert will occur.</span><br><span class="line">  --</span><br><span class="line">  --  It is possible to receive an alert, read the data, and find that no</span><br><span class="line">  --  data has changed.  This is because the data changed after the *prior*</span><br><span class="line">  --  alert, but before the data was read for that *prior* alert.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  --------------------------</span><br><span class="line">  --  IMPLEMENTATION DETAILS</span><br><span class="line">  --</span><br><span class="line">  --  In most cases the implementation is event-driven, i.e., there are no</span><br><span class="line">  --  polling loops.  There are two cases where polling loops can occur:</span><br><span class="line">  --</span><br><span class="line">  --    1) Parallel mode.  If your database is running parallel mode then</span><br><span class="line">  --       a polling loop is required to check for alerts from another</span><br><span class="line">  --       instance.  The polling loop defaults to one second and is settable</span><br><span class="line">  --       by the &apos;set_defaults&apos; call.</span><br><span class="line">  --    2) Waitany call.  If you use the &apos;waitany&apos; call, and a signalling</span><br><span class="line">  --       session does a signal but does not commit within one second of the</span><br><span class="line">  --       signal, then a polling loop is required so that this uncommitted</span><br><span class="line">  --       alert does not camouflage other alerts.  The polling loop begins</span><br><span class="line">  --       at a one second interval and exponentially backs off to 30 second</span><br><span class="line">  --       intervals.</span><br><span class="line">  --</span><br><span class="line">  --  This package uses the dbms_lock package (for synchronization between</span><br><span class="line">  --  signallers and waiters) and the dbms_pipe package (for asynchronous</span><br><span class="line">  --  event dispatching).</span><br><span class="line"></span><br><span class="line">  -------------------------------------------------------</span><br><span class="line">  --  INTERACTION WITH MULTI-THREADED AND PARALLEL SERVER</span><br><span class="line">  --</span><br><span class="line">  --  When running with the parallel server AND multi-threaded server, a</span><br><span class="line">  --  multi-threaded (dispatcher) &quot;shared server&quot; will be bound to a</span><br><span class="line">  --  session (and therefore not shareable) during the time a session has</span><br><span class="line">  --  any alerts &quot;registered&quot;, OR from the time a session &quot;signals&quot; an</span><br><span class="line">  --  alert until the time the session commits.  Therefore, applications</span><br><span class="line">  --  which register for alerts should use &quot;dedicated servers&quot; rather than</span><br><span class="line">  --  connecting through the dispatcher (to a &quot;shared server&quot;) since</span><br><span class="line">  --  registration typically lasts for a long time, and applications which</span><br><span class="line">  --  cause &quot;signals&quot; should have relatively short transactions so as not</span><br><span class="line">  --  to tie up &quot;shared servers&quot; for too long.</span><br><span class="line"></span><br><span class="line">  ------------</span><br><span class="line">  --  SECURITY</span><br><span class="line">  --</span><br><span class="line">  --  Security on this package may be controlled by granting execute on</span><br><span class="line">  --  this package to just those users or roles that you trust.  You may</span><br><span class="line">  --  wish to write a cover package on top of this one which restricts</span><br><span class="line">  --  the alertnames used.  Execute privilege on this cover package can</span><br><span class="line">  --  then be granted rather than on this package.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  -------------</span><br><span class="line">  --  RESOURCES</span><br><span class="line">  --</span><br><span class="line">  --  This package uses one database pipe and two locks for each alert a</span><br><span class="line">  --  session has registered.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  ---------------------</span><br><span class="line">  --  SPECIAL CONSTANTS</span><br><span class="line">  --</span><br><span class="line">  maxwait constant integer :=  86400000; -- 1000 days</span><br><span class="line">  --  The maximum time to wait for an alert (essentially forever).</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  ----------------------------</span><br><span class="line">  --  PROCEDURES AND FUNCTIONS</span><br><span class="line">  --</span><br><span class="line">  procedure set_defaults(sensitivity in number);</span><br><span class="line">  --  Set various defaults for this package.</span><br><span class="line">  --  Input parameters:</span><br><span class="line">  --    sensitivity</span><br><span class="line">  --      In case a polling loop is required (see &quot;Implementation Details&quot;</span><br><span class="line">  --      above), this is the time to sleep between polls.  Deafult is 5 sec.</span><br><span class="line">  --</span><br><span class="line">  procedure register(name in varchar2, cleanup in boolean default TRUE);</span><br><span class="line">  --  Register interest in an alert.  A session may register interest in</span><br><span class="line">  --    an unlimited number of alerts.  Alerts should be de-registered when</span><br><span class="line">  --    the session no longer has any interest (see &apos;remove&apos;).  This call</span><br><span class="line">  --    always performs a &apos;commit&apos;.</span><br><span class="line">  --  Input parameters:</span><br><span class="line">  --    name</span><br><span class="line">  --      The name of the alert in which this session is interested.</span><br><span class="line">  --      WARNING:  Alert names beginning with &apos;ORA$&apos; are reserved for use for</span><br><span class="line">  --      products provided by Oracle Corporation.  Name must be 30 bytes</span><br><span class="line">  --      or less.  The name is case-insensitive.</span><br><span class="line">  --    cleanup</span><br><span class="line">  --      This specifies whether we should perform cleanup of any orphaned</span><br><span class="line">  --      pipes that may exist and are used by the dbms_alert package. This</span><br><span class="line">  --      cleanup is only performed on the first call to &quot;register&quot; for each</span><br><span class="line">  --      package instantiation. The default for the parameter is TRUE.</span><br><span class="line">  --</span><br><span class="line">  procedure remove(name in varchar2);</span><br><span class="line">  --  Remove alert from registration list.  Do this when the session is no</span><br><span class="line">  --    longer interested in an alert.  Removing an alert is important</span><br><span class="line">  --    since it will reduce the amount of work done by signalers of the alert.</span><br><span class="line">  --    If a session dies without removing the alert, that alert will</span><br><span class="line">  --    eventually (but not immediately) be cleaned up.  This call always</span><br><span class="line">  --    performs a commit.</span><br><span class="line">  --  Input parameters:</span><br><span class="line">  --    name</span><br><span class="line">  --      The name of the alert to be removed from registration list. The</span><br><span class="line">  --      name is case-insensitive.</span><br><span class="line">  --</span><br><span class="line">  procedure removeall;</span><br><span class="line">  --  Remove all alerts for this session from registration list.  Do this</span><br><span class="line">  --    when the session is no longer interested in any alerts.  Removing</span><br><span class="line">  --    alerts is important since it will reduce the amount of work done</span><br><span class="line">  --    by signalers of the alert.  If a session dies without removing all</span><br><span class="line">  --    of its alerts, the alerts will eventually (but not immediately)</span><br><span class="line">  --    be cleaned up.  This call always performs a commit.</span><br><span class="line">  --</span><br><span class="line">  --    This procedure is called automatically upon first reference to this</span><br><span class="line">  --    package during a session.  Therefore no alerts from prior sessions</span><br><span class="line">  --    which may have terminated abnormally can affect this session.</span><br><span class="line">  procedure waitany(name out varchar2,</span><br><span class="line">                    message out varchar2,</span><br><span class="line">                    status out integer,</span><br><span class="line">                    timeout in number default maxwait);</span><br><span class="line">  --  Wait for an alert to occur for any of the alerts for which this</span><br><span class="line">  --    session is registered.  Although probably unusual, the same session</span><br><span class="line">  --    that waits for the alert may also first signal the alert.  In this</span><br><span class="line">  --    case remember to commit after the signal and prior to the wait.</span><br><span class="line">  --    Otherwise a lock request exception (status 4) will occur.  This</span><br><span class="line">  --    call always performs a commit.</span><br><span class="line">  --  Input parameters:</span><br><span class="line">  --    timeout</span><br><span class="line">  --      The maximum time to wait for an alert.  If no alert occurs before</span><br><span class="line">  --      timeout seconds, then this call will return with status of 1.</span><br><span class="line">  --  Output parameters:</span><br><span class="line">  --    name</span><br><span class="line">  --      The name of the alert that occurred, in uppercase.</span><br><span class="line">  --    message</span><br><span class="line">  --      The message associated with the alert.  This is the message</span><br><span class="line">  --      provided by the &apos;signal&apos; call.  Note that if multiple signals</span><br><span class="line">  --      on this alert occurred before the waitany call, then the message</span><br><span class="line">  --      will correspond to the most recent signal call.  Messages from</span><br><span class="line">  --      prior signal calls will be discarded.</span><br><span class="line">  --    status</span><br><span class="line">  --      0 - alert occurred</span><br><span class="line">  --      1 - timeout occurred</span><br><span class="line">  --  Errors raised:</span><br><span class="line">  --    -20000, ORU-10024: there are no alerts registered.</span><br><span class="line">  --       Cause: You must register an alert before waiting.</span><br><span class="line">  --</span><br><span class="line">  procedure waitone(name in varchar2,</span><br><span class="line">                    message out varchar2,</span><br><span class="line">                    status out integer,</span><br><span class="line">                    timeout in number default maxwait);</span><br><span class="line">  --  Wait for specified alert to occur. If the alert was signalled since</span><br><span class="line">  --    the register or last waitone/waitany, then this call will return</span><br><span class="line">  --    immediately.  The same session that waits for the alert may also</span><br><span class="line">  --    first signal the alert.  In this case remember to commit after the</span><br><span class="line">  --    signal and prior to the wait.  Otherwise a lock request exception</span><br><span class="line">  --    (status 4) will occur.  This call always performs a commit.</span><br><span class="line">  --  Input parameters:</span><br><span class="line">  --    name</span><br><span class="line">  --      The name of the alert to wait for. The name is case-insensitive.</span><br><span class="line">  --    timeout</span><br><span class="line">  --      The maximum time to wait for this alert.  If no alert occurs before</span><br><span class="line">  --      timeout seconds, then this call will return with status of 1.</span><br><span class="line">  --      If the named alert has not been registered then the this call</span><br><span class="line">  --      will return after the timeout period expires.</span><br><span class="line">  --  Output parameters:</span><br><span class="line">  --    message</span><br><span class="line">  --      The message associated with the alert.  This is the message</span><br><span class="line">  --      provided by the &apos;signal&apos; call.  Note that if multiple signals</span><br><span class="line">  --      on this alert occurred before the waitone call, then the message</span><br><span class="line">  --      will correspond to the most recent signal call.  Messages from</span><br><span class="line">  --      prior signal calls will be discarded.  The message may be up to</span><br><span class="line">  --      1800 bytes.</span><br><span class="line">  --    status</span><br><span class="line">  --      0 - alert occurred</span><br><span class="line">  --      1 - timeout occurred</span><br><span class="line">  --</span><br><span class="line">  procedure signal(name in varchar2,</span><br><span class="line">                   message in varchar2);</span><br><span class="line">  --  Signal an alert.</span><br><span class="line">  --  Input parameters:</span><br><span class="line">  --    name</span><br><span class="line">  --      Name of the alert to signal.  The effect of the signal call only</span><br><span class="line">  --      occurs when the transaction in which it is made commits.  If the</span><br><span class="line">  --      transaction rolls back, then the effect of the signal call is as</span><br><span class="line">  --      if it had never occurred.  All sessions that have registered</span><br><span class="line">  --      interest in this alert will be notified.  If the interested sessions</span><br><span class="line">  --      are currently waiting, they will be awakened.  If the interested</span><br><span class="line">  --      sessions are not currently waiting, then they will be notified the</span><br><span class="line">  --      next time they do a wait call.  Multiple sessions may concurrently</span><br><span class="line">  --      perform signals on the same alert.  However the first session</span><br><span class="line">  --      will block concurrent sessions until the first session commits.</span><br><span class="line">  --      Name must be 30 bytes or less. It is case-insensitive.  This call</span><br><span class="line">  --      does not perform a commit.</span><br><span class="line">  --    message</span><br><span class="line">  --      Message to associate with this alert.  This will be passed to</span><br><span class="line">  --      the waiting session.  The waiting session may be able to avoid</span><br><span class="line">  --      reading the database after the alert occurs by using the</span><br><span class="line">  --      information in this message.  The message must be 1800 bytes or less.</span><br><span class="line"></span><br><span class="line">end;</span><br></pre></td></tr></table></figure><h3 id="注释模版"><a href="#注释模版" class="headerlink" title="注释模版"></a>注释模版</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br></pre></td><td class="code"><pre><span class="line">CREATE OR REPLACE PROCEDURE TEST_PA_COMMENT_STYLE(I_COMP_ID    IN VARCHAR2, -- 1</span><br><span class="line">                                                  I_MODE_IDS   IN VARCHAR2, -- 2</span><br><span class="line">                                                  I_OBJ_TYPES  IN VARCHAR2, -- 3</span><br><span class="line">                                                  I_OBJECTS    IN VARCHAR2, -- 4</span><br><span class="line">                                                  I_DATE_POINT IN VARCHAR2 -- 5</span><br><span class="line">                                                  ) IS</span><br><span class="line">  -------------------------------</span><br><span class="line">  -- TEST_PA_COMMENT_STYLE：                                                      </span><br><span class="line">  -- 功能：</span><br><span class="line">  --   根据对方数据添加“清理关键字”, </span><br><span class="line">  --   根据“借方”或者“借方”给对方添加关键字.    </span><br><span class="line">  -- 编写人：LJN</span><br><span class="line">  -- 编写日期：2017-12-26</span><br><span class="line">  -- 内部提交(commit): NO</span><br><span class="line">  --</span><br><span class="line">  -- 策略(vpd)：</span><br><span class="line">  --   时间和单位</span><br><span class="line">  --</span><br><span class="line">  -- 中间表（temporary table）：</span><br><span class="line">  --   1. GT_GET_GLDX_SES</span><br><span class="line">  --   2. GT_GET_KMTMP_SES</span><br><span class="line"></span><br><span class="line">  -----------------------</span><br><span class="line">  -- 输入（IN）参数说明：</span><br><span class="line">  -- I_OBJ_TYPES：</span><br><span class="line">  --   单位id</span><br><span class="line">  -- I_MODE_IDS: </span><br><span class="line">  --   清理方式id，多个逗号分隔.</span><br><span class="line">  -- I_OBJ_TYPES：</span><br><span class="line">  --   管理对象类型id，多个逗号分隔.</span><br><span class="line">  -- I_OBJECTS：</span><br><span class="line">  --   管理对象id.</span><br><span class="line">  -- I_DATE_POINT：</span><br><span class="line">  --   时间点；格式YYYY-MM-DD.</span><br><span class="line"></span><br><span class="line">  ---------------</span><br><span class="line">  -- 输出(out)参数：</span><br><span class="line">  --</span><br><span class="line"></span><br><span class="line">  ---------------</span><br><span class="line">  -- 异常说明：</span><br><span class="line">  --   E_IN_PARAM_EMPTY_EX</span><br><span class="line">  --     参数为空异常</span><br><span class="line"></span><br><span class="line">  -----------</span><br><span class="line">  -- 变量声明</span><br><span class="line">  --   V_SQL：</span><br><span class="line">  --     SQL语句.</span><br><span class="line"></span><br><span class="line">  ----------</span><br><span class="line">  -- 子程序</span><br><span class="line">  --   FU_ADD_QUOTES_STR</span><br><span class="line">  --     添加英文引号</span><br><span class="line">  --   FU_BUILD_IN_CONDITION</span><br><span class="line">  --     构建IN条件</span><br><span class="line"></span><br><span class="line">  -----------</span><br><span class="line">  -- 异常定义</span><br><span class="line">  --   V_ERR_MSG</span><br><span class="line">  --     错误消息.</span><br><span class="line"></span><br><span class="line">  V_SQL VARCHAR2(8000);</span><br><span class="line">  V_ERR_MSG  VARCHAR2(4000);</span><br><span class="line">  V_ERR_CODE BINARY_INTEGER;</span><br><span class="line">  E_PARAM_EMPTY_CODE CONSTANT BINARY_INTEGER DEFAULT - 20001;</span><br><span class="line"></span><br><span class="line">  ---------------</span><br><span class="line">  -- 参数为空异常.</span><br><span class="line">  E_IN_PARAM_EMPTY_EX EXCEPTION;</span><br><span class="line">  PRAGMA EXCEPTION_INIT(E_IN_PARAM_EMPTY_EX, -20001);</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">  FUNCTION FU_ADD_QUOTES_STR(I_STR       IN VARCHAR2, -- 1</span><br><span class="line">                             I_SEPARATOR IN VARCHAR2 DEFAULT &apos;,&apos; -- 2</span><br><span class="line">                             ) RETURN VARCHAR2 IS</span><br><span class="line">    V_ID_STR    VARCHAR2(50);</span><br><span class="line">    V_INDEX1    NUMBER(5) DEFAULT 0;</span><br><span class="line">    V_INDEX2    NUMBER(5) DEFAULT 1;</span><br><span class="line">    V_CONDITION VARCHAR2(4000);</span><br><span class="line">    V_ID        VARCHAR2(4000);</span><br><span class="line">    O_STR       VARCHAR2(4000);</span><br><span class="line">  </span><br><span class="line">  BEGIN</span><br><span class="line">    V_ID_STR := I_STR;</span><br><span class="line">    IF V_ID_STR IS NOT NULL THEN</span><br><span class="line">      V_INDEX1 := INSTR(V_ID_STR, I_SEPARATOR);</span><br><span class="line">      WHILE V_INDEX1 &gt; -1 LOOP</span><br><span class="line">        V_INDEX1 := INSTR(V_ID_STR, I_SEPARATOR, V_INDEX2);</span><br><span class="line">        IF V_INDEX1 = 0 THEN</span><br><span class="line">          V_ID     := SUBSTR(V_ID_STR, V_INDEX2);</span><br><span class="line">          V_INDEX1 := -1;</span><br><span class="line">        ELSE</span><br><span class="line">          V_ID     := SUBSTR(V_ID_STR, V_INDEX2, V_INDEX1 - V_INDEX2);</span><br><span class="line">          V_INDEX2 := V_INDEX1 + 1;</span><br><span class="line">        END IF;</span><br><span class="line">        IF V_CONDITION IS NOT NULL THEN</span><br><span class="line">          V_CONDITION := V_CONDITION || &apos;,&apos;;</span><br><span class="line">        END IF;</span><br><span class="line">        V_CONDITION := V_CONDITION || &apos;&apos;&apos;&apos; || V_ID || &apos;&apos;&apos;&apos;;</span><br><span class="line">      END LOOP;</span><br><span class="line">    END IF;</span><br><span class="line">    O_STR := V_CONDITION;</span><br><span class="line">    RETURN(O_STR);</span><br><span class="line">  END FU_ADD_QUOTES_STR;</span><br><span class="line">  -- END FU_ADD_QUOTES_STR</span><br><span class="line"></span><br><span class="line">  FUNCTION FU_BUILD_IN_CONDITION(I_NUM_STR   IN VARCHAR2, -- 1</span><br><span class="line">                                 I_CONDT_STR IN VARCHAR2, -- 2</span><br><span class="line">                                 I_SEPARATOR IN VARCHAR2 DEFAULT &apos;,&apos; --3</span><br><span class="line">                                 ) RETURN VARCHAR2 IS</span><br><span class="line">  </span><br><span class="line">    V_CONDITION VARCHAR2(4000);</span><br><span class="line">    O_STR       VARCHAR2(4000);</span><br><span class="line">  </span><br><span class="line">  BEGIN</span><br><span class="line">    V_CONDITION := FU_ADD_QUOTES_STR(I_NUM_STR, I_SEPARATOR);</span><br><span class="line">    O_STR       := I_CONDT_STR || &apos; IN (&apos; || V_CONDITION || &apos;)&apos;;</span><br><span class="line">    RETURN(O_STR);</span><br><span class="line">  END FU_BUILD_IN_CONDITION;</span><br><span class="line"></span><br><span class="line">BEGIN</span><br><span class="line">  ------------</span><br><span class="line">  -- 参数处理</span><br><span class="line">  -- 单位ID</span><br><span class="line">  IF I_COMP_ID IS NULL THEN</span><br><span class="line">    RAISE E_IN_PARAM_EMPTY_EX;</span><br><span class="line">  END IF;</span><br><span class="line"></span><br><span class="line">  -- 清理方式ID</span><br><span class="line">  IF I_MODE_IDS IS NULL THEN</span><br><span class="line">    RAISE E_IN_PARAM_EMPTY_EX;</span><br><span class="line">  END IF;</span><br><span class="line">  -------------</span><br><span class="line">  -- 处理临时表</span><br><span class="line">  EXECSQL(&apos;DELETE FROM GT_GET_KMTMP_SES&apos;);</span><br><span class="line">  EXECSQL(&apos;DELETE FROM GT_GET_GLDX_SES&apos;);</span><br><span class="line">  EXECSQL(&apos;DELETE FROM HZ_LS_KMHZBQUERY_SEC&apos;);</span><br><span class="line">  ------------</span><br><span class="line">  -- 科目</span><br><span class="line">  --   GT_GET_KMTMP_SES</span><br><span class="line"></span><br><span class="line">  -- 确定清理方式科目设置层级 及科目方向(ITEMCODE科目方向, LEAF清理层次)</span><br><span class="line">  V_SQL := &apos;INSERT INTO HZ_LS_KMHZBQUERY_SEC (IID, ITEMCODE, LEAF)&apos; ||</span><br><span class="line">           &apos; SELECT &apos;;</span><br><span class="line">  --SELECT * FROM XTQLMODE X WHERE X.DWDH=&apos;0001&apos; AND NVL(X.TYBZ, 0) = 0 AND X.QLMODEID IN ();</span><br><span class="line"></span><br><span class="line">  ------------</span><br><span class="line">  -- 对象类型</span><br><span class="line"></span><br><span class="line">  -----------</span><br><span class="line">  -- 管理对象</span><br><span class="line"></span><br><span class="line">  ---------——---------</span><br><span class="line">  -- 查询出未清理数据：</span><br><span class="line">  --   1. qlbz=0</span><br><span class="line"></span><br><span class="line">EXCEPTION</span><br><span class="line">  ------------</span><br><span class="line">  -- 参数为空</span><br><span class="line">  WHEN E_IN_PARAM_EMPTY_EX THEN</span><br><span class="line">    V_ERR_CODE := SQLCODE;</span><br><span class="line">    V_ERR_MSG  := &apos;参数为空.&apos;;</span><br><span class="line">    DBMS_STANDARD.RAISE_APPLICATION_ERROR(V_ERR_CODE, V_ERR_MSG);</span><br><span class="line">    DBMS_OUTPUT.PUT_LINE(DBMS_UTILITY.FORMAT_ERROR_BACKTRACE);</span><br><span class="line">  WHEN OTHERS THEN</span><br><span class="line">    V_ERR_CODE := SQLCODE;</span><br><span class="line">    V_ERR_MSG  := SQLERRM(SQLCODE);</span><br><span class="line">    ROLLBACK; -- OTHERS中必须显式回滚</span><br><span class="line">  </span><br><span class="line">    -------------</span><br><span class="line">    -- 打印异常栈</span><br><span class="line">    DBMS_STANDARD.RAISE_APPLICATION_ERROR(V_ERR_CODE, V_ERR_MSG);</span><br><span class="line">    DBMS_OUTPUT.PUT_LINE(DBMS_UTILITY.FORMAT_ERROR_BACKTRACE);</span><br><span class="line">    RAISE; -- 继续抛异常</span><br><span class="line">END TEST_PA_COMMENT_STYLE;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;PL-SQL注释风格&quot;&gt;&lt;a href=&quot;#PL-SQL注释风格&quot; class=&quot;headerlink&quot; title=&quot;PL/SQL注释风格&quot;&gt;&lt;/a&gt;PL/SQL注释风格&lt;/h1&gt;&lt;h2 id=&quot;PL-SQL-Comment-Style&quot;&gt;&lt;a href=&quot;#P
      
    
    </summary>
    
      <category term="PLSQL" scheme="https://betgar.github.io/categories/PLSQL/"/>
    
    
      <category term="PLSQL" scheme="https://betgar.github.io/tags/PLSQL/"/>
    
  </entry>
  
  <entry>
    <title>JavaScript中Object类型转换到原始类型</title>
    <link href="https://betgar.github.io/2017/11/24/object-to-primitive-conversions-in-javascript/"/>
    <id>https://betgar.github.io/2017/11/24/object-to-primitive-conversions-in-javascript/</id>
    <published>2017-11-24T12:00:00.000Z</published>
    <updated>2018-06-28T11:24:48.019Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Object-to-Primitive-Conversions-in-JavaScript"><a href="#Object-to-Primitive-Conversions-in-JavaScript" class="headerlink" title="Object-to-Primitive Conversions in JavaScript"></a>Object-to-Primitive Conversions in JavaScript</h2><blockquote><p>这是一篇转载的文章。</p></blockquote><p>Like most object-oriented programming languages, JavaScript provides built-in ways to convert between objects and primitive values, by way of the special toString and valueOf methods. This article will cover the basics of these methods, but then dive into the details of how this stuff really works, bad stuff, performance, and browser support.</p><h3 id="Types-and-Primitives"><a href="#Types-and-Primitives" class="headerlink" title="Types and Primitives"></a>Types and Primitives</h3><p>To understand this article, you’ll need to understand the difference between primitive and non-primitive values in JavaScript. There are 5 primitive types, which are associated with the various primitive values.</p><ul><li>Null: The value null.</li></ul><ul><li>Undefined: The value undefined.</li></ul><ul><li>Number: All numbers, such as 0 and 3.14. Also NaN, and Infinity.</li></ul><ul><li>Boolean: The values true and false.</li></ul><ul><li>String: All strings, such as “foo” and “”.</li></ul><p>All other values are non-primitive, including arrays, functions, and plain old objects. For completeness, here are the results of the typeof operator, applied to these values:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typeof</span> <span class="literal">null</span>; <span class="comment">// "object"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typeof</span> <span class="literal">undefined</span>; <span class="comment">// "undefined"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typeof</span> <span class="number">0</span>; <span class="comment">// "number" (typeof NaN is also "number")</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typeof</span> <span class="literal">true</span>; <span class="comment">// "boolean"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typeof</span> <span class="string">"foo"</span>; <span class="comment">// "string"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typeof</span> &#123;&#125;; <span class="comment">// "object"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typeof</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;; <span class="comment">// "function"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typeof</span> []; <span class="comment">// "object"</span></span><br></pre></td></tr></table></figure><p><strong>Note</strong>: <code>typeof null</code> should <em>not</em> be <code>&quot;object&quot;</code>. This is a mistake from the first versions of JavaScript, but it’s really too late to fix. A more sensible type would have been <code>&quot;null&quot;</code>, but this is what we’re stuck with.<br>If you’ve got that down, then we’re ready to move on to the basics of toString and valueOf. If you’re already familiar with the basics, feel free to skip ahead to “How it Works”.</p><p>Basic Usage</p><p>We’ll be using a simple example population object that holds a country name and a population. Lets code that up.</p><p>function population(country, pop) {<br>    return {<br>        country: country,<br>        pop: pop<br>    };<br>}</p><p>var america_pop = population(“USA”, 350e6);<br>var mexico_pop = population(“Mexico”, 200e6);<br>var canada_pop = population(“Canada”, 200e6);</p><p>alert(america_pop); // [object Object]</p><p>var north_america_pop = america_pop + mexico_pop + canada_pop;</p><p>alert(north_america_pop); // [object Object][object Object][object Object]<br>This works, but the calls to alert are not very useful. What we’d really like is for the first alert to show ‘[Population “USA” 350000000]’ and the second to show “750000000”. So, let’s code that up next.</p><p>toString</p><p>All objects inherit the method toString from Object.prototype, which returns “[object Object]”. However, we can easily override this by providing toString as a method of our object, or its prototype. In this example, we’ll attach it directly to each instance, but feel free to use the prototype instead.</p><p>function population(country, pop) {<br>    return {<br>        country: country,<br>        pop: pop,</p><pre><code>    toString: function () {        return &quot;[Population &quot; +             &quot;\&quot;&quot; + country + &quot;\&quot; &quot; +            pop +        &quot;]&quot;;    }}</code></pre><p>}</p><p>var america_pop = population(“USA”, 350e6);<br>alert(america_pop); // [Population “USA” 350000000]<br><strong>Note</strong>: I’m using <strong>closure</strong> on the <code>country</code> parameter, rather than using <code>this.country</code>. This only works due to how the constructor is set up. If you placed <code>toString</code> on the prototype, you would need to use <code>this.country</code>.<br>valueOf</p><p>All JavaScript objects also inherit the method valueOf from Object.prototype. By default, this method simply returns the object itself, but is generally overridden to convert an object to a Number, or another primitive value, so it can be used by operators like +. We can do the same thing as above to complete our basic example.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">population</span>(<span class="params">country, pop</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">    country: country,</span><br><span class="line">    pop: pop,</span><br><span class="line">    </span><br><span class="line">    toString: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"[Population "</span> + </span><br><span class="line">    <span class="string">"\""</span> + country + <span class="string">"\" "</span> +</span><br><span class="line">    pop +</span><br><span class="line">    <span class="string">"]"</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    </span><br><span class="line">    valueOf: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> pop;</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> america_pop = population(<span class="string">"USA"</span>, <span class="number">350e6</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> mexico_pop = population(<span class="string">"Mexico"</span>, <span class="number">200e6</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> canada_pop = population(<span class="string">"Canada"</span>, <span class="number">200e6</span>);</span><br><span class="line"></span><br><span class="line">alert(america_pop); <span class="comment">// [Population "USA" 350000000</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> north_america_pop = america_pop + mexico_pop + canada_pop;</span><br><span class="line"></span><br><span class="line">alert(north_america_pop); <span class="comment">// 750000000</span></span><br></pre></td></tr></table></figure><p>Here we’ve defined the valueOf function of our population object to return the population, which should be a Number.</p><h3 id="How-It-Works"><a href="#How-It-Works" class="headerlink" title="How It Works"></a>How It Works</h3><p>As with most things in JavaScript, the process by which toString gets called is not as simple as you’d think. Let’s explore what happens when alert(america_pop) is called.</p><p>alert calls GetValue on the reference. This returns the object it points at.<br>alert calls ToString on the value (this is not the same as the object’s toString)<br>ToString calls ToPrimitive on the value, passing the hint String.<br>ToPrimitive calls the object’s internal [[DefaultValue]] method with the hint String.<br>[[DefaultValue]] calls the toString property of the object, with the object as this.<br>The result of toString is a primitive value, so it is returned, all the way up the chain to the ToString method.<br>Since the result is of type String, ToString returns all the way to alert.<br>alert displays the value.<br>While this is a lot, it’s pretty straightforward. However, he key mechanism that needs more explaining is the ToPrimitive function. This function is used to take an arbitrary value and get a corresponding primitive value instead. If the input is already a primitive value then the value will be returned without conversion. However, if the value is non-primitive, then it will call the internal [[DefaultValue]] method to find a default value for the object.</p><p>[[DefaultValue]] is an internal property of every object. It’s a method that takes an optional hint, which should be either Number or String. If a hint is not provided, it will default to Number unless the object is a Date, in which case it defaults to String (this is silly). After this has been figured out, it will call toString and valueOf, in order, to find a primitive value. This is where the hint comes into play. If the hint is Number, then valueOf will be tried first, but if it’s String then toString will be tried first. Here’s the ensuing process:</p><p>If the first method exists, and is callable, call it and get the result, otherwise skip to 3.<br>If the result of 1 is a primitive, return it.<br>If the second method exists, and is callable, call it and get the result, otherwise skip to 5.<br>If the result of 3 is a primitive, return it.<br>Throw a TypeError exception.<br>The value that is returned by [[DefaultValue]] is guaranteed to be primitive. If it was not, a TypeError would have been thrown. This also implies that toString and valueOf should return primitives on order to be useful in this context.</p><p>Confusion About the + Operator</p><p>Here’s an example with a (possibly) unexpected result:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> foo = &#123;</span><br><span class="line"></span><br><span class="line">    toString: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"foo"</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    valueOf: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">5</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">alert(foo + <span class="string">"bar"</span>); <span class="comment">// 5bar</span></span><br><span class="line"></span><br><span class="line">alert([foo, <span class="string">"bar"</span>].join(<span class="string">""</span>)); <span class="comment">// foobar</span></span><br></pre></td></tr></table></figure><p>In this context, we’re using the + operator to do string concatenation. But, foo was not converted to a string using toString, it was turned into a number using valueOf, then used for string concatenation. This probably isn’t what we want, but it is how it works. It’s a side-effect of the overloading of the + operator for arithmetic and string concatenation. The +operator has a well-defined process:</p><ol><li><p>Evaluate the left-hand side, and get the value.</p></li><li><p>Evaluate the right-hand side, and get the value.</p></li><li>Call ToPrimitive on both the left-hand and right-hand sides (without a hint)</li><li>If either primitive value is a String, then skip to 7.</li><li>Call ToNumber on both values.</li><li>Return the sum of the values.</li><li>Call ToString on both values.</li><li>Return the concatenation of both values.</li></ol><p>Since no hint is passed to the ToPrimitive calls, the hint will be defaulted to Number (unless it’s a Date, which defaults to String). This means that our valueOf function will be called, instead of toString. It’s not until after the primitive values are retrieved that the interpreter decides whether it is going to do string concatenation or arithmetic. That’s why our example above returns “5bar” instead of “foobar”.</p><h3 id="Bad-Stuff"><a href="#Bad-Stuff" class="headerlink" title="Bad Stuff"></a>Bad Stuff</h3><p>There is one really bad feature of all this, which is that ToPrimitive does not enforce any type-checking on the return values, other than that they are primitive. This means you can write code like this:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> foo = &#123;</span><br><span class="line"></span><br><span class="line">    toString: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">5</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    valueOf: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"foo"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">alert(foo.toString() + <span class="number">1</span>); <span class="comment">// 6 (bad!)</span></span><br><span class="line"></span><br><span class="line">alert(foo + <span class="number">1</span>); <span class="comment">// "foo1" (no good!)</span></span><br><span class="line"></span><br><span class="line">alert(+foo); <span class="comment">// NaN (the worst!)</span></span><br></pre></td></tr></table></figure><p>The valueOf method can be forgiven for not type-checking, because it is more generic. You’d expect it to be able to return any suitable primitive value. However, the toString method has no such excuse. This is simply a bad feature. You can, of course, mitigate by using String(foo) instead of foo.toString(), which will call toString and then convert that result to a string. But you should not have to do this, or worry about this. Please do not make objects with toString methods that do not return strings.</p><h3 id="How-About-Performance"><a href="#How-About-Performance" class="headerlink" title="How About Performance?"></a>How About Performance?</h3><p>After understanding the complexity that goes into these implicit conversion, I got curious about how that affects performance. So I decided to test the time it takes to perform an [].join(obj) over 1,000,000 iterations in the major browsers. I did one test with the object being implicitly cast to a string, and one where I called the toString method manually (i.e. [].join(obj.toString())). As expected, the explicit call was faster in most cases.</p><p>Firefox 3.6.2: 874ms vs. 320ms - almost 3x faster.<br>Chrome 5: 94ms vs. 47ms - 2x faster.<br>Opera 10.50: 155ms vs 182ms - a little slower.<br>Safari 4: 409ms vs 280ms - almost 2x faster.<br>Internet Explorer 8: 2856ms vs 2786ms - about the same.<br>Internet Explorer 9 (preview): 645ms vs 633ms - about the same.<br><strong><em>Note 1</em></strong>: The Firefox, Chrome, Opera, and Safari tests were all run on a Macbook Pro running OS X 10.5. The IE tests were run on a desktop running Windows 7. <a href="http://www.bcherry.net/playground/defaultvalues" target="_blank" rel="noopener">Run the tests yourself here.</a><strong><em>Note 2</em></strong>: I chose to use the <code>[].join</code> method because doing so was most likely to avoid any dead-code elimination optimizations in modern browsers. I’ve had trouble with this before, in Firefox. I <em>did</em> try testing with the <code>String()</code> constructor, with similar results in most browsers. Opera was an exception where using the explicit <code>toString</code> was close to <strong>5x faster</strong>. In Firefox, the explicit cast was a bit faster, but both cases were about 100x faster than the <code>[].join</code> method (and other browsers), which means the code-path was probably being removed by the dead code eliminator.<br>The takeaway from this performance test is that it’s always best to call your object’s type-conversion methods directly, rather than relying on the interpreter to do the complex series of method calls and comparisons needed to do it automatically. The Opera 10.50 result is very strange, but it’s not particularly slower, so I wouldn’t worry about it. The gains made in other browsers more than make up for the outlier Opera result.</p><p>How About Browser Support?</p><p>Like many things in the ECMAScript specification, these processes are complex, and I doubted that all browsers would implement them exactly as specified. So, in that test suite from earlier, I added compliance checks. I was quite surprised to see that all major browsers, including versions of Internet Explorer going back to at least IE 5.5, implement these mechanisms correctly. This is even the case with the awkward handling when developers do things like make toString return a number instead of a string. All browsers handle the code according to the specification. This is great news.</p><p>But the specification unhelpfully introduced ambiguity in one particular area: the absence of a hint for the ToPrimitive function. Here’s the exact wording:</p><p>All native ECMAScript objects except Date objects handle the absence of a hint as if the hint Number were given; Date objects handle the absence of a hint as if the hint String were given. Host objects may handle the absence of a hint in some other manner.</p><p>That the standard explicitly allows browsers to deviate here worried me. Included in that test suite was a check that, in the absence of a hint, Date objects will default to String and Boolean objects will default to Number. All browsers passed this check as well, which means that browser support for all of this functionality seems to be consistent and correct.</p><h3 id="Conclusions"><a href="#Conclusions" class="headerlink" title="Conclusions"></a>Conclusions</h3><p>I hope this was useful in understanding how these mechanisms work in JavaScript. There are three important things to take away from this article:</p><p>Implement toString and valueOf on your commonly-reused objects. They can help you write clearer, more concise code, and make debugging easier too.<br>All browsers implement object-to-primitive conversion according to the specification, so you can safely consult it for more detail.<br>When performance is important, always try to call your type-conversion methods directly, instead of relying on JavaScript’s implicit calls.<br>You can find the test suite used for this article here if you’re interested in trying to replicate my results. Please let me know if you find contradictory results to what I posted here.</p><p>Thanks for reading! If you have questions or feedback then leave a comment below or contact me directly.</p><p>filed under javascript</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;Object-to-Primitive-Conversions-in-JavaScript&quot;&gt;&lt;a href=&quot;#Object-to-Primitive-Conversions-in-JavaScript&quot; class=&quot;headerlink&quot; title=&quot;Ob
      
    
    </summary>
    
      <category term="JavaScript" scheme="https://betgar.github.io/categories/JavaScript/"/>
    
    
      <category term="JavaScript" scheme="https://betgar.github.io/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>怎么使用Oracle手册</title>
    <link href="https://betgar.github.io/2017/11/23/how-to-use-oracle-reference/"/>
    <id>https://betgar.github.io/2017/11/23/how-to-use-oracle-reference/</id>
    <published>2017-11-23T12:00:00.000Z</published>
    <updated>2018-06-28T11:24:48.019Z</updated>
    
    <content type="html"><![CDATA[<h1 id="怎么使用Oracle手册"><a href="#怎么使用Oracle手册" class="headerlink" title="怎么使用Oracle手册"></a>怎么使用Oracle手册</h1><blockquote><p>介绍一下官网文档模块。这是一片转载的文章。</p></blockquote><h2 id="Concept"><a href="#Concept" class="headerlink" title="Concept"></a>Concept</h2><p>包含了 oracle 数据库里面的一些基本概念和原理, 比如 数据库逻辑结构, 物理结构, 实例结构, 优化器, 事务等. PDF 460页<br>Reference</p><p>包含了动态性能视图, 数据字典, 初始化参数等, 如果有参数不知道意思, 或者 v$视图字段信息模糊, 都可以从这里找到描述, 使用 html版的进去 ctrl+f查找比较快.还包含一些其他比如数据库的硬性限制, 等待事件的名称, 后台进程的描述等.</p><h3 id="SQL-Language-Reference"><a href="#SQL-Language-Reference" class="headerlink" title="SQL Language Reference"></a>SQL Language Reference</h3><p>这个文档中包含 oracle数据库的sql语法,(不包含plsql), 比如 create table 等.</p><h3 id="Administrator’s-Guide"><a href="#Administrator’s-Guide" class="headerlink" title="Administrator’s Guide"></a>Administrator’s Guide</h3><p>各种管理oracle数据库的场景都在这里, 各种管理表, 索引, 表空间, redo等</p><h3 id="Performance-tuning-guide"><a href="#Performance-tuning-guide" class="headerlink" title="Performance tuning guide"></a>Performance tuning guide</h3><p>包含优化相关内容, 介绍优化方法, 数据库实例及sql的优化</p><h3 id="Database-Administration-页面"><a href="#Database-Administration-页面" class="headerlink" title="Database Administration 页面"></a>Database Administration 页面</h3><p>因为上面 administrator’s guide 已经描述了, 这里列举几个比较重要文档</p><h4 id="Net-Services-Reference"><a href="#Net-Services-Reference" class="headerlink" title="Net Services Reference"></a>Net Services Reference</h4><p>文档说明了几个关于监听的重要文件, tnsnames.ora, listener.ora, sqlnet.ora 等</p><h4 id="Backup-and-Recovery-User’s-Guide"><a href="#Backup-and-Recovery-User’s-Guide" class="headerlink" title="Backup and Recovery User’s Guide"></a>Backup and Recovery User’s Guide</h4><p>描述了 rman 的各种用法</p><h3 id="Application-Development-页面"><a href="#Application-Development-页面" class="headerlink" title="Application Development 页面"></a>Application Development 页面</h3><h5 id="PL-SQL-Packages-and-Types-Reference"><a href="#PL-SQL-Packages-and-Types-Reference" class="headerlink" title="PL/SQL Packages and Types Reference"></a>PL/SQL Packages and Types Reference</h5><p>包括各种 oracle 自建的包和函数的功能, 参数描述. 如果有不了解的包, 可以在这里找到, 比如 dbms_stats.</p><h4 id="PL-SQL-language-Reference"><a href="#PL-SQL-language-Reference" class="headerlink" title="PL/SQL language Reference"></a>PL/SQL language Reference</h4><p>plsql 编程的基础概念, 语法等.</p><h5 id="SQLJ-Developer’s-Guide"><a href="#SQLJ-Developer’s-Guide" class="headerlink" title="SQLJ Developer’s Guide"></a>SQLJ Developer’s Guide</h5><p>SQLJ, JAVA相关的内容</p><h5 id="Workspace-Manager-Developer’s-Guide"><a href="#Workspace-Manager-Developer’s-Guide" class="headerlink" title="Workspace Manager Developer’s Guide"></a>Workspace Manager Developer’s Guide</h5><p>关于 oracle 的 workspace manager 版本化的一些东西</p><h3 id="installing-and-upgrading-页面"><a href="#installing-and-upgrading-页面" class="headerlink" title="installing and upgrading 页面"></a>installing and upgrading 页面</h3><p>需要安装 oracle 参照这里.</p><h3 id="Grid-Computing-页面"><a href="#Grid-Computing-页面" class="headerlink" title="Grid Computing 页面"></a>Grid Computing 页面</h3><p>包括 oracle grid infrastructure 集群软件的各种文档</p><h3 id="Automatic-Storage-Management-Administrator’s-Guide"><a href="#Automatic-Storage-Management-Administrator’s-Guide" class="headerlink" title="Automatic Storage Management Administrator’s Guide"></a>Automatic Storage Management Administrator’s Guide</h3><p>Asm 相关文档</p><h3 id="Real-Application-Clusters-Administration-and-Development-Guide"><a href="#Real-Application-Clusters-Administration-and-Development-Guide" class="headerlink" title="Real Application Clusters Administration and Development Guide"></a>Real Application Clusters Administration and Development Guide</h3><p>包括 RAC 环境下的数据库管理和维护的内容</p><h3 id="Clusterware-Administration-and-Deployment-Guide"><a href="#Clusterware-Administration-and-Deployment-Guide" class="headerlink" title="Clusterware Administration and Deployment Guide"></a>Clusterware Administration and Deployment Guide</h3><p>主要写了集群软件的各种工具和命令</p><h3 id="High-Availability-页面"><a href="#High-Availability-页面" class="headerlink" title="High Availability 页面"></a>High Availability 页面</h3><p>包含各种高可用文档</p><h3 id="Data-Guard-Broker-和-Data-Guard-Concepts-and-Administration"><a href="#Data-Guard-Broker-和-Data-Guard-Concepts-and-Administration" class="headerlink" title="Data Guard Broker 和 Data Guard Concepts and Administration"></a>Data Guard Broker 和 Data Guard Concepts and Administration</h3><p>关于 Data guard 文档</p><h3 id="Data-Warehousing-and-Business-Intelligence-页面"><a href="#Data-Warehousing-and-Business-Intelligence-页面" class="headerlink" title="Data Warehousing and Business Intelligence 页面"></a>Data Warehousing and Business Intelligence 页面</h3><p>数据仓库和商业智能的相关技术</p><h3 id="VLDB-and-Partitioning-Guide"><a href="#VLDB-and-Partitioning-Guide" class="headerlink" title="VLDB and Partitioning Guide"></a>VLDB and Partitioning Guide</h3><p>very large database, … partition 和 parallel 相关的内容</p><h3 id="utilities"><a href="#utilities" class="headerlink" title="utilities"></a>utilities</h3><p>imp, expdp, sql*loader, 外部表, dbv, adrci, logminer</p><h3 id="unstructured-Data-and-Content-Management-页面"><a href="#unstructured-Data-and-Content-Management-页面" class="headerlink" title="unstructured Data and Content Management 页面"></a>unstructured Data and Content Management 页面</h3><p>非结构化数据相关, 比如 object type, xml type, oracle text</p><h3 id="SecureFiles-and-Large-Objects-Developer’s-Guide"><a href="#SecureFiles-and-Large-Objects-Developer’s-Guide" class="headerlink" title="SecureFiles and Large Objects Developer’s Guide"></a>SecureFiles and Large Objects Developer’s Guide</h3><p>讲述了 11g 中存储 lob 字段使用的 secure file 技术内容</p><h3 id="Text-Application-Developer’s-Guide-和-Text-Reference"><a href="#Text-Application-Developer’s-Guide-和-Text-Reference" class="headerlink" title="Text Application Developer’s Guide 和 Text Reference"></a>Text Application Developer’s Guide 和 Text Reference</h3><p>全文索引相关</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;怎么使用Oracle手册&quot;&gt;&lt;a href=&quot;#怎么使用Oracle手册&quot; class=&quot;headerlink&quot; title=&quot;怎么使用Oracle手册&quot;&gt;&lt;/a&gt;怎么使用Oracle手册&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;介绍一下官网文档模块。这是一片转载
      
    
    </summary>
    
      <category term="Oracle" scheme="https://betgar.github.io/categories/Oracle/"/>
    
    
      <category term="Oracle" scheme="https://betgar.github.io/tags/Oracle/"/>
    
  </entry>
  
  <entry>
    <title>jQuery的数据缓存模块</title>
    <link href="https://betgar.github.io/2017/05/31/the-data-storage-module-of-jquery/"/>
    <id>https://betgar.github.io/2017/05/31/the-data-storage-module-of-jquery/</id>
    <published>2017-05-31T12:00:00.000Z</published>
    <updated>2018-06-28T11:24:48.019Z</updated>
    
    <content type="html"><![CDATA[<h1 id="jQuery的数据缓存模块"><a href="#jQuery的数据缓存模块" class="headerlink" title="jQuery的数据缓存模块"></a>jQuery的数据缓存模块</h1><blockquote><p>几乎每一个前端库或者框架都有自己的数据缓存模块，而且这个是框架的基础核心模块。所有的应用模块，都会依赖这个数据缓存模块。jQuery也有自己的数据缓存模块，所以把自己学习的心得分享一下。</p></blockquote><h2 id="属性缓存数据"><a href="#属性缓存数据" class="headerlink" title="属性缓存数据"></a>属性缓存数据</h2><blockquote><p>属性缓存数据，就是使用对象的属性或者element元素的attribute来缓存数据。jQuery（1.x）就是利用这个实现的自己的数据缓存模块的。这种方法也叫<strong>属性标记法</strong>.</p></blockquote><ol><li><p>element属性attribute标记法</p><blockquote><p>这个写过前端代码的都很熟悉，就是在标签的html上加上自定义属性。</p></blockquote><p>栗子1：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- element-attribute.html --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"demo1"</span> <span class="attr">customize</span>=<span class="string">"defined by me"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"getAttrBtn"</span>&gt;</span>getAttr<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"setAttrBtn"</span>&gt;</span>setAttr<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> $ = <span class="function"><span class="keyword">function</span> (<span class="params">id</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">document</span>.getElementById(id);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> getAttrBtn = $(<span class="string">'getAttrBtn'</span>);</span><br><span class="line"><span class="keyword">var</span> setAttrBtn = $(<span class="string">'setAttrBtn'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *标签属性标记法</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">getAttrBtn.onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> demoEle = $(<span class="string">'demo1'</span>), value = demoEle.getAttribute(<span class="string">'customize'</span>);</span><br><span class="line">  <span class="built_in">window</span>.console.log(value);</span><br><span class="line">  demoEle.innerHTML = value;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">setAttrBtn.onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> demoEle = $(<span class="string">'demo1'</span>),value;</span><br><span class="line">  demoEle.setAttribute(<span class="string">'customize'</span>, <span class="string">'changed by element attribute'</span>);</span><br><span class="line">  value = demoEle.getAttribute(<span class="string">'customize'</span>);</span><br><span class="line">  <span class="built_in">window</span>.console.log(value);</span><br><span class="line">  demoEle.innerHTML = value;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>栗子1就是我们通过element标签来保存一些自己的业务数据。</p><p>优点：原生；所有浏览器都支持。</p><p>缺点：只能保存<strong>字符串</strong>，不能保存<strong>对象</strong>和<strong>function</strong>，这两种类型。</p><p>​</p></li><li><p>对象属性标记法</p><blockquote><p>对象属性标记，就很好理解了，就是平时我们给JavaScript对象赋值的操作。</p></blockquote><p>栗子2：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- element-attribute.html --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"demo1"</span> <span class="attr">customize</span>=<span class="string">"defined by me"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"getAttrBtn"</span>&gt;</span>getAttr<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"setAttrBtn"</span>&gt;</span>setAttr<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><p>​</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">*对象属性标记法</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">getAttrBtn.ondblclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> demoEle = $(<span class="string">'demo1'</span>), value = demoEle[<span class="string">'customize'</span>];</span><br><span class="line">  <span class="built_in">window</span>.console.log(value);</span><br><span class="line">  demoEle.innerHTML = value;</span><br><span class="line">&#125;;</span><br><span class="line">setAttrBtn.ondblclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> demoEle = $(<span class="string">'demo1'</span>),value;</span><br><span class="line">  demoEle[<span class="string">'customize'</span>] = <span class="string">'changed by object attribute'</span>,value = demoEle[<span class="string">'customize'</span>];</span><br><span class="line">  <span class="built_in">window</span>.console.log(value);</span><br><span class="line">  demoEle.innerHTML = value;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>栗子2就是对象属性标记法，原理就是直接使用浏览器中element(宿主元素)进行数据缓存。</p><p>优点：JavaScript全类型的数据都支持。</p><p>缺点：</p><ul><li><p>浏览器兼容性问题。</p></li><li><p>object,applet,embed等对象是不能使用这种方法，进行属性缓存数据，因为他们不是标准的浏览器中的对象，属于扩展内容。</p></li><li><p>window对象如果使用这种方式，变成了全局变量</p></li><li><p><strong>内存泄漏</strong>：内存泄漏是这种方式的最大威胁。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 内存泄漏栗子：</span></span><br><span class="line"><span class="comment">// 最直接的栗子就是demoEle.dep.el的属性指向demoEle</span></span><br><span class="line"><span class="keyword">var</span> demoEle = $(<span class="string">'demo1'</span>);</span><br><span class="line">demoEle.dep = &#123;</span><br><span class="line">  el: demoEle</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 这样的循环依赖，很难觉察到，所以demoEle.dep和demoEle都得不到回收，造成内存泄漏。</span></span><br></pre></td></tr></table></figure></li></ul></li></ol><h2 id="数据缓存模块实现原理"><a href="#数据缓存模块实现原理" class="headerlink" title="数据缓存模块实现原理"></a>数据缓存模块实现原理</h2><blockquote><p>属性缓存数据的两种方法，各有优缺点，但是<strong>对象属性缓存数据</strong> 已经非常理想了，只要解决一下<strong>内存泄漏</strong> 这个问题就很实用了。分享一下jQuery的巧妙设计。</p></blockquote><p>jQuery的设计思路：</p><ul><li>数据统一管理（数据储存在一个<strong>对象</strong> 中）</li><li>数据不缓存在具体的element对象属性上，而是在element缓存一个jQueryKey，然后通过jQueryKey存取数据。</li></ul><blockquote><p>jQueryKey：是一个字符串值，不存在<strong>循环依赖</strong> 解决<strong>内存泄漏</strong>的问题 。</p></blockquote><p>栗子：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- data-storage.html --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"demo1"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"getAttrBtn"</span>&gt;</span>getStore<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"setAttrBtn"</span>&gt;</span>store<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isNumeric</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> !<span class="built_in">isNaN</span>(<span class="built_in">parseFloat</span>(obj)) &amp;&amp; <span class="built_in">isFinite</span>(obj);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Model</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">Model.cacheKey = <span class="string">'ceche'</span> + (<span class="keyword">new</span> <span class="built_in">Date</span>).getTime();</span><br><span class="line">Model.cache = &#123;&#125;; <span class="comment">// 用来缓存数据</span></span><br><span class="line">Model.uuid = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">Model.data = <span class="function"><span class="keyword">function</span> (<span class="params">ele, key, value</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> cacheKey = Model.cacheKey, indexKey = ele[cacheKey];</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">arguments</span>.length === <span class="number">2</span>) &#123;</span><br><span class="line">    <span class="comment">// get </span></span><br><span class="line">    <span class="keyword">if</span> (isNumeric(indexKey)) &#123;</span><br><span class="line">      <span class="keyword">return</span> Model.cache[indexKey][key] === <span class="literal">undefined</span> ? <span class="literal">null</span> </span><br><span class="line">      : Model.cache[indexKey][key];</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// set</span></span><br><span class="line">    <span class="keyword">if</span> (isNumeric(indexKey)) &#123;</span><br><span class="line">      Model.cache[indexKey][key] = value;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      ele[cacheKey] = indexKey = <span class="string">''</span> + Model.uuid++;</span><br><span class="line">      Model.cache[indexKey] = &#123;&#125;;</span><br><span class="line">      Model.cache[indexKey][key] = value;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;  </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>上面的栗子：</p><p>Model.cacheKey做element的属性，element[Model.cacheKey]的value值是Model.cache的对象key。</p><ul><li>element[Model.cacheKey]的value值，只是一个字符串所以，完美解决了<strong>内存泄漏</strong> 问题。</li><li>Model.cache是一个普通的JavaScript对象，所以它可以支持所有的JavaScript的数据类型。解决了在标签的属性上缓存数据，只支持 <strong>字符串</strong> 的问题。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 这就是element对应cache中缓存的整个数据对象</span></span><br><span class="line">Model.cache[element[Model.cacheKey]];</span><br></pre></td></tr></table></figure><h2 id="jQuery数据缓存模块源码"><a href="#jQuery数据缓存模块源码" class="headerlink" title="jQuery数据缓存模块源码"></a>jQuery数据缓存模块源码</h2><blockquote><p>jQuery数据缓存模块的部分源码。</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 下面的就是一些 jQuery 涉及数据存储的操作</span></span><br><span class="line">jQuery.extend(&#123;</span><br><span class="line">  <span class="comment">// 全局的缓存对象</span></span><br><span class="line">  cache: &#123;&#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// The following elements throw uncatchable exceptions if you</span></span><br><span class="line">  <span class="comment">// attempt to add expando properties to them.</span></span><br><span class="line">  <span class="comment">// 如果你尝试给以下元素添加扩展属性,将抛出“无法捕捉”的异常</span></span><br><span class="line">  <span class="comment">// 这里声明的几个元素对象是不给于数据绑定的</span></span><br><span class="line">  <span class="comment">// applet、embed 和 object 元素是不支持设置 expando 属性的，所以不支持 data 方法</span></span><br><span class="line">  noData: &#123;</span><br><span class="line">    <span class="string">"applet"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="string">"embed"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="comment">// Ban all objects except for Flash (which handle expandos)</span></span><br><span class="line">    <span class="string">"object"</span>: <span class="string">"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 检查对象是否已经存储了数据</span></span><br><span class="line">  hasData: <span class="function"><span class="keyword">function</span>(<span class="params">elem</span>) </span>&#123;</span><br><span class="line">    elem = elem.nodeType ? jQuery.cache[elem[jQuery.expando]] : elem[jQuery.expando];</span><br><span class="line">    <span class="keyword">return</span> !!elem &amp;&amp; !isEmptyDataObject(elem);</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 给 elem（可是DOM，可以是JS对象）添加 key-value 为 name-data 的数据</span></span><br><span class="line">  data: <span class="function"><span class="keyword">function</span>(<span class="params">elem, name, data</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> internalData(elem, name, data);</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 移除 elem（可是DOM，可以是JS对象）上</span></span><br><span class="line">  removeData: <span class="function"><span class="keyword">function</span>(<span class="params">elem, name</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> internalRemoveData(elem, name);</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// For internal use only.</span></span><br><span class="line">  <span class="comment">// 添加或读取一个仅供内部使用的数据</span></span><br><span class="line">  _data: <span class="function"><span class="keyword">function</span>(<span class="params">elem, name, data</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> internalData(elem, name, data, <span class="literal">true</span>);</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 删除内部使用的数据数据</span></span><br><span class="line">  _removeData: <span class="function"><span class="keyword">function</span>(<span class="params">elem, name</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> internalRemoveData(elem, name, <span class="literal">true</span>);</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// A method for determining if a DOM node can handle the data expando</span></span><br><span class="line">  <span class="comment">// 检测一个属性是否可以绑定数据</span></span><br><span class="line">  <span class="comment">// nodeType = 1 -- Element</span></span><br><span class="line">  <span class="comment">// nodeType = 9 -- Document</span></span><br><span class="line">  acceptData: <span class="function"><span class="keyword">function</span>(<span class="params">elem</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// Do not set data on non-element because it will not be cleared (#8335).</span></span><br><span class="line">    <span class="comment">// </span></span><br><span class="line">    <span class="keyword">if</span> (elem.nodeType &amp;&amp; elem.nodeType !== <span class="number">1</span> &amp;&amp; elem.nodeType !== <span class="number">9</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// if(elem.nodeName)&#123;</span></span><br><span class="line">    <span class="comment">//   noData = jQuery.noData[elem.nodeName.toLowerCase()];</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">    <span class="keyword">var</span> noData = elem.nodeName &amp;&amp; jQuery.noData[elem.nodeName.toLowerCase()];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// nodes accept data unless otherwise specified; rejection can be conditional</span></span><br><span class="line">    <span class="keyword">return</span> !noData || noData !== <span class="literal">true</span> &amp;&amp; elem.getAttribute(<span class="string">"classid"</span>) === noData;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>来一个对应：</p><ul><li>jQuery.expando对应Model.cacheKey</li><li>jQuery.cache对应Model.cache</li><li>jQuery.data对应Model.data</li></ul><p>在jQuery.hasData方法内部看到了：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jQuery.cache[elem[jQuery.expando]]; <span class="comment">// 取数据</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Model.cache[indexKey][key]; <span class="comment">// Model和jQuery原理是一样的。</span></span><br></pre></td></tr></table></figure><p>有了Model这个小栗子，就能更好的理解jQuery的data模块实现原理了；当然jQuery的data模块还有很多其它的兼容性处理，防冲突处理。</p><h2 id="HTML5的DataSet-API"><a href="#HTML5的DataSet-API" class="headerlink" title="HTML5的DataSet API"></a>HTML5的DataSet API</h2><blockquote><p>HTML5加入了一个关于自定义属性的API，很是方便，虽然非现代浏览器不支持，但是你可以使用jQuery，jQuery已经提供了支持。</p></blockquote><p>栗子：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 自定义属性使用 data-* 开头 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">data-toggle</span>=<span class="string">"dropdown"</span> <span class="attr">class</span>=<span class="string">"moduleTitle"</span> <span class="attr">data-options</span>=<span class="string">"234"</span>&gt;</span>测试<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 原生操作</span></span><br><span class="line"><span class="comment">// 返回全部以data-开头的自定义属性.</span></span><br><span class="line"><span class="keyword">var</span> dataSet = <span class="built_in">document</span>.querySelector(<span class="string">'.moduleTitle'</span>).dataset; <span class="comment">// DOMStringMap</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 返回options</span></span><br><span class="line"><span class="keyword">var</span> dataSet = <span class="built_in">document</span>.querySelector(<span class="string">'.moduleTitle'</span>).dataset.options;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 新增或者修改(同步DOM元素的data-options属性)</span></span><br><span class="line"><span class="built_in">document</span>.querySelector(<span class="string">'.moduleTitle'</span>).dataset.options = <span class="number">234</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 删除</span></span><br><span class="line"><span class="keyword">delete</span> <span class="built_in">document</span>.querySelector(<span class="string">'.moduleTitle'</span>).dataset.options</span><br></pre></td></tr></table></figure><p>jQuery栗子：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">data-toggle</span>=<span class="string">"dropdown"</span> <span class="attr">class</span>=<span class="string">"moduleTitle"</span> <span class="attr">data-options</span>=<span class="string">"234"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">data-camel-options</span>=<span class="string">"234"</span>&gt;</span>测试<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// jQuery操作</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 访问所有的缓存数据，包括data-*自定义部分</span></span><br><span class="line"><span class="keyword">var</span> dataSet = $(<span class="string">'.moduleTitle'</span>).data();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 查询 （jQuery为了遵守规范自动转换data-*自定义属性为“驼峰”访问方式.）</span></span><br><span class="line"><span class="keyword">var</span> camelOptions = $(<span class="string">'.moduleTitle'</span>).data(<span class="string">'camelOptions'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 修改 (jQuery使用自己数据缓存模块，不再同步修改data-camel-options属性)</span></span><br><span class="line">$(<span class="string">'.moduleTitle'</span>).data(<span class="string">'camelOptions'</span>, <span class="number">3</span>);</span><br><span class="line">$(<span class="string">'.moduleTitle'</span>).data(<span class="string">'camelOptions'</span>); <span class="comment">// 3</span></span><br><span class="line">$(<span class="string">'.moduleTitle'</span>).attr(<span class="string">'data-camel-options'</span>); <span class="comment">// 234</span></span><br></pre></td></tr></table></figure><p>注意：</p><blockquote><p>​       jQuery.data访问data-<em>自定义属性是有优先级顺序，先从$.cache中获取，如果没有，才尝试自定义属性获取。<br>​       jQuery.data方法只能修改自己缓存内的数据，不会修改data-</em>属性的数据；所以千万不要使用jQuery().attr和jQuery.data混合使用操作data-自定义属性。</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;jQuery的数据缓存模块&quot;&gt;&lt;a href=&quot;#jQuery的数据缓存模块&quot; class=&quot;headerlink&quot; title=&quot;jQuery的数据缓存模块&quot;&gt;&lt;/a&gt;jQuery的数据缓存模块&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;几乎每一个前端库或者框架都
      
    
    </summary>
    
      <category term="jQuery" scheme="https://betgar.github.io/categories/jQuery/"/>
    
    
      <category term="jQuery" scheme="https://betgar.github.io/tags/jQuery/"/>
    
  </entry>
  
  <entry>
    <title>使用jQuery UI widget编写有状态的插件</title>
    <link href="https://betgar.github.io/2017/05/07/building-stateful-plugins-with-jquery-ui-widget/"/>
    <id>https://betgar.github.io/2017/05/07/building-stateful-plugins-with-jquery-ui-widget/</id>
    <published>2017-05-07T12:00:00.000Z</published>
    <updated>2018-06-28T11:24:48.019Z</updated>
    
    <content type="html"><![CDATA[<h1 id="使用jQuery-UI-widget编写有状态的插件"><a href="#使用jQuery-UI-widget编写有状态的插件" class="headerlink" title="使用jQuery UI widget编写有状态的插件"></a>使用jQuery UI widget编写有状态的插件</h1><blockquote><p>jQuery最好的设计在于两个方面，一是它的API，另外一个是它的插件系统。这也是jQuery这些年异军突起的原因，虽然现在遇到了新的危机，Vue，Angular，React的出现给在现代的浏览器开放带来了新的开发体验。</p><p>这两年前端库或者框架更新太快，但是如果你是一个真正的实践者，时间长了你慢慢发现其实很多的前端开发框架都是当时编程思想的不同实现。</p><p>本人的JavaScript编程能力，也从最初的面向过程的面条式代码，转变到面向对象和使用一些MVC方式来组织代码。废话不多说，进入正题。</p></blockquote><p>[TOC]</p><h2 id="定义插件的步骤"><a href="#定义插件的步骤" class="headerlink" title="定义插件的步骤"></a>定义插件的步骤</h2><blockquote><p>首先插件定义时，为了防止外部影响插件，一般插件定义全部放在闭包内部。</p></blockquote><ul><li>定义插件的闭包</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="comment">// define you plugin</span></span><br><span class="line">&#125;)()</span><br></pre></td></tr></table></figure><ul><li>基于jQuery来定义插件</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 以step插件为例</span></span><br><span class="line">;(<span class="function"><span class="keyword">function</span> (<span class="params">$</span>) </span>&#123;</span><br><span class="line">  $.fn.step = <span class="function"><span class="keyword">function</span> (<span class="params">element, options</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// do something</span></span><br><span class="line">  &#125;</span><br><span class="line"> $.fn.step.prototype = &#123;</span><br><span class="line">   options: &#123;</span><br><span class="line">      version: <span class="string">'0.0.1'</span>,</span><br><span class="line">      name: <span class="string">'step'</span></span><br><span class="line">    &#125;</span><br><span class="line"> &#125;;</span><br><span class="line">&#125;)(jQuery)</span><br></pre></td></tr></table></figure><p>  使用extend扩展jQuery对象（jQuery也是这样扩展而成的）</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">;(<span class="function"><span class="keyword">function</span> (<span class="params">$</span>) </span>&#123;</span><br><span class="line">  $.extend($.fn, &#123;</span><br><span class="line">    <span class="comment">// 插件属性</span></span><br><span class="line">    options: &#123;</span><br><span class="line">      version: <span class="string">'0.0.1'</span>,</span><br><span class="line">      name: <span class="string">'step'</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;)(jQuery)</span><br></pre></td></tr></table></figure><ul><li>插件定义的大致步骤</li></ul><blockquote><p>举一个bootstrap插件Alert的例子。</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 以Alert为例</span></span><br><span class="line">+<span class="function"><span class="keyword">function</span> (<span class="params">$</span>) </span>&#123;</span><br><span class="line"><span class="meta">  'use strict'</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ALERT CLASS DEFINITION</span></span><br><span class="line">  <span class="comment">// ======================</span></span><br><span class="line">  <span class="comment">// Alert构造函数</span></span><br><span class="line">  <span class="keyword">var</span> Alert   = <span class="function"><span class="keyword">function</span> (<span class="params">el</span>) </span>&#123;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 公共属性</span></span><br><span class="line">  Alert.VERSION = <span class="string">'3.3.7'</span></span><br><span class="line">  Alert.TRANSITION_DURATION = <span class="number">150</span></span><br><span class="line"></span><br><span class="line">  Alert.prototype.close = <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 备份jQuery的prototype上已经有的alert</span></span><br><span class="line">  <span class="comment">// 为了后面防冲突处理使用.</span></span><br><span class="line">  <span class="keyword">var</span> old = $.fn.alert</span><br><span class="line">  $.fn.alert             = Plugin</span><br><span class="line">  $.fn.alert.Constructor = Alert</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment">// ALERT NO CONFLICT</span></span><br><span class="line">  <span class="comment">// =================</span></span><br><span class="line">  <span class="comment">// 防冲突处理</span></span><br><span class="line">  $.fn.alert.noConflict = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    $.fn.alert = old</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment">// ALERT PLUGIN DEFINITION</span></span><br><span class="line">  <span class="comment">// =======================</span></span><br><span class="line">  <span class="comment">// DOM-TO-Object的桥接模式</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">Plugin</span>(<span class="params">option</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.each(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> $<span class="keyword">this</span> = $(<span class="keyword">this</span>)</span><br><span class="line">      <span class="keyword">var</span> data  = $<span class="keyword">this</span>.data(<span class="string">'bs.alert'</span>)</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (!data) $<span class="keyword">this</span>.data(<span class="string">'bs.alert'</span>, (data = <span class="keyword">new</span> Alert(<span class="keyword">this</span>)))</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> option == <span class="string">'string'</span>) data[option].call($<span class="keyword">this</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;(jQuery);</span><br></pre></td></tr></table></figure><p>从上面的例子，可以看出定义插件需要如下几个步骤：</p><ol><li>定义插件的构造函数。</li><li>定义插件的参数（包含公共属性）插件可以通过初始化参数，或者动态的改变参数，来改变自己的状态和行为。</li><li>定义插件的行为方法，来具体的控制插件的状态。</li><li>插件的公共部分（所有的插件都会涉及，例如：防冲突处理，一般提供noConflict方法；使用DOM-to-Object的桥接模式等）。</li></ol><p>栗子：Step插件</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Step插件</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">$</span>) </span>&#123;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">  *@param &#123;Object&#125; options 动态参数</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">Step</span> (<span class="params">options</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// do something</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 公共属性</span></span><br><span class="line">  Step.VERSION = <span class="string">'0.0.1'</span>;</span><br><span class="line">  Step.NAME = <span class="string">'step'</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 原型定义，所有的实例(instance)都会拥有的方法</span></span><br><span class="line">  Step.prototype = &#123;</span><br><span class="line">    <span class="keyword">constructor</span>: Step, // 修正构造函数属性的指向</span><br><span class="line">    // 插件参数</span><br><span class="line">    options : &#123;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 很多插件系统的默认初始化方法</span></span><br><span class="line">    _init: <span class="function"><span class="keyword">function</span> (<span class="params">options</span>) </span>&#123;&#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;)(jQuery)</span><br></pre></td></tr></table></figure><h2 id="jQuery-UI插件编写的方式"><a href="#jQuery-UI插件编写的方式" class="headerlink" title="jQuery UI插件编写的方式"></a>jQuery UI插件编写的方式</h2><blockquote><p>上面总结的定义插件步骤其实还不完整，定义一个插件，我们就要想到，插件实例从无到有，还要从有到无。我们定义的插件，需要有一个生命周期管理，而这个生命周期的管理，其实是所有插件都要处理的，其实它是一个公共部分。既然是公共部分(DRY原则)，必须是能够重用，而不用重复这部分代码。</p></blockquote><p>如果你多看几个bootstrap的插件，你会发现几乎每一个插件都有如下的代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">// ALERT PLUGIN DEFINITION</span></span><br><span class="line">  <span class="comment">// =======================</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">Plugin</span>(<span class="params">option</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.each(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> $<span class="keyword">this</span> = $(<span class="keyword">this</span>)</span><br><span class="line">      <span class="keyword">var</span> data  = $<span class="keyword">this</span>.data(<span class="string">'plug.name'</span>)</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (!data) $<span class="keyword">this</span>.data(<span class="string">'plug.name'</span>, (data = <span class="keyword">new</span> Step(<span class="keyword">this</span>)))</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> option == <span class="string">'string'</span>) data[option].call($<span class="keyword">this</span>)</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 这段代码之所以会重复出现，是因为bootstrap的设计者，想减少bootstrap对其它库的依赖。</span></span><br><span class="line"><span class="comment">// 这段代码在$.widget.bridge中有非常巧妙的实现(jquery.ui.widget.js或者widget.js)。</span></span><br></pre></td></tr></table></figure><ul><li><p>使用$.Widget对象扩展控件</p><blockquote><p>jQuery widget factory 帮我们做了很多事情，尤其一些插件公共部分的生命周期管理，都帮我们实现了，所以创建一个jQuery UI组件从widget factory开始。</p><p>jQueryUI的widget公共模块，只依赖jQuery，没有和jQueryUI的core模块耦合，是一个纯粹的工厂函数实现，很方便定义自己的ui组件。</p></blockquote><p>举个栗子：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$.widget(<span class="string">'repay.step'</span>, &#123;</span><br><span class="line">  _create: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li><li><p>命名空间(namespace)： ‘repay.step’，其中repay是namespace；step是控件名称。<strong>ui</strong> 命名空间默认留给jquery.ui使用了。</p></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 调用</span></span><br><span class="line">$(<span class="string">'table'</span>).step();</span><br></pre></td></tr></table></figure><ul><li>继续step的例子</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 这个是控件的模版 --&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">name</span>=<span class="string">"step"</span> <span class="attr">class</span>=<span class="string">"step"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">"text-center"</span>&gt;</span>第一步<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure><p>控件的每一步有三个状态：原始状态，活动状态，焦点状态。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @date 2017-05-08</span></span><br><span class="line"><span class="comment"> * @author lijunnan</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">$</span>) </span>&#123;</span><br><span class="line"><span class="keyword">var</span> baseClass = <span class="string">'step'</span>,</span><br><span class="line">textClass = <span class="string">'text-center'</span>,</span><br><span class="line">activeClass = <span class="string">'active'</span>,</span><br><span class="line">focusClass = <span class="string">'js-focus'</span>;</span><br><span class="line"></span><br><span class="line">$.widget(<span class="string">'repay.step'</span>, &#123;</span><br><span class="line">options: &#123;</span><br><span class="line">VERSION: <span class="string">'0.0.1'</span>,</span><br><span class="line">NAME: <span class="string">'step'</span>,</span><br><span class="line">template: <span class="string">'&lt;td&gt;&lt;/td&gt;'</span></span><br><span class="line">&#125;,</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 创建控件的时候调用.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">_create: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">this</span>._haveContainer()) &#123;</span><br><span class="line"><span class="keyword">this</span>._addContainer();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">this</span>.refresh();</span><br><span class="line"><span class="keyword">this</span>.$container = <span class="keyword">this</span>.element.find(<span class="string">'tr'</span>);</span><br><span class="line">&#125;,</span><br><span class="line">add: <span class="function"><span class="keyword">function</span> (<span class="params">name</span>) </span>&#123;</span><br><span class="line">$(<span class="keyword">this</span>.options.template).appendTo(<span class="keyword">this</span>.$container).text(name);</span><br><span class="line"><span class="keyword">this</span>.refresh();</span><br><span class="line">&#125;,</span><br><span class="line">refresh: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.element.addClass(baseClass);</span><br><span class="line"><span class="keyword">this</span>.element.find(<span class="string">'td'</span>).addClass(textClass);</span><br><span class="line">&#125;,</span><br><span class="line">activate: <span class="function"><span class="keyword">function</span> (<span class="params">index, onFocus</span>) </span>&#123;</span><br><span class="line">onFocus = <span class="keyword">typeof</span> onFocus === <span class="string">'boolean'</span> ? onFocus : <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">var</span> classes = onFocus ? activeClass + <span class="string">" "</span> + focusClass : activeClass;</span><br><span class="line"><span class="keyword">this</span>.element.find(<span class="string">'td'</span>).eq(<span class="keyword">this</span>._constrainedIndex(index))</span><br><span class="line">.addClass(classes);</span><br><span class="line">&#125;,</span><br><span class="line">isFocus: <span class="function"><span class="keyword">function</span> (<span class="params">index</span>) </span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">this</span>.element.find(<span class="string">'td'</span>).eq(<span class="keyword">this</span>._constrainedIndex(index))</span><br><span class="line">.hasClass(focusClass);</span><br><span class="line">&#125;,</span><br><span class="line">isActive: <span class="function"><span class="keyword">function</span> (<span class="params">index</span>) </span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">this</span>.element.find(<span class="string">'td'</span>).eq(<span class="keyword">this</span>._constrainedIndex(index))</span><br><span class="line">.hasClass(activeClass);</span><br><span class="line">&#125;,</span><br><span class="line">_haveContainer: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">this</span>.element.find(<span class="string">'tr'</span>).length &gt; <span class="number">0</span>;</span><br><span class="line">&#125;,</span><br><span class="line">_addContainer: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.element.append(<span class="string">'&lt;tbody&gt;&lt;tr&gt;&lt;/tr&gt;&lt;/tbody&gt;'</span>);</span><br><span class="line">&#125;,</span><br><span class="line">_constrainedIndex: <span class="function"><span class="keyword">function</span> (<span class="params">index</span>) </span>&#123;</span><br><span class="line"><span class="keyword">var</span> $allSteps = <span class="keyword">this</span>.element.find(<span class="string">'td'</span>),</span><br><span class="line">lastIndex = $allSteps.length - <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">typeof</span> index !== <span class="string">'number'</span>) &#123;</span><br><span class="line">index = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">index = index &lt; <span class="number">0</span> ? <span class="number">0</span> : index;</span><br><span class="line">index = index &gt; lastIndex ? lastIndex : index;</span><br><span class="line"><span class="keyword">return</span> index;</span><br><span class="line">&#125;,</span><br><span class="line">      _destroy: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.element.remove();</span><br><span class="line">        &#125;,</span><br><span class="line">        next: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> activeSelector = <span class="string">'.'</span> + activeClass, </span><br><span class="line">                focusSelector = <span class="string">'.'</span> + focusClass, </span><br><span class="line">                focusIndex,</span><br><span class="line">                $allSteps = <span class="keyword">this</span>.element.find(<span class="string">'td'</span>), </span><br><span class="line">                maxIndex = $allSteps.length - <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">var</span> $focusNode = $allSteps.filter(activeSelector + focusSelector);</span><br><span class="line">            <span class="keyword">if</span> ($focusNode.length === <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">this</span>.activate(<span class="number">0</span>);</span><br><span class="line">                <span class="keyword">this</span>._trigger(<span class="string">'start'</span>, <span class="literal">null</span>, &#123;</span><br><span class="line">                    name: $allSteps.first().text(),</span><br><span class="line">                    index: <span class="number">0</span></span><br><span class="line">                &#125;);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                focusIndex = <span class="keyword">this</span>._constrainedIndex($focusNode.next().index());</span><br><span class="line">                $focusNode.removeClass(focusClass)</span><br><span class="line">                    .next(<span class="string">'td'</span>).addClass(activeClass + <span class="string">' '</span> + focusClass);</span><br><span class="line">                <span class="keyword">if</span> (focusIndex === maxIndex) &#123;</span><br><span class="line">                    <span class="keyword">this</span>._trigger(<span class="string">'done'</span>, <span class="literal">null</span>, &#123;</span><br><span class="line">                    name: $focusNode.text(),</span><br><span class="line">                    index: focusIndex</span><br><span class="line">                &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;);</span><br><span class="line">&#125;)(jQuery);</span><br></pre></td></tr></table></figure><p>上面的代码控件已经完成了。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 模版1 --&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">name</span>=<span class="string">"step"</span> <span class="attr">class</span>=<span class="string">"step"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">"text-center"</span>&gt;</span>第1步<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">"text-center"</span>&gt;</span>第2步<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">"text-center"</span>&gt;</span>第3步<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>控件的初始化</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 控件的初始化调用</span></span><br><span class="line">$(<span class="string">'table'</span>).step(); <span class="comment">// 这样就创建了step控件实例</span></span><br></pre></td></tr></table></figure><ul><li>控件的方法调用</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 活动状态</span></span><br><span class="line">$(<span class="string">'table'</span>).step(<span class="string">'next'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用带参数的方法</span></span><br><span class="line">$(<span class="string">'table'</span>).step(<span class="string">'isActive'</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 销毁控件</span></span><br><span class="line">$(<span class="string">'table'</span>).step(<span class="string">'destroy'</span>);</span><br></pre></td></tr></table></figure><ul><li><p>事件</p><blockquote><p>事件是控件的很重要的一部分，事件是控件和外界其它控件解耦的关键。</p></blockquote></li></ul><p>栗子中next方法：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 触发的start</span></span><br><span class="line"><span class="keyword">this</span>._trigger(<span class="string">'start'</span>, <span class="literal">null</span>, &#123;</span><br><span class="line">  name: $allSteps.first().text(),</span><br><span class="line">  index: <span class="number">0</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">this</span>._trigger(<span class="string">'done'</span>, <span class="literal">null</span>, &#123;</span><br><span class="line">  name: $focusNode.text(),</span><br><span class="line">  index: focusIndex</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><blockquote><p>this._trigger方法是从<strong>jQuery.Widget继承的</strong> ，  此方法对触发事件做了特殊处理，所以控件对外发布的事件会变成<strong>控件名+事件名</strong> 。所以start和done事件，对外发布的事件是stepstart和stepdone。</p></blockquote><ul><li><p>监听事件</p><blockquote><p>事件对外发布之后，我们可以根据控件发布的事件，做一些其它的业务处理。</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="built_in">document</span>).on(<span class="string">'stepstart'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">evt, data</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> args = <span class="built_in">arguments</span>;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'stepstart'</span>);</span><br><span class="line">&#125;).on(<span class="string">'stepdone'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> args = <span class="built_in">arguments</span>;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'stepdone'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li></ul><h4 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h4><blockquote><p>step已经完成了一个完整的控件例子的展示，从create控件建立控件到destory控件，整个生命周期的管理。</p><p>一个控件最终要的就是几个部分：</p><ol><li>初始化渲染(create)</li><li>控件的事件(event)</li><li>控件的销毁(destroy)</li><li>控件的扩展性(extend)</li><li>可配置性(configurable)：通过option来动态改变控件的状态。</li></ol></blockquote><h4 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h4><p><a href="https://www.smashingmagazine.com/2011/10/essential-jquery-plugin-patterns/" target="_blank" rel="noopener">https://www.smashingmagazine.com/2011/10/essential-jquery-plugin-patterns/</a></p><p><a href="http://www.cnblogs.com/timy/archive/2011/04/01/2001871.html" target="_blank" rel="noopener">http://www.cnblogs.com/timy/archive/2011/04/01/2001871.html</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;使用jQuery-UI-widget编写有状态的插件&quot;&gt;&lt;a href=&quot;#使用jQuery-UI-widget编写有状态的插件&quot; class=&quot;headerlink&quot; title=&quot;使用jQuery UI widget编写有状态的插件&quot;&gt;&lt;/a&gt;使用jQuery
      
    
    </summary>
    
      <category term="jQuery" scheme="https://betgar.github.io/categories/jQuery/"/>
    
    
      <category term="jQuery" scheme="https://betgar.github.io/tags/jQuery/"/>
    
      <category term="jQuery Widget" scheme="https://betgar.github.io/tags/jQuery-Widget/"/>
    
  </entry>
  
  <entry>
    <title>Oracle中被锁定的表</title>
    <link href="https://betgar.github.io/2017/04/18/query-oracle-table-locked/"/>
    <id>https://betgar.github.io/2017/04/18/query-oracle-table-locked/</id>
    <published>2017-04-18T12:00:00.000Z</published>
    <updated>2018-06-28T11:24:48.112Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Oracle-中被锁定的表"><a href="#Oracle-中被锁定的表" class="headerlink" title="Oracle 中被锁定的表"></a>Oracle 中被锁定的表</h1><blockquote><p>查询oracle中被锁定的表</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 相关表</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> V$<span class="keyword">LOCK</span>;</span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> V$SQLAREA;</span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> V$<span class="keyword">SESSION</span>;</span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> V$PROCESS ;</span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> V$LOCKED_OBJECT;</span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> ALL_OBJECTS;</span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> V$SESSION_WAIT;</span><br></pre></td></tr></table></figure><h2 id="查询锁定的对象"><a href="#查询锁定的对象" class="headerlink" title="查询锁定的对象"></a>查询锁定的对象</h2><blockquote><p>查询数据库中锁定的对象</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 可以根据操作系统的用户名查询</span></span><br><span class="line"><span class="keyword">SELECT</span> B.OWNER, B.OBJECT_NAME, A.SESSION_ID, A.LOCKED_MODE, A.PROCESS,</span><br><span class="line">       A.OS_USER_NAME</span><br><span class="line">  <span class="keyword">FROM</span> V$LOCKED_OBJECT A, DBA_OBJECTS B</span><br><span class="line"> <span class="keyword">WHERE</span> B.OBJECT_ID = A.OBJECT_ID</span><br><span class="line">   <span class="comment">-- AND A.OS_USER_NAME = '操作系统用户名称';</span></span><br></pre></td></tr></table></figure><blockquote><p> 查询Session和SERIAL#序号</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- SESSION_ID会话id</span></span><br><span class="line"><span class="keyword">SELECT</span> B.USERNAME, B.SID, B.SERIAL#, LOGON_TIME</span><br><span class="line">  <span class="keyword">FROM</span> V$LOCKED_OBJECT A, V$<span class="keyword">SESSION</span> B</span><br><span class="line"> <span class="keyword">WHERE</span> A.SESSION_ID = B.SID</span><br><span class="line">   <span class="keyword">AND</span> A.SESSION_ID <span class="keyword">IN</span> (<span class="number">404</span>) <span class="comment">-- 会话id</span></span><br><span class="line"> <span class="keyword">ORDER</span> <span class="keyword">BY</span> B.LOGON_TIME;</span><br></pre></td></tr></table></figure><h2 id="杀死锁定表的会话-Session"><a href="#杀死锁定表的会话-Session" class="headerlink" title="杀死锁定表的会话(Session)"></a>杀死锁定表的会话(Session)</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询被锁定的表</span></span><br><span class="line"><span class="comment">-- OS_USER_NAME操作系统用户名称</span></span><br><span class="line"><span class="keyword">SELECT</span> B.OWNER, B.OBJECT_NAME, A.SESSION_ID, A.LOCKED_MODE, A.PROCESS,</span><br><span class="line">       A.OS_USER_NAME</span><br><span class="line">  <span class="keyword">FROM</span> V$LOCKED_OBJECT A, DBA_OBJECTS B</span><br><span class="line"> <span class="keyword">WHERE</span> B.OBJECT_ID = A.OBJECT_ID</span><br><span class="line">   <span class="comment">-- AND A.OS_USER_NAME = 'os';</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询Session和SERIAL#序号</span></span><br><span class="line"><span class="keyword">SELECT</span> B.USERNAME, B.SID, B.SERIAL#, LOGON_TIME</span><br><span class="line">  <span class="keyword">FROM</span> V$LOCKED_OBJECT A, V$<span class="keyword">SESSION</span> B</span><br><span class="line"> <span class="keyword">WHERE</span> A.SESSION_ID = B.SID</span><br><span class="line">   <span class="keyword">AND</span> A.SESSION_ID <span class="keyword">IN</span> (<span class="number">404</span>)</span><br><span class="line"> <span class="keyword">ORDER</span> <span class="keyword">BY</span> B.LOGON_TIME;</span><br><span class="line"> </span><br><span class="line"> <span class="comment">-- 根据Session和SERIAL#序号杀死锁定的会话</span></span><br><span class="line"> <span class="keyword">ALTER</span> <span class="keyword">SYSTEM</span> <span class="keyword">KILL</span> <span class="keyword">SESSION</span> <span class="string">'404,6797'</span>;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Oracle-中被锁定的表&quot;&gt;&lt;a href=&quot;#Oracle-中被锁定的表&quot; class=&quot;headerlink&quot; title=&quot;Oracle 中被锁定的表&quot;&gt;&lt;/a&gt;Oracle 中被锁定的表&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;查询oracle中被锁定的
      
    
    </summary>
    
      <category term="Oracle" scheme="https://betgar.github.io/categories/Oracle/"/>
    
    
      <category term="Oracle" scheme="https://betgar.github.io/tags/Oracle/"/>
    
  </entry>
  
  <entry>
    <title>羽毛球赛规则</title>
    <link href="https://betgar.github.io/2017/04/14/the-rules-of-badminton/"/>
    <id>https://betgar.github.io/2017/04/14/the-rules-of-badminton/</id>
    <published>2017-04-14T12:00:00.000Z</published>
    <updated>2018-06-28T11:24:48.019Z</updated>
    
    <content type="html"><![CDATA[<h1 id="羽毛球赛规则"><a href="#羽毛球赛规则" class="headerlink" title="羽毛球赛规则"></a>羽毛球赛规则</h1><blockquote><p>赛事规则，像我这种的非常必要了解。</p></blockquote><h2 id="规则"><a href="#规则" class="headerlink" title="规则"></a>规则</h2><p>首局获胜一方在接下来的一局比赛中先发球。 羽毛球双打比赛还有其它的一些规则，包括：</p><ol><li><p>一局比赛开始应从右发球区发球。</p></li><li><p>只有接发球员才能接发球；如果他的同伴去接球或被球触及，发球方得一分。</p></li><li><p>自发球被回击后，由发球方的任何一人击球，然后由接发球方的任何一人击球，如此往返直至死球。</p></li><li><p>自发球被回击后，运动员可以从网的各自一方任何位置击球。</p></li><li><p>接发球方违例或因球触及接发球方场区内的地面而成死球，发球方得一分，原双打发球员继续发球。</p></li><li><p>发球方违例或应球触及发球方场区内的地面而成死球，原双打发球员即失去发球权，对方得分。</p></li><li><p>双打比赛中，当比分为0或偶数时，球由右发球区对角发向对方场地的右接发球区；当比分为奇数时，球由左发球区对角发向对方场地的左接发球区。双打比赛中，只有当一方连续得分时，发球员必须在右或左发球区交替发球，而接发球方队员的位置不变。其它情况下，选手应站在上一回合的各自发球区不变，以此保证发球员的交替。</p></li><li><p>羽毛球双打比赛一方每次只有一次发球权。发球方失误不仅丢失发球权也将丢失1分，如果这时得发球权的一方得分为奇数时，则必须是位于左发球区的选手发球，如果此时得发球权的一方得分为偶数时，则必须是位于右发球区的选手发球。</p></li><li><p>羽毛球双打比赛只有接发球队员才能接发球，若其同伴接发球或被球触及则“违例”，判发球方得分，当发球被回击后，球可由二人中任一人击回，不得连击，如此往返直至死球。</p></li><li><p>羽毛球双打比赛发球时，发球队员和接发球队员必须站在规定的发球区和接发球区内发球和接发球，他们的同伴站位可以不受限制，但不得妨碍对方。运动员发球和接发球顺序有误，已得比分有效，纠正方位或顺序。</p></li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;羽毛球赛规则&quot;&gt;&lt;a href=&quot;#羽毛球赛规则&quot; class=&quot;headerlink&quot; title=&quot;羽毛球赛规则&quot;&gt;&lt;/a&gt;羽毛球赛规则&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;赛事规则，像我这种的非常必要了解。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 i
      
    
    </summary>
    
      <category term="sports" scheme="https://betgar.github.io/categories/sports/"/>
    
    
      <category term="sports" scheme="https://betgar.github.io/tags/sports/"/>
    
  </entry>
  
  <entry>
    <title>nbtstat</title>
    <link href="https://betgar.github.io/2017/04/10/how-to-use-nbtstat-command-get-ip-address/"/>
    <id>https://betgar.github.io/2017/04/10/how-to-use-nbtstat-command-get-ip-address/</id>
    <published>2017-04-10T12:00:00.000Z</published>
    <updated>2018-06-28T11:24:48.019Z</updated>
    
    <content type="html"><![CDATA[<h1 id="nbtstat计算机名称和MAC互转"><a href="#nbtstat计算机名称和MAC互转" class="headerlink" title="nbtstat计算机名称和MAC互转"></a>nbtstat计算机名称和MAC互转</h1><h4 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h4><blockquote><p>因为个人部署了一个小博客，发布一些经验总结方便自己（顺便方便一下大家）。因为个人的电脑IP地址是动态的，所以经常导致之前分享的地址不能使用，所以经过研究，发下了一个一劳永逸的好办法，唯一要求只需要你记得计算机名称(computer name)。</p><p>如果电脑处于休眠状态还需要你记得MAC地址（最好记住这个）。</p><p>MAC : D43D7ED1CE05</p></blockquote><h4 id="个人计算机名称"><a href="#个人计算机名称" class="headerlink" title="个人计算机名称"></a>个人计算机名称</h4><blockquote><p>JN</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MAC地址：D43D7ED1CE05</span><br></pre></td></tr></table></figure><h4 id="通过计算机名称查询MAC和IP地址"><a href="#通过计算机名称查询MAC和IP地址" class="headerlink" title="通过计算机名称查询MAC和IP地址"></a>通过计算机名称查询MAC和IP地址</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nbtstat -a LIJN</span><br></pre></td></tr></table></figure><h4 id="通过IP查询计算机名称和MAC地址"><a href="#通过IP查询计算机名称和MAC地址" class="headerlink" title="通过IP查询计算机名称和MAC地址"></a>通过IP查询计算机名称和MAC地址</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nbtstat -A 10.11.4.11</span><br></pre></td></tr></table></figure><h4 id="查看帮助"><a href="#查看帮助" class="headerlink" title="查看帮助"></a>查看帮助</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nbtstat /?    # 帮助</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;nbtstat计算机名称和MAC互转&quot;&gt;&lt;a href=&quot;#nbtstat计算机名称和MAC互转&quot; class=&quot;headerlink&quot; title=&quot;nbtstat计算机名称和MAC互转&quot;&gt;&lt;/a&gt;nbtstat计算机名称和MAC互转&lt;/h1&gt;&lt;h4 id=&quot;背
      
    
    </summary>
    
      <category term="cmd" scheme="https://betgar.github.io/categories/cmd/"/>
    
    
      <category term="cmd" scheme="https://betgar.github.io/tags/cmd/"/>
    
  </entry>
  
  <entry>
    <title>Linux命令学习笔记</title>
    <link href="https://betgar.github.io/2017/03/29/the-linux-command-line-learn-note/"/>
    <id>https://betgar.github.io/2017/03/29/the-linux-command-line-learn-note/</id>
    <published>2017-03-29T12:00:00.000Z</published>
    <updated>2018-06-28T11:24:48.019Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Linux命令学习笔记"><a href="#Linux命令学习笔记" class="headerlink" title="Linux命令学习笔记"></a>Linux命令学习笔记</h3><h4 id="Linux系统目录结构"><a href="#Linux系统目录结构" class="headerlink" title="Linux系统目录结构"></a>Linux系统目录结构</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">/-- # root</span><br><span class="line"></span><br><span class="line"> |--bin                # Essential command binaries</span><br><span class="line"></span><br><span class="line"> |--boot                  # Static files of the boot loader</span><br><span class="line"></span><br><span class="line"> |--dev                # Device files</span><br><span class="line"></span><br><span class="line"> |--etc                # Host-specific system configuration</span><br><span class="line"></span><br><span class="line"> |--lib                #   Essential shared libraries and kernel modules</span><br><span class="line"></span><br><span class="line"> |--media        #  Mount point for removeable media</span><br><span class="line"></span><br><span class="line"> |--mnt                # Mount point for mounting a filesystem temporarily</span><br><span class="line"></span><br><span class="line"> |--opt                 # Add-on application software packages</span><br><span class="line"></span><br><span class="line"> |--sbin                 # Essential system binaries</span><br><span class="line"></span><br><span class="line"> |--srv                 # Data for services provided by this system</span><br><span class="line"></span><br><span class="line"> |--tmp                 # Temporary files</span><br><span class="line"></span><br><span class="line"> |--usr                 # Secondary hierarchy</span><br><span class="line"></span><br><span class="line"> |--var                 # Variable data</span><br></pre></td></tr></table></figure><h4 id="Linux系统目录简写名称"><a href="#Linux系统目录简写名称" class="headerlink" title="Linux系统目录简写名称"></a>Linux系统目录简写名称</h4><h4 id="Linux命令缩写含义（Linux-short-command-meaning）"><a href="#Linux命令缩写含义（Linux-short-command-meaning）" class="headerlink" title="Linux命令缩写含义（Linux short command meaning）"></a>Linux命令缩写含义（Linux short command meaning）</h4><ul><li>pwd: print work directory</li></ul><ul><li><p>cd:  change directory</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd ~</span><br><span class="line">cd - # 在上一个和当前目录之间切换</span><br><span class="line">cd ~user name # 切换到指定的用户的home目录</span><br></pre></td></tr></table></figure></li></ul><h5 id="文件和目录"><a href="#文件和目录" class="headerlink" title="文件和目录"></a>文件和目录</h5><ul><li>ls: list</li><li>cp: copy</li><li>mv: move </li><li>mkdir: make directory</li><li>rm : remove </li><li>ln : link</li><li>less: less is more(more也是一个命令.zless和less一样，但是可以读取gzip文件)</li><li>file</li></ul><h4 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h4><ul><li>type</li><li>which</li><li>whatis</li><li>alias</li><li>info</li><li>man: manual</li><li>apropos</li><li>help</li></ul><h4 id="重定向"><a href="#重定向" class="headerlink" title="重定向"></a>重定向</h4><ul><li>cat: （链接多个文件）</li><li>head</li><li>tail</li><li>sort</li><li>uniq</li><li>grep</li><li>wc</li></ul><h5 id="标准重定向"><a href="#标准重定向" class="headerlink" title="标准重定向"></a>标准重定向</h5><blockquote><p>标准输入、输出、错误在shell 内部参考它们为文件描述符 0， 1 和 2。</p></blockquote><h6 id="重定向标准输出"><a href="#重定向标准输出" class="headerlink" title="重定向标准输出"></a>重定向标准输出</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 重定向标准输出到文件(这里会重新覆写ls-stdout.txt)</span><br><span class="line">ls -l &gt; ls-stdout.txt</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 追加到ls-stdout.txt</span><br><span class="line">ls -l &gt;&gt; ls-stdout.txt</span><br></pre></td></tr></table></figure><h6 id="重定向错误"><a href="#重定向错误" class="headerlink" title="重定向错误"></a>重定向错误</h6><blockquote><p>错误文件描述符为：2</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 重定向错误</span><br><span class="line">ls -l /bin/usr 2&gt; ls-error.txt</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 标准输出和错误输出到同一个文件</span><br><span class="line">ls -l /bin/usr &gt; ls-error.txt 2&gt;&amp;1</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> bash现代版本支持</span><br><span class="line">ls -l /bin/usr &amp;&gt; ls-error.txt</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;Linux命令学习笔记&quot;&gt;&lt;a href=&quot;#Linux命令学习笔记&quot; class=&quot;headerlink&quot; title=&quot;Linux命令学习笔记&quot;&gt;&lt;/a&gt;Linux命令学习笔记&lt;/h3&gt;&lt;h4 id=&quot;Linux系统目录结构&quot;&gt;&lt;a href=&quot;#Linux系
      
    
    </summary>
    
      <category term="linux" scheme="https://betgar.github.io/categories/linux/"/>
    
    
      <category term="linux" scheme="https://betgar.github.io/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>UNIX文件系统的历史</title>
    <link href="https://betgar.github.io/2017/03/29/a-history-of-unix-directory-structure/"/>
    <id>https://betgar.github.io/2017/03/29/a-history-of-unix-directory-structure/</id>
    <published>2017-03-29T12:00:00.000Z</published>
    <updated>2018-06-28T11:24:47.972Z</updated>
    
    <content type="html"><![CDATA[<p><a href="http://www.pathname.com/fhs/" target="_blank" rel="noopener">Filesystem Hierarchy Standard</a></p><p><a href="http://www.ruanyifeng.com/blog/2012/02/a_history_of_unix_directory_structure.html" target="_blank" rel="noopener">阮一峰译文</a></p><p><a href="http://lists.busybox.net/pipermail/busybox/2010-December/074114.html" target="_blank" rel="noopener">Rob Landley原文</a></p><p>On Tuesday 30 November 2010 15:58:00 David Collier wrote:</p><blockquote><p>I see that busybox spreads it’s links over these 4 directories.</p><p>Is there a simple rule which decides which directory each link lives<br>in…..</p><p>For instance I see kill is in /bin and killall in /usr/bin…. I don’t<br>have a grip on what might be the logic for that.</p></blockquote><p>You know how Ken Thompson and Dennis Ritchie created Unix on a PDP-7 in 1969?<br>Well around 1971 they upgraded to a PDP-11 with a pair of RK05 disk packs (1.5<br>megabytes each) for storage.</p><p>When the operating system grew too big to fit on the first RK05 disk pack (their<br>root filesystem) they let it leak into the second one, which is where all the<br>user home directories lived (which is why the mount was called /usr).  They<br>replicated all the OS directories under there (/bin, /sbin, /lib, /tmp…) and<br>wrote files to those new directories because their original disk was out of<br>space.  When they got a third disk, they mounted it on /home and relocated all<br>the user directories to there so the OS could consume all the space on both<br>disks and grow to THREE WHOLE MEGABYTES (ooooh!).</p><p>Of course they made rules about “when the system first boots, it has to come up<br>enough to be able to mount the second disk on /usr, so don’t put things like<br>the mount command /usr/bin or we’ll have a chicken and egg problem bringing<br>the system up.”  Fairly straightforward.  Also fairly specific to v6 unix of 35<br>years ago.</p><p>The /bin vs /usr/bin split (and all the others) is an artifact of this, a<br>1970’s implementation detail that got carried forward for decades by<br>bureaucrats who never question <em>why</em> they’re doing things.  It stopped making<br>any sense before Linux was ever invented, for multiple reasons:</p><p>1) Early system bringup is the provice of initrd and initramfs, which deals<br>with the “this file is needed before that file” issues.  We’ve already <em>got</em> a<br>temporary system that boots the main system.</p><p>2) shared libraries (introduced by the Berkeley guys) prevent you from<br>independently upgrading the /lib and /usr/bin parts.  They two partitions have<br>to <em>match</em> or they won’t work.  This wasn’t the case in 1974, back then they<br>had a certain level of independence because everything was statically linked.</p><p>3) Cheap retail hard drives passed the 100 megabyte mark around 1990, and<br>partition resizing software showed up somewhere around there (partition magic<br>3.0 shipped in 1997).</p><p>Of course once the split existed, some people made other rules to justify it.<br>Root was for the OS stuff you got from upstream and /usr was for your site-<br>local files.  Then / was for the stuff you got from AT&amp;T and /usr was for the<br>stuff that your distro like IBM AIX or Dec Ultrix or SGI Irix added to it, and<br>/usr/local was for your specific installation’s files.  Then somebody decided<br>/usr/local wasn’t a good place to install new packages, so let’s add /opt!<br>I’m still waiting for /opt/local to show up…</p><p>Of course given 30 years to fester, this split made some interesting distro-<br>specific rules show up and go away again, such as “/tmp is cleared between<br>reboots but /usr/tmp isn’t”.  (Of course on Ubuntu /usr/tmp doesn’t exist and<br>on Gentoo /usr/tmp is a symlink to /var/tmp which now has the “not cleared<br>between reboots” rule.  Yes all this predated tmpfs.  It has to do with read-<br>only root filesystems, /usr is always going to be read only in that case and<br>/var is where your writable space is, / is <em>mostly</em> read only except for bits<br>of /etc which they tried to move to /var but really symlinking /etc to<br>/var/etc happens more often than not…)</p><p>Standards bureaucracies like the Linux Foundation (which consumed the Free<br>Standards Group in its’ ever-growing accretion disk years ago) happily<br>document and add to this sort of complexity without ever trying to understand<br>why it was there in the first place.  ‘Ken and Dennis leaked their OS into the<br>equivalent of home because an RK05 disk pack on the PDP-11 was too small” goes<br>whoosh over their heads.</p><p>I’m pretty sure the busybox install just puts binaries wherever other versions<br>of those binaries have historically gone.  There’s no actual REASON for any of<br>it anymore.  Personally, I symlink /bin /sbin and /lib to their /usr<br>equivalents on systems I put together.  Embedded guys try to understand and<br>simplify…</p><h2 id="Rob"><a href="#Rob" class="headerlink" title="Rob"></a>Rob</h2><p>GPLv3: as worthy a successor as The Phantom Menace, as timely as Duke Nukem<br>Forever, and as welcome as New Coke.</p><p>On Thursday 09 December 2010 16:45, Rob Landley wrote:</p><blockquote><p>The /bin vs /usr/bin split (and all the others) is an artifact of this, a<br>1970’s implementation detail that got carried forward for decades by<br>bureaucrats who never question <em>why</em> they’re doing things.  It stopped making<br>any sense before Linux was ever invented, for multiple reasons:<br>…</p></blockquote><blockquote><p>I’m pretty sure the busybox install just puts binaries wherever other versions<br>of those binaries have historically gone.  There’s no actual REASON for any of<br>it anymore.  Personally, I symlink /bin /sbin and /lib to their /usr<br>equivalents on systems I put together.  Embedded guys try to understand and<br>simplify…</p></blockquote><p>Another simplification:</p><p>I symlink [/usr]/sbin to bin. If a program shouldn’t be runnable by a non-root,<br>it can easily be arranged by suitable mode in the binary. No need to have<br>separate directory for that.</p><p>–<br>vda</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;http://www.pathname.com/fhs/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Filesystem Hierarchy Standard&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.ruanyi
      
    
    </summary>
    
      <category term="FHS" scheme="https://betgar.github.io/categories/FHS/"/>
    
    
      <category term="FHS" scheme="https://betgar.github.io/tags/FHS/"/>
    
  </entry>
  
  <entry>
    <title>fuel-ux-spinner源码</title>
    <link href="https://betgar.github.io/2017/03/04/fuel-ux-spinner/"/>
    <id>https://betgar.github.io/2017/03/04/fuel-ux-spinner/</id>
    <published>2017-03-04T12:00:00.000Z</published>
    <updated>2018-06-28T11:24:48.034Z</updated>
    
    <content type="html"><![CDATA[<h1 id="fuel-ux-spinner源码"><a href="#fuel-ux-spinner源码" class="headerlink" title="fuel-ux-spinner源码"></a>fuel-ux-spinner源码</h1><blockquote><p>之前使用到了bootstrap的一个插件，但是没有api，所以直接把源码拷贝出来备份一下。</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Fuel UX Spinner</span></span><br><span class="line"><span class="comment"> * https://github.com/ExactTarget/fuelux</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Copyright (c) 2012 ExactTarget</span></span><br><span class="line"><span class="comment"> * Licensed under the MIT license.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">!<span class="function"><span class="keyword">function</span>(<span class="params">$</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> Spinner = <span class="function"><span class="keyword">function</span>(<span class="params">element, options</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.$element = $(element),</span><br><span class="line">        <span class="keyword">this</span>.options = $.extend(&#123;&#125;, $.fn.spinner.defaults, options),</span><br><span class="line">        <span class="keyword">this</span>.$input = <span class="keyword">this</span>.$element.find(<span class="string">".spinner-input"</span>),</span><br><span class="line">        <span class="keyword">this</span>.$element.on(<span class="string">"keyup"</span>, <span class="keyword">this</span>.$input, $.proxy(<span class="keyword">this</span>.change, <span class="keyword">this</span>)),</span><br><span class="line">        <span class="keyword">this</span>.options.hold ? (<span class="keyword">this</span>.$element.on(<span class="string">"mousedown"</span>, <span class="string">".spinner-up"</span>, $.proxy(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.startSpin(!<span class="number">0</span>)</span><br><span class="line">        &#125;, <span class="keyword">this</span>)),</span><br><span class="line">        <span class="keyword">this</span>.$element.on(<span class="string">"mouseup"</span>, <span class="string">".spinner-up, .spinner-down"</span>, $.proxy(<span class="keyword">this</span>.stopSpin, <span class="keyword">this</span>)),</span><br><span class="line">        <span class="keyword">this</span>.$element.on(<span class="string">"mouseout"</span>, <span class="string">".spinner-up, .spinner-down"</span>, $.proxy(<span class="keyword">this</span>.stopSpin, <span class="keyword">this</span>)),</span><br><span class="line">        <span class="keyword">this</span>.$element.on(<span class="string">"mousedown"</span>, <span class="string">".spinner-down"</span>, $.proxy(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.startSpin(!<span class="number">1</span>)</span><br><span class="line">        &#125;, <span class="keyword">this</span>))) : (<span class="keyword">this</span>.$element.on(<span class="string">"click"</span>, <span class="string">".spinner-up"</span>, $.proxy(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.step(!<span class="number">0</span>)</span><br><span class="line">        &#125;, <span class="keyword">this</span>)),</span><br><span class="line">        <span class="keyword">this</span>.$element.on(<span class="string">"click"</span>, <span class="string">".spinner-down"</span>, $.proxy(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.step(!<span class="number">1</span>)</span><br><span class="line">        &#125;, <span class="keyword">this</span>))),</span><br><span class="line">        <span class="keyword">this</span>.switches = &#123;</span><br><span class="line">            count: <span class="number">1</span>,</span><br><span class="line">            enabled: !<span class="number">0</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="keyword">this</span>.switches.speed = <span class="string">"medium"</span> === <span class="keyword">this</span>.options.speed ? <span class="number">300</span> : <span class="string">"fast"</span> === <span class="keyword">this</span>.options.speed ? <span class="number">100</span> : <span class="number">500</span>,</span><br><span class="line">        <span class="keyword">this</span>.lastValue = <span class="literal">null</span>,</span><br><span class="line">        <span class="keyword">this</span>.render(),</span><br><span class="line">        <span class="keyword">this</span>.options.disabled &amp;&amp; <span class="keyword">this</span>.disable()</span><br><span class="line">    &#125;;</span><br><span class="line">    Spinner.prototype = &#123;</span><br><span class="line">        <span class="keyword">constructor</span>: Spinner,</span><br><span class="line">        render: function() &#123;</span><br><span class="line">            <span class="keyword">var</span> inputValue = <span class="keyword">this</span>.$input.val();</span><br><span class="line">            inputValue ? <span class="keyword">this</span>.value(inputValue) : <span class="keyword">this</span>.$input.val(<span class="keyword">this</span>.options.value),</span><br><span class="line">            <span class="keyword">this</span>.$input.attr(<span class="string">"maxlength"</span>, (<span class="keyword">this</span>.options.max + <span class="string">""</span>).split(<span class="string">""</span>).length)</span><br><span class="line">        &#125;,</span><br><span class="line">        change: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> value = <span class="keyword">this</span>.$input.val();</span><br><span class="line">            value / <span class="number">1</span> ? <span class="keyword">this</span>.options.value = value / <span class="number">1</span> : (value = value.replace(<span class="regexp">/[^0-9]/g</span>, <span class="string">""</span>),</span><br><span class="line">            <span class="keyword">this</span>.$input.val(value),</span><br><span class="line">            <span class="keyword">this</span>.options.value = value / <span class="number">1</span>),</span><br><span class="line">            <span class="keyword">this</span>.triggerChangedEvent()</span><br><span class="line">        &#125;,</span><br><span class="line">        stopSpin: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            clearTimeout(<span class="keyword">this</span>.switches.timeout),</span><br><span class="line">            <span class="keyword">this</span>.switches.count = <span class="number">1</span>,</span><br><span class="line">            <span class="keyword">this</span>.triggerChangedEvent()</span><br><span class="line">        &#125;,</span><br><span class="line">        triggerChangedEvent: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> value = <span class="keyword">this</span>.value();</span><br><span class="line">            value !== <span class="keyword">this</span>.lastValue &amp;&amp; (<span class="keyword">this</span>.lastValue = value,</span><br><span class="line">            <span class="keyword">this</span>.$element.trigger(<span class="string">"changed"</span>, value),</span><br><span class="line">            <span class="keyword">this</span>.$element.trigger(<span class="string">"change"</span>))</span><br><span class="line">        &#125;,</span><br><span class="line">        startSpin: <span class="function"><span class="keyword">function</span>(<span class="params">t</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="keyword">this</span>.options.disabled) &#123;</span><br><span class="line">                <span class="keyword">var</span> i = <span class="keyword">this</span>.switches.count;</span><br><span class="line">                <span class="number">1</span> === i ? (<span class="keyword">this</span>.step(t),</span><br><span class="line">                i = <span class="number">1</span>) : i = <span class="number">3</span> &gt; i ? <span class="number">1.5</span> : <span class="number">8</span> &gt; i ? <span class="number">2.5</span> : <span class="number">4</span>,</span><br><span class="line">                <span class="keyword">this</span>.switches.timeout = setTimeout($.proxy(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                    <span class="keyword">this</span>.iterator(t)</span><br><span class="line">                &#125;, <span class="keyword">this</span>), <span class="keyword">this</span>.switches.speed / i),</span><br><span class="line">                <span class="keyword">this</span>.switches.count++</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        iterator: <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.step(e),</span><br><span class="line">            <span class="keyword">this</span>.startSpin(e)</span><br><span class="line">        &#125;,</span><br><span class="line">        step: <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> t = <span class="keyword">this</span>.options.value</span><br><span class="line">              , i = e ? <span class="keyword">this</span>.options.max : <span class="keyword">this</span>.options.min;</span><br><span class="line">            <span class="keyword">if</span> (e ? i &gt; t : t &gt; i) &#123;</span><br><span class="line">                <span class="keyword">var</span> s = t + (e ? <span class="number">1</span> : <span class="number">-1</span>) * <span class="keyword">this</span>.options.step;</span><br><span class="line">                (e ? s &gt; i : i &gt; s) ? <span class="keyword">this</span>.value(i) : <span class="keyword">this</span>.value(s)</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">this</span>.options.cycle) &#123;</span><br><span class="line">                <span class="keyword">var</span> n = e ? <span class="keyword">this</span>.options.min : <span class="keyword">this</span>.options.max;</span><br><span class="line">                <span class="keyword">this</span>.value(n)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        value: <span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> !<span class="built_in">isNaN</span>(<span class="built_in">parseFloat</span>(value)) &amp;&amp; <span class="built_in">isFinite</span>(value) ? (value = <span class="built_in">parseFloat</span>(value),</span><br><span class="line">            <span class="keyword">this</span>.options.value = value,</span><br><span class="line">            <span class="keyword">this</span>.$input.val(value),</span><br><span class="line">            <span class="keyword">this</span>) : <span class="keyword">this</span>.options.value</span><br><span class="line">        &#125;,</span><br><span class="line">        disable: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.options.disabled = !<span class="number">0</span>,</span><br><span class="line">            <span class="keyword">this</span>.$input.attr(<span class="string">"disabled"</span>, <span class="string">""</span>),</span><br><span class="line">            <span class="keyword">this</span>.$element.find(<span class="string">"button"</span>).addClass(<span class="string">"disabled"</span>)</span><br><span class="line">        &#125;,</span><br><span class="line">        enable: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.options.disabled = !<span class="number">1</span>,</span><br><span class="line">            <span class="keyword">this</span>.$input.removeAttr(<span class="string">"disabled"</span>),</span><br><span class="line">            <span class="keyword">this</span>.$element.find(<span class="string">"button"</span>).removeClass(<span class="string">"disabled"</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    $.fn.spinner = <span class="function"><span class="keyword">function</span>(<span class="params">i, s</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> n, a = <span class="keyword">this</span>.each(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> a = $(<span class="keyword">this</span>)</span><br><span class="line">              , o = a.data(<span class="string">"spinner"</span>)</span><br><span class="line">              , r = <span class="string">"object"</span> == <span class="keyword">typeof</span> i &amp;&amp; i;</span><br><span class="line">            o || a.data(<span class="string">"spinner"</span>, o = <span class="keyword">new</span> Spinner(<span class="keyword">this</span>,r)),</span><br><span class="line">            <span class="string">"string"</span> == <span class="keyword">typeof</span> i &amp;&amp; (n = o[i](s))</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">void</span> <span class="number">0</span> === n ? a : n</span><br><span class="line">    &#125;</span><br><span class="line">    ,</span><br><span class="line">    $.fn.spinner.defaults = &#123;</span><br><span class="line">        value: <span class="number">1</span>,</span><br><span class="line">        min: <span class="number">1</span>,</span><br><span class="line">        max: <span class="number">999</span>,</span><br><span class="line">        step: <span class="number">1</span>,</span><br><span class="line">        hold: !<span class="number">0</span>,</span><br><span class="line">        speed: <span class="string">"medium"</span>,</span><br><span class="line">        disabled: !<span class="number">1</span></span><br><span class="line">    &#125;,</span><br><span class="line">    $.fn.spinner.Constructor = Spinner,</span><br><span class="line">    $(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        $(<span class="string">"body"</span>).on(<span class="string">"mousedown.spinner.data-api"</span>, <span class="string">".spinner"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> t = $(<span class="keyword">this</span>);</span><br><span class="line">            t.data(<span class="string">"spinner"</span>) || t.spinner(t.data())</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;(<span class="built_in">window</span>.jQuery);</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;fuel-ux-spinner源码&quot;&gt;&lt;a href=&quot;#fuel-ux-spinner源码&quot; class=&quot;headerlink&quot; title=&quot;fuel-ux-spinner源码&quot;&gt;&lt;/a&gt;fuel-ux-spinner源码&lt;/h1&gt;&lt;blockquote&gt;

      
    
    </summary>
    
      <category term="Bootstrap" scheme="https://betgar.github.io/categories/Bootstrap/"/>
    
    
      <category term="Bootstrap" scheme="https://betgar.github.io/tags/Bootstrap/"/>
    
      <category term="spinner" scheme="https://betgar.github.io/tags/spinner/"/>
    
  </entry>
  
  <entry>
    <title>NPM的正确使用姿势</title>
    <link href="https://betgar.github.io/2017/03/04/use-npm-with-right-posture/"/>
    <id>https://betgar.github.io/2017/03/04/use-npm-with-right-posture/</id>
    <published>2017-03-04T12:00:00.000Z</published>
    <updated>2018-06-28T11:24:47.956Z</updated>
    
    <content type="html"><![CDATA[<h2 id="NPM的正确使用姿势"><a href="#NPM的正确使用姿势" class="headerlink" title="NPM的正确使用姿势"></a>NPM的正确使用姿势</h2><blockquote><p>node package manager是node的包管理器，使用NPM来管理node的模块。</p><p>但是因为中国的独特的网络环境，所以给使用NPM带来很多不变。</p></blockquote><h3 id="安装cnpm"><a href="#安装cnpm" class="headerlink" title="安装cnpm"></a>安装cnpm</h3><blockquote><p>cnpm是npm的一个模块，它是淘宝（阿里）推出的一个为中国大陆开发者的工具，强烈建议使用cnpm安装项目依赖的插件，它可以帮你简化因为“网络环境”带来的问题。</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g cnpm</span><br></pre></td></tr></table></figure><h3 id="配置npm的registry"><a href="#配置npm的registry" class="headerlink" title="配置npm的registry"></a>配置npm的registry</h3><blockquote><p>国内访问npm的registry很慢，而且有时候还会出现错误，所以配置成淘宝的镜像。</p><p><strong>注意</strong> ：如果你决定使用cnpm安装依赖模块，可以不用配置npm的registry</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 配置全局的（永久生效）</span><br><span class="line">npm config set registry="https://registry.npm.taobao.org"</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 临时（一次性）</span><br><span class="line">npm install module_name --registry="https://registry.npm.taobao.org"</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 如果公司屏蔽了taobao</span><br><span class="line">npm config set registry="https://r.cnpmjs.org"</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 查看registry是否生效</span><br><span class="line">npm config get registry</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 查看默认的npm所有配置</span><br><span class="line">npm config list</span><br></pre></td></tr></table></figure><h3 id="配置cnpm的registry"><a href="#配置cnpm的registry" class="headerlink" title="配置cnpm的registry"></a>配置cnpm的registry</h3><blockquote><p>如果你的网络屏蔽了taobao，那就使用<a href="https://r.cnpmjs.org" target="_blank" rel="noopener">https://r.cnpmjs.org</a></p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 如果没有taobao访问限制，不需要这步配置</span><br><span class="line">cnpm config set registry="https://r.cnpmjs.org"</span><br></pre></td></tr></table></figure><h3 id="cnpm使用"><a href="#cnpm使用" class="headerlink" title="cnpm使用"></a>cnpm使用</h3><blockquote><p>因为cnpm的配置和npm的是完全独立，所以如果你希望单独配置cache，请重新配置。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span> # &lt;path&gt; 是真实路径</span><br><span class="line"><span class="meta">&gt;</span> cnpm config set cache="&lt;path&gt;"</span><br><span class="line"><span class="meta">&gt;</span></span><br></pre></td></tr></table></figure></blockquote><blockquote></blockquote><p>现在就可以使用cnpm代替npm操作，但是如果你需要发布一个模块，请切换使用npm来publish。因为cnpm是只读的，所以只能用来方便下载。</p><h3 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h3><p><a href="https://github.com/cnpm/cnpm" title="cnpm github" target="_blank" rel="noopener">cnpm-github</a></p><p><a href="https://npm.taobao.org/" title="cnpm China mirror" target="_blank" rel="noopener">China-mirror</a> </p><p><a href="https://cnpmjs.org/" title="cnpmjs" target="_blank" rel="noopener">cnpmjs</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;NPM的正确使用姿势&quot;&gt;&lt;a href=&quot;#NPM的正确使用姿势&quot; class=&quot;headerlink&quot; title=&quot;NPM的正确使用姿势&quot;&gt;&lt;/a&gt;NPM的正确使用姿势&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;node package manager是node
      
    
    </summary>
    
      <category term="npm" scheme="https://betgar.github.io/categories/npm/"/>
    
    
      <category term="npm" scheme="https://betgar.github.io/tags/npm/"/>
    
  </entry>
  
</feed>
